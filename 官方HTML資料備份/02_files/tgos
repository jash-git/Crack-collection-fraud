(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(d,a){var b=this.length>>>0,e=Number(a)||0,e=0>e?Math.ceil(e):Math.floor(e);for(0>e&&(e+=b);e<b;e++)if(e in this&&this[e]===d)return e;return-1});window.console||(window.console={},window.console.log=function(){},window.console.debug=function(){},window.console.warning=function(){});window.getWebProtocal=function(){return"https:"==document.location.protocol?"https://":"http://"};window.getAPIPath=function(){return"api.tgos.tw/"};
window.getServicePath=function(){return"gis.tgos.tw/"};window.TGOS={RES_PATH:getWebProtocal()+getAPIPath()+"TGOS_API/images/",SCRIPT_PATH:getWebProtocal()+getAPIPath()+"TGOS_API/src/"};TGOS.math=TGOS.math||{};TGOS.math.toRadian=function(d){return d/180*Math.PI};TGOS.math.toDegree=function(d){return 180*(d/Math.PI)};TGOS.RegisterEvent=function(d,a){var b=0;d.prototype.events||(d.prototype.events=[]);for(b=0;b<a.length;b++)d.prototype.events.push(a[b])};TGOS.extend=function(d,a){a.prototype=new d;a.prototype.constructor=
d;a.prototype._super_=d};TGOS.math.degreeToRadian=function(d){return d/180*Math.PI};TGOS.math.radianToDegree=function(d){return 180*(d/Math.PI)};TGOS.math.length=function(d,a){return Math.sqrt(d*d+a*a)};TGOS.math.rotate=function(d,a,b){b=TGOS.math.degreeToRadian(b);d=d*Math.cos(b)-a*Math.sin(b);a=d*Math.sin(b)+a*Math.cos(b);return{x:d,y:a}};TGOS.math.Matrix=function(){var d=function(a){this.arr_=a};d.square=function(a,b){return d.create(a,a,b)};d.rotate=function(a){a=TGOS.math.degreeToRadian(a);a=
[[Math.cos(a),-Math.sin(a),0],[Math.sin(a),Math.cos(a),0],[0,0,1]];return new d(a)};d.scale=function(a,b){return new d([[a,0,0],[0,b,0],[0,0,1]])};d.translate=function(a,b){return new d([[1,0,a],[0,1,b],[0,0,1]])};d.identity=function(a){for(var b=d.zero(a,a),g=b.arr_,h=0;h<a;h++)g[h][h]=1;return b};d.create=function(a,b,g){g=g?g:0;for(var h=[],k=0;k<a;k++){var l=Array(b);h.push(l);for(var p=0;p<b;p++)l[p]="function"==typeof g?g(k,p):g}return new d(h)};d.zero=function(a,b){return d.create(a,b,0)};
var a=d.prototype;a.toString=function(){for(var a="\n"+this.getRows()+" x "+this.getCols(),d=0;d<this.getRows();d++)a+="\n"+this.arr_[d].join();return a};a.array=function(){return arr_};a.getRows=function(){return this.arr_.length};a.getCols=function(){return this.arr_[0].length};a.get=function(a,d){return this.arr_[a][d]};a.set=function(a,d,b){this.arr_[a][d]=b};a.add=function(a){return this.elementOperate(a,function(d,b){return this.get(d,b)+a.get(d,b)})};a.productOperate=function(a,d){if(!this.isAligned(a))return null;
for(var b=0;b<r_this;b++)for(var h=0;h<c_target;h++){for(var k=0,l=0;l<c_this;l++)k+=this.arr_[b][l]*a.arr_[l][h];d(b,h,k)}return r};a.elementOperate=function(a,b){if(!this.isEqualSize(a))return null;var g=d.zero(r1,c1);this.forEach(function(a,d){g.set(a,d,b(a,d))});return g};a.multiply=function(a){return this.elementOperate(a,function(d,b){return this.get(d,b)*a.get(d,b)})};a.substract=function(a){return this.elementOperate(a,function(d,b){return this.get(d,b)-a.get(d,b)})};a.forEach=function(a){if(a)for(var d=
this.getCols(),b=this.getRows(),h=0;h<b;h++)for(var k=0;k<d;k++)a(h,k)};a.inverse=function(){var a=this.determinant();if(0==a)throw"This matrix have zero determinant";var b=this.arr_,g=b[0][0],h=b[0][1],k=b[0][2],l=b[1][0],p=b[1][1],m=b[1][2],n=b[2][0],u=b[2][1],b=b[2][2];return new d([[(p*b-m*u)/a,-(h*b-k*u)/a,(h*m-k*p)/a],[-(l*b-m*n)/a,(g*b-k*n)/a,-(g*m-k*l)/a],[k/a,-(g*u-h*n)/a,(g*p-h*l)/a]])};a.determinant=function(){var a=this.arr_,d=a[1][0],b=a[1][1],h=a[1][2],k=a[2][0],l=a[2][1],p=a[2][2];
return a[0][0]*(b*p-h*l)+a[0][1]*-(d*p-h*k)+a[0][2]*(d*l-b*k)};a.transform=function(a,b){var g=new d([[a],[b],[1]]),g=this.product(g);return{x:g.get(0,0),y:g.get(1,0)}};a.isEqualSize=function(a){var d=this.getRows(),b=this.getCols(),h=a.getRows();a=a.getCols();return b===a&&d===h};a.isAligned=function(a){this.getRows();var d=this.getCols(),b=a.getRows();a.getCols();return d===b};a.product=function(a){if(!this.isAligned(a))throw"Matrix not aligned";var b=this.getRows(),g=this.getCols();a.getRows();
for(var h=a.getCols(),k=d.zero(b,h),l=0;l<b;l++)for(var p=0;p<h;p++){for(var m=0,n=0;n<g;n++)m+=this.arr_[l][n]*a.arr_[n][p];k.set(l,p,m)}return k};return d}();window.util=util||{};util.removeEventHandler=function(d,a,b){d.removeEventListener&&d.removeEventListener(a,b,!1);d.detachEvent&&d.detachEvent("on"+a,b)};util.createUUID=function(d,a){return function(){return"xxxxTGOSxxxxxxxxxxxxxxxxxxxxxxxx".replace(d,a).toUpperCase()}}(/[xy]/g,function(d){var a=16*Math.random()|0;return("x"==d?a:a&3|8).toString(16)});
util.getInternetExplorerVersion=function(){var d=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(d=parseFloat(RegExp.$1));return d};util.eventTarget=function(d){return d.target?d.target:d.srcElement};util.disableDefault=function(d){d.preventDefault?d.preventDefault():d.returnValue=!1};util.disableSelect=function(d){d.addEventListener?d.addEventListener("mousedown",util.disabler,"false"):d.attachEvent("onselectstart",util.disabler)};
util.enableSelect=function(d){d.addEventListener?d.removeEventListener("mousedown",util.disabler,"false"):d.detachEvent("onselectstart",util.disabler)};util.disabler=function(d){util.disableDefault(d);return!1};util.intersectRect=function(d,a){return!(a.left>d.right||a.right<d.left||a.top>d.bottom||a.bottom<d.top)};util.loadScript=function(d){var a=document.createElement("script");a.src=d;document.getElementsByTagName("head")[0].appendChild(a)};var b=function(d){d=d.toString(16);return 1==d.length?
"0"+d:d};TGOS.Color=function(d,a,b,e){this.r=d?parseInt(d):this.r;this.g=a?parseInt(a):this.g;this.b=b?parseInt(b):this.b;this.a=void 0==e?this.a:e};this.toHex=function(){return"#"+b(this.r)+b(this.g)+b(this.b)};this.toRgb=function(){return[this.r,this.g,this.b]};this.toRgba=function(){return[this.r,this.g,this.b,this.a]};this.toCss=function(b){return b?"rgb("+this.r+","+this.g+","+this.b+","+this.a+")":"rgb("+this.r+","+this.g+","+this.b+")"};this.toString=function(){return this.toCss(!0)}})();window.performance=window.performance||{};performance.now=function(){return performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||function(){return(new Date).getTime()}}();
function DeviceTest(){var b=navigator.userAgent.toLowerCase();return 0<b.indexOf("msie")&&document.all?"MSIE":0<b.indexOf("edge")?"Edge":0<b.indexOf("firefox")?"Firefox":0<b.indexOf("chrome")?"Chrome":0<b.indexOf("safari")?"Safari":0<b.indexOf("opera")?"Opera":0<b.indexOf("camino")?"Camino":0<b.indexOf("gecko")?"Gecko":0<b.indexOf("trident")?"Trident":0<b.indexOf("mozilla")?"Mozilla":null}function FuncAdapter(b,d){return function(a){return d.call(b,a)}}
function Inherit(b,d){for(var a in d)b[a]=d[a]}function AttachEvent(b,d,a,f){b.addEventListener?("mousewheel"==d&&"Firefox"==DeviceTest()&&(d="DOMMouseScroll"),"keydown"==d&&(f=!0),"keyup"==d&&(f=!0),f?b.ownerDocument.addEventListener(d,a,f):b.addEventListener(d,a,f)):(b.attachEvent("on"+d,a),f&&b.setCapture())}
function DetachEvent(b,d,a,f){b.removeEventListener?("mousewheel"==d&&"Firefox"==DeviceTest()&&(d="DOMMouseScroll"),f?b.ownerDocument.removeEventListener(d,a,f):b.removeEventListener(d,a,f)):(b.detachEvent("on"+d,a),f&&b.releaseCapture())}TGOS.isString=function(b){return"string"==typeof b};TGOS.isArray=function(b){return Array.isArray?Array.isArray(b):b.constructor===Array};TGOS.isNumber=function(b){return!isNaN(b)};TGOS.isFunction=function(b){return"function"===typeof b};
TGOS.isBoolean=function(b){return"boolean"==typeof b};TGOS.forEach=function(b,d){if(b&&d)for(var a=0;a<b.length;a++)d.call(b,b[a],a,b)};TGOS.parseXML=function(b){var d=null;if(window.DOMParser)d=(new DOMParser).parseFromString(b,"application/xml");else if(window.ActiveXObject)d=new ActiveXObject("Microsoft.XMLDOM"),d.async=!1,d.loadXML(b);else return null;return d};
TGOS.simplifyLineString=function(b,d){var a=b;if(void 0!==b){var f=b;if(!(1>=f.length)){for(var a=void 0!==d?d*d:1,e=f[0],g=[e],h,k=1,l=f.length;k<l;k++){h=f[k];var p=h.x-e.x,m=h.y-e.y;p*p+m*m>a&&(g.push(h),e=h)}e!==h&&g.push(h);h=g;var f=h.length,e=new ("undefined"!==typeof Uint8Array?Uint8Array:Array)(f),g=0,k=f-1,l=[],p=[],n,u,s;for(e[g]=e[k]=1;k;){n=0;for(m=g+1;m<k;m++){u=h[m];var q=h[g],w=h[k],C=q.x,q=q.y,B=w.x-C,H=w.y-q;if(0!==B||0!==H){var A=((u.x-C)*B+(u.y-q)*H)/(B*B+H*H);1<A?(C=w.x,q=w.y):
0<A&&(C+=B*A,q+=H*A)}B=u.x-C;H=u.y-q;u=B*B+H*H;u>n&&(s=m,n=u)}n>a&&(e[s]=1,l.push(g,s,s,k));k=l.pop();g=l.pop()}for(m=0;m<f;m++)e[m]&&p.push(h[m]);f=p}a=f}return a};
(function(){TGOS.features={};var b=navigator.userAgent.toLowerCase(),d=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(d=parseFloat(RegExp.$1));d&&(TGOS.features.ie={},TGOS.features.ie.version=d);0<b.indexOf("firefox")&&(TGOS.features.firefox=!0);0<b.indexOf("chrome")&&(TGOS.features.chrome=!0);b=document.createElement("canvas");TGOS.features.canvas=!(!b.getContext||!b.getContext("2d"));b=window.requestAnimationFrame||window.mozRequestAnimationFrame||
window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=b;d=window.cancelAnimationFrame||window.mozCancelAnimationFrame;window.cancelAnimationFrame=d;b&&d&&TGOS.features.animationFrame;TGOS.features.getDPI=function(){if(TGOS.isNumber(TGOS.features.DPI))return TGOS.features.DPI;if("complete"===document.readyState){var a=document.createElement("div");a.style.width="1in";a.style.height="1in";a.style.position="absolute";a.style.visibility="hidden";document.body.appendChild(a);
TGOS.features.DPI=a.offsetHeight;document.body.removeChild(a);return TGOS.features.DPI}};TGOS.features.svg=!!("createElementNS"in document&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect);TGOS.features.cssTransform="transform"in document.documentElement.style||"msTransform"in document.documentElement.style;TGOS.wrap=function(a,b){return function(){b.apply(a,arguments)}}})();
TGOS.JsonToGraphic=function(b,d){var a="Point MultiPoint LineString MultiLineString Polygon MultiPolygon GeometryCollection".split(" "),f=b.getCoordSys(),e=function(a,b,d){var e=a[0];a=a[1];b=b==d?{x:e,y:a}:TGOS[b+"to"+d](e,a);return new TGOS.TGPoint(b.x,b.y)},g=function(a,b,d){switch(a.type){case "Point":return e(a.coordinates,b,d);case "MultiPoint":for(var f=[],h=0;h<a.coordinates.length;h++)f.push(e(a.coordinates[h],b,d));return new TGOS.TGMultiPoint(f);case "LineString":f=[];for(h=0;h<a.coordinates.length;h++)f.push(e(a.coordinates[h],
b,d));return new TGOS.TGLineString(f);case "MultiLineString":for(var l=[],k=0;k<a.coordinates.length;k++){f=[];for(h=0;h<a.coordinates[k].length;h++)f.push(e(a.coordinates[k][h],b,d));f=new TGOS.TGLineString(f);l.push(f)}return new TGOS.TGMultiLineString(l);case "Polygon":for(var p=[],k=0;k<a.coordinates.length;k++){f=[];if(0==k)for(h=0;h<a.coordinates[k].length;h++)f.push(e(a.coordinates[k][h],b,d));else for(h=a.coordinates[k].length-1;0<=h;h--)f.push(e(a.coordinates[k][h],b,d));f=new TGOS.TGLineString(f);
f=new TGOS.TGLinearRing(f);p.push(f)}return new TGOS.TGPolygon(p);case "MultiPolygon":for(var H=[],l=0;l<a.coordinates.length;l++){p=[];for(k=0;k<a.coordinates[l].length;k++){f=[];for(h=0;h<a.coordinates[l][k].length;h++)f.push(e(a.coordinates[l][k][h],b,d));f=new TGOS.TGLineString(f);f=new TGOS.TGLinearRing(f);p.push(f)}k=new TGOS.TGPolygon(p);H.push(k)}return new TGOS.TGMultiPolygon(H);case "GeometryCollection":b=[];for(l=0;l<a.geometries.length;l++)d=g(a.geometries[l]),b.push(d);return new TGOS.TGGeometryCollection(b);
default:throw"Unable to import GeoJSON";}},h=function(a,b,d){b=g(a.geometry,b,d);return new TGOS.TGGraphic({geometry:b,properties:a.properties,id:a.id})},k=function(){var a;a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var b=JSON.parse(a.responseText);p=l(b)}};a.open("GET",d,!1);a.send()},l=function(b){if(""!=b)b instanceof Object||(b=JSON.parse(b));else throw"Unable to import GeoJSON";if(!b)throw"Unable to import GeoJSON";
var d="WGS84";if(b.crs&&"name"==b.crs.type&&b.crs.properties){var e=b.crs.properties.name;"urn:ogc:def:crs:EPSG::3826"==e?d="TWD97":"urn:ogc:def:crs:EPSG::3825"==e&&(d="TWD97_119")}e=null;switch(f){case TGOS.TGCoordSys.EPSG3857:e="WGS84";break;case TGOS.TGCoordSys.EPSG3826:e="TWD97";break;case TGOS.TGCoordSys.EPSG3825:e="TWD97_119";break;default:throw"Invalid Map CRS";}if(0<=a.indexOf(b.type))return b=g(b,d,e),[new TGOS.TGGraphic({geometry:b})];if("Feature"==b.type)return[h(b,d,e)];if("FeatureCollection"==
b.type){for(var l=[],k=0;k<b.features.length;k++)l.push(h(b.features[k],d,e));return l}throw"Unable to import GeoJSON";},p="";0==d.indexOf("http")?k():(k=JSON.parse(d),p=l(k));return p};
function createNode(b){if(b.constructor===String)return document.createTextNode(b);if(b instanceof Element)return b;var d=null,d=b.ns?document.createElementNS(b.ns,b.tag):document.createElement(b.tag);if(b.attr)for(var a in b.attr)d.setAttribute(a,b.attr[a]);if(b.style)for(a in b.style)d.style[a]=b.style[a];if(b.event)for(a in b.event)d.addEventListener(a,b.event[a]);b.child&&(b.child.constructor===Array?b.child.forEach(function(a){d.appendChild(createNode(a))}):d.appendChild(createNode(b.child)));
b.parent&&createNode(b.parent).appendChild(d);b.init&&b.init.call(d);return d};var bDebug=!0;
function AjaxAgent(b,d,a){var f=this,e=null;if(window.XMLHttpRequest)e=new XMLHttpRequest,e.overrideMimeType&&e.overrideMimeType("text/xml");else if(window.ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(g){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(h){}}this.Open=function(b,f){null!=e&&(e.open(b,f,d),a&&e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"))};this.SendRequest=function(a,b,g,m,h){function u(){g&&g.call(f,e,e.status);200!=e.status?(m&&m.call(f,
e,e.status),bDebug&&window.open("").document.write(e.responseText)):b&&b.call(f,e)}if(null!=e){d&&(e.onreadystatechange=function(){h&&h.call(f,e,e.readyState);4==e.readyState&&u()});try{e.send(a)}catch(s){return alert(s)}return d?null:(d||u(),e)}};b&&this.Open("POST",b)}function GetXMLChildNode(b,d){var a=FindXMLNodes(b,d);return null!=a&&0<a.length?a.item(0):null}function FindXMLNodes(b,d){return null==b?null:b.getElementsByTagName(d)}
function GetXMLNodeText(b){return null==b?null:b.firstChild?b.firstChild.nodeValue:""}function GetXMLNodeAttribute(b,d){return b?b.getAttribute(d):""}var nResult=0,result=null;
function LoadScript(b,d,a){function f(){"loaded"==h.readyState&&e()}function e(){var a=eval(g);result=a;d.call(null,h,a);DetachEvent(h,"readystatechange",f,!1);DetachEvent(h,"load",e,!1);document.body.removeChild(h)}var g="_result_"+a+"_"+nResult;nResult++;var h=document.createElement("script");AttachEvent(h,"readystatechange",f,!1);AttachEvent(h,"load",e,!1);document.body.appendChild(h);h.type="text/javascript";h.src=b+"&Result="+g};TGOS.TGLevelTransform=function(b,d,a,f){function e(a){for(var b=0,b=0;b<l.length-1&&!(a<l[b+1]);b++);if(b<l.length-1)var d=l[b],e=l[b+1],b=b+Math.log(a/d)/Math.log(e/d);return b}function g(a){var b=Math.floor(Math.max(0,Math.min(a,l.length-2))),d=l[b];return d*Math.pow(l[b+1]/d,a-b)}var h=d,k=a,l=[];for(b=0;b<f.length;b++)l.push(1/f[b].factor);l.reverse();var p=0,m=1;this.FitLevel=function(){this.putMapLevel(Math.round(p))};this.getBaseScaleX=function(){return h};this.putBaseScaleX=function(a){h=
a};this.getBaseScaleY=function(){return k};this.putBaseScaleY=function(a){k=a};this.getMapMaxLevel=function(){return l.length};this.getMapLevel=function(){return p};this.putMapLevel=function(a){if(p==a)return!0;var b=a>l.length-1?l.length-1:0>a?0:a;if((a>=l.length||0>a)&&p==b)return!1;p=b;m=g(p);return!0};this.getScale=function(){return h*m};this.putScale=function(a){this.putMapLevel(e(a/h))};this.getScaleX=function(){return h*m};this.getScaleY=function(){return k*m};this.getLevelScale=function(a){return h*
g(a)}};
function CachedLevelTransformation(b){function d(a){for(var b=0,b=0;b<g.length-1&&!(a<g[b+1]);b++);if(b<g.length-1)var d=g[b],e=g[b+1],b=b+Math.log(a/d)/Math.log(e/d);return b}function a(a){var b=Math.floor(Math.max(0,Math.min(a,g.length-2))),d=g[b];return d*Math.pow(g[b+1]/d,a-b)}var f=b.getBaseScaleX(),e=b.getBaseScaleY(),g=[];b=b.getScales();for(var h=0;h<b.length;h++)g.push(1/b[h].factor);g.reverse();var k=0,l=1;this.FitLevel=function(){this.putMapLevel(Math.round(k))};this.getBaseScaleX=function(){return f};
this.putBaseScaleX=function(a){f=a};this.getBaseScaleY=function(){return e};this.putBaseScaleY=function(a){e=a};this.getMapMaxLevel=function(){return g.length};this.getMapLevel=function(){return k};this.putMapLevel=function(b){if(k==b)return!0;var d=b>g.length-1?g.length-1:0>b?0:b;if((b>=g.length||0>b)&&k==d)return!1;k=d;l=a(k);return!0};this.getScale=function(){return f*l};this.putScale=function(a){this.putMapLevel(d(a/f))};this.getScaleX=function(){return f*l};this.getScaleY=function(){return e*
l};this.getLevelScale=function(b){return f*a(b)}}
function MapCachedLayer(b,d,a,f,e,g,h){function k(a,b){function e(a,m,k,n){for(var v=0;v<g.length;v++)if(g[v].isEqual(a.scale,m,k))return;n=d+"/GetCacheImage?S="+n+"&X="+m+"&Y="+k+"&L="+b+"&appid="+TGOS.APPID+"&apikey="+TGOS.APIKEY;if(null!=n){if(l)var v=a.l+m*a.factor*B,t=a.l+(m+1)*a.factor*B,p=a.b+(k+a.frow)*a.factor*H,q=a.b+(k+1+a.frow)*a.factor*H;else v=A+m*a.factor*B,t=A+(m+1)*a.factor*B,p=I+k*a.factor*H,q=I+(k+1)*a.factor*H;g.push(new MapCachedImage(n,h,a.scale,m,k,v,q,t,p,f))}}var g=[],m=[],
h=null,k=!0,n="",v=0,t="";a&&(n=a.Name,v=parseInt(a.FeatureType),t=a.SRName);var E=n;this.getName=function(){return n};this.putName=function(a){n=a};this.getTitle=function(){return E};this.putTitle=function(a){E=a};this.getVisible=function(){return k};this.putVisible=function(a){k=a;h&&(h.style.visibility=k?"":"hidden")};this.getFields=function(){return null};this.getFeatureType=function(){return v};this.getSRName=function(){return t};this.Initialize=function(a){this.RemoveSelf();h=K.ownerDocument.createElement("div");
K.appendChild(h);h.style.position="absolute";h.style.overflow="hidden";h.style.left="0px";h.style.top="0px";h.style.width="100%";h.style.height="100%";h.style.visibility=k?"":"hidden"};this.RemoveSelf=function(){if(g)for(;0<g.length;)g.pop().RemoveSelf();if(m)for(;0<m.length;)m.pop().RemoveSelf();null!=h&&h.parentNode&&(null!=p&&h.parentNode.removeChild(h),h=null)};this.MoveTiles=function(){if(null!=p&&this.getVisible())for(var a=[g,m],b=0;b<a.length;b++)for(var d=a[b],e=0;e<d.length;e++){var f=p.FromMapPoint(d[e].getLeft(),
d[e].getTop()),h=p.FromMapPoint(d[e].getRight(),d[e].getBottom()),l=h.x-f.x,h=h.y-f.y;0>l&&(f.x-=l=-l);0>h&&(f.y-=h=-h);d[e].ReloadStatus(f.x,f.y,l,h)}};this.getTiles=function(a,e,f,g,m){a=p.ToMapDistX(1);p.ToMapDistY(1);m=0;if(0<J.length)for(m=0;m<J.length-1&&!(a<(J[m+1].factor+J[m].factor)/2);m++);g=function(a,b){var d=[],e=Infinity,f=-Infinity,g=Infinity,m=-Infinity,h=0,l=0,k=[0,-1];for(z=Math.pow(Math.max(a,b),2);0<z;z--){-a/2<h&&h<=a/2&&-b/2<l&&l<=b/2&&(d.push({x:h,y:l}),h<e&&(e=h),h>f&&(f=h),
l<g&&(g=l),l>m&&(m=l));if(h===l||0>h&&h===-l||0<h&&h===1-l)k=[-k[1],k[0]];h+=k[0];l+=k[1]}return{l:e,r:f,t:m,b:g,xy:d}};if(l){f=J[m];a=f.factor*B;e=f.factor*H;var h=p.ToMapPoint(0,0),k=p.ToMapPoint(p.getClientWidth(),p.getClientHeight()),n=Math.max(h.x,s),v=Math.min(k.x,w),t=Math.max(k.y,C),E=Math.min(h.y,q),n=Math.floor((n-f.l)/a),t=Math.floor((t-f.b)/e)-f.frow,v=Math.ceil((v-f.l)/a),E=Math.ceil((E-f.b)/e)-f.frow;h.x=f.l+n*a;k.y=f.b+(t+f.frow)*e;k.x=f.l+v*a;h.y=f.b+(E+f.frow)*e;var z,u,h=[],E=g(v-
n,E-t);g=E.xy;if(0<g.length)for(k=n-E.l,t-=E.b,n=0;n<g.length;n++)z=g[n].x+k,u=g[n].y+t,E=d+"/GetCacheImage?S="+m+"&X="+z+"&Y="+u+"&L="+b+"&appid="+TGOS.APPID+"&apikey="+TGOS.APIKEY,v=f.l+z*a,u=f.b+(u+1+f.frow)*e,h.push({url:E,leftTop:[v,u]})}else if(a=J[m].factor*B,e=J[m].factor*H,h=p.ToMapPoint(0,0),k=p.ToMapPoint(p.getClientWidth(),p.getClientHeight()),n=Math.floor((s-A)/a),t=Math.floor((C-I)/e),E=Math.ceil((w-A)/a),f=Math.ceil((q-I)/e),n=Math.max(Math.floor((h.x-A)/a),n),t=Math.max(Math.floor((k.y-
I)/e),t),v=Math.min(Math.ceil((k.x-A)/a),E),E=Math.min(Math.ceil((h.y-I)/e),f),h.x=n*a+A,k.y=t*e+I,k.x=v*a+A,h.y=E*e+I,h=[],E=g(v-n,E-t),g=E.xy,0<g.length)for(k=n-E.l,t-=E.b,n=0;n<g.length;n++)z=g[n].x+k,u=g[n].y+t,E=d+"/GetCacheImage?S="+m+"&X="+z+"&Y="+u+"&L="+b+"&appid="+TGOS.APPID+"&apikey="+TGOS.APIKEY,v=A+z*J[m].factor*B,u=I+(u+1)*J[m].factor*H,h.push({url:E,leftTop:[v,u]});return h};this.UpdateElement=function(){this.RebuildElement()};this.RebuildElement=function(){if(null!=p&&this.getVisible()){var a=
p.ToMapDistX(1);p.ToMapDistY(1);var b=0;if(0<J.length)for(b=0;b<J.length-1&&!(a<(J[b+1].factor+J[b].factor)/2);b++);var d=J[b],f=d.factor*B,h=d.factor*H,a=p.ToMapPoint(0,0),k=p.ToMapPoint(p.getClientWidth(),p.getClientHeight());if(l){var n=Math.max(a.x,s),v=Math.min(k.x,w),t=Math.max(k.y,C),E=Math.min(a.y,q),n=Math.floor((n-d.l)/f),t=Math.floor((t-d.b)/h)-d.frow,v=Math.ceil((v-d.l)/f),E=Math.ceil((E-d.b)/h)-d.frow;a.x=d.l+n*f;k.y=d.b+(t+d.frow)*h;k.x=d.l+v*f;a.y=d.b+(E+d.frow)*h;h=k.y;for(h=t;h<E;h++)for(f=
n;f<v;f++)e(d,f,h,b)}else for(n=Math.floor((s-A)/f),t=Math.floor((C-I)/h),v=Math.ceil((w-A)/f),d=Math.ceil((q-I)/h),n=Math.max(Math.floor((a.x-A)/f),n),t=Math.max(Math.floor((k.y-I)/h),t),v=Math.min(Math.ceil((k.x-A)/f),v),E=Math.min(Math.ceil((a.y-I)/h),d),a.x=n*f+A,k.y=t*h+I,k.x=v*f+A,a.y=E*h+I,h=k.y,h=t;h<E;h++)for(f=n;f<v;f++)e(J[b],f,h,b);n=[];d=g.length;for(f=0;f<d;f++)t=g[f],v=t.getScale(),E=(t.getLeft()+t.getRight())/2,h=(t.getTop()+t.getBottom())/2,v==J[b].scale&&E<a.x!=E<k.x&&h<a.y!=h<k.y?
n.push(t):t.IsComplete()&&t.getStatus()?m.push(t):t.RemoveSelf();g=n;this.MoveTiles();var z=function(){for(var a=!0,b=0;b<g.length;b++)if(g[b].IsComplete())a=g[b].getStatus();else return setTimeout(z,100);if(a)for(;0<m.length;)m.pop().RemoveSelf()};setTimeout(z,100)}}}var l=void 0!==h?!0:!1,p=null,m=b,n=b,u=!0,s=0,q=0,w=1,C=1,B=256,H=256,A=0,I=0,G=1,D=1,J=[],K=null,F=[],t=null,v=this;LoadScript(d+"/GetCacheConfig?Format=JSON&appid="+TGOS.APPID+"&apikey="+TGOS.APIKEY,function(a,b){var d=b.Infomation;
B=parseInt(d.TileWidth);isNaN(B)&&(B=256);H=parseInt(d.TileHeight);isNaN(H)&&(H=256);A=parseFloat(d.CornerLeft);isNaN(A)&&(A=0);I=parseFloat(d.CornerLower);isNaN(I)&&(I=0);var e=d.Envelope;s=parseFloat(e.Left);q=parseFloat(e.Top);w=parseFloat(e.Right);C=parseFloat(e.Bottom);isNaN(s)&&(s=0);isNaN(q)&&(q=1);isNaN(w)&&(w=1);isNaN(C)&&(C=0);J=[];e=d.Scales;G=parseFloat(e.ScaleFactorX);D=parseFloat(e.ScaleFactorY);isNaN(G)&&(G=1);isNaN(D)&&(D=1);var f=d.Scales.Scale;if(f&&0<f.length)if(l)for(e=0;e<f.length;e++){var m=
f[e],E=parseFloat(m._text),m=parseFloat(m.Factor),z=Math.ceil((w-s)/(m*B)),u=Math.ceil((q-C)/(m*H)),K=h[e],O=K.left,S=K.top;J.push({scale:E,factor:m,ox:O,oy:S,fcol:z,frow:u,l:O,r:K.right,t:S,b:K.bottom})}else if(z=parseFloat(f[f.length-1]),isNaN(z))for(e=0;e<f.length;e++)m=f[e],E=parseFloat(m._text),m=parseFloat(m.Factor),J.push({scale:E,factor:m});else for(e=0;e<f.length;e++)E=parseFloat(f[e]),m=E/z,J.push({scale:E,factor:m});if(d=d.Layers.Layer){if(d.length)for(e=0;e<d.length;e++)F.push(new k(d[e],
e));else F.push(new k(d,0));F.reverse();if(null!=p)for(e=F.length-1;0<=e;e--)F[e].Initialize(p)}0==F.length?F.push(new k(null)):1==F.length&&(F[0].putName(""),F[0].putTitle(n));t=F[F.length-1];v.RebuildElement();g&&g.call(this,!0)},e);this.getName=function(){return m};this.putName=function(a){m=a};this.getTitle=function(){return n};this.putTitle=function(a){n=a};this.getVisible=function(){return u};this.putVisible=function(a){u=a;K&&(K.style.visibility=a?"":"hidden")};this.getResourcePath=function(){return d};
this.getLeft=function(){return s};this.getTop=function(){return q};this.getRight=function(){return w};this.getBottom=function(){return C};this.getImageWidth=function(){return B};this.getImageHeight=function(){return H};this.getLayers=function(){return F};this.getThematicLayer=function(){return t};this.getScales=function(){return J};this.getBaseScaleX=function(){return B/G};this.getBaseScaleY=function(){return H/D};this.Initialize=function(a){p=a;var b=p.getHObject();K=b.ownerDocument.createElement("div");
b.appendChild(K);K.style.position="absolute";K.style.overflow="hidden";K.style.left="0px";K.style.top="0px";K.style.width="100%";K.style.height="100%";K.style.visibility=u?"":"hidden";for(b=F.length-1;0<=b;b--)F[b].Initialize(a)};this.RemoveSelf=function(){for(var a=0;a<F.length;a++)F[a].RemoveSelf();p=null};this.UpdateElement=function(){if(this.getVisible()){var a;for(a=0;a<F.length;a++)F[a].UpdateElement()}};this.getTiles=function(a,b,d,e,f,g){if(F[g])return F[g].getTiles(a,b,d,e,f)};this.RebuildElement=
function(){if(this.getVisible())for(var a=0;a<F.length;a++)F[a].RebuildElement()};var z=1;this.setZIndex=function(a){K&&(K.style.zIndex=a)};this.setOpacity=function(a){K&&(z=a,K.style.opacity=z,K.style.filter="alpha(opacity="+100*z+")")};var E=function(a,b){t=b};this.CreateLegend=function(a){if(1<F.length)for(var b=0;b<F.length;b++)a.CreateSubLegend(F[b],E)};this.ExecuteQuery=function(a,b,d,e){null!=t&&t.ExecuteQuery(a,b,d,e)};this.getFeatureType=function(){if(null!=t)return t.getFeatureType()};this.getFields=
function(){if(null!=t)return t.getFields()};this.gethLayers=function(){return K}}
function MapCachedImage(b,d,a,f,e,g,h,k,l,p){var m,n=!1;m=d.ownerDocument.createElement("img");m.onerror=function(){m&&(m.alt="\u4e0d\u63d0\u4f9b\u5716\u78da\u670d\u52d9",m.onload=null,m.onerror=null);n=!0};m.onmousedown=function(){return!1};m.onload=function(){m&&(m.alt="");this.loaded=!0;TGOS.TGEvent.trigger(p,"tilesloaded")};m.galleryImg=!1;m.hideFocus=!0;m.style.MozUserSelect="none";m.style.border="0 none";m.style.position="absolute";m.src=b;d.appendChild(m);this.IsComplete=function(){return m.loaded||
"complete"==m.readyState};this.getStatus=function(){return!n};this.getHObject=function(){return m};this.getScale=function(){return a};this.getLeft=function(){return g};this.getTop=function(){return h};this.getRight=function(){return k};this.getBottom=function(){return l};this.RemoveSelf=function(){m&&(m.onmousedown=null,d.removeChild(m));m=null};this.ReloadStatus=function(a,b,d,e){d=a+d;a=Math.round(a);e=b+e;b=Math.round(b);m.style.left=a+"px";m.style.top=b+"px";m.style.width=Math.round(d-a)+"px";
m.style.height=Math.round(e-b)+"px"};this.isEqual=function(b,d,g){return a==b&&f==d&&e==g}};(function(b){var d=/[\.\/]/,a=function(){},f=function(a,b){return a-b},e,g,h={n:{}},k=function(a,b){a=String(a);var d=g,h=Array.prototype.slice.call(arguments,2),u=k.listeners(a),s=0,q,w=[],C={},B=[],H=e;e=a;for(var A=g=0,I=u.length;A<I;A++)"zIndex"in u[A]&&(w.push(u[A].zIndex),0>u[A].zIndex&&(C[u[A].zIndex]=u[A]));for(w.sort(f);0>w[s];)if(q=C[w[s++]],B.push(q.apply(b,h)),g)return g=d,B;for(A=0;A<I;A++)if(q=u[A],"zIndex"in q)if(q.zIndex==w[s]){B.push(q.apply(b,h));if(g)break;do if(s++,(q=C[w[s]])&&
B.push(q.apply(b,h)),g)break;while(q)}else C[q.zIndex]=q;else if(B.push(q.apply(b,h)),g)break;g=d;e=H;return B.length?B:null};k._events=h;k.listeners=function(a){a=a.split(d);var b=h,e,f,g,k,q,w,C,B=[b],H=[];g=0;for(k=a.length;g<k;g++){C=[];q=0;for(w=B.length;q<w;q++)for(b=B[q].n,e=[b[a[g]],b["*"]],f=2;f--;)if(b=e[f])C.push(b),H=H.concat(b.f||[]);B=C}return H};k.on=function(b,e){b=String(b);if("function"!=typeof e)return function(){};for(var f=b.split(d),g=h,k=0,s=f.length;k<s;k++)g=g.n,g=g.hasOwnProperty(f[k])&&
g[f[k]]||(g[f[k]]={n:{}});g.f=g.f||[];k=0;for(s=g.f.length;k<s;k++)if(g.f[k]==e)return a;g.f.push(e);return function(a){+a==+a&&(e.zIndex=+a)}};k.f=function(a){var b=[].slice.call(arguments,1);return function(){k.apply(null,[a,null].concat(b).concat([].slice.call(arguments,0)))}};k.stop=function(){g=1};k.nt=function(a){return a?RegExp("(?:\\.|\\/|^)"+a+"(?:\\.|\\/|$)").test(e):e};k.nts=function(){return e.split(d)};k.off=k.unbind=function(a,b){if(a){var e=a.split(d),f,g,s,q,w,C,B=[h];q=0;for(w=e.length;q<
w;q++)for(C=0;C<B.length;C+=s.length-2){s=[C,1];f=B[C].n;if("*"!=e[q])f[e[q]]&&s.push(f[e[q]]);else for(g in f)f.hasOwnProperty(g)&&s.push(f[g]);B.splice.apply(B,s)}q=0;for(w=B.length;q<w;q++)for(f=B[q];f.n;){if(b){if(f.f){C=0;for(e=f.f.length;C<e;C++)if(f.f[C]==b){f.f.splice(C,1);break}!f.f.length&&delete f.f}for(g in f.n)if(f.n.hasOwnProperty(g)&&f.n[g].f){s=f.n[g].f;C=0;for(e=s.length;C<e;C++)if(s[C]==b){s.splice(C,1);break}!s.length&&delete f.n[g].f}}else for(g in delete f.f,f.n)f.n.hasOwnProperty(g)&&
f.n[g].f&&delete f.n[g].f;f=f.n}}else k._events=h={n:{}}};k.once=function(a,b){var d=function(){k.unbind(a,d);return b.apply(this,arguments)};return k.on(a,d)};k.version="0.4.2";k.toString=function(){return"You are running Eve 0.4.2"};"undefined"!=typeof module&&module.exports?module.exports=k:"undefined"!=typeof define?define("eve",[],function(){return k}):b.eve=k})(this);
(function(b,d){"function"===typeof define&&define.amd?define(["eve"],function(a){return d(b,a)}):d(b,b.eve||"function"==typeof require&&require("eve"))})(this,function(b,d){function a(b){if(a.is(b,"function"))return C?b():d.on("raphael.DOMload",b);if(a.is(b,R))return a._engine.create[t](a,b.splice(0,3+a.is(b[0],S))).add(b);var e=Array.prototype.slice.call(arguments,0);if(a.is(e[e.length-1],"function")){var f=e.pop();return C?f.call(a._engine.create[t](a,e)):d.on("raphael.DOMload",function(){f.call(a._engine.create[t](a,
e))})}return a._engine.create[t](a,arguments)}function f(a){if("function"==typeof a||Object(a)!==a)return a;var b=new a.constructor,d;for(d in a)a[I](d)&&(b[d]=f(a[d]));return b}function e(a,b,d){function e(){var f=Array.prototype.slice.call(arguments,0),g=f.join("\u2400"),m=e.cache=e.cache||{},h=e.count=e.count||[];if(m[I](g)){a:for(var f=h,h=g,k=0,l=f.length;k<l;k++)if(f[k]===h){f.push(f.splice(k,1)[0]);break a}return d?d(m[g]):m[g]}1E3<=h.length&&delete m[h.shift()];h.push(g);m[g]=a[t](b,f);return d?
d(m[g]):m[g]}return e}function g(){return this.hex}function h(a,b){for(var d=[],e=0,f=a.length;f-2*!b>e;e+=2){var g=[{x:+a[e-2],y:+a[e-1]},{x:+a[e],y:+a[e+1]},{x:+a[e+2],y:+a[e+3]},{x:+a[e+4],y:+a[e+5]}];b?e?f-4==e?g[3]={x:+a[0],y:+a[1]}:f-2==e&&(g[2]={x:+a[0],y:+a[1]},g[3]={x:+a[2],y:+a[3]}):g[0]={x:+a[f-2],y:+a[f-1]}:f-4==e?g[3]=g[2]:e||(g[0]={x:+a[e],y:+a[e+1]});d.push(["C",(-g[0].x+6*g[1].x+g[2].x)/6,(-g[0].y+6*g[1].y+g[2].y)/6,(g[1].x+6*g[2].x-g[3].x)/6,(g[1].y+6*g[2].y-g[3].y)/6,g[2].x,g[2].y])}return d}
function k(a,b,d,e,f,g,m,h,k){null==k&&(k=1);k=(1<k?1:0>k?0:k)/2;for(var l=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],n=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],v=0,t=0;12>t;t++)var p=k*l[t]+k,E=p*(p*(-3*a+9*d-9*f+3*m)+6*a-12*d+6*f)-3*a+3*d,p=p*(p*(-3*b+9*e-9*g+3*h)+6*b-12*e+6*g)-3*b+3*e,v=v+n[t]*N.sqrt(E*E+p*p);return k*v}function l(a,b,d,e,f,g,m,h,l){if(!(0>l||k(a,b,d,e,f,g,m,h)<l)){var n=0.5,v=1-n,t;for(t=
k(a,b,d,e,f,g,m,h,v);0.01<T(t-l);)n/=2,v+=(t<l?1:-1)*n,t=k(a,b,d,e,f,g,m,h,v);return v}}function p(b,d,e){b=a._path2curve(b);d=a._path2curve(d);for(var f,g,m,h,l,n,v,t,p,E,q=e?0:[],z=0,s=b.length;z<s;z++)if(p=b[z],"M"==p[0])f=l=p[1],g=n=p[2];else{"C"==p[0]?(p=[f,g].concat(p.slice(1)),f=p[6],g=p[7]):(p=[f,g,f,g,l,n,l,n],f=l,g=n);for(var u=0,L=d.length;u<L;u++)if(E=d[u],"M"==E[0])m=v=E[1],h=t=E[2];else{"C"==E[0]?(E=[m,h].concat(E.slice(1)),m=E[6],h=E[7]):(E=[m,h,m,h,v,t,v,t],m=v,h=t);var w;var A=p,
F=E;w=e;var B=a.bezierBBox(A),P=a.bezierBBox(F);if(a.isBBoxIntersect(B,P)){for(var B=k.apply(0,A),P=k.apply(0,F),B=Q(~~(B/5),1),P=Q(~~(P/5),1),G=[],D=[],J={},H=w?0:[],C=0;C<B+1;C++){var I=a.findDotsAtSegment.apply(a,A.concat(C/B));G.push({x:I.x,y:I.y,t:C/B})}for(C=0;C<P+1;C++)I=a.findDotsAtSegment.apply(a,F.concat(C/P)),D.push({x:I.x,y:I.y,t:C/P});for(C=0;C<B;C++)for(A=0;A<P;A++){var U=G[C],K=G[C+1],F=D[A],I=D[A+1],Y=0.001>T(K.x-U.x)?"y":"x",ma=0.001>T(I.x-F.x)?"y":"x",M;M=U.x;var X=U.y,N=K.x,ta=
K.y,pa=F.x,ja=F.y,O=I.x,Z=I.y;if(Q(M,N)<$(pa,O)||$(M,N)>Q(pa,O)||Q(X,ta)<$(ja,Z)||$(X,ta)>Q(ja,Z))M=void 0;else{var S=(M*ta-X*N)*(pa-O)-(M-N)*(pa*Z-ja*O),aa=(M*ta-X*N)*(ja-Z)-(X-ta)*(pa*Z-ja*O),ra=(M-N)*(ja-Z)-(X-ta)*(pa-O);if(ra){var S=S/ra,aa=aa/ra,ra=+S.toFixed(2),za=+aa.toFixed(2);M=ra<+$(M,N).toFixed(2)||ra>+Q(M,N).toFixed(2)||ra<+$(pa,O).toFixed(2)||ra>+Q(pa,O).toFixed(2)||za<+$(X,ta).toFixed(2)||za>+Q(X,ta).toFixed(2)||za<+$(ja,Z).toFixed(2)||za>+Q(ja,Z).toFixed(2)?void 0:{x:S,y:aa}}else M=
void 0}M&&J[M.x.toFixed(4)]!=M.y.toFixed(4)&&(J[M.x.toFixed(4)]=M.y.toFixed(4),U=U.t+T((M[Y]-U[Y])/(K[Y]-U[Y]))*(K.t-U.t),F=F.t+T((M[ma]-F[ma])/(I[ma]-F[ma]))*(I.t-F.t),0<=U&&1.001>=U&&0<=F&&1.001>=F&&(w?H++:H.push({x:M.x,y:M.y,t1:$(U,1),t2:$(F,1)})))}w=H}else w=w?0:[];if(e)q+=w;else{B=0;for(P=w.length;B<P;B++)w[B].segment1=z,w[B].segment2=u,w[B].bez1=p,w[B].bez2=E;q=q.concat(w)}}}return q}function m(a,b,d,e,f,g){null!=a?(this.a=+a,this.b=+b,this.c=+d,this.d=+e,this.e=+f,this.f=+g):(this.a=1,this.c=
this.b=0,this.d=1,this.f=this.e=0)}function n(){return this.x+E+this.y+E+this.width+" \u00d7 "+this.height}function u(a,b,d,e,f,g){function m(a,b){var d,e,f,g;f=a;for(e=0;8>e;e++){g=((l*f+k)*f+h)*f-a;if(T(g)<b)return f;d=(3*l*f+2*k)*f+h;if(1E-6>T(d))break;f-=g/d}d=0;e=1;f=a;if(f<d)return d;if(f>e)return e;for(;d<e;){g=((l*f+k)*f+h)*f;if(T(g-a)<b)break;a>g?d=f:e=f;f=(e-d)/2+d}return f}var h=3*b,k=3*(e-b)-h,l=1-h-k,n=3*d,v=3*(f-d)-n,t=1-n-v;return function(a,b){var d=m(a,b);return((t*d+v)*d+n)*d}(a,
1/(200*g))}function s(a,b){var d=[],e={};this.ms=b;this.times=1;if(a){for(var f in a)a[I](f)&&(e[W(f)]=a[f],d.push(W(f)));d.sort(X)}this.anim=e;this.top=d[d.length-1];this.percents=d}function q(b,e,f,g,h,k){f=W(f);var l,n,t,p,E,q,z=b.ms,s={},w={},A={};if(g)for(q=0,G=ca.length;q<G;q++){var F=ca[q];if(F.el.id==e.id&&F.anim==b){F.percent!=f?(ca.splice(q,1),t=1):n=F;e.attr(F.totalOrigin);break}}else g=+w;q=0;for(var G=b.percents.length;q<G;q++)if(b.percents[q]==f||b.percents[q]>g*b.top){f=b.percents[q];
E=b.percents[q-1]||0;z=z/b.top*(f-E);p=b.percents[q+1];l=b.anim[f];break}else g&&e.attr(b.anim[b.percents[q]]);if(l){if(n)n.initstatus=g,n.start=new Date-n.ms*g;else{for(var D in l)if(l[I](D)&&(Aa[I](D)||e.paper.customAttributes[I](D)))switch(s[D]=e.attr(D),null==s[D]&&(s[D]=ha[D]),w[D]=l[D],Aa[D]){case S:A[D]=(w[D]-s[D])/z;break;case "colour":s[D]=a.getRGB(s[D]);q=a.getRGB(w[D]);A[D]={r:(q.r-s[D].r)/z,g:(q.g-s[D].g)/z,b:(q.b-s[D].b)/z};break;case "path":q=La(s[D],w[D]);F=q[1];s[D]=q[0];A[D]=[];q=
0;for(G=s[D].length;q<G;q++){A[D][q]=[0];for(var J=1,C=s[D][q].length;J<C;J++)A[D][q][J]=(F[q][J]-s[D][q][J])/z}break;case "transform":q=e._;if(G=ib(q[D],w[D]))for(s[D]=G.from,w[D]=G.to,A[D]=[],A[D].real=!0,q=0,G=s[D].length;q<G;q++)for(A[D][q]=[s[D][q][0]],J=1,C=s[D][q].length;J<C;J++)A[D][q][J]=(w[D][q][J]-s[D][q][J])/z;else G=e.matrix||new m,q={_:{transform:q.transform},getBBox:function(){return e.getBBox(1)}},s[D]=[G.a,G.b,G.c,G.d,G.e,G.f],$a(q,w[D]),w[D]=q._.transform,A[D]=[(q.matrix.a-G.a)/
z,(q.matrix.b-G.b)/z,(q.matrix.c-G.c)/z,(q.matrix.d-G.d)/z,(q.matrix.e-G.e)/z,(q.matrix.f-G.f)/z];break;case "csv":G=L(l[D])[P](B);F=L(s[D])[P](B);if("clip-rect"==D)for(s[D]=F,A[D]=[],q=F.length;q--;)A[D][q]=(G[q]-s[D][q])/z;w[D]=G;break;default:for(G=[][v](l[D]),F=[][v](s[D]),A[D]=[],q=e.paper.customAttributes[D].length;q--;)A[D][q]=((G[q]||0)-(F[q]||0))/z}q=l.easing;D=a.easing_formulas[q];if(!D)if((D=L(q).match(na))&&5==D.length){var H=D;D=function(a){return u(a,+H[1],+H[2],+H[3],+H[4],z)}}else D=
ja;q=l.start||b.start||+new Date;F={anim:b,percent:f,timestamp:q,start:q+(b.del||0),status:0,initstatus:g||0,stop:!1,ms:z,easing:D,from:s,diff:A,to:w,el:e,callback:l.callback,prev:E,next:p,repeat:k||b.times,origin:e.attr(),totalOrigin:h};ca.push(F);if(g&&!n&&!t&&(F.stop=!0,F.start=new Date-z*g,1==ca.length))return Sa();t&&(F.start=new Date-F.ms*g);1==ca.length&&ab(Sa)}d("raphael.anim.start."+e.id,e,b)}}function w(a){for(var b=0;b<ca.length;b++)ca[b].el.paper==a&&ca.splice(b--,1)}a.version="2.1.2";
a.eve=d;var C,B=/[, ]+/,H={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},A=/\{(\d+)\}/g,I="hasOwnProperty",G={doc:document,win:b},D=Object.prototype[I].call(G.win,"Raphael"),J=G.win.Raphael,K=function(){this.ca=this.customAttributes={}},F,t="apply",v="concat",z="ontouchstart"in G.win||G.win.DocumentTouch&&G.doc instanceof DocumentTouch,E=" ",L=String,P="split",U="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[P](E),Y={mousedown:"touchstart",
mousemove:"touchmove",mouseup:"touchend"},M=L.prototype.toLowerCase,N=Math,Q=N.max,$=N.min,T=N.abs,aa=N.pow,O=N.PI,S="number",R="array",ka=Object.prototype.toString;a._ISURL=/^url\(['"]?(.+?)['"]?\)$/i;var V=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,
ia={NaN:1,Infinity:1,"-Infinity":1},na=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,la=N.round,W=parseFloat,ba=parseInt,ga=L.prototype.toUpperCase,ha=a._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",
r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},Aa=a._availableAnimAttrs={blur:S,"clip-rect":"csv",cx:S,cy:S,fill:"colour","fill-opacity":S,"font-size":S,height:S,opacity:S,path:"path",r:S,rx:S,ry:S,stroke:"colour","stroke-opacity":S,"stroke-width":S,transform:"transform",width:S,x:S,y:S},ya=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,
xa={hs:1,rg:1},Da=/,?([achlmqrstvxz]),?/gi,fa=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,
oa=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,ua=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig;
a._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/;var da={},X=function(a,b){return W(a)-W(b)},ja=function(a){return a},Z=a._rectPath=function(a,b,d,e,f){return f?[["M",a+f,b],["l",d-2*f,0],["a",f,f,0,0,1,f,f],["l",0,e-2*f],
["a",f,f,0,0,1,-f,f],["l",2*f-d,0],["a",f,f,0,0,1,-f,-f],["l",0,2*f-e],["a",f,f,0,0,1,f,-f],["z"]]:[["M",a,b],["l",d,0],["l",0,e],["l",-d,0],["z"]]},Ba=function(a,b,d,e){null==e&&(e=d);return[["M",a,b],["m",0,-e],["a",d,e,0,1,1,0,2*e],["a",d,e,0,1,1,0,-2*e],["z"]]},ma=a._getPath={path:function(a){return a.attr("path")},circle:function(a){a=a.attrs;return Ba(a.cx,a.cy,a.r)},ellipse:function(a){a=a.attrs;return Ba(a.cx,a.cy,a.rx,a.ry)},rect:function(a){a=a.attrs;return Z(a.x,a.y,a.width,a.height,a.r)},
image:function(a){a=a.attrs;return Z(a.x,a.y,a.width,a.height)},text:function(a){a=a._getBBox();return Z(a.x,a.y,a.width,a.height)},set:function(a){a=a._getBBox();return Z(a.x,a.y,a.width,a.height)}},pa=a.mapPath=function(a,b){if(!b)return a;var d,e,f,g,m,h,k;a=La(a);f=0;for(m=a.length;f<m;f++)for(k=a[f],g=1,h=k.length;g<h;g+=2)d=b.x(k[g],k[g+1]),e=b.y(k[g],k[g+1]),k[g]=d,k[g+1]=e;return a};a._g=G;a.type=G.win.SVGAngle||G.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure",
"1.1")?"SVG":"VML";if("VML"==a.type){var ta=G.doc.createElement("div"),za;ta.innerHTML='<v:shape adj="1"/>';za=ta.firstChild;za.style.behavior="url(#default#VML)";if(!za||"object"!=typeof za.adj)return a.type="";ta=null}a.svg=!(a.vml="VML"==a.type);a._Paper=K;a.fn=F=K.prototype=a.prototype;a._id=0;a._oid=0;a.is=function(a,b){b=M.call(b);return"finite"==b?!ia[I](+a):"array"==b?a instanceof Array:"null"==b&&null===a||b==typeof a&&null!==a||"object"==b&&a===Object(a)||"array"==b&&Array.isArray&&Array.isArray(a)||
ka.call(a).slice(8,-1).toLowerCase()==b};a.angle=function(b,d,e,f,g,m){return null==g?(b-=e,d-=f,b||d?(180*N.atan2(-d,-b)/O+540)%360:0):a.angle(b,d,g,m)-a.angle(e,f,g,m)};a.rad=function(a){return a%360*O/180};a.deg=function(a){return Math.round(1E3*(180*a/O%360))/1E3};a.snapTo=function(b,d,e){e=a.is(e,"finite")?e:10;if(a.is(b,R))for(var f=b.length;f--;){if(T(b[f]-d)<=e)return b[f]}else{b=+b;f=d%b;if(f<e)return d-f;if(f>b-e)return d-f+b}return d};a.createUUID=function(a,b){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a,
b).toUpperCase()}}(/[xy]/g,function(a){var b=16*N.random()|0;return("x"==a?b:b&3|8).toString(16)});a.setWindow=function(b){d("raphael.setWindow",a,G.win,b);G.win=b;G.doc=G.win.document;a._engine.initWin&&a._engine.initWin(G.win)};var ra=function(b){if(a.vml){var d=/^\s+|\s+$/g,f;try{var g=new ActiveXObject("htmlfile");g.write("<body>");g.close();f=g.body}catch(m){f=createPopup().document.body}var h=f.createTextRange();ra=e(function(a){try{f.style.color=L(a).replace(d,"");var b=h.queryCommandValue("ForeColor");
return"#"+("000000"+((b&255)<<16|b&65280|(b&16711680)>>>16).toString(16)).slice(-6)}catch(e){return"none"}})}else{var k=G.doc.createElement("i");k.title="Rapha\u00ebl Colour Picker";k.style.display="none";G.doc.body.appendChild(k);ra=e(function(a){k.style.color=a;return G.doc.defaultView.getComputedStyle(k,"").getPropertyValue("color")})}return ra(b)},Ia=function(){return"hsb("+[this.h,this.s,this.b]+")"},Ea=function(){return"hsl("+[this.h,this.s,this.l]+")"},Ca=function(){return this.hex},Ha=function(b,
d,e){null==d&&a.is(b,"object")&&"r"in b&&"g"in b&&"b"in b&&(e=b.b,d=b.g,b=b.r);null==d&&a.is(b,"string")&&(e=a.getRGB(b),b=e.r,d=e.g,e=e.b);if(1<b||1<d||1<e)b/=255,d/=255,e/=255;return[b,d,e]},Ma=function(b,d,e,f){b*=255;d*=255;e*=255;b={r:b,g:d,b:e,hex:a.rgb(b,d,e),toString:Ca};a.is(f,"finite")&&(b.opacity=f);return b};a.color=function(b){var d;a.is(b,"object")&&"h"in b&&"s"in b&&"b"in b?(d=a.hsb2rgb(b),b.r=d.r,b.g=d.g,b.b=d.b,b.hex=d.hex):a.is(b,"object")&&"h"in b&&"s"in b&&"l"in b?(d=a.hsl2rgb(b),
b.r=d.r,b.g=d.g,b.b=d.b,b.hex=d.hex):(a.is(b,"string")&&(b=a.getRGB(b)),a.is(b,"object")&&"r"in b&&"g"in b&&"b"in b?(d=a.rgb2hsl(b),b.h=d.h,b.s=d.s,b.l=d.l,d=a.rgb2hsb(b),b.v=d.b):(b={hex:"none"},b.r=b.g=b.b=b.h=b.s=b.v=b.l=-1));b.toString=Ca;return b};a.hsb2rgb=function(a,b,d,e){this.is(a,"object")&&"h"in a&&"s"in a&&"b"in a&&(d=a.b,b=a.s,e=a.o,a=a.h);var f,g,m;a=360*a%360/60;m=d*b;b=m*(1-T(a%2-1));d=f=g=d-m;a=~~a;d+=[m,b,0,0,b,m][a];f+=[b,m,m,b,0,0][a];g+=[0,0,b,m,m,b][a];return Ma(d,f,g,e)};a.hsl2rgb=
function(a,b,d,e){this.is(a,"object")&&"h"in a&&"s"in a&&"l"in a&&(d=a.l,b=a.s,a=a.h);if(1<a||1<b||1<d)a/=360,b/=100,d/=100;var f,g,m;a=360*a%360/60;m=2*b*(0.5>d?d:1-d);b=m*(1-T(a%2-1));d=f=g=d-m/2;a=~~a;d+=[m,b,0,0,b,m][a];f+=[b,m,m,b,0,0][a];g+=[0,0,b,m,m,b][a];return Ma(d,f,g,e)};a.rgb2hsb=function(a,b,d){d=Ha(a,b,d);a=d[0];b=d[1];d=d[2];var e,f;e=Q(a,b,d);f=e-$(a,b,d);a=60*(((0==f?0:e==a?(b-d)/f:e==b?(d-a)/f+2:(a-b)/f+4)+360)%6)/360;return{h:a,s:0==f?0:f/e,b:e,toString:Ia}};a.rgb2hsl=function(a,
b,d){d=Ha(a,b,d);a=d[0];b=d[1];d=d[2];var e,f,g;e=Q(a,b,d);f=$(a,b,d);g=e-f;a=60*(((0==g?0:e==a?(b-d)/g:e==b?(d-a)/g+2:(a-b)/g+4)+360)%6)/360;e=(e+f)/2;return{h:a,s:0==g?0:0.5>e?g/(2*e):g/(2-2*e),l:e,toString:Ea}};a._path2string=function(){return this.join(",").replace(Da,"$1")};a._preload=function(a,b){var d=G.doc.createElement("img");d.style.cssText="position:absolute;left:-9999em;top:-9999em";d.onload=function(){b.call(this);this.onload=null;G.doc.body.removeChild(this)};d.onerror=function(){G.doc.body.removeChild(this)};
G.doc.body.appendChild(d);d.src=a};a.getRGB=e(function(b){if(!b||(b=L(b)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:g};if("none"==b)return{r:-1,g:-1,b:-1,hex:"none",toString:g};!xa[I](b.toLowerCase().substring(0,2))&&"#"!=b.charAt()&&(b=ra(b));var d,e,f,m,h;if(b=b.match(V)){b[2]&&(f=ba(b[2].substring(5),16),e=ba(b[2].substring(3,5),16),d=ba(b[2].substring(1,3),16));b[3]&&(f=ba((h=b[3].charAt(3))+h,16),e=ba((h=b[3].charAt(2))+h,16),d=ba((h=b[3].charAt(1))+h,16));b[4]&&(h=b[4][P](ya),
d=W(h[0]),"%"==h[0].slice(-1)&&(d*=2.55),e=W(h[1]),"%"==h[1].slice(-1)&&(e*=2.55),f=W(h[2]),"%"==h[2].slice(-1)&&(f*=2.55),"rgba"==b[1].toLowerCase().slice(0,4)&&(m=W(h[3])),h[3]&&"%"==h[3].slice(-1)&&(m/=100));if(b[5])return h=b[5][P](ya),d=W(h[0]),"%"==h[0].slice(-1)&&(d*=2.55),e=W(h[1]),"%"==h[1].slice(-1)&&(e*=2.55),f=W(h[2]),"%"==h[2].slice(-1)&&(f*=2.55),"deg"!=h[0].slice(-3)&&"\u00b0"!=h[0].slice(-1)||(d/=360),"hsba"==b[1].toLowerCase().slice(0,4)&&(m=W(h[3])),h[3]&&"%"==h[3].slice(-1)&&(m/=
100),a.hsb2rgb(d,e,f,m);if(b[6])return h=b[6][P](ya),d=W(h[0]),"%"==h[0].slice(-1)&&(d*=2.55),e=W(h[1]),"%"==h[1].slice(-1)&&(e*=2.55),f=W(h[2]),"%"==h[2].slice(-1)&&(f*=2.55),"deg"!=h[0].slice(-3)&&"\u00b0"!=h[0].slice(-1)||(d/=360),"hsla"==b[1].toLowerCase().slice(0,4)&&(m=W(h[3])),h[3]&&"%"==h[3].slice(-1)&&(m/=100),a.hsl2rgb(d,e,f,m);b={r:d,g:e,b:f,toString:g};b.hex="#"+(16777216|f|e<<8|d<<16).toString(16).slice(1);a.is(m,"finite")&&(b.opacity=m);return b}return{r:-1,g:-1,b:-1,hex:"none",error:1,
toString:g}},a);a.hsb=e(function(b,d,e){return a.hsb2rgb(b,d,e).hex});a.hsl=e(function(b,d,e){return a.hsl2rgb(b,d,e).hex});a.rgb=e(function(a,b,d){return"#"+(16777216|d|b<<8|a<<16).toString(16).slice(1)});a.getColor=function(a){a=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||0.75};var b=this.hsb2rgb(a.h,a.s,a.b);a.h+=0.075;1<a.h&&(a.h=0,a.s-=0.2,0>=a.s&&(this.getColor.start={h:0,s:1,b:a.b}));return b.hex};a.getColor.reset=function(){delete this.start};a.parsePathString=function(b){if(!b)return null;
var d=va(b);if(d.arr)return qa(d.arr);var e={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},f=[];a.is(b,R)&&a.is(b[0],R)&&(f=qa(b));f.length||L(b).replace(fa,function(a,b,d){var g=[];a=b.toLowerCase();d.replace(ua,function(a,b){b&&g.push(+b)});"m"==a&&2<g.length&&(f.push([b][v](g.splice(0,2))),a="l",b="m"==b?"l":"L");if("r"==a)f.push([b][v](g));else for(;g.length>=e[a]&&(f.push([b][v](g.splice(0,e[a]))),e[a]););});f.toString=a._path2string;d.arr=qa(f);return f};a.parseTransformString=e(function(b){if(!b)return null;
var d=[];a.is(b,R)&&a.is(b[0],R)&&(d=qa(b));d.length||L(b).replace(oa,function(a,b,e){var f=[];M.call(b);e.replace(ua,function(a,b){b&&f.push(+b)});d.push([b][v](f))});d.toString=a._path2string;return d});var va=function(a){var b=va.ps=va.ps||{};b[a]?b[a].sleep=100:b[a]={sleep:100};setTimeout(function(){for(var d in b)b[I](d)&&d!=a&&(b[d].sleep--,!b[d].sleep&&delete b[d])});return b[a]};a.findDotsAtSegment=function(a,b,d,e,f,g,m,h,k){var l=1-k,n=aa(l,3),v=aa(l,2),t=k*k,q=t*k,p=n*a+3*v*k*d+3*l*k*k*
f+q*m,n=n*b+3*v*k*e+3*l*k*k*g+q*h,v=a+2*k*(d-a)+t*(f-2*d+a),q=b+2*k*(e-b)+t*(g-2*e+b),E=d+2*k*(f-d)+t*(m-2*f+d),t=e+2*k*(g-e)+t*(h-2*g+e);a=l*a+k*d;b=l*b+k*e;f=l*f+k*m;g=l*g+k*h;h=90-180*N.atan2(v-E,q-t)/O;(v>E||q<t)&&(h+=180);return{x:p,y:n,m:{x:v,y:q},n:{x:E,y:t},start:{x:a,y:b},end:{x:f,y:g},alpha:h}};a.bezierBBox=function(b,d,e,f,g,h,m,k){a.is(b,"array")||(b=[b,d,e,f,g,h,m,k]);b=bb.apply(null,b);return{x:b.min.x,y:b.min.y,x2:b.max.x,y2:b.max.y,width:b.max.x-b.min.x,height:b.max.y-b.min.y}};a.isPointInsideBBox=
function(a,b,d){return b>=a.x&&b<=a.x2&&d>=a.y&&d<=a.y2};a.isBBoxIntersect=function(b,d){var e=a.isPointInsideBBox;return e(d,b.x,b.y)||e(d,b.x2,b.y)||e(d,b.x,b.y2)||e(d,b.x2,b.y2)||e(b,d.x,d.y)||e(b,d.x2,d.y)||e(b,d.x,d.y2)||e(b,d.x2,d.y2)||(b.x<d.x2&&b.x>d.x||d.x<b.x2&&d.x>b.x)&&(b.y<d.y2&&b.y>d.y||d.y<b.y2&&d.y>b.y)};a.pathIntersection=function(a,b){return p(a,b)};a.pathIntersectionNumber=function(a,b){return p(a,b,1)};a.isPointInsidePath=function(b,d,e){var f=a.pathBBox(b);return a.isPointInsideBBox(f,
d,e)&&1==p(b,[["M",d,e],["H",f.x2+10]],1)%2};a._removedFactory=function(a){return function(){d("raphael.log",null,"Rapha\u00ebl: you are calling to method \u201c"+a+"\u201d of removed object",a)}};var Fa=a.pathBBox=function(a){var b=va(a);if(b.bbox)return f(b.bbox);if(!a)return{x:0,y:0,width:0,height:0,x2:0,y2:0};a=La(a);for(var d=0,e=0,g=[],h=[],m,k=0,l=a.length;k<l;k++)m=a[k],"M"==m[0]?(d=m[1],e=m[2],g.push(d),h.push(e)):(d=bb(d,e,m[1],m[2],m[3],m[4],m[5],m[6]),g=g[v](d.min.x,d.max.x),h=h[v](d.min.y,
d.max.y),d=m[5],e=m[6]);a=$[t](0,g);m=$[t](0,h);g=Q[t](0,g);h=Q[t](0,h);k=g-a;l=h-m;h={x:a,y:m,x2:g,y2:h,width:k,height:l,cx:a+k/2,cy:m+l/2};b.bbox=f(h);return h},qa=function(b){b=f(b);b.toString=a._path2string;return b},Na=a._pathToRelative=function(b){var d=va(b);if(d.rel)return qa(d.rel);a.is(b,R)&&a.is(b&&b[0],R)||(b=a.parsePathString(b));var e=[],f=0,g=0,m=0,h=0,k=0;"M"==b[0][0]&&(f=b[0][1],g=b[0][2],m=f,h=g,k++,e.push(["M",f,g]));for(var l=b.length;k<l;k++){var n=e[k]=[],v=b[k];if(v[0]!=M.call(v[0]))switch(n[0]=
M.call(v[0]),n[0]){case "a":n[1]=v[1];n[2]=v[2];n[3]=v[3];n[4]=v[4];n[5]=v[5];n[6]=+(v[6]-f).toFixed(3);n[7]=+(v[7]-g).toFixed(3);break;case "v":n[1]=+(v[1]-g).toFixed(3);break;case "m":m=v[1],h=v[2];default:for(var t=1,q=v.length;t<q;t++)n[t]=+(v[t]-(t%2?f:g)).toFixed(3)}else for(e[k]=[],"m"==v[0]&&(m=v[1]+f,h=v[2]+g),n=0,t=v.length;n<t;n++)e[k][n]=v[n];v=e[k].length;switch(e[k][0]){case "z":f=m;g=h;break;case "h":f+=+e[k][v-1];break;case "v":g+=+e[k][v-1];break;default:f+=+e[k][v-2],g+=+e[k][v-
1]}}e.toString=a._path2string;d.rel=qa(e);return e},Ja=a._pathToAbsolute=function(b){var d=va(b);if(d.abs)return qa(d.abs);a.is(b,R)&&a.is(b&&b[0],R)||(b=a.parsePathString(b));if(!b||!b.length)return[["M",0,0]];var e=[],f=0,g=0,m=0,k=0,l=0;"M"==b[0][0]&&(f=+b[0][1],g=+b[0][2],m=f,k=g,l++,e[0]=["M",f,g]);for(var n=3==b.length&&"M"==b[0][0]&&"R"==b[1][0].toUpperCase()&&"Z"==b[2][0].toUpperCase(),t,q=l,p=b.length;q<p;q++){e.push(l=[]);t=b[q];if(t[0]!=ga.call(t[0]))switch(l[0]=ga.call(t[0]),l[0]){case "A":l[1]=
t[1];l[2]=t[2];l[3]=t[3];l[4]=t[4];l[5]=t[5];l[6]=+(t[6]+f);l[7]=+(t[7]+g);break;case "V":l[1]=+t[1]+g;break;case "H":l[1]=+t[1]+f;break;case "R":for(var E=[f,g][v](t.slice(1)),z=2,s=E.length;z<s;z++)E[z]=+E[z]+f,E[++z]=+E[z]+g;e.pop();e=e[v](h(E,n));break;case "M":m=+t[1]+f,k=+t[2]+g;default:for(z=1,s=t.length;z<s;z++)l[z]=+t[z]+(z%2?f:g)}else if("R"==t[0])E=[f,g][v](t.slice(1)),e.pop(),e=e[v](h(E,n)),l=["R"][v](t.slice(-2));else for(E=0,z=t.length;E<z;E++)l[E]=t[E];switch(l[0]){case "Z":f=m;g=k;
break;case "H":f=l[1];break;case "V":g=l[1];break;case "M":m=l[l.length-2],k=l[l.length-1];default:f=l[l.length-2],g=l[l.length-1]}}e.toString=a._path2string;d.abs=qa(e);return e},Oa=function(a,b,d,e,f,g){var m=1/3,h=2/3;return[m*a+h*d,m*b+h*e,m*f+h*d,m*g+h*e,f,g]},cb=function(a,b,d,f,g,m,h,k,l,n){var t=120*O/180,q=O/180*(+g||0),p=[],E,z=e(function(a,b,d){var e=a*N.cos(d)-b*N.sin(d);a=a*N.sin(d)+b*N.cos(d);return{x:e,y:a}});if(n)w=n[0],E=n[1],m=n[2],s=n[3];else{E=z(a,b,-q);a=E.x;b=E.y;E=z(k,l,-q);
k=E.x;l=E.y;N.cos(O/180*g);N.sin(O/180*g);E=(a-k)/2;w=(b-l)/2;s=E*E/(d*d)+w*w/(f*f);1<s&&(s=N.sqrt(s),d*=s,f*=s);var s=d*d,u=f*f,s=(m==h?-1:1)*N.sqrt(T((s*u-s*w*w-u*E*E)/(s*w*w+u*E*E)));m=s*d*w/f+(a+k)/2;var s=s*-f*E/d+(b+l)/2,w=N.asin(((b-s)/f).toFixed(9));E=N.asin(((l-s)/f).toFixed(9));w=a<m?O-w:w;E=k<m?O-E:E;0>w&&(w=2*O+w);0>E&&(E=2*O+E);h&&w>E&&(w-=2*O);!h&&E>w&&(E-=2*O)}if(T(E-w)>t){var p=E,u=k,A=l;E=w+t*(h&&E>w?1:-1);k=m+d*N.cos(E);l=s+f*N.sin(E);p=cb(k,l,d,f,g,0,h,u,A,[E,p,m,s])}m=E-w;g=N.cos(w);
t=N.sin(w);h=N.cos(E);E=N.sin(E);m=N.tan(m/4);d=4/3*d*m;m*=4/3*f;f=[a,b];a=[a+d*t,b-m*g];b=[k+d*E,l-m*h];k=[k,l];a[0]=2*f[0]-a[0];a[1]=2*f[1]-a[1];if(n)return[a,b,k][v](p);p=[a,b,k][v](p).join()[P](",");n=[];k=0;for(l=p.length;k<l;k++)n[k]=k%2?z(p[k-1],p[k],q).y:z(p[k],p[k+1],q).x;return n},Qa=function(a,b,d,e,f,g,m,h,k){var l=1-k;return{x:aa(l,3)*a+3*aa(l,2)*k*d+3*l*k*k*f+aa(k,3)*m,y:aa(l,3)*b+3*aa(l,2)*k*e+3*l*k*k*g+aa(k,3)*h}},bb=e(function(a,b,d,e,f,g,m,h){var k=f-2*d+a-(m-2*f+d),l=2*(d-a)-2*
(f-d),n=a-d,v=(-l+N.sqrt(l*l-4*k*n))/2/k,k=(-l-N.sqrt(l*l-4*k*n))/2/k,E=[b,h],q=[a,m];"1e12"<T(v)&&(v=0.5);"1e12"<T(k)&&(k=0.5);0<v&&1>v&&(v=Qa(a,b,d,e,f,g,m,h,v),q.push(v.x),E.push(v.y));0<k&&1>k&&(v=Qa(a,b,d,e,f,g,m,h,k),q.push(v.x),E.push(v.y));k=g-2*e+b-(h-2*g+e);l=2*(e-b)-2*(g-e);n=b-e;v=(-l+N.sqrt(l*l-4*k*n))/2/k;k=(-l-N.sqrt(l*l-4*k*n))/2/k;"1e12"<T(v)&&(v=0.5);"1e12"<T(k)&&(k=0.5);0<v&&1>v&&(v=Qa(a,b,d,e,f,g,m,h,v),q.push(v.x),E.push(v.y));0<k&&1>k&&(v=Qa(a,b,d,e,f,g,m,h,k),q.push(v.x),E.push(v.y));
return{min:{x:$[t](0,q),y:$[t](0,E)},max:{x:Q[t](0,q),y:Q[t](0,E)}}}),La=a._path2curve=e(function(a,b){var d=!b&&va(a);if(!b&&d.curve)return qa(d.curve);var e=Ja(a),f=b&&Ja(b),g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},m={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},h=function(a,b,d){if(!a)return["C",b.x,b.y,b.x,b.y,b.x,b.y];a[0]in{T:1,Q:1}||(b.qx=b.qy=null);switch(a[0]){case "M":b.X=a[1];b.Y=a[2];break;case "A":a=["C"][v](cb[t](0,[b.x,b.y][v](a.slice(1))));break;case "S":"C"==d||"S"==d?(d=2*b.x-
b.bx,b=2*b.y-b.by):(d=b.x,b=b.y);a=["C",d,b][v](a.slice(1));break;case "T":"Q"==d||"T"==d?(b.qx=2*b.x-b.qx,b.qy=2*b.y-b.qy):(b.qx=b.x,b.qy=b.y);a=["C"][v](Oa(b.x,b.y,b.qx,b.qy,a[1],a[2]));break;case "Q":b.qx=a[1];b.qy=a[2];a=["C"][v](Oa(b.x,b.y,a[1],a[2],a[3],a[4]));break;case "L":a=["C"][v]([b.x,b.y,a[1],a[2],a[1],a[2]]);break;case "H":a=["C"][v]([b.x,b.y,a[1],b.y,a[1],b.y]);break;case "V":a=["C"][v]([b.x,b.y,b.x,a[1],b.x,a[1]]);break;case "Z":a=["C"][v]([b.x,b.y,b.X,b.Y,b.X,b.Y])}return a},k=function(a,
b){if(7<a[b].length){a[b].shift();for(var d=a[b];d.length;)n[b]="A",f&&(E[b]="A"),a.splice(b++,0,["C"][v](d.splice(0,6)));a.splice(b,1);s=Q(e.length,f&&f.length||0)}},l=function(a,b,d,g,m){a&&b&&"M"==a[m][0]&&"M"!=b[m][0]&&(b.splice(m,0,["M",g.x,g.y]),d.bx=0,d.by=0,d.x=a[m][1],d.y=a[m][2],s=Q(e.length,f&&f.length||0))},n=[],E=[],q="",p="",z=0,s=Q(e.length,f&&f.length||0);for(;z<s;z++){e[z]&&(q=e[z][0]);"C"!=q&&(n[z]=q,z&&(p=n[z-1]));e[z]=h(e[z],g,p);"A"!=n[z]&&"C"==q&&(n[z]="C");k(e,z);f&&(f[z]&&
(q=f[z][0]),"C"!=q&&(E[z]=q,z&&(p=E[z-1])),f[z]=h(f[z],m,p),"A"!=E[z]&&"C"==q&&(E[z]="C"),k(f,z));l(e,f,g,m,z);l(f,e,m,g,z);var u=e[z],w=f&&f[z],A=u.length,L=f&&w.length;g.x=u[A-2];g.y=u[A-1];g.bx=W(u[A-4])||g.x;g.by=W(u[A-3])||g.y;m.bx=f&&(W(w[L-4])||m.x);m.by=f&&(W(w[L-3])||m.y);m.x=f&&w[L-2];m.y=f&&w[L-1]}f||(d.curve=qa(e));return f?[e,f]:e},null,qa);a._parseDots=e(function(b){for(var d=[],e=0,f=b.length;e<f;e++){var g={},m=b[e].match(/^([^:]*):?([\d\.]*)/);g.color=a.getRGB(m[1]);if(g.color.error)return null;
g.color=g.color.hex;m[2]&&(g.offset=m[2]+"%");d.push(g)}e=1;for(f=d.length-1;e<f;e++)if(!d[e].offset){b=W(d[e-1].offset||0);m=0;for(g=e+1;g<f;g++)if(d[g].offset){m=d[g].offset;break}m||(m=100,g=f);m=W(m);for(m=(m-b)/(g-e+1);e<g;e++)b+=m,d[e].offset=b+"%"}return d});var Ra=a._tear=function(a,b){a==b.top&&(b.top=a.prev);a==b.bottom&&(b.bottom=a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)};a._tofront=function(a,b){b.top!==a&&(Ra(a,b),a.next=null,a.prev=b.top,b.top.next=a,b.top=a)};
a._toback=function(a,b){b.bottom!==a&&(Ra(a,b),a.next=b.bottom,a.prev=null,b.bottom.prev=a,b.bottom=a)};a._insertafter=function(a,b,d){Ra(a,d);b==d.top&&(d.top=a);b.next&&(b.next.prev=a);a.next=b.next;a.prev=b;b.next=a};a._insertbefore=function(a,b,d){Ra(a,d);b==d.bottom&&(d.bottom=a);b.prev&&(b.prev.next=a);a.prev=b.prev;b.prev=a;a.next=b};var jb=a.toMatrix=function(a,b){var d=Fa(a),e={_:{transform:""},getBBox:function(){return d}};$a(e,b);return e.matrix};a.transformPath=function(a,b){return pa(a,
jb(a,b))};var $a=a._extractTransform=function(b,d){if(null==d)return b._.transform;d=L(d).replace(/\.{3}|\u2026/g,b._.transform||"");var e=a.parseTransformString(d),f=0,g=0,h=0,k=1,l=1,v=b._,h=new m;v.transform=e||[];if(e)for(var g=0,n=e.length;g<n;g++){var t=e[g],q=t.length,E=L(t[0]).toLowerCase(),p=t[0]!=E,z=p?h.invert():0,s;"t"==E&&3==q?p?(q=z.x(0,0),E=z.y(0,0),p=z.x(t[1],t[2]),z=z.y(t[1],t[2]),h.translate(p-q,z-E)):h.translate(t[1],t[2]):"r"==E?2==q?(s=s||b.getBBox(1),h.rotate(t[1],s.x+s.width/
2,s.y+s.height/2),f+=t[1]):4==q&&(p?(p=z.x(t[2],t[3]),z=z.y(t[2],t[3]),h.rotate(t[1],p,z)):h.rotate(t[1],t[2],t[3]),f+=t[1]):"s"==E?2==q||3==q?(s=s||b.getBBox(1),h.scale(t[1],t[q-1],s.x+s.width/2,s.y+s.height/2),k*=t[1],l*=t[q-1]):5==q&&(p?(p=z.x(t[3],t[4]),z=z.y(t[3],t[4]),h.scale(t[1],t[2],p,z)):h.scale(t[1],t[2],t[3],t[4]),k*=t[1],l*=t[2]):"m"==E&&7==q&&h.add(t[1],t[2],t[3],t[4],t[5],t[6]);v.dirtyT=1;b.matrix=h}b.matrix=h;v.sx=k;v.sy=l;v.deg=f;v.dx=g=h.e;v.dy=h=h.f;1==k&&1==l&&!f&&v.bbox?(v.bbox.x+=
+g,v.bbox.y+=+h):v.dirtyT=1},db=function(a){var b=a[0];switch(b.toLowerCase()){case "t":return[b,0,0];case "m":return[b,1,0,0,1,0,0];case "r":return 4==a.length?[b,0,a[2],a[3]]:[b,0];case "s":return 5==a.length?[b,1,1,a[3],a[4]]:3==a.length?[b,1,1]:[b,1]}},ib=a._equaliseTransform=function(b,d){d=L(d).replace(/\.{3}|\u2026/g,b);b=a.parseTransformString(b)||[];d=a.parseTransformString(d)||[];for(var e=Q(b.length,d.length),f=[],g=[],m=0,h,k,l,v;m<e;m++){l=b[m]||db(d[m]);v=d[m]||db(l);if(l[0]!=v[0]||
"r"==l[0].toLowerCase()&&(l[2]!=v[2]||l[3]!=v[3])||"s"==l[0].toLowerCase()&&(l[3]!=v[3]||l[4]!=v[4]))return;f[m]=[];g[m]=[];h=0;for(k=Q(l.length,v.length);h<k;h++)h in l&&(f[m][h]=l[h]),h in v&&(g[m][h]=v[h])}return{from:f,to:g}};a._getContainer=function(b,d,e,f){var g;g=null!=f||a.is(b,"object")?b:G.doc.getElementById(b);if(null!=g)return g.tagName?null==d?{container:g,width:g.style.pixelWidth||g.offsetWidth,height:g.style.pixelHeight||g.offsetHeight}:{container:g,width:d,height:e}:{container:1,
x:b,y:d,width:e,height:f}};a.pathToRelative=Na;a._engine={};a.path2curve=La;a.matrix=function(a,b,d,e,f,g){return new m(a,b,d,e,f,g)};(function(b){function d(a){return a[0]*a[0]+a[1]*a[1]}function e(a){var b=N.sqrt(d(a));a[0]&&(a[0]/=b);a[1]&&(a[1]/=b)}b.add=function(a,b,d,e,f,g){var h=[[],[],[]],k=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]];b=[[a,d,f],[b,e,g],[0,0,1]];a&&a instanceof m&&(b=[[a.a,a.c,a.e],[a.b,a.d,a.f],[0,0,1]]);for(a=0;3>a;a++)for(d=0;3>d;d++){for(e=f=0;3>e;e++)f+=k[a][e]*
b[e][d];h[a][d]=f}this.a=h[0][0];this.b=h[1][0];this.c=h[0][1];this.d=h[1][1];this.e=h[0][2];this.f=h[1][2]};b.invert=function(){var a=this.a*this.d-this.b*this.c;return new m(this.d/a,-this.b/a,-this.c/a,this.a/a,(this.c*this.f-this.d*this.e)/a,(this.b*this.e-this.a*this.f)/a)};b.clone=function(){return new m(this.a,this.b,this.c,this.d,this.e,this.f)};b.translate=function(a,b){this.add(1,0,0,1,a,b)};b.scale=function(a,b,d,e){null==b&&(b=a);(d||e)&&this.add(1,0,0,1,d,e);this.add(a,0,0,b,0,0);(d||
e)&&this.add(1,0,0,1,-d,-e)};b.rotate=function(b,d,e){b=a.rad(b);d=d||0;e=e||0;var f=+N.cos(b).toFixed(9);b=+N.sin(b).toFixed(9);this.add(f,b,-b,f,d,e);this.add(1,0,0,1,-d,-e)};b.x=function(a,b){return a*this.a+b*this.c+this.e};b.y=function(a,b){return a*this.b+b*this.d+this.f};b.get=function(a){return+this[L.fromCharCode(97+a)].toFixed(4)};b.toString=function(){return a.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),
this.get(3),0,0].join()};b.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};b.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};b.split=function(){var b={};b.dx=this.e;b.dy=this.f;var f=[[this.a,this.c],[this.b,this.d]];b.scalex=N.sqrt(d(f[0]));e(f[0]);b.shear=f[0][0]*f[1][0]+f[0][1]*f[1][1];f[1]=[f[1][0]-f[0][0]*
b.shear,f[1][1]-f[0][1]*b.shear];b.scaley=N.sqrt(d(f[1]));e(f[1]);b.shear/=b.scaley;var g=-f[0][1],f=f[1][1];0>f?(b.rotate=a.deg(N.acos(f)),0>g&&(b.rotate=360-b.rotate)):b.rotate=a.deg(N.asin(g));b.isSimple=!+b.shear.toFixed(9)&&(b.scalex.toFixed(9)==b.scaley.toFixed(9)||!b.rotate);b.isSuperSimple=!+b.shear.toFixed(9)&&b.scalex.toFixed(9)==b.scaley.toFixed(9)&&!b.rotate;b.noRotation=!+b.shear.toFixed(9)&&!b.rotate;return b};b.toTransformString=function(a){a=a||this[P]();return a.isSimple?(a.scalex=
+a.scalex.toFixed(4),a.scaley=+a.scaley.toFixed(4),a.rotate=+a.rotate.toFixed(4),(a.dx||a.dy?"t"+[a.dx,a.dy]:"")+(1!=a.scalex||1!=a.scaley?"s"+[a.scalex,a.scaley,0,0]:"")+(a.rotate?"r"+[a.rotate,0,0]:"")):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}})(m.prototype);for(var kb=function(){this.returnValue=!1},lb=function(){return this.originalEvent.preventDefault()},mb=function(){this.cancelBubble=!0},nb=function(){return this.originalEvent.stopPropagation()},eb=function(a){return{x:a.clientX+
(G.doc.documentElement.scrollLeft||G.doc.body.scrollLeft),y:a.clientY+(G.doc.documentElement.scrollTop||G.doc.body.scrollTop)}},ob=function(){if(G.doc.addEventListener)return function(a,b,d,e){var f=function(a){var b=eb(a);return d.call(e,a,b.x,b.y)};a.addEventListener(b,f,!1);if(z&&Y[b]){var g=function(b){for(var f=eb(b),g=b,m=0,h=b.targetTouches&&b.targetTouches.length;m<h;m++)if(b.targetTouches[m].target==a){b=b.targetTouches[m];b.originalEvent=g;b.preventDefault=lb;b.stopPropagation=nb;break}return d.call(e,
b,f.x,f.y)};a.addEventListener(Y[b],g,!1)}return function(){a.removeEventListener(b,f,!1);z&&Y[b]&&a.removeEventListener(Y[b],g,!1);return!0}};if(G.doc.attachEvent)return function(a,b,d,e){var f=function(a){a=a||G.win.event;var b=a.clientX+(G.doc.documentElement.scrollLeft||G.doc.body.scrollLeft),f=a.clientY+(G.doc.documentElement.scrollTop||G.doc.body.scrollTop);a.preventDefault=a.preventDefault||kb;a.stopPropagation=a.stopPropagation||mb;return d.call(e,a,b,f)};a.attachEvent("on"+b,f);return function(){a.detachEvent("on"+
b,f);return!0}}}(),Ga=[],Ta=function(a){for(var b=a.clientX,e=a.clientY,f=G.doc.documentElement.scrollTop||G.doc.body.scrollTop,g=G.doc.documentElement.scrollLeft||G.doc.body.scrollLeft,m,h=Ga.length;h--;){m=Ga[h];if(z&&a.touches)for(var k=a.touches.length,l;k--;){if(l=a.touches[k],l.identifier==m.el._drag.id){b=l.clientX;e=l.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();var k=m.el.node,v=k.nextSibling,n=k.parentNode,t=k.style.display;G.win.opera&&n.removeChild(k);
k.style.display="none";l=m.el.paper.getElementByPoint(b,e);k.style.display=t;G.win.opera&&(v?n.insertBefore(k,v):n.appendChild(k));l&&d("raphael.drag.over."+m.el.id,m.el,l);b+=g;e+=f;d("raphael.drag.move."+m.el.id,m.move_scope||m.el,b-m.el._drag.x,e-m.el._drag.y,b,e,a)}},Ua=function(b){a.unmousemove(Ta).unmouseup(Ua);for(var e=Ga.length,f;e--;)f=Ga[e],f.el._drag={},d("raphael.drag.end."+f.el.id,f.end_scope||f.start_scope||f.move_scope||f.el,b);Ga=[]},ea=a.el={},fb=U.length;fb--;)(function(b){a[b]=
ea[b]=function(d,e){a.is(d,"function")&&(this.events=this.events||[],this.events.push({name:b,f:d,unbind:ob(this.shape||this.node||G.doc,b,d,e||this)}));return this};a["un"+b]=ea["un"+b]=function(d){for(var e=this.events||[],f=e.length;f--;)e[f].name!=b||!a.is(d,"undefined")&&e[f].f!=d||(e[f].unbind(),e.splice(f,1),!e.length&&delete this.events);return this}})(U[fb]);ea.data=function(b,e){var f=da[this.id]=da[this.id]||{};if(0==arguments.length)return f;if(1==arguments.length){if(a.is(b,"object")){for(var g in b)b[I](g)&&
this.data(g,b[g]);return this}d("raphael.data.get."+this.id,this,f[b],b);return f[b]}f[b]=e;d("raphael.data.set."+this.id,this,e,b);return this};ea.removeData=function(a){null==a?da[this.id]={}:da[this.id]&&delete da[this.id][a];return this};ea.getData=function(){return f(da[this.id]||{})};ea.hover=function(a,b,d,e){return this.mouseover(a,d).mouseout(b,e||d)};ea.unhover=function(a,b){return this.unmouseover(a).unmouseout(b)};var Ka=[];ea.drag=function(b,e,f,g,m,h){function k(l){(l.originalEvent||
l).preventDefault();var v=l.clientX,n=l.clientY,t=G.doc.documentElement.scrollTop||G.doc.body.scrollTop,q=G.doc.documentElement.scrollLeft||G.doc.body.scrollLeft;this._drag.id=l.identifier;if(z&&l.touches)for(var E=l.touches.length,p;E--;)if(p=l.touches[E],this._drag.id=p.identifier,p.identifier==this._drag.id){v=p.clientX;n=p.clientY;break}this._drag.x=v+q;this._drag.y=n+t;!Ga.length&&a.mousemove(Ta).mouseup(Ua);Ga.push({el:this,move_scope:g,start_scope:m,end_scope:h});e&&d.on("raphael.drag.start."+
this.id,e);b&&d.on("raphael.drag.move."+this.id,b);f&&d.on("raphael.drag.end."+this.id,f);d("raphael.drag.start."+this.id,m||g||this,l.clientX+q,l.clientY+t,l)}this._drag={};Ka.push({el:this,start:k});this.mousedown(k);return this};ea.onDragOver=function(a){a?d.on("raphael.drag.over."+this.id,a):d.unbind("raphael.drag.over."+this.id)};ea.undrag=function(){for(var b=Ka.length;b--;)Ka[b].el==this&&(this.unmousedown(Ka[b].start),Ka.splice(b,1),d.unbind("raphael.drag.*."+this.id));!Ka.length&&a.unmousemove(Ta).unmouseup(Ua);
Ga=[]};F.circle=function(b,d,e){b=a._engine.circle(this,b||0,d||0,e||0);this.__set__&&this.__set__.push(b);return b};F.rect=function(b,d,e,f,g){b=a._engine.rect(this,b||0,d||0,e||0,f||0,g||0);this.__set__&&this.__set__.push(b);return b};F.ellipse=function(b,d,e,f){b=a._engine.ellipse(this,b||0,d||0,e||0,f||0);this.__set__&&this.__set__.push(b);return b};F.path=function(b){b&&!a.is(b,"string")&&!a.is(b[0],R)&&(b+="");var d=a._engine.path(a.format[t](a,arguments),this);this.__set__&&this.__set__.push(d);
return d};F.image=function(b,d,e,f,g){b=a._engine.image(this,b||"about:blank",d||0,e||0,f||0,g||0);this.__set__&&this.__set__.push(b);return b};F.text=function(b,d,e){b=a._engine.text(this,b||0,d||0,L(e));this.__set__&&this.__set__.push(b);return b};F.set=function(b){!a.is(b,"array")&&(b=Array.prototype.splice.call(arguments,0,arguments.length));var d=new Pa(b);this.__set__&&this.__set__.push(d);d.paper=this;d.type="set";return d};F.setStart=function(a){this.__set__=a||this.set()};F.setFinish=function(a){a=
this.__set__;delete this.__set__;return a};F.getSize=function(){var a=this.canvas.parentNode;return{width:a.offsetWidth,height:a.offsetHeight}};F.setSize=function(b,d){return a._engine.setSize.call(this,b,d)};F.setViewBox=function(b,d,e,f,g){return a._engine.setViewBox.call(this,b,d,e,f,g)};F.top=F.bottom=null;F.raphael=a;F.getElementByPoint=function(a,b){var d,e,f=this.canvas,g=G.doc.elementFromPoint(a,b);if(G.win.opera&&"svg"==g.tagName){e=f.getBoundingClientRect();d=f.ownerDocument;var m=d.body,
h=d.documentElement;d=e.top+(G.win.pageYOffset||h.scrollTop||m.scrollTop)-(h.clientTop||m.clientTop||0);e=e.left+(G.win.pageXOffset||h.scrollLeft||m.scrollLeft)-(h.clientLeft||m.clientLeft||0);m=f.createSVGRect();m.x=a-e;m.y=b-d;m.width=m.height=1;d=f.getIntersectionList(m,null);d.length&&(g=d[d.length-1])}if(!g)return null;for(;g.parentNode&&g!=f.parentNode&&!g.raphael;)g=g.parentNode;g==this.canvas.parentNode&&(g=f);return g=g&&g.raphael?this.getById(g.raphaelid):null};F.getElementsByBBox=function(b){var d=
this.set();this.forEach(function(e){a.isBBoxIntersect(e.getBBox(),b)&&d.push(e)});return d};F.getById=function(a){for(var b=this.bottom;b;){if(b.id==a)return b;b=b.next}return null};F.forEach=function(a,b){for(var d=this.bottom;d&&!1!==a.call(b,d);)d=d.next;return this};F.getElementsByPoint=function(a,b){var d=this.set();this.forEach(function(e){e.isPointInside(a,b)&&d.push(e)});return d};ea.isPointInside=function(b,d){var e=this.realPath=ma[this.type](this);this.attr("transform")&&this.attr("transform").length&&
(e=a.transformPath(e,this.attr("transform")));return a.isPointInsidePath(e,b,d)};ea.getBBox=function(a){if(this.removed)return{};var b=this._;if(a){if(b.dirty||!b.bboxwt)this.realPath=ma[this.type](this),b.bboxwt=Fa(this.realPath),b.bboxwt.toString=n,b.dirty=0;return b.bboxwt}if(b.dirty||b.dirtyT||!b.bbox){if(b.dirty||!this.realPath)b.bboxwt=0,this.realPath=ma[this.type](this);b.bbox=Fa(pa(this.realPath,this.matrix));b.bbox.toString=n;b.dirty=b.dirtyT=0}return b.bbox};ea.clone=function(){if(this.removed)return null;
var a=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(a);return a};ea.glow=function(a){if("text"==this.type)return null;a=a||{};var b=(a.width||10)+(+this.attr("stroke-width")||1),d=a.fill||!1,e=a.opacity||0.5,f=a.offsetx||0,g=a.offsety||0;a=a.color||"#000";for(var m=b/2,h=this.paper,k=h.set(),l=this.realPath||ma[this.type](this),l=this.matrix?pa(l,this.matrix):l,v=1;v<m+1;v++)k.push(h.path(l).attr({stroke:a,fill:d?a:"none","stroke-linejoin":"round","stroke-linecap":"round",
"stroke-width":+(b/m*v).toFixed(3),opacity:+(e/m).toFixed(3)}));return k.insertBefore(this).translate(f,g)};var Va=function(b,d,e,f,g,m,h,v,n){return null==n?k(b,d,e,f,g,m,h,v):a.findDotsAtSegment(b,d,e,f,g,m,h,v,l(b,d,e,f,g,m,h,v,n))},Wa=function(b,d){return function(e,f,g){e=La(e);for(var m,h,k,l,v="",n={},t=0,q=0,E=e.length;q<E;q++){k=e[q];if("M"==k[0])m=+k[1],h=+k[2];else{l=Va(m,h,k[1],k[2],k[3],k[4],k[5],k[6]);if(t+l>f){if(d&&!n.start){m=Va(m,h,k[1],k[2],k[3],k[4],k[5],k[6],f-t);v+=["C"+m.start.x,
m.start.y,m.m.x,m.m.y,m.x,m.y];if(g)return v;n.start=v;v=["M"+m.x,m.y+"C"+m.n.x,m.n.y,m.end.x,m.end.y,k[5],k[6]].join();t+=l;m=+k[5];h=+k[6];continue}if(!b&&!d)return m=Va(m,h,k[1],k[2],k[3],k[4],k[5],k[6],f-t),{x:m.x,y:m.y,alpha:m.alpha}}t+=l;m=+k[5];h=+k[6]}v+=k.shift()+k}n.end=v;m=b?t:d?n:a.findDotsAtSegment(m,h,k[0],k[1],k[2],k[3],k[4],k[5],1);m.alpha&&(m={x:m.x,y:m.y,alpha:m.alpha});return m}},gb=Wa(1),hb=Wa(),Xa=Wa(0,1);a.getTotalLength=gb;a.getPointAtLength=hb;a.getSubpath=function(a,b,d){if(1E-6>
this.getTotalLength(a)-d)return Xa(a,b).end;a=Xa(a,d,1);return b?Xa(a,b).end:a};ea.getTotalLength=function(){var a=this.getPath();if(a)return this.node.getTotalLength?this.node.getTotalLength():gb(a)};ea.getPointAtLength=function(a){var b=this.getPath();if(b)return hb(b,a)};ea.getPath=function(){var b,d=a._getPath[this.type];if("text"!=this.type&&"set"!=this.type)return d&&(b=d(this)),b};ea.getSubpath=function(b,d){var e=this.getPath();if(e)return a.getSubpath(e,b,d)};var wa=a.easing_formulas={linear:function(a){return a},
"<":function(a){return aa(a,1.7)},">":function(a){return aa(a,0.48)},"<>":function(a){var b=0.48-a/1.04,d=N.sqrt(0.1734+b*b);a=d-b;a=aa(T(a),1/3)*(0>a?-1:1);b=-d-b;b=aa(T(b),1/3)*(0>b?-1:1);a=a+b+0.5;return 3*(1-a)*a*a+a*a*a},backIn:function(a){return a*a*(2.70158*a-1.70158)},backOut:function(a){a-=1;return a*a*(2.70158*a+1.70158)+1},elastic:function(a){return a==!!a?a:aa(2,-10*a)*N.sin(2*(a-0.075)*O/0.3)+1},bounce:function(a){a<1/2.75?a*=7.5625*a:a<2/2.75?(a-=1.5/2.75,a=7.5625*a*a+0.75):a<2.5/2.75?
(a-=2.25/2.75,a=7.5625*a*a+0.9375):(a-=2.625/2.75,a=7.5625*a*a+0.984375);return a}};wa.easeIn=wa["ease-in"]=wa["<"];wa.easeOut=wa["ease-out"]=wa[">"];wa.easeInOut=wa["ease-in-out"]=wa["<>"];wa["back-in"]=wa.backIn;wa["back-out"]=wa.backOut;var ca=[],ab=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||b.oRequestAnimationFrame||b.msRequestAnimationFrame||function(a){setTimeout(a,16)},Sa=function(){for(var b=+new Date,e=0;e<ca.length;e++){var f=ca[e];if(!f.el.removed&&
!f.paused){var g=b-f.start,m=f.ms,h=f.easing,k=f.from,l=f.diff,n=f.to,t=f.el,p={},z,s={},u;f.initstatus?(g=(f.initstatus*f.anim.top-f.prev)/(f.percent-f.prev)*m,f.status=f.initstatus,delete f.initstatus,f.stop&&ca.splice(e--,1)):f.status=(f.prev+(f.percent-f.prev)*(g/m))/f.anim.top;if(!(0>g))if(g<m){var w=h(g/m),A;for(A in k)if(k[I](A)){switch(Aa[A]){case S:z=+k[A]+w*m*l[A];break;case "colour":z="rgb("+[Ya(la(k[A].r+w*m*l[A].r)),Ya(la(k[A].g+w*m*l[A].g)),Ya(la(k[A].b+w*m*l[A].b))].join()+")";break;
case "path":z=[];g=0;for(h=k[A].length;g<h;g++){z[g]=[k[A][g][0]];n=1;for(s=k[A][g].length;n<s;n++)z[g][n]=+k[A][g][n]+w*m*l[A][g][n];z[g]=z[g].join(E)}z=z.join(E);break;case "transform":if(l[A].real)for(z=[],g=0,h=k[A].length;g<h;g++)for(z[g]=[k[A][g][0]],n=1,s=k[A][g].length;n<s;n++)z[g][n]=k[A][g][n]+w*m*l[A][g][n];else z=function(a){return+k[A][a]+w*m*l[A][a]},z=[["m",z(0),z(1),z(2),z(3),z(4),z(5)]];break;case "csv":if("clip-rect"==A)for(z=[],g=4;g--;)z[g]=+k[A][g]+w*m*l[A][g];break;default:for(h=
[][v](k[A]),z=[],g=t.paper.customAttributes[A].length;g--;)z[g]=+h[g]+w*m*l[A][g]}p[A]=z}t.attr(p);(function(a,b,e){setTimeout(function(){d("raphael.anim.frame."+a,b,e)})})(t.id,t,f.anim)}else{(function(b,e,f){setTimeout(function(){d("raphael.anim.frame."+e.id,e,f);d("raphael.anim.finish."+e.id,e,f);a.is(b,"function")&&b.call(e)})})(f.callback,t,f.anim);t.attr(n);ca.splice(e--,1);if(1<f.repeat&&!f.next){for(u in n)n[I](u)&&(s[u]=f.totalOrigin[u]);f.el.attr(s);q(f.anim,f.el,f.anim.percents[0],null,
f.totalOrigin,f.repeat-1)}f.next&&!f.stop&&q(f.anim,f.el,f.next,null,f.totalOrigin,f.repeat)}}}ca.length&&ab(Sa)},Ya=function(a){return 255<a?255:0>a?0:a};ea.animateWith=function(b,d,e,f,g,m){if(this.removed)return m&&m.call(this),this;e=e instanceof s?e:a.animation(e,f,g,m);q(e,this,e.percents[0],null,this.attr());e=0;for(f=ca.length;e<f;e++)if(ca[e].anim==d&&ca[e].el==b){ca[f-1].start=ca[e].start;break}return this};ea.onAnimation=function(a){a?d.on("raphael.anim.frame."+this.id,a):d.unbind("raphael.anim.frame."+
this.id);return this};s.prototype.delay=function(a){var b=new s(this.anim,this.ms);b.times=this.times;b.del=+a||0;return b};s.prototype.repeat=function(a){var b=new s(this.anim,this.ms);b.del=this.del;b.times=N.floor(Q(a,0))||1;return b};a.animation=function(b,d,e,f){if(b instanceof s)return b;if(a.is(e,"function")||!e)f=f||e||null,e=null;b=Object(b);d=+d||0;var g={},m,h;for(h in b)b[I](h)&&W(h)!=h&&W(h)+"%"!=h&&(m=!0,g[h]=b[h]);if(m)return e&&(g.easing=e),f&&(g.callback=f),new s({100:g},d);if(f){e=
0;for(var k in b)g=ba(k),b[I](k)&&g>e&&(e=g);e+="%";!b[e].callback&&(b[e].callback=f)}return new s(b,d)};ea.animate=function(b,d,e,f){if(this.removed)return f&&f.call(this),this;b=b instanceof s?b:a.animation(b,d,e,f);q(b,this,b.percents[0],null,this.attr());return this};ea.setTime=function(a,b){a&&null!=b&&this.status(a,$(b,a.ms)/a.ms);return this};ea.status=function(a,b){var d=[],e=0,f,g;if(null!=b)return q(a,this,-1,$(b,1)),this;for(f=ca.length;e<f;e++)if(g=ca[e],g.el.id==this.id&&(!a||g.anim==
a)){if(a)return g.status;d.push({anim:g.anim,status:g.status})}return a?0:d};ea.pause=function(a){for(var b=0;b<ca.length;b++)ca[b].el.id!=this.id||a&&ca[b].anim!=a||!1===d("raphael.anim.pause."+this.id,this,ca[b].anim)||(ca[b].paused=!0);return this};ea.resume=function(a){for(var b=0;b<ca.length;b++)if(ca[b].el.id==this.id&&(!a||ca[b].anim==a)){var e=ca[b];!1!==d("raphael.anim.resume."+this.id,this,e.anim)&&(delete e.paused,this.status(e.anim,e.status))}return this};ea.stop=function(a){for(var b=
0;b<ca.length;b++)ca[b].el.id!=this.id||a&&ca[b].anim!=a||!1!==d("raphael.anim.stop."+this.id,this,ca[b].anim)&&ca.splice(b--,1);return this};d.on("raphael.remove",w);d.on("raphael.clear",w);ea.toString=function(){return"Rapha\u00ebl\u2019s object"};var Pa=function(a){this.items=[];this.length=0;this.type="set";if(a)for(var b=0,d=a.length;b<d;b++)!a[b]||a[b].constructor!=ea.constructor&&a[b].constructor!=Pa||(this[this.items.length]=this.items[this.items.length]=a[b],this.length++)},sa=Pa.prototype;
sa.push=function(){for(var a,b,d=0,e=arguments.length;d<e;d++)!(a=arguments[d])||a.constructor!=ea.constructor&&a.constructor!=Pa||(b=this.items.length,this[b]=this.items[b]=a,this.length++);return this};sa.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};sa.forEach=function(a,b){for(var d=0,e=this.items.length;d<e&&!1!==a.call(b,this.items[d],d);d++);return this};for(var Za in ea)ea[I](Za)&&(sa[Za]=function(a){return function(){var b=arguments;return this.forEach(function(d){d[a][t](d,
b)})}}(Za));sa.attr=function(b,d){if(b&&a.is(b,R)&&a.is(b[0],"object"))for(var e=0,f=b.length;e<f;e++)this.items[e].attr(b[e]);else for(e=0,f=this.items.length;e<f;e++)this.items[e].attr(b,d);return this};sa.clear=function(){for(;this.length;)this.pop()};sa.splice=function(a,b,d){a=0>a?Q(this.length+a,0):a;b=Q(0,$(this.length-a,b));var e=[],f=[],g=[],m;for(m=2;m<arguments.length;m++)g.push(arguments[m]);for(m=0;m<b;m++)f.push(this[a+m]);for(;m<this.length-a;m++)e.push(this[a+m]);var h=g.length;for(m=
0;m<h+e.length;m++)this.items[a+m]=this[a+m]=m<h?g[m]:e[m-h];for(m=this.items.length=this.length-=b-h;this[m];)delete this[m++];return new Pa(f)};sa.exclude=function(a){for(var b=0,d=this.length;b<d;b++)if(this[b]==a)return this.splice(b,1),!0};sa.animate=function(b,d,e,f){!a.is(e,"function")&&e||(f=e||null);var g=this.items.length,m=g,h=this,k;if(!g)return this;f&&(k=function(){!--g&&f.call(h)});e=a.is(e,"string")?e:k;d=a.animation(b,d,e,k);for(b=this.items[--m].animate(d);m--;)this.items[m]&&!this.items[m].removed&&
this.items[m].animateWith(b,d,d),this.items[m]&&!this.items[m].removed||g--;return this};sa.insertAfter=function(a){for(var b=this.items.length;b--;)this.items[b].insertAfter(a);return this};sa.getBBox=function(){for(var a=[],b=[],d=[],e=[],f=this.items.length;f--;)if(!this.items[f].removed){var g=this.items[f].getBBox();a.push(g.x);b.push(g.y);d.push(g.x+g.width);e.push(g.y+g.height)}a=$[t](0,a);b=$[t](0,b);d=Q[t](0,d);e=Q[t](0,e);return{x:a,y:b,x2:d,y2:e,width:d-a,height:e-b}};sa.clone=function(a){a=
this.paper.set();for(var b=0,d=this.items.length;b<d;b++)a.push(this.items[b].clone());return a};sa.toString=function(){return"Rapha\u00ebl\u2018s set"};sa.glow=function(a){var b=this.paper.set();this.forEach(function(d,e){var f=d.glow(a);null!=f&&f.forEach(function(a,d){b.push(a)})});return b};sa.isPointInside=function(a,b){var d=!1;this.forEach(function(e){if(e.isPointInside(a,b))return d=!0,!1});return d};a.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var b={w:a.w,face:{},
glyphs:{}},d=a.face["font-family"],e;for(e in a.face)a.face[I](e)&&(b.face[e]=a.face[e]);this.fonts[d]?this.fonts[d].push(b):this.fonts[d]=[b];if(!a.svg){b.face["units-per-em"]=ba(a.face["units-per-em"],10);for(var f in a.glyphs)if(a.glyphs[I](f)&&(d=a.glyphs[f],b.glyphs[f]={w:d.w,k:{},d:d.d&&"M"+d.d.replace(/[mlcxtrv]/g,function(a){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[a]||"M"})+"z"},d.k))for(var g in d.k)d[I](g)&&(b.glyphs[f].k[g]=d.k[g])}return a};F.getFont=function(b,d,e,f){f=f||"normal";
e=e||"normal";d=+d||{normal:400,bold:700,lighter:300,bolder:800}[d]||400;if(a.fonts){var g=a.fonts[b];if(!g){b=RegExp("(^|\\s)"+b.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var m in a.fonts)if(a.fonts[I](m)&&b.test(m)){g=a.fonts[m];break}}var h;if(g)for(m=0,b=g.length;m<b&&(h=g[m],h.face["font-weight"]!=d||h.face["font-style"]!=e&&h.face["font-style"]||h.face["font-stretch"]!=f);m++);return h}};F.print=function(b,d,e,f,g,m,h,k){m=m||"middle";h=Q($(h||0,1),-1);k=Q($(k||1,3),1);e=L(e)[P]("");
var l=0,v=0,n="";a.is(f,"string")&&(f=this.getFont(f));if(f){g=(g||16)/f.face["units-per-em"];var t=f.face.bbox[P](B),q=+t[0],E=t[3]-t[1],p=0;m=+t[1]+("baseline"==m?E+ +f.face.descent:E/2);for(var t=0,z=e.length;t<z;t++){if("\n"==e[t])v=u=l=0,p+=E*k;else var s=v&&f.glyphs[e[t-1]]||{},u=f.glyphs[e[t]],l=l+(v?(s.w||f.w)+(s.k&&s.k[e[t]]||0)+f.w*h:0),v=1;u&&u.d&&(n+=a.transformPath(u.d,["t",l*g,p*g,"s",g,g,q,m,"t",(b-q)/g,(d-m)/g]))}}return this.path(n).attr({fill:"#000",stroke:"none"})};F.add=function(b){if(a.is(b,
"array"))for(var d=this.set(),e=0,f=b.length,g;e<f;e++)g=b[e]||{},H[I](g.type)&&d.push(this[g.type]().attr(g));return d};a.format=function(b,d){var e=a.is(d,R)?[0][v](d):arguments;b&&a.is(b,"string")&&e.length-1&&(b=b.replace(A,function(a,b){return null==e[++b]?"":e[b]}));return b||""};a.fullfill=function(){var a=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,d=function(a,d,e){var f=e;d.replace(b,function(a,b,d,e,g){b=b||e;f&&(b in f&&(f=f[b]),"function"==typeof f&&g&&
(f=f()))});return f=(null==f||f==e?a:f)+""};return function(b,e){return String(b).replace(a,function(a,b){return d(a,b,e)})}}();a.ninja=function(){D?G.win.Raphael=J:delete Raphael;return a};a.st=sa;d.on("raphael.DOMload",function(){C=!0});(function(b,d,e){function f(){/in/.test(b.readyState)?setTimeout(f,9):a.eve("raphael.DOMload")}null==b.readyState&&b.addEventListener&&(b.addEventListener(d,e=function(){b.removeEventListener(d,e,!1);b.readyState="complete"},!1),b.readyState="loading");f()})(document,
"DOMContentLoaded");(function(){if(a.svg){var b=String,d=parseFloat,e=parseInt,f=Math,g=f.max,m=f.abs,h=f.pow,k=/[, ]+/,l=a.eve,v={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},n={};a.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var t=function(d,e){if(e){"string"==typeof d&&(d=t(d));for(var f in e)e.hasOwnProperty(f)&&
("xlink:"==f.substring(0,6)?d.setAttributeNS("http://www.w3.org/1999/xlink",f.substring(6),b(e[f])):d.setAttribute(f,b(e[f])))}else d=a._g.doc.createElementNS("http://www.w3.org/2000/svg",d),d.style&&(d.style.webkitTapHighlightColor="rgba(0,0,0,0)");return d},q=function(e,k){var l="linear",v=e.id+k,n=0.5,q=0.5,E=e.node,p=e.paper,z=E.style,s=a._g.doc.getElementById(v);if(!s){k=b(k).replace(a._radial_gradient,function(a,b,e){l="radial";b&&e&&(n=d(b),q=d(e),a=2*(0.5<q)-1,0.25<h(n-0.5,2)+h(q-0.5,2)&&
(q=f.sqrt(0.25-h(n-0.5,2))*a+0.5)&&0.5!=q&&(q=q.toFixed(5)-1E-5*a));return""});k=k.split(/\s*\-\s*/);if("linear"==l){s=k.shift();s=-d(s);if(isNaN(s))return null;var u=[0,0,f.cos(a.rad(s)),f.sin(a.rad(s))],s=1/(g(m(u[2]),m(u[3]))||1);u[2]*=s;u[3]*=s;0>u[2]&&(u[0]=-u[2],u[2]=0);0>u[3]&&(u[1]=-u[3],u[3]=0)}var w=a._parseDots(k);if(!w)return null;v=v.replace(/[\(\)\s,\xb0#]/g,"_");e.gradient&&v!=e.gradient.id&&(p.defs.removeChild(e.gradient),delete e.gradient);if(!e.gradient)for(s=t(l+"Gradient",{id:v}),
e.gradient=s,t(s,"radial"==l?{fx:n,fy:q}:{x1:u[0],y1:u[1],x2:u[2],y2:u[3],gradientTransform:e.matrix.invert()}),p.defs.appendChild(s),p=0,u=w.length;p<u;p++)s.appendChild(t("stop",{offset:w[p].offset?w[p].offset:p?"100%":"0%","stop-color":w[p].color||"#fff"}))}t(E,{fill:"url('"+document.location+"#"+v+"')",opacity:1,"fill-opacity":1});z.fill="";z.opacity=1;return z.fillOpacity=1},E=function(a){var b=a.getBBox(1);t(a.pattern,{patternTransform:a.matrix.invert()+" translate("+b.x+","+b.y+")"})},p=function(d,
e,f){if("path"==d.type){for(var g=b(e).toLowerCase().split("-"),m=d.paper,h=f?"end":"start",k=d.node,l=d.attrs,q=l["stroke-width"],E=g.length,p="classic",z,s,u=3,w=3,A=5;E--;)switch(g[E]){case "block":case "classic":case "oval":case "diamond":case "open":case "none":p=g[E];break;case "wide":w=5;break;case "narrow":w=2;break;case "long":u=5;break;case "short":u=2}"open"==p?(u+=2,w+=2,A+=2,z=1,s=f?4:1,g={fill:"none",stroke:l.stroke}):(s=z=u/2,g={fill:l.stroke,stroke:"none"});d._.arrows?f?(d._.arrows.endPath&&
n[d._.arrows.endPath]--,d._.arrows.endMarker&&n[d._.arrows.endMarker]--):(d._.arrows.startPath&&n[d._.arrows.startPath]--,d._.arrows.startMarker&&n[d._.arrows.startMarker]--):d._.arrows={};if("none"!=p){var E="raphael-marker-"+p,L="raphael-marker-"+h+p+u+w+"-obj"+d.id;a._g.doc.getElementById(E)?n[E]++:(m.defs.appendChild(t(t("path"),{"stroke-linecap":"round",d:v[p],id:E})),n[E]=1);var F=a._g.doc.getElementById(L);F?(n[L]++,u=F.getElementsByTagName("use")[0]):(F=t(t("marker"),{id:L,markerHeight:w,
markerWidth:u,orient:"auto",refX:s,refY:w/2}),u=t(t("use"),{"xlink:href":"#"+E,transform:(f?"rotate(180 "+u/2+" "+w/2+") ":"")+"scale("+u/A+","+w/A+")","stroke-width":(1/((u/A+w/A)/2)).toFixed(4)}),F.appendChild(u),m.defs.appendChild(F),n[L]=1);t(u,g);m=z*("diamond"!=p&&"oval"!=p);f?(f=d._.arrows.startdx*q||0,q=a.getTotalLength(l.path)-m*q):(f=m*q,q=a.getTotalLength(l.path)-(d._.arrows.enddx*q||0));g={};g["marker-"+h]="url(#"+("undefined"==L?null:L)+")";if(q||f)g.d=a.getSubpath(l.path,f,q);t(k,g);
d._.arrows[h+"Path"]=E;d._.arrows[h+"Marker"]=L;d._.arrows[h+"dx"]=m;d._.arrows[h+"Type"]=p;d._.arrows[h+"String"]=e}else f?(f=d._.arrows.startdx*q||0,q=a.getTotalLength(l.path)-f):(f=0,q=a.getTotalLength(l.path)-(d._.arrows.enddx*q||0)),d._.arrows[h+"Path"]&&t(k,{d:a.getSubpath(l.path,f,q)}),delete d._.arrows[h+"Path"],delete d._.arrows[h+"Marker"],delete d._.arrows[h+"dx"],delete d._.arrows[h+"Type"],delete d._.arrows[h+"String"];for(g in n)n.hasOwnProperty(g)&&!n[g]&&(d=a._g.doc.getElementById(g))&&
d.parentNode.removeChild(d)}},z={"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},s=function(a,d,e){if(d=z[b(d).toLowerCase()]){var f=a.attrs["stroke-width"]||"1";e={round:f,square:f,butt:0}[a.attrs["stroke-linecap"]||e["stroke-linecap"]]||0;for(var g=[],m=d.length;m--;)g[m]=d[m]*f+(m%2?1:-1)*e;t(a.node,{"stroke-dasharray":g.join(",")})}else t(a.node,{"stroke-dasharray":"none"})},u=function(d,f){var h=d.node,
l=d.attrs,v=h.style.visibility;h.style.visibility="hidden";for(var n in f)if(f.hasOwnProperty(n)&&a._availableAttrs.hasOwnProperty(n)){var z=f[n];l[n]=z;switch(n){case "blur":d.blur(z);break;case "title":var u=h.getElementsByTagName("title");u.length&&(u=u[0])?u.firstChild.nodeValue=z:(u=t("title"),z=a._g.doc.createTextNode(z),u.appendChild(z),h.appendChild(u));break;case "href":case "target":u=h.parentNode;if("a"!=u.tagName.toLowerCase()){var A=t("a");u.insertBefore(A,h);A.appendChild(h);u=A}"target"==
n?u.setAttributeNS("http://www.w3.org/1999/xlink","show","blank"==z?"new":z):u.setAttributeNS("http://www.w3.org/1999/xlink",n,z);break;case "cursor":h.style.cursor=z;break;case "transform":d.transform(z);break;case "arrow-start":p(d,z);break;case "arrow-end":p(d,z,1);break;case "clip-rect":u=b(z).split(k);if(4==u.length){d.clip&&d.clip.parentNode.parentNode.removeChild(d.clip.parentNode);var A=t("clipPath"),L=t("rect");A.id=a.createUUID();t(L,{x:u[0],y:u[1],width:u[2],height:u[3]});A.appendChild(L);
d.paper.defs.appendChild(A);t(h,{"clip-path":"url(#"+A.id+")"});d.clip=L}!z&&(z=h.getAttribute("clip-path"))&&((z=a._g.doc.getElementById(z.replace(/(^url\(#|\)$)/g,"")))&&z.parentNode.removeChild(z),t(h,{"clip-path":""}),delete d.clip);break;case "path":"path"==d.type&&(t(h,{d:z?l.path=a._pathToAbsolute(z):"M0,0"}),d._.dirty=1,d._.arrows&&("startString"in d._.arrows&&p(d,d._.arrows.startString),"endString"in d._.arrows&&p(d,d._.arrows.endString,1)));break;case "width":if(h.setAttribute(n,z),d._.dirty=
1,l.fx)n="x",z=l.x;else break;case "x":l.fx&&(z=-l.x-(l.width||0));case "rx":if("rx"==n&&"rect"==d.type)break;case "cx":h.setAttribute(n,z);d.pattern&&E(d);d._.dirty=1;break;case "height":if(h.setAttribute(n,z),d._.dirty=1,l.fy)n="y",z=l.y;else break;case "y":l.fy&&(z=-l.y-(l.height||0));case "ry":if("ry"==n&&"rect"==d.type)break;case "cy":h.setAttribute(n,z);d.pattern&&E(d);d._.dirty=1;break;case "r":"rect"==d.type?t(h,{rx:z,ry:z}):h.setAttribute(n,z);d._.dirty=1;break;case "src":"image"==d.type&&
h.setAttributeNS("http://www.w3.org/1999/xlink","href",z);break;case "stroke-width":if(1!=d._.sx||1!=d._.sy)z/=g(m(d._.sx),m(d._.sy))||1;h.setAttribute(n,z);l["stroke-dasharray"]&&s(d,l["stroke-dasharray"],f);d._.arrows&&("startString"in d._.arrows&&p(d,d._.arrows.startString),"endString"in d._.arrows&&p(d,d._.arrows.endString,1));break;case "stroke-dasharray":s(d,z,f);break;case "fill":var F=b(z).match(a._ISURL);if(F){var A=t("pattern"),D=t("image");A.id=a.createUUID();t(A,{x:0,y:0,patternUnits:"userSpaceOnUse",
height:1,width:1});t(D,{x:0,y:0,"xlink:href":F[1]});A.appendChild(D);(function(b){a._preload(F[1],function(){var a=this.offsetWidth,d=this.offsetHeight;t(b,{width:a,height:d});t(D,{width:a,height:d})})})(A);d.paper.defs.appendChild(A);t(h,{fill:"url(#"+A.id+")"});d.pattern=A;d.pattern&&E(d);break}u=a.getRGB(z);if(!u.error)delete f.gradient,delete l.gradient,!a.is(l.opacity,"undefined")&&a.is(f.opacity,"undefined")&&t(h,{opacity:l.opacity}),!a.is(l["fill-opacity"],"undefined")&&a.is(f["fill-opacity"],
"undefined")&&t(h,{"fill-opacity":l["fill-opacity"]});else if(("circle"==d.type||"ellipse"==d.type||"r"!=b(z).charAt())&&q(d,z)){if("opacity"in l||"fill-opacity"in l)if(u=a._g.doc.getElementById(h.getAttribute("fill").replace(/^url\(#|\)$/g,"")))u=u.getElementsByTagName("stop"),t(u[u.length-1],{"stop-opacity":("opacity"in l?l.opacity:1)*("fill-opacity"in l?l["fill-opacity"]:1)});l.gradient=z;l.fill="none";break}u.hasOwnProperty("opacity")&&t(h,{"fill-opacity":1<u.opacity?u.opacity/100:u.opacity});
case "stroke":u=a.getRGB(z);h.setAttribute(n,u.hex);"stroke"==n&&u.hasOwnProperty("opacity")&&t(h,{"stroke-opacity":1<u.opacity?u.opacity/100:u.opacity});"stroke"==n&&d._.arrows&&("startString"in d._.arrows&&p(d,d._.arrows.startString),"endString"in d._.arrows&&p(d,d._.arrows.endString,1));break;case "gradient":"circle"!=d.type&&"ellipse"!=d.type&&"r"==b(z).charAt()||q(d,z);break;case "opacity":l.gradient&&!l.hasOwnProperty("stroke-opacity")&&t(h,{"stroke-opacity":1<z?z/100:z});case "fill-opacity":if(l.gradient){if(u=
a._g.doc.getElementById(h.getAttribute("fill").replace(/^url\(#|\)$/g,"")))u=u.getElementsByTagName("stop"),t(u[u.length-1],{"stop-opacity":z});break}default:"font-size"==n&&(z=e(z,10)+"px"),u=n.replace(/(\-.)/g,function(a){return a.substring(1).toUpperCase()}),h.style[u]=z,d._.dirty=1,h.setAttribute(n,z)}}w(d,f);h.style.visibility=v},w=function(d,f){if("text"==d.type&&(f.hasOwnProperty("text")||f.hasOwnProperty("font")||f.hasOwnProperty("font-size")||f.hasOwnProperty("x")||f.hasOwnProperty("y"))){var g=
d.attrs,m=d.node,h=m.firstChild?e(a._g.doc.defaultView.getComputedStyle(m.firstChild,"").getPropertyValue("font-size"),10):10;if(f.hasOwnProperty("text")){for(g.text=f.text;m.firstChild;)m.removeChild(m.firstChild);for(var k=b(f.text).split("\n"),l=[],n,v=0,q=k.length;v<q;v++)n=t("tspan"),v&&t(n,{dy:1.2*h,x:g.x}),n.appendChild(a._g.doc.createTextNode(k[v])),m.appendChild(n),l[v]=n}else for(l=m.getElementsByTagName("tspan"),v=0,q=l.length;v<q;v++)v?t(l[v],{dy:1.2*h,x:g.x}):t(l[0],{dy:0});t(m,{x:g.x,
y:g.y});d._.dirty=1;m=d._getBBox();(g=g.y-(m.y+m.height/2))&&a.is(g,"finite")&&t(l[0],{dy:g})}},A=function(a){return a.parentNode&&"a"===a.parentNode.tagName.toLowerCase()?a.parentNode:a},L=function(b,d){this[0]=this.node=b;b.raphael=!0;this.id=a._oid++;b.raphaelid=this.id;this.matrix=a.matrix();this.realPath=null;this.paper=d;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};!d.bottom&&(d.bottom=this);(this.prev=d.top)&&(d.top.next=this);d.top=this;this.next=null},
F=a.el;L.prototype=F;F.constructor=L;a._engine.path=function(a,b){var d=t("path");b.canvas&&b.canvas.appendChild(d);d=new L(d,b);d.type="path";u(d,{fill:"none",stroke:"#000",path:a});return d};F.rotate=function(a,e,f){if(this.removed)return this;a=b(a).split(k);a.length-1&&(e=d(a[1]),f=d(a[2]));a=d(a[0]);null==f&&(e=f);if(null==e||null==f)f=this.getBBox(1),e=f.x+f.width/2,f=f.y+f.height/2;this.transform(this._.transform.concat([["r",a,e,f]]));return this};F.scale=function(a,e,f,g){if(this.removed)return this;
a=b(a).split(k);a.length-1&&(e=d(a[1]),f=d(a[2]),g=d(a[3]));a=d(a[0]);null==e&&(e=a);null==g&&(f=g);if(null==f||null==g)var m=this.getBBox(1);f=null==f?m.x+m.width/2:f;g=null==g?m.y+m.height/2:g;this.transform(this._.transform.concat([["s",a,e,f,g]]));return this};F.translate=function(a,e){if(this.removed)return this;a=b(a).split(k);a.length-1&&(e=d(a[1]));a=d(a[0])||0;this.transform(this._.transform.concat([["t",a,+e||0]]));return this};F.transform=function(b){var d=this._;if(null==b)return d.transform;
a._extractTransform(this,b);this.clip&&t(this.clip,{transform:this.matrix.invert()});this.pattern&&E(this);this.node&&t(this.node,{transform:this.matrix});if(1!=d.sx||1!=d.sy)b=this.attrs.hasOwnProperty("stroke-width")?this.attrs["stroke-width"]:1,this.attr({"stroke-width":b});return this};F.hide=function(){this.removed||(this.node.style.display="none");return this};F.show=function(){this.removed||(this.node.style.display="");return this};F.remove=function(){var b=A(this.node);if(!this.removed&&b.parentNode){var d=
this.paper;d.__set__&&d.__set__.exclude(this);l.unbind("raphael.*.*."+this.id);this.gradient&&d.defs.removeChild(this.gradient);a._tear(this,d);b.parentNode.removeChild(b);this.removeData();for(var e in this)this[e]="function"==typeof this[e]?a._removedFactory(e):null;this.removed=!0}};F._getBBox=function(){if("none"==this.node.style.display){this.show();var a=!0}var b=!1,d;this.paper.canvas.parentElement?d=this.paper.canvas.parentElement.style:this.paper.canvas.parentNode&&(d=this.paper.canvas.parentNode.style);
d&&"none"==d.display&&(b=!0,d.display="");var e={};try{e=this.node.getBBox()}catch(f){e={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}finally{e=e||{},b&&(d.display="none")}a&&this.hide();return e};F.attr=function(b,d){if(this.removed)return this;if(null==b){var e={},f;for(f in this.attrs)this.attrs.hasOwnProperty(f)&&(e[f]=this.attrs[f]);e.gradient&&"none"==e.fill&&(e.fill=e.gradient)&&delete e.gradient;e.transform=this._.transform;return e}if(null==
d&&a.is(b,"string")){if("fill"==b&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==b)return this._.transform;f=b.split(k);for(var e={},g=0,m=f.length;g<m;g++)b=f[g],b in this.attrs?e[b]=this.attrs[b]:a.is(this.paper.customAttributes[b],"function")?e[b]=this.paper.customAttributes[b].def:e[b]=a._availableAttrs[b];return m-1?e:e[f[0]]}if(null==d&&a.is(b,"array")){e={};g=0;for(m=b.length;g<m;g++)e[b[g]]=this.attr(b[g]);return e}null!=d?(e={},e[b]=d):null!=b&&a.is(b,
"object")&&(e=b);for(g in e)l("raphael.attr."+g+"."+this.id,this,e[g]);for(g in this.paper.customAttributes)if(this.paper.customAttributes.hasOwnProperty(g)&&e.hasOwnProperty(g)&&a.is(this.paper.customAttributes[g],"function"))for(m in f=this.paper.customAttributes[g].apply(this,[].concat(e[g])),this.attrs[g]=e[g],f)f.hasOwnProperty(m)&&(e[m]=f[m]);u(this,e);return this};F.toFront=function(){if(this.removed)return this;var b=A(this.node);b.parentNode.appendChild(b);b=this.paper;b.top!=this&&a._tofront(this,
b);return this};F.toBack=function(){if(this.removed)return this;var b=A(this.node),d=b.parentNode;d.insertBefore(b,d.firstChild);a._toback(this,this.paper);return this};F.insertAfter=function(b){if(this.removed||!b)return this;var d=A(this.node),e=A(b.node||b[b.length-1].node);e.nextSibling?e.parentNode.insertBefore(d,e.nextSibling):e.parentNode.appendChild(d);a._insertafter(this,b,this.paper);return this};F.insertBefore=function(b){if(this.removed||!b)return this;var d=A(this.node),e=A(b.node||b[0].node);
e.parentNode.insertBefore(d,e);a._insertbefore(this,b,this.paper);return this};F.blur=function(b){if(0!==+b){var d=t("filter"),e=t("feGaussianBlur");this.attrs.blur=b;d.id=a.createUUID();t(e,{stdDeviation:+b||1.5});d.appendChild(e);this.paper.defs.appendChild(d);this._blur=d;t(this.node,{filter:"url(#"+d.id+")"})}else this._blur&&(this._blur.parentNode.removeChild(this._blur),delete this._blur,delete this.attrs.blur),this.node.removeAttribute("filter");return this};a._engine.circle=function(a,b,d,
e){var f=t("circle");a.canvas&&a.canvas.appendChild(f);a=new L(f,a);a.attrs={cx:b,cy:d,r:e,fill:"none",stroke:"#000"};a.type="circle";t(f,a.attrs);return a};a._engine.rect=function(a,b,d,e,f,g){var m=t("rect");a.canvas&&a.canvas.appendChild(m);a=new L(m,a);a.attrs={x:b,y:d,width:e,height:f,rx:g||0,ry:g||0,fill:"none",stroke:"#000"};a.type="rect";t(m,a.attrs);return a};a._engine.ellipse=function(a,b,d,e,f){var g=t("ellipse");a.canvas&&a.canvas.appendChild(g);a=new L(g,a);a.attrs={cx:b,cy:d,rx:e,ry:f,
fill:"none",stroke:"#000"};a.type="ellipse";t(g,a.attrs);return a};a._engine.image=function(a,b,d,e,f,g){var m=t("image");t(m,{x:d,y:e,width:f,height:g,preserveAspectRatio:"none"});m.setAttributeNS("http://www.w3.org/1999/xlink","href",b);a.canvas&&a.canvas.appendChild(m);a=new L(m,a);a.attrs={x:d,y:e,width:f,height:g,src:b};a.type="image";return a};a._engine.text=function(b,d,e,f){var g=t("text");b.canvas&&b.canvas.appendChild(g);b=new L(g,b);b.attrs={x:d,y:e,"text-anchor":"middle",text:f,"font-family":a._availableAttrs["font-family"],
"font-size":a._availableAttrs["font-size"],stroke:"none",fill:"#000"};b.type="text";u(b,b.attrs);return b};a._engine.setSize=function(a,b){this.width=a||this.width;this.height=b||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);this._viewBox&&this.setViewBox.apply(this,this._viewBox);return this};a._engine.create=function(){var b=a._getContainer.apply(0,arguments),d=b&&b.container,e=b.x,f=b.y,g=b.width,b=b.height;if(!d)throw Error("SVG container not found.");
var m=t("svg"),h,e=e||0,f=f||0,g=g||512,b=b||342;t(m,{height:b,version:1.1,width:g,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"});1==d?(m.style.cssText="overflow:hidden;position:absolute;left:"+e+"px;top:"+f+"px",a._g.doc.body.appendChild(m),h=1):(m.style.cssText="overflow:hidden;position:relative",d.firstChild?d.insertBefore(m,d.firstChild):d.appendChild(m));d=new a._Paper;d.width=g;d.height=b;d.canvas=m;d.clear();d._left=d._top=0;h&&(d.renderfix=function(){});
d.renderfix();return d};a._engine.setViewBox=function(a,b,d,e,f){l("raphael.setViewBox",this,this._viewBox,[a,b,d,e,f]);var m=this.getSize(),m=g(d/m.width,e/m.height),h=this.top,k=f?"xMidYMid meet":"xMinYMin",n;null==a?(this._vbSize&&(m=1),delete this._vbSize,n="0 0 "+this.width+" "+this.height):(this._vbSize=m,n=a+" "+b+" "+d+" "+e);for(t(this.canvas,{viewBox:n,preserveAspectRatio:k});m&&h;)k="stroke-width"in h.attrs?h.attrs["stroke-width"]:1,h.attr({"stroke-width":k}),h._.dirty=1,h._.dirtyT=1,h=
h.prev;this._viewBox=[a,b,d,e,!!f];return this};a.prototype.renderfix=function(){var a=this.canvas,b=a.style,d;try{d=a.getScreenCTM()||a.createSVGMatrix()}catch(e){d=a.createSVGMatrix()}a=-d.e%1;d=-d.f%1;if(a||d)a&&(this._left=(this._left+a)%1,b.left=this._left+"px"),d&&(this._top=(this._top+d)%1,b.top=this._top+"px")};a.prototype.clear=function(){a.eve("raphael.clear",this);for(var b=this.canvas;b.firstChild;)b.removeChild(b.firstChild);this.bottom=this.top=null;(this.desc=t("desc")).appendChild(a._g.doc.createTextNode("Created with Rapha\u00ebl "+
a.version));b.appendChild(this.desc);b.appendChild(this.defs=t("defs"))};a.prototype.remove=function(){l("raphael.remove",this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var b in this)this[b]="function"==typeof this[b]?a._removedFactory(b):null};var D=a.st,B;for(B in F)F.hasOwnProperty(B)&&!D.hasOwnProperty(B)&&(D[B]=function(a){return function(){var b=arguments;return this.forEach(function(d){d[a].apply(d,b)})}}(B))}})();(function(){if(a.vml){var b=String,d=parseFloat,
e=Math,f=e.round,g=e.max,m=e.min,h=e.abs,k=/[, ]+/,l=a.eve,n={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},v=/([clmz]),?([^clmz]*)/gi,t=/ progid:\S+Blur\([^\)]+\)/g,q=/-?[^,\s-]+/g,E={path:1,rect:1,image:1},p={circle:1,ellipse:1},z=function(d){var e=/[ahqstv]/ig,g=a._pathToAbsolute;b(d).match(e)&&(g=a._path2curve);e=/[clmz]/g;if(g==a._pathToAbsolute&&!b(d).match(e))return d=b(d).replace(v,function(a,b,d){var e=[],g="m"==b.toLowerCase(),m=n[b];d.replace(q,function(a){g&&2==e.length&&(m+=e+n["m"==
b?"l":"L"],e=[]);e.push(f(21600*a))});return m+e});var e=g(d),m;d=[];for(var h=0,k=e.length;h<k;h++){g=e[h];m=e[h][0].toLowerCase();"z"==m&&(m="x");for(var l=1,t=g.length;l<t;l++)m+=f(21600*g[l])+(l!=t-1?",":"");d.push(m)}return d.join(" ")},s=function(b,d,e){var f=a.matrix();f.rotate(-b,0.5,0.5);return{dx:f.x(d,e),dy:f.y(d,e)}},u=function(a,b,d,e,f,g){var m=a._,k=a.matrix,l=m.fillpos;a=a.node;var n=a.style,v=1,t="",q=21600/b,E=21600/d;n.visibility="hidden";if(b&&d){a.coordsize=h(q)+" "+h(E);n.rotation=
g*(0>b*d?-1:1);g&&(f=s(g,e,f),e=f.dx,f=f.dy);0>b&&(t+="x");0>d&&(t+=" y")&&(v=-1);n.flip=t;a.coordorigin=e*-q+" "+f*-E;if(l||m.fillsize)e=(e=a.getElementsByTagName("fill"))&&e[0],a.removeChild(e),l&&(f=s(g,k.x(l[0],l[1]),k.y(l[0],l[1])),e.position=f.dx*v+" "+f.dy*v),m.fillsize&&(e.size=m.fillsize[0]*h(b)+" "+m.fillsize[1]*h(d)),a.appendChild(e);n.visibility="visible"}};a.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};
var A=function(a,d,e){d=b(d).toLowerCase().split("-");e=e?"end":"start";for(var f=d.length,g="classic",m="medium",h="medium";f--;)switch(d[f]){case "block":case "classic":case "oval":case "diamond":case "open":case "none":g=d[f];break;case "wide":case "narrow":h=d[f];break;case "long":case "short":m=d[f]}a=a.node.getElementsByTagName("stroke")[0];a[e+"arrow"]=g;a[e+"arrowlength"]=m;a[e+"arrowwidth"]=h},w=function(e,h){e.attrs=e.attrs||{};var l=e.node,n=e.attrs,v=l.style,t=E[e.type]&&(h.x!=n.x||h.y!=
n.y||h.width!=n.width||h.height!=n.height||h.cx!=n.cx||h.cy!=n.cy||h.rx!=n.rx||h.ry!=n.ry||h.r!=n.r),q=p[e.type]&&(n.cx!=h.cx||n.cy!=h.cy||n.r!=h.r||n.rx!=h.rx||n.ry!=h.ry),s;for(s in h)h.hasOwnProperty(s)&&(n[s]=h[s]);t&&(n.path=a._getPath[e.type](e),e._.dirty=1);h.href&&(l.href=h.href);h.title&&(l.title=h.title);h.target&&(l.target=h.target);h.cursor&&(v.cursor=h.cursor);"blur"in h&&e.blur(h.blur);if(h.path&&"path"==e.type||t)l.path=z(~b(n.path).toLowerCase().indexOf("r")?a._pathToAbsolute(n.path):
n.path),e._.dirty=1,"image"==e.type&&(e._.fillpos=[n.x,n.y],e._.fillsize=[n.width,n.height],u(e,1,1,0,0,0));"transform"in h&&e.transform(h.transform);q&&(v=+n.cx,t=+n.cy,q=+n.rx||+n.r||0,s=+n.ry||+n.r||0,l.path=a.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",f(21600*(v-q)),f(21600*(t-s)),f(21600*(v+q)),f(21600*(t+s)),f(21600*v)),e._.dirty=1);"clip-rect"in h&&(v=b(h["clip-rect"]).split(k),4==v.length&&(v[2]=+v[2]+ +v[0],v[3]=+v[3]+ +v[1],t=l.clipRect||a._g.doc.createElement("div"),q=t.style,q.clip=a.format("rect({1}px {2}px {3}px {0}px)",
v),l.clipRect||(q.position="absolute",q.top=0,q.left=0,q.width=e.paper.width+"px",q.height=e.paper.height+"px",l.parentNode.insertBefore(t,l),t.appendChild(l),l.clipRect=t)),h["clip-rect"]||l.clipRect&&(l.clipRect.style.clip="auto"));e.textpath&&(v=e.textpath.style,h.font&&(v.font=h.font),h["font-family"]&&(v.fontFamily='"'+h["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"'),h["font-size"]&&(v.fontSize=h["font-size"]),h["font-weight"]&&(v.fontWeight=h["font-weight"]),h["font-style"]&&
(v.fontStyle=h["font-style"]));"arrow-start"in h&&A(e,h["arrow-start"]);"arrow-end"in h&&A(e,h["arrow-end"],1);if(null!=h.opacity||null!=h["stroke-width"]||null!=h.fill||null!=h.src||null!=h.stroke||null!=h["stroke-width"]||null!=h["stroke-opacity"]||null!=h["fill-opacity"]||null!=h["stroke-dasharray"]||null!=h["stroke-miterlimit"]||null!=h["stroke-linejoin"]||null!=h["stroke-linecap"]){v=(v=l.getElementsByTagName("fill"))&&v[0];!v&&(v=B("fill"));"image"==e.type&&h.src&&(v.src=h.src);h.fill&&(v.on=
!0);if(null==v.on||"none"==h.fill||null===h.fill)v.on=!1;v.on&&h.fill&&((t=b(h.fill).match(a._ISURL))?(v.parentNode==l&&l.removeChild(v),v.rotate=!0,v.src=t[1],v.type="tile",q=e.getBBox(1),v.position=q.x+" "+q.y,e._.fillpos=[q.x,q.y],a._preload(t[1],function(){e._.fillsize=[this.offsetWidth,this.offsetHeight]})):(v.color=a.getRGB(h.fill).hex,v.src="",v.type="solid",a.getRGB(h.fill).error&&(e.type in{circle:1,ellipse:1}||"r"!=b(h.fill).charAt())&&L(e,h.fill,v)&&(n.fill="none",n.gradient=h.fill,v.rotate=
!1)));if("fill-opacity"in h||"opacity"in h)q=((+n["fill-opacity"]+1||2)-1)*((+n.opacity+1||2)-1)*((+a.getRGB(h.fill).o+1||2)-1),q=m(g(q,0),1),v.opacity=q,v.src&&(v.color="none");l.appendChild(v);v=l.getElementsByTagName("stroke")&&l.getElementsByTagName("stroke")[0];t=!1;!v&&(t=v=B("stroke"));if(h.stroke&&"none"!=h.stroke||h["stroke-width"]||null!=h["stroke-opacity"]||h["stroke-dasharray"]||h["stroke-miterlimit"]||h["stroke-linejoin"]||h["stroke-linecap"])v.on=!0;"none"!=h.stroke&&null!==h.stroke&&
null!=v.on&&0!=h.stroke&&0!=h["stroke-width"]||(v.on=!1);q=a.getRGB(h.stroke);v.on&&h.stroke&&(v.color=q.hex);q=((+n["stroke-opacity"]+1||2)-1)*((+n.opacity+1||2)-1)*((+q.o+1||2)-1);s=0.75*(d(h["stroke-width"])||1);q=m(g(q,0),1);null==h["stroke-width"]&&(s=n["stroke-width"]);h["stroke-width"]&&(v.weight=s);s&&1>s&&(q*=s)&&(v.weight=1);v.opacity=q;h["stroke-linejoin"]&&(v.joinstyle=h["stroke-linejoin"]||"miter");v.miterlimit=h["stroke-miterlimit"]||8;h["stroke-linecap"]&&(v.endcap="butt"==h["stroke-linecap"]?
"flat":"square"==h["stroke-linecap"]?"square":"round");"stroke-dasharray"in h&&(q={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},v.dashstyle=q.hasOwnProperty(h["stroke-dasharray"])?q[h["stroke-dasharray"]]:"");t&&l.appendChild(v)}if("text"==e.type){e.paper.canvas.style.display="";l=e.paper.span;t=n.font&&n.font.match(/\d+(?:\.\d*)?(?=px)/);v=l.style;n.font&&(v.font=n.font);
n["font-family"]&&(v.fontFamily=n["font-family"]);n["font-weight"]&&(v.fontWeight=n["font-weight"]);n["font-style"]&&(v.fontStyle=n["font-style"]);t=d(n["font-size"]||t&&t[0])||10;v.fontSize=100*t+"px";e.textpath.string&&(l.innerHTML=b(e.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));l=l.getBoundingClientRect();e.W=n.w=(l.right-l.left)/100;e.H=n.h=(l.bottom-l.top)/100;e.X=n.x;e.Y=n.y+e.H/2;("x"in h||"y"in h)&&(e.path.v=a.format("m{0},{1}l{2},{1}",f(21600*n.x),
f(21600*n.y),f(21600*n.x)+1));l="x y text font font-family font-weight font-style font-size".split(" ");v=0;for(t=l.length;v<t;v++)if(l[v]in h){e._.dirty=1;break}switch(n["text-anchor"]){case "start":e.textpath.style["v-text-align"]="left";e.bbx=e.W/2;break;case "end":e.textpath.style["v-text-align"]="right";e.bbx=-e.W/2;break;default:e.textpath.style["v-text-align"]="center",e.bbx=0}e.textpath.style["v-text-kern"]=!0}},L=function(f,g,h){f.attrs=f.attrs||{};var m=Math.pow,k="linear",l=".5 .5";f.attrs.gradient=
g;g=b(g).replace(a._radial_gradient,function(a,b,f){k="radial";b&&f&&(b=d(b),f=d(f),0.25<m(b-0.5,2)+m(f-0.5,2)&&(f=e.sqrt(0.25-m(b-0.5,2))*(2*(0.5<f)-1)+0.5),l=b+" "+f);return""});g=g.split(/\s*\-\s*/);if("linear"==k){var v=g.shift(),v=-d(v);if(isNaN(v))return null}g=a._parseDots(g);if(!g)return null;f=f.shape||f.node;if(g.length){f.removeChild(h);h.on=!0;h.method="none";h.color=g[0].color;h.color2=g[g.length-1].color;for(var n=[],t=0,q=g.length;t<q;t++)g[t].offset&&n.push(g[t].offset+" "+g[t].color);
h.colors=n.length?n.join():"0% "+h.color;"radial"==k?(h.type="gradientTitle",h.focus="100%",h.focussize="0 0",h.focusposition=l,h.angle=0):(h.type="gradient",h.angle=(270-v)%360);f.appendChild(h)}return 1},F=function(b,d){this[0]=this.node=b;b.raphael=!0;this.id=a._oid++;b.raphaelid=this.id;this.Y=this.X=0;this.attrs={};this.paper=d;this.matrix=a.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};!d.bottom&&(d.bottom=this);(this.prev=d.top)&&(d.top.next=this);d.top=this;this.next=
null},D=a.el;F.prototype=D;D.constructor=F;D.transform=function(d){if(null==d)return this._.transform;var e=this.paper._viewBoxShift,f=e?"s"+[e.scale,e.scale]+"-1-1t"+[e.dx,e.dy]:"",g;e&&(g=d=b(d).replace(/\.{3}|\u2026/g,this._.transform||""));a._extractTransform(this,f+d);var e=this.matrix.clone(),h=this.skew;d=this.node;var f=~b(this.attrs.fill).indexOf("-"),m=!b(this.attrs.fill).indexOf("url(");e.translate(1,1);m||f||"image"==this.type?(h.matrix="1 0 0 1",h.offset="0 0",h=e.split(),f&&h.noRotation||
!h.isSimple?(d.style.filter=e.toFilter(),f=this.getBBox(),h=this.getBBox(1),e=f.x-h.x,f=f.y-h.y,d.coordorigin=-21600*e+" "+-21600*f,u(this,1,1,e,f,0)):(d.style.filter="",u(this,h.scalex,h.scaley,h.dx,h.dy,h.rotate))):(d.style.filter="",h.matrix=b(e),h.offset=e.offset());null!==g&&(this._.transform=g,a._extractTransform(this,g));return this};D.rotate=function(a,e,f){if(this.removed)return this;if(null!=a){a=b(a).split(k);a.length-1&&(e=d(a[1]),f=d(a[2]));a=d(a[0]);null==f&&(e=f);if(null==e||null==
f)f=this.getBBox(1),e=f.x+f.width/2,f=f.y+f.height/2;this._.dirtyT=1;this.transform(this._.transform.concat([["r",a,e,f]]));return this}};D.translate=function(a,e){if(this.removed)return this;a=b(a).split(k);a.length-1&&(e=d(a[1]));a=d(a[0])||0;e=+e||0;this._.bbox&&(this._.bbox.x+=a,this._.bbox.y+=e);this.transform(this._.transform.concat([["t",a,e]]));return this};D.scale=function(a,e,f,g){if(this.removed)return this;a=b(a).split(k);a.length-1&&(e=d(a[1]),f=d(a[2]),g=d(a[3]),isNaN(f)&&(f=null),isNaN(g)&&
(g=null));a=d(a[0]);null==e&&(e=a);null==g&&(f=g);if(null==f||null==g)var h=this.getBBox(1);f=null==f?h.x+h.width/2:f;g=null==g?h.y+h.height/2:g;this.transform(this._.transform.concat([["s",a,e,f,g]]));this._.dirtyT=1;return this};D.hide=function(){!this.removed&&(this.node.style.display="none");return this};D.show=function(){!this.removed&&(this.node.style.display="");return this};D.auxGetBBox=a.el.getBBox;D.getBBox=function(){var a=this.auxGetBBox();if(this.paper&&this.paper._viewBoxShift){var b=
{},d=1/this.paper._viewBoxShift.scale;b.x=a.x-this.paper._viewBoxShift.dx;b.x*=d;b.y=a.y-this.paper._viewBoxShift.dy;b.y*=d;b.width=a.width*d;b.height=a.height*d;b.x2=b.x+b.width;b.y2=b.y+b.height;return b}return a};D._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};D.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this);a.eve.unbind("raphael.*.*."+this.id);a._tear(this,
this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var b in this)this[b]="function"==typeof this[b]?a._removedFactory(b):null;this.removed=!0}};D.attr=function(b,d){if(this.removed)return this;if(null==b){var e={},f;for(f in this.attrs)this.attrs.hasOwnProperty(f)&&(e[f]=this.attrs[f]);e.gradient&&"none"==e.fill&&(e.fill=e.gradient)&&delete e.gradient;e.transform=this._.transform;return e}if(null==d&&a.is(b,"string")){if("fill"==b&&
"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;f=b.split(k);for(var e={},g=0,h=f.length;g<h;g++)b=f[g],b in this.attrs?e[b]=this.attrs[b]:a.is(this.paper.customAttributes[b],"function")?e[b]=this.paper.customAttributes[b].def:e[b]=a._availableAttrs[b];return h-1?e:e[f[0]]}if(this.attrs&&null==d&&a.is(b,"array")){e={};g=0;for(h=b.length;g<h;g++)e[b[g]]=this.attr(b[g]);return e}null!=d&&(e={},e[b]=d);null==d&&a.is(b,"object")&&(e=b);for(g in e)l("raphael.attr."+g+"."+this.id,
this,e[g]);if(e){for(g in this.paper.customAttributes)if(this.paper.customAttributes.hasOwnProperty(g)&&e.hasOwnProperty(g)&&a.is(this.paper.customAttributes[g],"function"))for(h in f=this.paper.customAttributes[g].apply(this,[].concat(e[g])),this.attrs[g]=e[g],f)f.hasOwnProperty(h)&&(e[h]=f[h]);e.text&&"text"==this.type&&(this.textpath.string=e.text);w(this,e)}return this};D.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node);this.paper&&this.paper.top!=this&&a._tofront(this,
this.paper);return this};D.toBack=function(){if(this.removed)return this;this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),a._toback(this,this.paper));return this};D.insertAfter=function(b){if(this.removed)return this;b.constructor==a.st.constructor&&(b=b[b.length-1]);b.node.nextSibling?b.node.parentNode.insertBefore(this.node,b.node.nextSibling):b.node.parentNode.appendChild(this.node);a._insertafter(this,b,this.paper);return this};
D.insertBefore=function(b){if(this.removed)return this;b.constructor==a.st.constructor&&(b=b[0]);b.node.parentNode.insertBefore(this.node,b.node);a._insertbefore(this,b,this.paper);return this};D.blur=function(b){var d=this.node.runtimeStyle,e=d.filter,e=e.replace(t,"");0!==+b?(this.attrs.blur=b,d.filter=e+"  progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+b||1.5)+")",d.margin=a.format("-{0}px 0 0 -{0}px",f(+b||1.5))):(d.filter=e,d.margin=0,delete this.attrs.blur);return this};a._engine.path=
function(a,b){var d=B("shape");d.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)";d.coordsize="21600 21600";d.coordorigin=b.coordorigin;var e=new F(d,b),f={fill:"none",stroke:"#000"};a&&(f.path=a);e.type="path";e.path=[];e.Path="";w(e,f);b.canvas.appendChild(d);f=B("skew");f.on=!0;d.appendChild(f);e.skew=f;e.transform("");return e};a._engine.rect=function(b,d,e,f,g,h){var m=a._rectPath(d,e,f,g,h);b=b.path(m);var k=b.attrs;b.X=k.x=d;b.Y=k.y=e;b.W=k.width=
f;b.H=k.height=g;k.r=h;k.path=m;b.type="rect";return b};a._engine.ellipse=function(a,b,d,e,f){a=a.path();a.X=b-e;a.Y=d-f;a.W=2*e;a.H=2*f;a.type="ellipse";w(a,{cx:b,cy:d,rx:e,ry:f});return a};a._engine.circle=function(a,b,d,e){a=a.path();a.X=b-e;a.Y=d-e;a.W=a.H=2*e;a.type="circle";w(a,{cx:b,cy:d,r:e});return a};a._engine.image=function(b,d,e,f,g,h){var m=a._rectPath(e,f,g,h);b=b.path(m).attr({stroke:"none"});var k=b.attrs,l=b.node,v=l.getElementsByTagName("fill")[0];k.src=d;b.X=k.x=e;b.Y=k.y=f;b.W=
k.width=g;b.H=k.height=h;k.path=m;b.type="image";v.parentNode==l&&l.removeChild(v);v.rotate=!0;v.src=d;v.type="tile";b._.fillpos=[e,f];b._.fillsize=[g,h];l.appendChild(v);u(b,1,1,0,0,0);return b};a._engine.text=function(d,e,g,h){var m=B("shape"),k=B("path"),l=B("textpath");e=e||0;g=g||0;h=h||"";k.v=a.format("m{0},{1}l{2},{1}",f(21600*e),f(21600*g),f(21600*e)+1);k.textpathok=!0;l.string=b(h);l.on=!0;m.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)";m.coordsize=
"21600 21600";m.coordorigin="0 0";var v=new F(m,d),n={fill:"#000",stroke:"none",font:a._availableAttrs.font,text:h};v.shape=m;v.path=k;v.textpath=l;v.type="text";v.attrs.text=b(h);v.attrs.x=e;v.attrs.y=g;v.attrs.w=1;v.attrs.h=1;w(v,n);m.appendChild(l);m.appendChild(k);d.canvas.appendChild(m);d=B("skew");d.on=!0;m.appendChild(d);v.skew=d;v.transform("");return v};a._engine.setSize=function(b,d){var e=this.canvas.style;this.width=b;this.height=d;b==+b&&(b+="px");d==+d&&(d+="px");e.width=b;e.height=
d;e.clip="rect(0 "+b+" "+d+" 0)";this._viewBox&&a._engine.setViewBox.apply(this,this._viewBox);return this};a._engine.setViewBox=function(b,d,e,f,g){a.eve("raphael.setViewBox",this,this._viewBox,[b,d,e,f,g]);var h=this.getSize(),m=h.width,k=h.height,l,v;g&&(l=k/f,v=m/e,e*l<m&&(b-=(m-e*l)/2/l),f*v<k&&(d-=(k-f*v)/2/v));this._viewBox=[b,d,e,f,!!g];this._viewBoxShift={dx:-b,dy:-d,scale:h};this.forEach(function(a){a.transform("...")});return this};var B;a._engine.initWin=function(a){var b=a.document;31>
b.styleSheets.length?b.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):b.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");try{!b.namespaces.rvml&&b.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),B=function(a){return b.createElement("<rvml:"+a+' class="rvml">')}}catch(d){B=function(a){return b.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};a._engine.initWin(a._g.win);a._engine.create=function(){var b=a._getContainer.apply(0,arguments),
d=b.container,e=b.height,f=b.width,g=b.x,b=b.y;if(!d)throw Error("VML container not found.");var h=new a._Paper,m=h.canvas=a._g.doc.createElement("div"),k=m.style,g=g||0,b=b||0,f=f||512,e=e||342;h.width=f;h.height=e;f==+f&&(f+="px");e==+e&&(e+="px");h.coordsize="21600000 21600000";h.coordorigin="0 0";h.span=a._g.doc.createElement("span");h.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";m.appendChild(h.span);k.cssText=a.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",
f,e);1==d?(a._g.doc.body.appendChild(m),k.left=g+"px",k.top=b+"px",k.position="absolute"):d.firstChild?d.insertBefore(m,d.firstChild):d.appendChild(m);h.renderfix=function(){};return h};a.prototype.clear=function(){a.eve("raphael.clear",this);this.canvas.innerHTML="";this.span=a._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};a.prototype.remove=
function(){a.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);for(var b in this)this[b]="function"==typeof this[b]?a._removedFactory(b):null;return!0};var G=a.st,P;for(P in D)D.hasOwnProperty(P)&&!G.hasOwnProperty(P)&&(G[P]=function(a){return function(){var b=arguments;return this.forEach(function(d){d[a].apply(d,b)})}}(P))}})();D?G.win.Raphael=a:Raphael=a;"object"==typeof exports&&(module.exports=a);return a});var TGOS=TGOS||{};TGOS.MVCObject=function(){this.binds_=[];this.events_=[]};TGOS.MVCObject.prototype.addListener=function(b,d){};TGOS.MVCObject.prototype.bindTo=function(b,d,a,f){f={key:b,target:d,targetKey:a?a:b,noNotify:f?!0:!1,eventName:b+"_changed"};this.binds_.push(f);this[b]!==f.target[f.targetKey]&&(f.target[f.targetKey]=this[b],this.notify_(d,a))};TGOS.MVCObject.prototype.changed=function(b){};TGOS.MVCObject.prototype.get=function(b){return this[b]};
TGOS.MVCObject.prototype.notifyAll=function(b){this.notify_(this,b);for(var d=0;d<this.binds_.length;d++)this.binds_[d].key===b&&this.notify_(this.binds_[d].target,this.binds_[d].targetKey)};TGOS.MVCObject.prototype.notify_=function(b,d){if("function"==typeof b[d+"_changed"])b[d+"_changed"]();"function"==typeof b.changed&&b.changed(d)};
TGOS.MVCObject.prototype.set=function(b,d){if(this[b]!==d){this[b]=d;for(var a=0;a<this.binds_.length;a++){var f=this.binds_[a],e=f.target,g=f.targetKey,f=f.noNotify;g==b&&(e[b]=d);f||this.notify_(e,g)}this.notify_(this,b)}};TGOS.MVCObject.prototype.setValues=function(b){for(var d in b)this.set(d,b[d])};TGOS.MVCObject.prototype.unbind=function(b){for(var d=this.binds_[d].length;d--;)this.binds_[d].key===b&&this.binds_.splice(d,1)};TGOS.MVCObject.prototype.unbindAll=function(){this.binds_=[]};TGOS.fx=TGOS.fx||function(){var b={},d=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=d;var a=window.cancelAnimationFrame||window.mozCancelAnimationFrame;window.cancelAnimationFrame=a;b.easing={linear:function(a){return a},quadIn:function(a){return a*a},quadOut:function(a){return a*(2-a)},quadInOut:function(a){return 0.5>a?2*a*a:-1+(4-2*a)*a},cubicIn:function(a){return a*a*a},cubicOut:function(a){return--a*
a*a+1},cubicInOut:function(a){return 0.5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},quartIn:function(a){return a*a*a*a},quartOut:function(a){return 1- --a*a*a*a},quartInOut:function(a){return 0.5>a?8*a*a*a*a:1-8*--a*a*a*a},quintIn:function(a){return a*a*a*a*a},quintOut:function(a){return 1+--a*a*a*a*a},quintInOut:function(a){return 0.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a}};b.createAnimation=function(f){var e=f.easing?f.easing:b.easing.linear,g="number"==typeof f.duration?f.duration:350,h="function"==typeof f.onAnimation?
f.onAnimation:null,k="function"==typeof f.onEnd?f.onEnd:null,l="function"==typeof f.onStart?f.onStart:null,p=f.type?f.type:"setTimeout",m="boolean"==typeof f.repeat?f.repeat:!1,n=f.rate?f.rate:20,u=f.delay?f.delay:0,s,q=null,w,C=!1,B=function(a){if(!C){null===q&&(l&&l.call(this),q="setTimeout"==p?new Date:a);w="setTimeout"==p?new Date:a;var b="setTimeout"==p?Math.abs(w.getTime()-q.getTime()):Math.abs(a-q);percent=e(b/g);h&&h.call(this,percent);1>percent&&b<g?s="setTimeout"==p?setTimeout(B,n):d(B):
m?(percent%=1,q="setTimeout"==p?new Date:a,s="setTimeout"==p?setTimeout(B,n):d(B)):k&&k.call(this)}};return{play:function(){q=null;"setTimeout"!=p&&d?u?setTimeout(function(){d(B)},u):d(B):u?setTimeout(B,u):B()},stop:function(){C=!0;s&&("setTimeout"==p?clearTimeout(s):a(s))}}};return b}();/*

  proj4js.js -- Javascript reprojection library. 

  Authors:      Mike Adair madairATdmsolutions.ca
                Richard Greenwood richATgreenwoodmap.com
                Didier Richard didier.richardATign.fr
                Stephen Irons stephen.ironsATclear.net.nz
                Olivier Terral oterralATgmail.com

  License:      
 Copyright (c) 2012, Mike Adair, Richard Greenwood, Didier Richard, 
                     Stephen Irons and Olivier Terral

 Permission is hereby granted, free of charge, to any person obtaining a
 copy of this software and associated documentation files (the "Software"),
 to deal in the Software without restriction, including without limitation
 the rights to use, copy, modify, merge, publish, distribute, sublicense,
 and/or sell copies of the Software, and to permit persons to whom the
 Software is furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included
 in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
 OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 DEALINGS IN THE SOFTWARE.

 Note: This program is an almost direct port of the C library PROJ.4.
*/
var Proj4js={defaultDatum:"WGS84",transform:function(b,d,a){if(!b.readyToUse)return this.reportError("Proj4js initialization for:"+b.srsCode+" not yet complete"),a;if(!d.readyToUse)return this.reportError("Proj4js initialization for:"+d.srsCode+" not yet complete"),a;if(b.datum&&d.datum&&((b.datum.datum_type==Proj4js.common.PJD_3PARAM||b.datum.datum_type==Proj4js.common.PJD_7PARAM)&&"WGS84"!=d.datumCode||(d.datum.datum_type==Proj4js.common.PJD_3PARAM||d.datum.datum_type==Proj4js.common.PJD_7PARAM)&&
"WGS84"!=b.datumCode)){var f=Proj4js.WGS84;this.transform(b,f,a);b=f}"enu"!=b.axis&&this.adjust_axis(b,!1,a);"longlat"==b.projName?(a.x*=Proj4js.common.D2R,a.y*=Proj4js.common.D2R):(b.to_meter&&(a.x*=b.to_meter,a.y*=b.to_meter),b.inverse(a));b.from_greenwich&&(a.x+=b.from_greenwich);a=this.datum_transform(b.datum,d.datum,a);d.from_greenwich&&(a.x-=d.from_greenwich);"longlat"==d.projName?(a.x*=Proj4js.common.R2D,a.y*=Proj4js.common.R2D):(d.forward(a),d.to_meter&&(a.x/=d.to_meter,a.y/=d.to_meter));
"enu"!=d.axis&&this.adjust_axis(d,!0,a);return a},datum_transform:function(b,d,a){if(b.compare_datums(d)||b.datum_type==Proj4js.common.PJD_NODATUM||d.datum_type==Proj4js.common.PJD_NODATUM)return a;if(b.es!=d.es||b.a!=d.a||b.datum_type==Proj4js.common.PJD_3PARAM||b.datum_type==Proj4js.common.PJD_7PARAM||d.datum_type==Proj4js.common.PJD_3PARAM||d.datum_type==Proj4js.common.PJD_7PARAM)b.geodetic_to_geocentric(a),b.datum_type!=Proj4js.common.PJD_3PARAM&&b.datum_type!=Proj4js.common.PJD_7PARAM||b.geocentric_to_wgs84(a),
d.datum_type!=Proj4js.common.PJD_3PARAM&&d.datum_type!=Proj4js.common.PJD_7PARAM||d.geocentric_from_wgs84(a),d.geocentric_to_geodetic(a);return a},adjust_axis:function(b,d,a){for(var f=a.x,e=a.y,g=a.z||0,h,k,l=0;3>l;l++)if(!d||2!=l||void 0!==a.z)switch(0==l?(h=f,k="x"):1==l?(h=e,k="y"):(h=g,k="z"),b.axis[l]){case "e":a[k]=h;break;case "w":a[k]=-h;break;case "n":a[k]=h;break;case "s":a[k]=-h;break;case "u":void 0!==a[k]&&(a.z=h);break;case "d":void 0!==a[k]&&(a.z=-h);break;default:return alert("ERROR: unknow axis ("+
b.axis[l]+") - check definition of "+b.projName),null}return a},reportError:function(){},extend:function(b,d){b=b||{};if(d)for(var a in d){var f=d[a];void 0!==f&&(b[a]=f)}return b},Class:function(){for(var b=function(){this.initialize.apply(this,arguments)},d={},a,f=0;f<arguments.length;++f)a="function"==typeof arguments[f]?arguments[f].prototype:arguments[f],Proj4js.extend(d,a);b.prototype=d;return b},bind:function(b,d){var a=Array.prototype.slice.apply(arguments,[2]);return function(){var f=a.concat(Array.prototype.slice.apply(arguments,
[0]));return b.apply(d,f)}},scriptName:"proj4js-compressed.js",defsLookupService:"http://spatialreference.org/ref",libPath:null,getScriptLocation:function(){if(this.libPath)return this.libPath;for(var b=this.scriptName,d=b.length,a=document.getElementsByTagName("script"),f=0;f<a.length;f++){var e=a[f].getAttribute("src");if(e){var g=e.lastIndexOf(b);if(-1<g&&g+d==e.length){this.libPath=e.slice(0,-d);break}}}return this.libPath||""},loadScript:function(b,d,a,f){var e=document.createElement("script");
e.defer=!1;e.type="text/javascript";e.id=b;e.src=b;e.onload=d;e.onerror=a;e.loadCheck=f;/MSIE/.test(navigator.userAgent)&&(e.onreadystatechange=this.checkReadyState);document.getElementsByTagName("head")[0].appendChild(e)},checkReadyState:function(){if("loaded"==this.readyState)if(this.loadCheck())this.onload();else this.onerror()}};
Proj4js.Proj=Proj4js.Class({readyToUse:!1,title:null,projName:null,units:null,datum:null,x0:0,y0:0,localCS:!1,queue:null,initialize:function(b,d){this.srsCodeInput=b;this.queue=[];d&&this.queue.push(d);if(0<=b.indexOf("GEOGCS")||0<=b.indexOf("GEOCCS")||0<=b.indexOf("PROJCS")||0<=b.indexOf("LOCAL_CS"))this.parseWKT(b),this.deriveConstants(),this.loadProjCode(this.projName);else{if(0==b.indexOf("urn:")){var a=b.split(":");"ogc"!=a[1]&&"x-ogc"!=a[1]||"def"!=a[2]||"crs"!=a[3]||(b=a[4]+":"+a[a.length-
1])}else 0==b.indexOf("http://")&&(a=b.split("#"),a[0].match(/epsg.org/)?b="EPSG:"+a[1]:a[0].match(/RIG.xml/)&&(b="IGNF:"+a[1]));this.srsCode=b.toUpperCase();0==this.srsCode.indexOf("EPSG")?(this.srsCode=this.srsCode,this.srsAuth="epsg",this.srsProjNumber=this.srsCode.substring(5)):0==this.srsCode.indexOf("IGNF")?(this.srsCode=this.srsCode,this.srsAuth="IGNF",this.srsProjNumber=this.srsCode.substring(5)):0==this.srsCode.indexOf("CRS")?(this.srsCode=this.srsCode,this.srsAuth="CRS",this.srsProjNumber=
this.srsCode.substring(4)):(this.srsAuth="",this.srsProjNumber=this.srsCode);this.loadProjDefinition()}},loadProjDefinition:function(){if(Proj4js.defs[this.srsCode])this.defsLoaded();else{var b=Proj4js.getScriptLocation()+"defs/"+this.srsAuth.toUpperCase()+this.srsProjNumber+".js";Proj4js.loadScript(b,Proj4js.bind(this.defsLoaded,this),Proj4js.bind(this.loadFromService,this),Proj4js.bind(this.checkDefsLoaded,this))}},loadFromService:function(){Proj4js.loadScript(Proj4js.defsLookupService+"/"+this.srsAuth+
"/"+this.srsProjNumber+"/proj4js/",Proj4js.bind(this.defsLoaded,this),Proj4js.bind(this.defsFailed,this),Proj4js.bind(this.checkDefsLoaded,this))},defsLoaded:function(){this.parseDefs();this.loadProjCode(this.projName)},checkDefsLoaded:function(){return Proj4js.defs[this.srsCode]?!0:!1},defsFailed:function(){Proj4js.reportError("failed to load projection definition for: "+this.srsCode);Proj4js.defs[this.srsCode]=Proj4js.defs.WGS84;this.defsLoaded()},loadProjCode:function(b){if(Proj4js.Proj[b])this.initTransforms();
else{var d=Proj4js.getScriptLocation()+"projCode/"+b+".js";Proj4js.loadScript(d,Proj4js.bind(this.loadProjCodeSuccess,this,b),Proj4js.bind(this.loadProjCodeFailure,this,b),Proj4js.bind(this.checkCodeLoaded,this,b))}},loadProjCodeSuccess:function(b){Proj4js.Proj[b].dependsOn?this.loadProjCode(Proj4js.Proj[b].dependsOn):this.initTransforms()},loadProjCodeFailure:function(b){Proj4js.reportError("failed to find projection file for: "+b)},checkCodeLoaded:function(b){return Proj4js.Proj[b]?!0:!1},initTransforms:function(){Proj4js.extend(this,
Proj4js.Proj[this.projName]);this.init();this.readyToUse=!0;if(this.queue)for(var b;b=this.queue.shift();)b.call(this,this)},wktRE:/^(\w+)\[(.*)\]$/,parseWKT:function(b){if(b=b.match(this.wktRE)){var d=b[1],a=b[2].split(","),f;f="TOWGS84"==d.toUpperCase()?d:a.shift();f=f.replace(/^\"/,"");f=f.replace(/\"$/,"");b=[];for(var e=0,g="",h=0;h<a.length;++h){for(var k=a[h],l=0;l<k.length;++l)"["==k.charAt(l)&&++e,"]"==k.charAt(l)&&--e;g+=k;0===e?(b.push(g),g=""):g+=","}switch(d){case "LOCAL_CS":this.projName=
"identity";this.localCS=!0;this.srsCode=f;break;case "GEOGCS":this.projName="longlat";this.geocsCode=f;this.srsCode||(this.srsCode=f);break;case "PROJCS":this.srsCode=f;break;case "PROJECTION":this.projName=Proj4js.wktProjections[f];break;case "DATUM":this.datumName=f;break;case "LOCAL_DATUM":this.datumCode="none";break;case "SPHEROID":this.ellps=f;this.a=parseFloat(b.shift());this.rf=parseFloat(b.shift());break;case "PRIMEM":this.from_greenwich=parseFloat(b.shift());break;case "UNIT":this.units=
f;this.unitsPerMeter=parseFloat(b.shift());break;case "PARAMETER":d=f.toLowerCase();a=parseFloat(b.shift());switch(d){case "false_easting":this.x0=a;break;case "false_northing":this.y0=a;break;case "scale_factor":this.k0=a;break;case "central_meridian":this.long0=a*Proj4js.common.D2R;break;case "latitude_of_origin":this.lat0=a*Proj4js.common.D2R}break;case "TOWGS84":this.datum_params=b;break;case "AXIS":d=f.toLowerCase();a=b.shift();switch(a){case "EAST":a="e";break;case "WEST":a="w";break;case "NORTH":a=
"n";break;case "SOUTH":a="s";break;case "UP":a="u";break;case "DOWN":a="d";break;default:a=" "}this.axis||(this.axis="enu");switch(d){case "x":this.axis=a+this.axis.substr(1,2);break;case "y":this.axis=this.axis.substr(0,1)+a+this.axis.substr(2,1);break;case "z":this.axis=this.axis.substr(0,2)+a}}for(h=0;h<b.length;++h)this.parseWKT(b[h])}},parseDefs:function(){this.defData=Proj4js.defs[this.srsCode];var b,d;if(this.defData){for(var a=this.defData.split("+"),f=0;f<a.length;f++)switch(d=a[f].split("="),
b=d[0].toLowerCase(),d=d[1],b.replace(/\s/gi,"")){case "title":this.title=d;break;case "proj":this.projName=d.replace(/\s/gi,"");break;case "units":this.units=d.replace(/\s/gi,"");break;case "datum":this.datumCode=d.replace(/\s/gi,"");break;case "nadgrids":this.nagrids=d.replace(/\s/gi,"");break;case "ellps":this.ellps=d.replace(/\s/gi,"");break;case "a":this.a=parseFloat(d);break;case "b":this.b=parseFloat(d);break;case "rf":this.rf=parseFloat(d);break;case "lat_0":this.lat0=d*Proj4js.common.D2R;
break;case "lat_1":this.lat1=d*Proj4js.common.D2R;break;case "lat_2":this.lat2=d*Proj4js.common.D2R;break;case "lat_ts":this.lat_ts=d*Proj4js.common.D2R;break;case "lon_0":this.long0=d*Proj4js.common.D2R;break;case "alpha":this.alpha=parseFloat(d)*Proj4js.common.D2R;break;case "lonc":this.longc=d*Proj4js.common.D2R;break;case "x_0":this.x0=parseFloat(d);break;case "y_0":this.y0=parseFloat(d);break;case "k_0":this.k0=parseFloat(d);break;case "k":this.k0=parseFloat(d);break;case "r_a":this.R_A=!0;break;
case "zone":this.zone=parseInt(d,10);break;case "south":this.utmSouth=!0;break;case "towgs84":this.datum_params=d.split(",");break;case "to_meter":this.to_meter=parseFloat(d);break;case "from_greenwich":this.from_greenwich=d*Proj4js.common.D2R;break;case "pm":d=d.replace(/\s/gi,"");this.from_greenwich=Proj4js.PrimeMeridian[d]?Proj4js.PrimeMeridian[d]:parseFloat(d);this.from_greenwich*=Proj4js.common.D2R;break;case "axis":d=d.replace(/\s/gi,""),3==d.length&&-1!="ewnsud".indexOf(d.substr(0,1))&&-1!=
"ewnsud".indexOf(d.substr(1,1))&&-1!="ewnsud".indexOf(d.substr(2,1))&&(this.axis=d)}this.deriveConstants()}},deriveConstants:function(){"@null"==this.nagrids&&(this.datumCode="none");if(this.datumCode&&"none"!=this.datumCode){var b=Proj4js.Datum[this.datumCode];b&&(this.datum_params=b.towgs84?b.towgs84.split(","):null,this.ellps=b.ellipse,this.datumName=b.datumName?b.datumName:this.datumCode)}this.a||Proj4js.extend(this,Proj4js.Ellipsoid[this.ellps]?Proj4js.Ellipsoid[this.ellps]:Proj4js.Ellipsoid.WGS84);
this.rf&&!this.b&&(this.b=(1-1/this.rf)*this.a);if(0===this.rf||Math.abs(this.a-this.b)<Proj4js.common.EPSLN)this.sphere=!0,this.b=this.a;this.a2=this.a*this.a;this.b2=this.b*this.b;this.es=(this.a2-this.b2)/this.a2;this.e=Math.sqrt(this.es);this.R_A&&(this.a*=1-this.es*(Proj4js.common.SIXTH+this.es*(Proj4js.common.RA4+this.es*Proj4js.common.RA6)),this.a2=this.a*this.a,this.b2=this.b*this.b,this.es=0);this.ep2=(this.a2-this.b2)/this.b2;this.k0||(this.k0=1);this.axis||(this.axis="enu");this.datum=
new Proj4js.datum(this)}});Proj4js.Proj.longlat={init:function(){},forward:function(b){return b},inverse:function(b){return b}};Proj4js.Proj.identity=Proj4js.Proj.longlat;
Proj4js.defs={WGS84:"+title=long/lat:WGS84 +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees","EPSG:4326":"+title=long/lat:WGS84 +proj=longlat +a=6378137.0 +b=6356752.31424518 +ellps=WGS84 +datum=WGS84 +units=degrees","EPSG:4269":"+title=long/lat:NAD83 +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees","EPSG:3875":"+title= Google Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"};
Proj4js.defs["EPSG:3785"]=Proj4js.defs["EPSG:3875"];Proj4js.defs.GOOGLE=Proj4js.defs["EPSG:3875"];Proj4js.defs["EPSG:900913"]=Proj4js.defs["EPSG:3875"];Proj4js.defs["EPSG:102113"]=Proj4js.defs["EPSG:3875"];
Proj4js.common={PI:3.141592653589793,HALF_PI:1.5707963267948966,TWO_PI:6.283185307179586,FORTPI:0.7853981633974483,R2D:57.29577951308232,D2R:0.017453292519943295,SEC_TO_RAD:4.84813681109536E-6,EPSLN:1E-10,MAX_ITER:20,COS_67P5:0.3826834323650898,AD_C:1.0026,PJD_UNKNOWN:0,PJD_3PARAM:1,PJD_7PARAM:2,PJD_GRIDSHIFT:3,PJD_WGS84:4,PJD_NODATUM:5,SRS_WGS84_SEMIMAJOR:6378137,SIXTH:0.16666666666666666,RA4:0.04722222222222222,RA6:0.022156084656084655,RV4:0.06944444444444445,RV6:0.04243827160493827,msfnz:function(b,
d,a){b*=d;return a/Math.sqrt(1-b*b)},tsfnz:function(b,d,a){a*=b;a=Math.pow((1-a)/(1+a),0.5*b);return Math.tan(0.5*(this.HALF_PI-d))/a},phi2z:function(b,d){for(var a=0.5*b,f,e=this.HALF_PI-2*Math.atan(d),g=0;15>=g;g++)if(f=b*Math.sin(e),f=this.HALF_PI-2*Math.atan(d*Math.pow((1-f)/(1+f),a))-e,e+=f,1E-10>=Math.abs(f))return e;alert("phi2z has NoConvergence");return-9999},qsfnz:function(b,d){var a;return 1E-7<b?(a=b*d,(1-b*b)*(d/(1-a*a)-0.5/b*Math.log((1-a)/(1+a)))):2*d},asinz:function(b){1<Math.abs(b)&&
(b=1<b?1:-1);return Math.asin(b)},e0fn:function(b){return 1-0.25*b*(1+b/16*(3+1.25*b))},e1fn:function(b){return 0.375*b*(1+0.25*b*(1+0.46875*b))},e2fn:function(b){return 0.05859375*b*b*(1+0.75*b)},e3fn:function(b){return b*b*b*(35/3072)},mlfn:function(b,d,a,f,e){return b*e-d*Math.sin(2*e)+a*Math.sin(4*e)-f*Math.sin(6*e)},srat:function(b,d){return Math.pow((1-b)/(1+b),d)},sign:function(b){return 0>b?-1:1},adjust_lon:function(b){return Math.abs(b)<this.PI?b:b-this.sign(b)*this.TWO_PI},adjust_lat:function(b){return Math.abs(b)<
this.HALF_PI?b:b-this.sign(b)*this.PI},latiso:function(b,d,a){if(Math.abs(d)>this.HALF_PI)return+Number.NaN;if(d==this.HALF_PI)return Number.POSITIVE_INFINITY;if(d==-1*this.HALF_PI)return-1*Number.POSITIVE_INFINITY;a*=b;return Math.log(Math.tan((this.HALF_PI+d)/2))+b*Math.log((1-a)/(1+a))/2},fL:function(b,d){return 2*Math.atan(b*Math.exp(d))-this.HALF_PI},invlatiso:function(b,d){var a=this.fL(1,d),f=0,e=0;do f=a,e=b*Math.sin(f),a=this.fL(Math.exp(b*Math.log((1+e)/(1-e))/2),d);while(1E-12<Math.abs(a-
f));return a},sinh:function(b){b=Math.exp(b);return(b-1/b)/2},cosh:function(b){b=Math.exp(b);return(b+1/b)/2},tanh:function(b){b=Math.exp(b);return(b-1/b)/(b+1/b)},asinh:function(b){return(0<=b?1:-1)*Math.log(Math.abs(b)+Math.sqrt(b*b+1))},acosh:function(b){return 2*Math.log(Math.sqrt((b+1)/2)+Math.sqrt((b-1)/2))},atanh:function(b){return Math.log((b-1)/(b+1))/2},gN:function(b,d,a){d*=a;return b/Math.sqrt(1-d*d)},pj_enfn:function(b){var d=[];d[0]=this.C00-b*(this.C02+b*(this.C04+b*(this.C06+b*this.C08)));
d[1]=b*(this.C22-b*(this.C04+b*(this.C06+b*this.C08)));var a=b*b;d[2]=a*(this.C44-b*(this.C46+b*this.C48));a*=b;d[3]=a*(this.C66-b*this.C68);d[4]=a*b*this.C88;return d},pj_mlfn:function(b,d,a,f){a*=d;d*=d;return f[0]*b-a*(f[1]+d*(f[2]+d*(f[3]+d*f[4])))},pj_inv_mlfn:function(b,d,a){for(var f=1/(1-d),e=b,g=Proj4js.common.MAX_ITER;g;--g){var h=Math.sin(e),k=1-d*h*h,k=(this.pj_mlfn(e,h,Math.cos(e),a)-b)*k*Math.sqrt(k)*f,e=e-k;if(Math.abs(k)<Proj4js.common.EPSLN)return e}Proj4js.reportError("cass:pj_inv_mlfn: Convergence error");
return e},C00:1,C02:0.25,C04:0.046875,C06:0.01953125,C08:0.01068115234375,C22:0.75,C44:0.46875,C46:0.013020833333333334,C48:0.007120768229166667,C66:0.3645833333333333,C68:0.005696614583333333,C88:0.3076171875};
Proj4js.datum=Proj4js.Class({initialize:function(b){this.datum_type=Proj4js.common.PJD_WGS84;b.datumCode&&"none"==b.datumCode&&(this.datum_type=Proj4js.common.PJD_NODATUM);if(b&&b.datum_params){for(var d=0;d<b.datum_params.length;d++)b.datum_params[d]=parseFloat(b.datum_params[d]);if(0!=b.datum_params[0]||0!=b.datum_params[1]||0!=b.datum_params[2])this.datum_type=Proj4js.common.PJD_3PARAM;3<b.datum_params.length&&(0!=b.datum_params[3]||0!=b.datum_params[4]||0!=b.datum_params[5]||0!=b.datum_params[6])&&
(this.datum_type=Proj4js.common.PJD_7PARAM,b.datum_params[3]*=Proj4js.common.SEC_TO_RAD,b.datum_params[4]*=Proj4js.common.SEC_TO_RAD,b.datum_params[5]*=Proj4js.common.SEC_TO_RAD,b.datum_params[6]=b.datum_params[6]/1E6+1)}b&&(this.a=b.a,this.b=b.b,this.es=b.es,this.ep2=b.ep2,this.datum_params=b.datum_params)},compare_datums:function(b){return this.datum_type!=b.datum_type||this.a!=b.a||5E-11<Math.abs(this.es-b.es)?!1:this.datum_type==Proj4js.common.PJD_3PARAM?this.datum_params[0]==b.datum_params[0]&&
this.datum_params[1]==b.datum_params[1]&&this.datum_params[2]==b.datum_params[2]:this.datum_type==Proj4js.common.PJD_7PARAM?this.datum_params[0]==b.datum_params[0]&&this.datum_params[1]==b.datum_params[1]&&this.datum_params[2]==b.datum_params[2]&&this.datum_params[3]==b.datum_params[3]&&this.datum_params[4]==b.datum_params[4]&&this.datum_params[5]==b.datum_params[5]&&this.datum_params[6]==b.datum_params[6]:this.datum_type==Proj4js.common.PJD_GRIDSHIFT||b.datum_type==Proj4js.common.PJD_GRIDSHIFT?(alert("ERROR: Grid shift transformations are not implemented."),
!1):!0},geodetic_to_geocentric:function(b){var d=b.x,a=b.y,f=b.z?b.z:0,e,g,h;if(a<-Proj4js.common.HALF_PI&&a>-1.001*Proj4js.common.HALF_PI)a=-Proj4js.common.HALF_PI;else if(a>Proj4js.common.HALF_PI&&a<1.001*Proj4js.common.HALF_PI)a=Proj4js.common.HALF_PI;else if(a<-Proj4js.common.HALF_PI||a>Proj4js.common.HALF_PI)return Proj4js.reportError("geocent:lat out of range:"+a),null;d>Proj4js.common.PI&&(d-=2*Proj4js.common.PI);g=Math.sin(a);h=Math.cos(a);e=this.a/Math.sqrt(1-this.es*g*g);a=(e+f)*h*Math.cos(d);
d=(e+f)*h*Math.sin(d);f=(e*(1-this.es)+f)*g;b.x=a;b.y=d;b.z=f;return 0},geocentric_to_geodetic:function(b){var d,a,f,e,g,h,k,l,p,m,n=b.x;f=b.y;var u=b.z?b.z:0;d=Math.sqrt(n*n+f*f);a=Math.sqrt(n*n+f*f+u*u);if(1E-12>d/this.a){if(n=0,1E-12>a/this.a)return}else n=Math.atan2(f,n);f=u/a;e=d/a;g=1/Math.sqrt(1-this.es*(2-this.es)*e*e);k=e*(1-this.es)*g;l=f*g;m=0;do m++,h=this.a/Math.sqrt(1-this.es*l*l),a=d*k+u*l-h*(1-this.es*l*l),h=this.es*h/(h+a),g=1/Math.sqrt(1-h*(2-h)*e*e),h=e*(1-h)*g,g*=f,p=g*k-h*l,k=
h,l=g;while(1E-24<p*p&&30>m);d=Math.atan(g/Math.abs(h));b.x=n;b.y=d;b.z=a;return b},geocentric_to_geodetic_noniter:function(b){var d=b.x,a=b.y,f=b.z?b.z:0,e,g,h,k,l,d=parseFloat(d),a=parseFloat(a),f=parseFloat(f);l=!1;if(0!=d)e=Math.atan2(a,d);else if(0<a)e=Proj4js.common.HALF_PI;else if(0>a)e=-Proj4js.common.HALF_PI;else if(l=!0,e=0,0<f)g=Proj4js.common.HALF_PI;else if(0>f)g=-Proj4js.common.HALF_PI;else return;h=d*d+a*a;d=Math.sqrt(h);a=f*Proj4js.common.AD_C;h=Math.sqrt(a*a+h);a/=h;h=d/h;a=f+this.b*
this.ep2*a*a*a;k=d-this.a*this.es*h*h*h;h=Math.sqrt(a*a+k*k);a/=h;h=k/h;k=this.a/Math.sqrt(1-this.es*a*a);f=h>=Proj4js.common.COS_67P5?d/h-k:h<=-Proj4js.common.COS_67P5?d/-h-k:f/a+k*(this.es-1);!1==l&&(g=Math.atan(a/h));b.x=e;b.y=g;b.z=f;return b},geocentric_to_wgs84:function(b){if(this.datum_type==Proj4js.common.PJD_3PARAM)b.x+=this.datum_params[0],b.y+=this.datum_params[1],b.z+=this.datum_params[2];else if(this.datum_type==Proj4js.common.PJD_7PARAM){var d=this.datum_params[3],a=this.datum_params[4],
f=this.datum_params[5],e=this.datum_params[6],g=e*(f*b.x+b.y-d*b.z)+this.datum_params[1],d=e*(-a*b.x+d*b.y+b.z)+this.datum_params[2];b.x=e*(b.x-f*b.y+a*b.z)+this.datum_params[0];b.y=g;b.z=d}},geocentric_from_wgs84:function(b){if(this.datum_type==Proj4js.common.PJD_3PARAM)b.x-=this.datum_params[0],b.y-=this.datum_params[1],b.z-=this.datum_params[2];else if(this.datum_type==Proj4js.common.PJD_7PARAM){var d=this.datum_params[3],a=this.datum_params[4],f=this.datum_params[5],e=this.datum_params[6],g=(b.x-
this.datum_params[0])/e,h=(b.y-this.datum_params[1])/e,e=(b.z-this.datum_params[2])/e;b.x=g+f*h-a*e;b.y=-f*g+h+d*e;b.z=a*g-d*h+e}}});
Proj4js.Point=Proj4js.Class({initialize:function(b,d,a){"object"==typeof b?(this.x=b[0],this.y=b[1],this.z=b[2]||0):"string"==typeof b&&"undefined"==typeof d?(b=b.split(","),this.x=parseFloat(b[0]),this.y=parseFloat(b[1]),this.z=parseFloat(b[2])||0):(this.x=b,this.y=d,this.z=a||0)},clone:function(){return new Proj4js.Point(this.x,this.y,this.z)},toString:function(){return"x="+this.x+",y="+this.y},toShortString:function(){return this.x+", "+this.y}});
Proj4js.PrimeMeridian={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};
Proj4js.Ellipsoid={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},"APL4.":{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},
andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},CPM:{a:6375738.7,rf:334.29,
ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},
fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},
new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS72:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},
sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};
Proj4js.Datum={WGS84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},GGRS87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},NAD83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},NAD27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",
ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},OSGB36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"}};
Proj4js.WGS84=new Proj4js.Proj("WGS84");Proj4js.Datum.OSB36=Proj4js.Datum.OSGB36;Proj4js.wktProjections={"Lambert Tangential Conformal Conic Projection":"lcc",Mercator:"merc","Popular Visualisation Pseudo Mercator":"merc",Mercator_1SP:"merc",Transverse_Mercator:"tmerc","Transverse Mercator":"tmerc","Lambert Azimuthal Equal Area":"laea","Universal Transverse Mercator System":"utm"};
Proj4js.Proj.aea={init:function(){Math.abs(this.lat1+this.lat2)<Proj4js.common.EPSLN?Proj4js.reportError("aeaInitEqualLatitudes"):(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.con=this.t1=this.sin_po,this.ms1=Proj4js.common.msfnz(this.e3,this.sin_po,this.cos_po),this.qs1=Proj4js.common.qsfnz(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=
this.sin_po,this.ms2=Proj4js.common.msfnz(this.e3,this.sin_po,this.cos_po),this.qs2=Proj4js.common.qsfnz(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Proj4js.common.qsfnz(this.e3,this.sin_po,this.cos_po),this.ns0=Math.abs(this.lat1-this.lat2)>Proj4js.common.EPSLN?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/
this.ns0)},forward:function(b){var d=b.x,a=b.y;this.sin_phi=Math.sin(a);this.cos_phi=Math.cos(a);var a=Proj4js.common.qsfnz(this.e3,this.sin_phi,this.cos_phi),a=this.a*Math.sqrt(this.c-this.ns0*a)/this.ns0,f=this.ns0*Proj4js.common.adjust_lon(d-this.long0),d=a*Math.sin(f)+this.x0,a=this.rh-a*Math.cos(f)+this.y0;b.x=d;b.y=a;return b},inverse:function(b){var d,a,f;b.x-=this.x0;b.y=this.rh-b.y+this.y0;0<=this.ns0?(d=Math.sqrt(b.x*b.x+b.y*b.y),a=1):(d=-Math.sqrt(b.x*b.x+b.y*b.y),a=-1);f=0;0!=d&&(f=Math.atan2(a*
b.x,a*b.y));a=d*this.ns0/this.a;d=(this.c-a*a)/this.ns0;1E-10<=this.e3?(a=1-0.5*(1-this.es)*Math.log((1-this.e3)/(1+this.e3))/this.e3,a=1E-10<Math.abs(Math.abs(a)-Math.abs(d))?this.phi1z(this.e3,d):0<=d?0.5*Proj4js.common.PI:-0.5*Proj4js.common.PI):a=this.phi1z(this.e3,d);f=Proj4js.common.adjust_lon(f/this.ns0+this.long0);b.x=f;b.y=a;return b},phi1z:function(b,d){var a,f,e,g,h=Proj4js.common.asinz(0.5*d);if(b<Proj4js.common.EPSLN)return h;for(var k=b*b,l=1;25>=l;l++)if(a=Math.sin(h),f=Math.cos(h),
e=b*a,g=1-e*e,a=0.5*g*g/f*(d/(1-k)-a/g+0.5/b*Math.log((1-e)/(1+e))),h+=a,1E-7>=Math.abs(a))return h;Proj4js.reportError("aea:phi1z:Convergence error");return null}};
Proj4js.Proj.sterea={dependsOn:"gauss",init:function(){Proj4js.Proj.gauss.init.apply(this);this.rc?(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative")):Proj4js.reportError("sterea:init:E_ERROR_0")},forward:function(b){var d,a,f,e;b.x=Proj4js.common.adjust_lon(b.x-this.long0);Proj4js.Proj.gauss.forward.apply(this,[b]);d=Math.sin(b.y);a=Math.cos(b.y);f=Math.cos(b.x);e=this.k0*this.R2/(1+this.sinc0*d+this.cosc0*
a*f);b.x=e*a*Math.sin(b.x);b.y=e*(this.cosc0*d-this.sinc0*a*f);b.x=this.a*b.x+this.x0;b.y=this.a*b.y+this.y0;return b},inverse:function(b){var d,a,f,e;b.x=(b.x-this.x0)/this.a;b.y=(b.y-this.y0)/this.a;b.x/=this.k0;b.y/=this.k0;(e=Math.sqrt(b.x*b.x+b.y*b.y))?(f=2*Math.atan2(e,this.R2),d=Math.sin(f),a=Math.cos(f),f=Math.asin(a*this.sinc0+b.y*d*this.cosc0/e),d=Math.atan2(b.x*d,e*this.cosc0*a-b.y*this.sinc0*d)):(f=this.phic0,d=0);b.x=d;b.y=f;Proj4js.Proj.gauss.inverse.apply(this,[b]);b.x=Proj4js.common.adjust_lon(b.x+
this.long0);return b}};function phi4z(b,d,a,f,e,g,h,k,l){var p,m,n,u,s,q;l=g;for(q=1;15>=q;q++)if(p=Math.sin(l),n=Math.tan(l),k=n*Math.sqrt(1-b*p*p),m=Math.sin(2*l),u=d*l-a*m+f*Math.sin(4*l)-e*Math.sin(6*l),s=d-2*a*Math.cos(2*l)+4*f*Math.cos(4*l)-6*e*Math.cos(6*l),p=2*u+k*(u*u+h)-2*g*(k*u+1),n=b*m*(u*u+h-2*g*u)/(2*k),k=2*(g-u)*(k*s-2/m)-2*s,p/=n+k,l+=p,1E-10>=Math.abs(p))return l;Proj4js.reportError("phi4z: No convergence");return null}
function e4fn(b){var d;d=1+b;b=1-b;return Math.sqrt(Math.pow(d,d)*Math.pow(b,b))}
Proj4js.Proj.poly={init:function(){0==this.lat0&&(this.lat0=90);this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=Proj4js.common.e0fn(this.es);this.e1=Proj4js.common.e1fn(this.es);this.e2=Proj4js.common.e2fn(this.es);this.e3=Proj4js.common.e3fn(this.es);this.ml0=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(b){var d,a,f,e,g;f=b.y;a=Proj4js.common.adjust_lon(b.x-this.long0);1E-7>=Math.abs(f)?(g=this.x0+this.a*a,d=this.y0-this.a*
this.ml0):(d=Math.sin(f),a=Math.cos(f),f=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,f),e=Proj4js.common.msfnz(this.e,d,a),a=d,g=this.x0+this.a*e*Math.sin(a)/d,d=this.y0+this.a*(f-this.ml0+e*(1-Math.cos(a))/d));b.x=g;b.y=d;return b},inverse:function(b){var d,a;b.x-=this.x0;b.y-=this.y0;d=this.ml0+b.y/this.a;if(1E-7>=Math.abs(d))d=b.x/this.a+this.long0,a=0;else{d=d*d+b.x/this.a*(b.x/this.a);d=phi4z(this.es,this.e0,this.e1,this.e2,this.e3,this.al,d,void 0,a);if(1!=d)return d;d=Proj4js.common.adjust_lon(Proj4js.common.asinz(NaN*
b.x/this.a)/Math.sin(a)+this.long0)}b.x=d;b.y=a;return b}};
Proj4js.Proj.equi={init:function(){this.x0||(this.x0=0);this.y0||(this.y0=0);this.lat0||(this.lat0=0);this.long0||(this.long0=0)},forward:function(b){var d=b.y,a=this.x0+this.a*Proj4js.common.adjust_lon(b.x-this.long0)*Math.cos(this.lat0),d=this.y0+this.a*d;this.t1=a;this.t2=Math.cos(this.lat0);b.x=a;b.y=d;return b},inverse:function(b){b.x-=this.x0;b.y-=this.y0;var d=b.y/this.a;Math.abs(d)>Proj4js.common.HALF_PI&&Proj4js.reportError("equi:Inv:DataError");var a=Proj4js.common.adjust_lon(this.long0+
b.x/(this.a*Math.cos(this.lat0)));b.x=a;b.y=d}};
Proj4js.Proj.merc={init:function(){this.lat_ts&&(this.k0=this.sphere?Math.cos(this.lat_ts):Proj4js.common.msfnz(this.es,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(b){var d=b.x,a=b.y;if(90<a*Proj4js.common.R2D&&-90>a*Proj4js.common.R2D&&180<d*Proj4js.common.R2D&&-180>d*Proj4js.common.R2D)return Proj4js.reportError("merc:forward: llInputOutOfRange: "+d+" : "+a),null;if(Math.abs(Math.abs(a)-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN)return Proj4js.reportError("merc:forward: ll2mAtPoles"),null;
if(this.sphere)d=this.x0+this.a*this.k0*Proj4js.common.adjust_lon(d-this.long0),a=this.y0+this.a*this.k0*Math.log(Math.tan(Proj4js.common.FORTPI+0.5*a));else var f=Math.sin(a),a=Proj4js.common.tsfnz(this.e,a,f),d=this.x0+this.a*this.k0*Proj4js.common.adjust_lon(d-this.long0),a=this.y0-this.a*this.k0*Math.log(a);b.x=d;b.y=a;return b},inverse:function(b){var d=b.x-this.x0,a=b.y-this.y0;if(this.sphere)a=Proj4js.common.HALF_PI-2*Math.atan(Math.exp(-a/this.a*this.k0));else if(a=Math.exp(-a/(this.a*this.k0)),
a=Proj4js.common.phi2z(this.e,a),-9999==a)return Proj4js.reportError("merc:inverse: lat = -9999"),null;d=Proj4js.common.adjust_lon(this.long0+d/(this.a*this.k0));b.x=d;b.y=a;return b}};Proj4js.Proj.utm={dependsOn:"tmerc",init:function(){this.zone?(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*Proj4js.common.D2R,this.x0=5E5,this.y0=this.utmSouth?1E7:0,this.k0=0.9996,Proj4js.Proj.tmerc.init.apply(this),this.forward=Proj4js.Proj.tmerc.forward,this.inverse=Proj4js.Proj.tmerc.inverse):Proj4js.reportError("utm:init: zone must be specified for UTM")}};
Proj4js.Proj.eqdc={init:function(){this.mode||(this.mode=0);this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=Proj4js.common.e0fn(this.es);this.e1=Proj4js.common.e1fn(this.es);this.e2=Proj4js.common.e2fn(this.es);this.e3=Proj4js.common.e3fn(this.es);this.sinphi=Math.sin(this.lat1);this.cosphi=Math.cos(this.lat1);this.ms1=Proj4js.common.msfnz(this.e,this.sinphi,this.cosphi);this.ml1=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat1);0!=this.mode?
(Math.abs(this.lat1+this.lat2)<Proj4js.common.EPSLN&&Proj4js.reportError("eqdc:Init:EqualLatitudes"),this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Proj4js.common.msfnz(this.e,this.sinphi,this.cosphi),this.ml2=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=Math.abs(this.lat1-this.lat2)>=Proj4js.common.EPSLN?(this.ms1-this.ms2)/(this.ml2-this.ml1):this.sinphi):this.ns=this.sinphi;this.g=this.ml1+this.ms1/this.ns;this.ml0=Proj4js.common.mlfn(this.e0,
this.e1,this.e2,this.e3,this.lat0);this.rh=this.a*(this.g-this.ml0)},forward:function(b){var d=b.x,a=this.a*(this.g-Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,b.y)),f=this.ns*Proj4js.common.adjust_lon(d-this.long0),d=this.x0+a*Math.sin(f),a=this.y0+this.rh-a*Math.cos(f);b.x=d;b.y=a;return b},inverse:function(b){b.x-=this.x0;b.y=this.rh-b.y+this.y0;var d,a;0<=this.ns?(a=Math.sqrt(b.x*b.x+b.y*b.y),d=1):(a=-Math.sqrt(b.x*b.x+b.y*b.y),d=-1);var f=0;0!=a&&(f=Math.atan2(d*b.x,d*b.y));d=this.phi3z(this.g-
a/this.a,this.e0,this.e1,this.e2,this.e3);f=Proj4js.common.adjust_lon(this.long0+f/this.ns);b.x=f;b.y=d;return b},phi3z:function(b,d,a,f,e){var g,h;g=b;for(var k=0;15>k;k++)if(h=(b+a*Math.sin(2*g)-f*Math.sin(4*g)+e*Math.sin(6*g))/d-g,g+=h,1E-10>=Math.abs(h))return g;Proj4js.reportError("PHI3Z-CONV:Latitude failed to converge after 15 iterations");return null}};
Proj4js.Proj.tmerc={init:function(){this.e0=Proj4js.common.e0fn(this.es);this.e1=Proj4js.common.e1fn(this.es);this.e2=Proj4js.common.e2fn(this.es);this.e3=Proj4js.common.e3fn(this.es);this.ml0=this.a*Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(b){var d=b.y,a=Proj4js.common.adjust_lon(b.x-this.long0),f,e;f=Math.sin(d);var g=Math.cos(d);if(this.sphere){var h=g*Math.sin(a);if(1E-10>Math.abs(Math.abs(h)-1))return Proj4js.reportError("tmerc:forward: Point projects into infinity"),
93;e=0.5*this.a*this.k0*Math.log((1+h)/(1-h));f=Math.acos(g*Math.cos(a)/Math.sqrt(1-h*h));0>d&&(f=-f);d=this.a*this.k0*(f-this.lat0)}else{e=g*a;var a=Math.pow(e,2),g=this.ep2*Math.pow(g,2),h=Math.tan(d),k=Math.pow(h,2);f=1-this.es*Math.pow(f,2);f=this.a/Math.sqrt(f);d=this.a*Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,d);e=this.k0*f*e*(1+a/6*(1-k+g+a/20*(5-18*k+Math.pow(k,2)+72*g-58*this.ep2)))+this.x0;d=this.k0*(d-this.ml0+f*h*a*(0.5+a/24*(5-k+9*g+4*Math.pow(g,2)+a/30*(61-58*k+Math.pow(k,
2)+600*g-330*this.ep2))))+this.y0}b.x=e;b.y=d;return b},inverse:function(b){var d,a,f,e;if(this.sphere){a=Math.exp(b.x/(this.a*this.k0));var g=0.5*(a-1/a);f=this.lat0+b.y/(this.a*this.k0);e=Math.cos(f);d=Math.sqrt((1-e*e)/(1+g*g));a=Proj4js.common.asinz(d);0>f&&(a=-a);d=0==g&&0==e?this.long0:Proj4js.common.adjust_lon(Math.atan2(g,e)+this.long0)}else{var g=b.x-this.x0,h=b.y-this.y0;a=d=(this.ml0+h/this.k0)/this.a;for(e=0;;e++){f=(d+this.e1*Math.sin(2*a)-this.e2*Math.sin(4*a)+this.e3*Math.sin(6*a))/
this.e0-a;a+=f;if(Math.abs(f)<=Proj4js.common.EPSLN)break;if(6<=e)return Proj4js.reportError("tmerc:inverse: Latitude failed to converge"),95}if(Math.abs(a)<Proj4js.common.HALF_PI){d=Math.sin(a);f=Math.cos(a);var k=Math.tan(a);e=this.ep2*Math.pow(f,2);var h=Math.pow(e,2),l=Math.pow(k,2),p=Math.pow(l,2);d=1-this.es*Math.pow(d,2);var m=this.a/Math.sqrt(d);d=m*(1-this.es)/d;var g=g/(m*this.k0),n=Math.pow(g,2);a-=m*k*n/d*(0.5-n/24*(5+3*l+10*e-4*h-9*this.ep2-n/30*(61+90*l+298*e+45*p-252*this.ep2-3*h)));
d=Proj4js.common.adjust_lon(this.long0+g*(1-n/6*(1+2*l+e-n/20*(5-2*e+28*l-3*h+8*this.ep2+24*p)))/f)}else a=Proj4js.common.HALF_PI*Proj4js.common.sign(h),d=this.long0}b.x=d;b.y=a;return b}};Proj4js.defs.GOOGLE="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs";Proj4js.defs["EPSG:900913"]=Proj4js.defs.GOOGLE;
Proj4js.Proj.gstmerc={init:function(){var b=this.b/this.a;this.e=Math.sqrt(1-b*b);this.lc=this.long0;this.rs=Math.sqrt(1+this.e*this.e*Math.pow(Math.cos(this.lat0),4)/(1-this.e*this.e));var b=Math.sin(this.lat0),d=Math.asin(b/this.rs),a=Math.sin(d);this.cp=Proj4js.common.latiso(0,d,a)-this.rs*Proj4js.common.latiso(this.e,this.lat0,b);this.n2=this.k0*this.a*Math.sqrt(1-this.e*this.e)/(1-this.e*this.e*b*b);this.xs=this.x0;this.ys=this.y0-this.n2*d;this.title||(this.title="Gauss Schreiber transverse mercator")},
forward:function(b){var d=b.y,a=this.rs*(b.x-this.lc),d=this.cp+this.rs*Proj4js.common.latiso(this.e,d,Math.sin(d)),f=Math.asin(Math.sin(a)/Proj4js.common.cosh(d)),f=Proj4js.common.latiso(0,f,Math.sin(f));b.x=this.xs+this.n2*f;b.y=this.ys+this.n2*Math.atan(Proj4js.common.sinh(d)/Math.cos(a));return b},inverse:function(b){var d=b.x,a=b.y,f=Math.atan(Proj4js.common.sinh((d-this.xs)/this.n2)/Math.cos((a-this.ys)/this.n2)),d=Math.asin(Math.sin((a-this.ys)/this.n2)/Proj4js.common.cosh((d-this.xs)/this.n2)),
d=Proj4js.common.latiso(0,d,Math.sin(d));b.x=this.lc+f/this.rs;b.y=Proj4js.common.invlatiso(this.e,(d-this.cp)/this.rs);return b}};
Proj4js.Proj.ortho={init:function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0)},forward:function(b){var d,a,f,e,g;a=b.y;f=Proj4js.common.adjust_lon(b.x-this.long0);d=Math.sin(a);a=Math.cos(a);e=Math.cos(f);g=this.sin_p14*d+this.cos_p14*a*e;if(0<g||Math.abs(g)<=Proj4js.common.EPSLN)var h=1*this.a*a*Math.sin(f),k=this.y0+1*this.a*(this.cos_p14*d-this.sin_p14*a*e);else Proj4js.reportError("orthoFwdPointError");b.x=h;b.y=k;return b},inverse:function(b){var d,a,f,e;b.x-=this.x0;
b.y-=this.y0;d=Math.sqrt(b.x*b.x+b.y*b.y);d>this.a+1E-7&&Proj4js.reportError("orthoInvDataError");a=Proj4js.common.asinz(d/this.a);f=Math.sin(a);e=Math.cos(a);a=this.long0;Math.abs(d);f=Proj4js.common.asinz(e*this.sin_p14+b.y*f*this.cos_p14/d);d=Math.abs(this.lat0)-Proj4js.common.HALF_PI;Math.abs(d)<=Proj4js.common.EPSLN&&(a=0<=this.lat0?Proj4js.common.adjust_lon(this.long0+Math.atan2(b.x,-b.y)):Proj4js.common.adjust_lon(this.long0-Math.atan2(-b.x,b.y)));Math.sin(f);b.x=a;b.y=f;return b}};
Proj4js.Proj.krovak={init:function(){this.a=6377397.155;this.es=0.006674372230614;this.e=Math.sqrt(this.es);this.lat0||(this.lat0=0.863937979737193);this.long0||(this.long0=0.4334234309119251);this.k0||(this.k0=0.9999);this.s45=0.785398163397448;this.s90=2*this.s45;this.fi0=this.lat0;this.e2=this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/
(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq},forward:function(b){var d,a,f;a=b.y;f=Proj4js.common.adjust_lon(b.x-this.long0);d=Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.alfa*
this.e/2);d=2*(Math.atan(this.k*Math.pow(Math.tan(a/2+this.s45),this.alfa)/d)-this.s45);a=-f*this.alfa;f=Math.asin(Math.cos(this.ad)*Math.sin(d)+Math.sin(this.ad)*Math.cos(d)*Math.cos(a));d=this.n*Math.asin(Math.cos(d)*Math.sin(a)/Math.cos(f));f=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(f/2+this.s45),this.n);b.y=f*Math.cos(d)/1;b.x=f*Math.sin(d)/1;this.czech&&(b.y*=-1,b.x*=-1);return b},inverse:function(b){var d,a,f;d=b.x;b.x=b.y;b.y=d;this.czech&&(b.y*=-1,b.x*=-1);
d=Math.sqrt(b.x*b.x+b.y*b.y);a=Math.atan2(b.y,b.x)/Math.sin(this.s0);f=2*(Math.atan(Math.pow(this.ro0/d,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);d=Math.asin(Math.cos(this.ad)*Math.sin(f)-Math.sin(this.ad)*Math.cos(f)*Math.cos(a));a=Math.asin(Math.cos(f)*Math.sin(a)/Math.cos(d));b.x=this.long0-a/this.alfa;a=d;var e=f=0;do b.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(d/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),1E-10>
Math.abs(a-b.y)&&(f=1),a=b.y,e+=1;while(0==f&&15>e);return 15<=e?(Proj4js.reportError("PHI3Z-CONV:Latitude failed to converge after 15 iterations"),null):b}};
Proj4js.Proj.somerc={init:function(){var b=this.lat0;this.lambda0=this.long0;var d=Math.sin(b),a=this.a,f=1/this.rf,f=2*f-Math.pow(f,2),e=this.e=Math.sqrt(f);this.R=this.k0*a*Math.sqrt(1-f)/(1-f*Math.pow(d,2));this.alpha=Math.sqrt(1+f/(1-f)*Math.pow(Math.cos(b),4));this.b0=Math.asin(d/this.alpha);this.K=Math.log(Math.tan(Math.PI/4+this.b0/2))-this.alpha*Math.log(Math.tan(Math.PI/4+b/2))+this.alpha*e/2*Math.log((1+e*d)/(1-e*d))},forward:function(b){var d=Math.log(Math.tan(Math.PI/4-b.y/2)),a=this.e/
2*Math.log((1+this.e*Math.sin(b.y))/(1-this.e*Math.sin(b.y))),a=2*(Math.atan(Math.exp(-this.alpha*(d+a)+this.K))-Math.PI/4),f=this.alpha*(b.x-this.lambda0),d=Math.atan(Math.sin(f)/(Math.sin(this.b0)*Math.tan(a)+Math.cos(this.b0)*Math.cos(f))),a=Math.asin(Math.cos(this.b0)*Math.sin(a)-Math.sin(this.b0)*Math.cos(a)*Math.cos(f));b.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0;b.x=this.R*d+this.x0;return b},inverse:function(b){for(var d=(b.x-this.x0)/this.R,a=2*(Math.atan(Math.exp((b.y-
this.y0)/this.R))-Math.PI/4),f=Math.asin(Math.cos(this.b0)*Math.sin(a)+Math.sin(this.b0)*Math.cos(a)*Math.cos(d)),d=this.lambda0+Math.atan(Math.sin(d)/(Math.cos(this.b0)*Math.cos(d)-Math.sin(this.b0)*Math.tan(a)))/this.alpha,e=f,g=-1E3,h=0;1E-7<Math.abs(e-g);){if(20<++h){Proj4js.reportError("omercFwdInfinity");return}a=1/this.alpha*(Math.log(Math.tan(Math.PI/4+f/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(e))/2));g=e;e=2*Math.atan(Math.exp(a))-Math.PI/2}b.x=d;b.y=e;return b}};
Proj4js.Proj.stere={ssfn_:function(b,d,a){d*=a;return Math.tan(0.5*(Proj4js.common.HALF_PI+b))*Math.pow((1-d)/(1+d),0.5*a)},TOL:1E-8,NITER:8,CONV:1E-10,S_POLE:0,N_POLE:1,OBLIQ:2,EQUIT:3,init:function(){this.phits=this.lat_ts?this.lat_ts:Proj4js.common.HALF_PI;var b=Math.abs(this.lat0);this.mode=Math.abs(b)-Proj4js.common.HALF_PI<Proj4js.common.EPSLN?0>this.lat0?this.S_POLE:this.N_POLE:b>Proj4js.common.EPSLN?this.OBLIQ:this.EQUIT;this.phits=Math.abs(this.phits);if(this.es){var d;switch(this.mode){case this.N_POLE:case this.S_POLE:Math.abs(this.phits-
Proj4js.common.HALF_PI)<Proj4js.common.EPSLN?this.akm1=2*this.k0/Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)):(b=Math.sin(this.phits),this.akm1=Math.cos(this.phits)/Proj4js.common.tsfnz(this.e,this.phits,b),b*=this.e,this.akm1/=Math.sqrt(1-b*b));break;case this.EQUIT:this.akm1=2*this.k0;break;case this.OBLIQ:b=Math.sin(this.lat0),d=2*Math.atan(this.ssfn_(this.lat0,b,this.e))-Proj4js.common.HALF_PI,b*=this.e,this.akm1=2*this.k0*Math.cos(this.lat0)/Math.sqrt(1-b*b),this.sinX1=
Math.sin(d),this.cosX1=Math.cos(d)}}else switch(this.mode){case this.OBLIQ:this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0);case this.EQUIT:this.akm1=2*this.k0;break;case this.S_POLE:case this.N_POLE:this.akm1=Math.abs(this.phits-Proj4js.common.HALF_PI)>=Proj4js.common.EPSLN?Math.cos(this.phits)/Math.tan(Proj4js.common.FORTPI-0.5*this.phits):2*this.k0}},forward:function(b){var d=b.x,d=Proj4js.common.adjust_lon(d-this.long0),a=b.y,f,e;if(this.sphere){var g,h,k;g=Math.sin(a);h=Math.cos(a);
k=Math.cos(d);d=Math.sin(d);switch(this.mode){case this.EQUIT:e=1+h*k;e<=Proj4js.common.EPSLN&&Proj4js.reportError("stere:forward:Equit");e=this.akm1/e;f=e*h*d;e*=g;break;case this.OBLIQ:e=1+this.sinph0*g+this.cosph0*h*k;e<=Proj4js.common.EPSLN&&Proj4js.reportError("stere:forward:Obliq");e=this.akm1/e;f=e*h*d;e*=this.cosph0*g-this.sinph0*h*k;break;case this.N_POLE:k=-k,a=-a;case this.S_POLE:Math.abs(a-Proj4js.common.HALF_PI)<this.TOL&&Proj4js.reportError("stere:forward:S_POLE"),e=this.akm1*Math.tan(Proj4js.common.FORTPI+
0.5*a),f=d*e,e*=k}}else{k=Math.cos(d);d=Math.sin(d);g=Math.sin(a);var l;if(this.mode==this.OBLIQ||this.mode==this.EQUIT)l=2*Math.atan(this.ssfn_(a,g,this.e)),h=Math.sin(l-Proj4js.common.HALF_PI),l=Math.cos(l);switch(this.mode){case this.OBLIQ:a=this.akm1/(this.cosX1*(1+this.sinX1*h+this.cosX1*l*k));e=a*(this.cosX1*h-this.sinX1*l*k);f=a*l;break;case this.EQUIT:a=2*this.akm1/(1+l*k);e=a*h;f=a*l;break;case this.S_POLE:a=-a,k=-k,g=-g;case this.N_POLE:f=this.akm1*Proj4js.common.tsfnz(this.e,a,g),e=-f*
k}f*=d}b.x=f*this.a+this.x0;b.y=e*this.a+this.y0;return b},inverse:function(b){var d=(b.x-this.x0)/this.a,a=(b.y-this.y0)/this.a,f,e,g,h=f=0,k,l=g=0;if(this.sphere){h=Math.sqrt(d*d+a*a);l=2*Math.atan(h/this.akm1);g=Math.sin(l);l=Math.cos(l);f=0;switch(this.mode){case this.EQUIT:e=Math.abs(h)<=Proj4js.common.EPSLN?0:Math.asin(a*g/h);if(0!=l||0!=d)f=Math.atan2(d*g,l*h);break;case this.OBLIQ:e=Math.abs(h)<=Proj4js.common.EPSLN?this.phi0:Math.asin(l*this.sinph0+a*g*this.cosph0/h);l-=this.sinph0*Math.sin(e);
if(0!=l||0!=d)f=Math.atan2(d*g*this.cosph0,l*h);break;case this.N_POLE:a=-a;case this.S_POLE:e=Math.abs(h)<=Proj4js.common.EPSLN?this.phi0:Math.asin(this.mode==this.S_POLE?-l:l),f=0==d&&0==a?0:Math.atan2(d,a)}b.x=Proj4js.common.adjust_lon(f+this.long0);b.y=e}else{k=Math.sqrt(d*d+a*a);switch(this.mode){case this.OBLIQ:case this.EQUIT:f=2*Math.atan2(k*this.cosX1,this.akm1);g=Math.cos(f);e=Math.sin(f);h=0==k?Math.asin(g*this.sinX1):Math.asin(g*this.sinX1+a*e*this.cosX1/k);f=Math.tan(0.5*(Proj4js.common.HALF_PI+
h));d*=e;a=k*this.cosX1*g-a*this.sinX1*e;l=Proj4js.common.HALF_PI;g=0.5*this.e;break;case this.N_POLE:a=-a;case this.S_POLE:f=-k/this.akm1,h=Proj4js.common.HALF_PI-2*Math.atan(f),l=-Proj4js.common.HALF_PI,g=-0.5*this.e}for(k=this.NITER;k--;h=e)if(e=this.e*Math.sin(h),e=2*Math.atan(f*Math.pow((1+e)/(1-e),g))-l,Math.abs(h-e)<this.CONV)return this.mode==this.S_POLE&&(e=-e),f=0==d&&0==a?0:Math.atan2(d,a),b.x=Proj4js.common.adjust_lon(f+this.long0),b.y=e,b}}};
Proj4js.Proj.nzmg={iterations:1,init:function(){this.A=[];this.A[1]=0.6399175073;this.A[2]=-0.1358797613;this.A[3]=0.063294409;this.A[4]=-0.02526853;this.A[5]=0.0117879;this.A[6]=-0.0055161;this.A[7]=0.0026906;this.A[8]=-0.001333;this.A[9]=6.7E-4;this.A[10]=-3.4E-4;this.B_re=[];this.B_im=[];this.B_re[1]=0.7557853228;this.B_im[1]=0;this.B_re[2]=0.249204646;this.B_im[2]=0.003371507;this.B_re[3]=-0.001541739;this.B_im[3]=0.04105856;this.B_re[4]=-0.10162907;this.B_im[4]=0.01727609;this.B_re[5]=-0.26623489;
this.B_im[5]=-0.36249218;this.B_re[6]=-0.6870983;this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-0.577245789;this.C_im[2]=-0.007809598;this.C_re[3]=0.508307513;this.C_im[3]=-0.112208952;this.C_re[4]=-0.15094762;this.C_im[4]=0.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;this.C_im[6]=2.5127645;this.D=[];this.D[1]=1.5627014243;this.D[2]=0.5185406398;this.D[3]=-0.03333098;this.D[4]=-0.1052906;this.D[5]=-0.0368594;
this.D[6]=0.007317;this.D[7]=0.0122;this.D[8]=0.00394;this.D[9]=-0.0013},forward:function(b){for(var d=1E-5*((b.y-this.lat0)/Proj4js.common.SEC_TO_RAD),a=b.x-this.long0,f=1,e=0,g=1;10>=g;g++)f*=d,e+=this.A[g]*f;for(var d=e,f=1,h=0,k=0,l=0,g=1;6>=g;g++)e=f*d-h*a,h=h*d+f*a,f=e,k=k+this.B_re[g]*f-this.B_im[g]*h,l=l+this.B_im[g]*f+this.B_re[g]*h;b.x=l*this.a+this.x0;b.y=k*this.a+this.y0;return b},inverse:function(b){for(var d=(b.y-this.y0)/this.a,a=(b.x-this.x0)/this.a,f=1,e=0,g,h=0,k=0,l=1;6>=l;l++)g=
f*d-e*a,e=e*d+f*a,f=g,h=h+this.C_re[l]*f-this.C_im[l]*e,k=k+this.C_im[l]*f+this.C_re[l]*e;for(f=0;f<this.iterations;f++){var p=h,m=k,n;g=d;e=a;for(l=2;6>=l;l++)n=p*h-m*k,m=m*h+p*k,p=n,g+=(l-1)*(this.B_re[l]*p-this.B_im[l]*m),e+=(l-1)*(this.B_im[l]*p+this.B_re[l]*m);for(var p=1,m=0,u=this.B_re[1],s=this.B_im[1],l=2;6>=l;l++)n=p*h-m*k,m=m*h+p*k,p=n,u+=l*(this.B_re[l]*p-this.B_im[l]*m),s+=l*(this.B_im[l]*p+this.B_re[l]*m);k=u*u+s*s;h=(g*u+e*s)/k;k=(e*u-g*s)/k}d=h;a=1;h=0;for(l=1;9>=l;l++)a*=d,h+=this.D[l]*
a;l=this.lat0+1E5*h*Proj4js.common.SEC_TO_RAD;b.x=this.long0+k;b.y=l;return b}};Proj4js.Proj.mill={init:function(){},forward:function(b){var d=b.y,a=this.x0+this.a*Proj4js.common.adjust_lon(b.x-this.long0),d=this.y0+1.25*this.a*Math.log(Math.tan(Proj4js.common.PI/4+d/2.5));b.x=a;b.y=d;return b},inverse:function(b){b.x-=this.x0;b.y-=this.y0;var d=Proj4js.common.adjust_lon(this.long0+b.x/this.a),a=2.5*(Math.atan(Math.exp(0.8*b.y/this.a))-Proj4js.common.PI/4);b.x=d;b.y=a;return b}};
Proj4js.Proj.gnom={init:function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1E3*this.a;this.rc=1},forward:function(b){var d,a,f,e,g;a=b.y;f=Proj4js.common.adjust_lon(b.x-this.long0);d=Math.sin(a);a=Math.cos(a);e=Math.cos(f);g=this.sin_p14*d+this.cos_p14*a*e;0<g||Math.abs(g)<=Proj4js.common.EPSLN?(f=this.x0+1*this.a*a*Math.sin(f)/g,d=this.y0+1*this.a*(this.cos_p14*d-this.sin_p14*a*e)/g):(Proj4js.reportError("orthoFwdPointError"),f=this.x0+this.infinity_dist*
a*Math.sin(f),d=this.y0+this.infinity_dist*(this.cos_p14*d-this.sin_p14*a*e));b.x=f;b.y=d;return b},inverse:function(b){var d,a,f,e;b.x=(b.x-this.x0)/this.a;b.y=(b.y-this.y0)/this.a;b.x/=this.k0;b.y/=this.k0;(d=Math.sqrt(b.x*b.x+b.y*b.y))?(e=Math.atan2(d,this.rc),a=Math.sin(e),f=Math.cos(e),e=Proj4js.common.asinz(f*this.sin_p14+b.y*a*this.cos_p14/d),d=Math.atan2(b.x*a,d*this.cos_p14*f-b.y*this.sin_p14*a),d=Proj4js.common.adjust_lon(this.long0+d)):(e=this.phic0,d=0);b.x=d;b.y=e;return b}};
Proj4js.Proj.sinu={init:function(){this.sphere?(this.n=1,this.es=this.m=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Proj4js.common.pj_enfn(this.es)},forward:function(b){var d,a;d=b.x;a=b.y;d=Proj4js.common.adjust_lon(d-this.long0);if(this.sphere){if(this.m)for(var f=this.n*Math.sin(a),e=Proj4js.common.MAX_ITER;e;--e){var g=(this.m*a+Math.sin(a)-f)/(this.m+Math.cos(a));a-=g;if(Math.abs(g)<Proj4js.common.EPSLN)break}else a=1!=this.n?Math.asin(this.n*Math.sin(a)):a;
d=this.a*this.C_x*d*(this.m+Math.cos(a));a=a*this.a*this.C_y}else f=Math.sin(a),e=Math.cos(a),a=this.a*Proj4js.common.pj_mlfn(a,f,e,this.en),d=this.a*d*e/Math.sqrt(1-this.es*f*f);b.x=d;b.y=a;return b},inverse:function(b){var d,a;b.x-=this.x0;b.y-=this.y0;if(this.sphere)b.y/=this.C_y,d=this.m?Math.asin((this.m*b.y+Math.sin(b.y))/this.n):1!=this.n?Math.asin(Math.sin(b.y)/this.n):b.y,a=b.x/(this.C_x*(this.m+Math.cos(b.y)));else{d=Proj4js.common.pj_inv_mlfn(b.y/this.a,this.es,this.en);var f=Math.abs(d);
f<Proj4js.common.HALF_PI?(f=Math.sin(d),a=this.long0+b.x*Math.sqrt(1-this.es*f*f)/(this.a*Math.cos(d)),a=Proj4js.common.adjust_lon(a)):f-Proj4js.common.EPSLN<Proj4js.common.HALF_PI&&(a=this.long0)}b.x=a;b.y=d;return b}};
Proj4js.Proj.vandg={init:function(){this.R=6370997},forward:function(b){var d=b.y,a=Proj4js.common.adjust_lon(b.x-this.long0);Math.abs(d);var f=Proj4js.common.asinz(2*Math.abs(d/Proj4js.common.PI));(Math.abs(a)<=Proj4js.common.EPSLN||Math.abs(Math.abs(d)-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN)&&Math.tan(0.5*f);var e=0.5*Math.abs(Proj4js.common.PI/a-a/Proj4js.common.PI),g=e*e,h=Math.sin(f),f=Math.cos(f),f=f/(h+f-1),h=f*(2/h-1),h=h*h,g=Proj4js.common.PI*this.R*(e*(f-h)+Math.sqrt(g*(f-h)*(f-h)-
(h+g)*(f*f-h)))/(h+g);0>a&&(g=-g);a=this.x0+g;g=Math.abs(g/(Proj4js.common.PI*this.R));d=0<=d?this.y0+Proj4js.common.PI*this.R*Math.sqrt(1-g*g-2*e*g):this.y0-Proj4js.common.PI*this.R*Math.sqrt(1-g*g-2*e*g);b.x=a;b.y=d;return b},inverse:function(b){var d,a,f,e,g,h,k,l;b.x-=this.x0;b.y-=this.y0;l=Proj4js.common.PI*this.R;d=b.x/l;f=b.y/l;e=d*d+f*f;g=-Math.abs(f)*(1+e);a=g-2*f*f+d*d;h=-2*g+1+2*f*f+e*e;l=f*f/h+(2*a*a*a/h/h/h-9*g*a/h/h)/27;k=(g-a*a/3/h)/h;g=2*Math.sqrt(-k/3);l=3*l/k/g;1<Math.abs(l)&&(l=
0<=l?1:-1);l=Math.acos(l)/3;a=0<=b.y?(-g*Math.cos(l+Proj4js.common.PI/3)-a/3/h)*Proj4js.common.PI:-(-g*Math.cos(l+Proj4js.common.PI/3)-a/3/h)*Proj4js.common.PI;Math.abs(d);d=Proj4js.common.adjust_lon(this.long0+Proj4js.common.PI*(e-1+Math.sqrt(1+2*(d*d-f*f)+e*e))/2/d);b.x=d;b.y=a;return b}};
Proj4js.Proj.cea={init:function(){},forward:function(b){var d=b.y,a=this.x0+this.a*Proj4js.common.adjust_lon(b.x-this.long0)*Math.cos(this.lat_ts),d=this.y0+this.a*Math.sin(d)/Math.cos(this.lat_ts);b.x=a;b.y=d;return b},inverse:function(b){b.x-=this.x0;b.y-=this.y0;var d=Proj4js.common.adjust_lon(this.long0+b.x/this.a/Math.cos(this.lat_ts)),a=Math.asin(b.y/this.a*Math.cos(this.lat_ts));b.x=d;b.y=a;return b}};
Proj4js.Proj.eqc={init:function(){this.x0||(this.x0=0);this.y0||(this.y0=0);this.lat0||(this.lat0=0);this.long0||(this.long0=0);this.lat_ts||(this.lat_ts=0);this.title||(this.title="Equidistant Cylindrical (Plate Carre)");this.rc=Math.cos(this.lat_ts)},forward:function(b){var d=b.y,a=Proj4js.common.adjust_lon(b.x-this.long0),d=Proj4js.common.adjust_lat(d-this.lat0);b.x=this.x0+this.a*a*this.rc;b.y=this.y0+this.a*d;return b},inverse:function(b){var d=b.y;b.x=Proj4js.common.adjust_lon(this.long0+(b.x-
this.x0)/(this.a*this.rc));b.y=Proj4js.common.adjust_lat(this.lat0+(d-this.y0)/this.a);return b}};
Proj4js.Proj.cass={init:function(){this.sphere||(this.en=Proj4js.common.pj_enfn(this.es),this.m0=Proj4js.common.pj_mlfn(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},C1:0.16666666666666666,C2:0.008333333333333333,C3:0.041666666666666664,C4:0.3333333333333333,C5:0.06666666666666667,forward:function(b){var d,a,f=b.x,e=b.y,f=Proj4js.common.adjust_lon(f-this.long0);this.sphere?(d=Math.asin(Math.cos(e)*Math.sin(f)),a=Math.atan2(Math.tan(e),Math.cos(f))-this.phi0):(this.n=Math.sin(e),this.c=
Math.cos(e),a=Proj4js.common.pj_mlfn(e,this.n,this.c,this.en),this.n=1/Math.sqrt(1-this.es*this.n*this.n),this.tn=Math.tan(e),this.t=this.tn*this.tn,this.a1=f*this.c,this.c*=this.es*this.c/(1-this.es),this.a2=this.a1*this.a1,d=this.n*this.a1*(1-this.a2*this.t*(this.C1-(8-this.t+8*this.c)*this.a2*this.C2)),a-=this.m0-this.n*this.tn*this.a2*(0.5+(5-this.t+6*this.c)*this.a2*this.C3));b.x=this.a*d+this.x0;b.y=this.a*a+this.y0;return b},inverse:function(b){b.x-=this.x0;b.y-=this.y0;var d=b.x/this.a,a=
b.y/this.a;if(this.sphere)this.dd=a+this.lat0,a=Math.asin(Math.sin(this.dd)*Math.cos(d)),d=Math.atan2(Math.tan(d),Math.cos(this.dd));else{var f=Proj4js.common.pj_inv_mlfn(this.m0+a,this.es,this.en);this.tn=Math.tan(f);this.t=this.tn*this.tn;this.n=Math.sin(f);this.r=1/(1-this.es*this.n*this.n);this.n=Math.sqrt(this.r);this.r=this.r*(1-this.es)*this.n;this.dd=d/this.n;this.d2=this.dd*this.dd;a=f-this.n*this.tn/this.r*this.d2*(0.5-(1+3*this.t)*this.d2*this.C3);d=this.dd*(1+this.t*this.d2*(-this.C4+
(1+3*this.t)*this.d2*this.C5))/Math.cos(f)}b.x=Proj4js.common.adjust_lon(this.long0+d);b.y=a;return b}};
Proj4js.Proj.gauss={init:function(){var b=Math.sin(this.lat0),d=Math.cos(this.lat0),d=d*d;this.rc=Math.sqrt(1-this.es)/(1-this.es*b*b);this.C=Math.sqrt(1+this.es*d*d/(1-this.es));this.phic0=Math.asin(b/this.C);this.ratexp=0.5*this.C*this.e;this.K=Math.tan(0.5*this.phic0+Proj4js.common.FORTPI)/(Math.pow(Math.tan(0.5*this.lat0+Proj4js.common.FORTPI),this.C)*Proj4js.common.srat(this.e*b,this.ratexp))},forward:function(b){var d=b.x,a=b.y;b.y=2*Math.atan(this.K*Math.pow(Math.tan(0.5*a+Proj4js.common.FORTPI),
this.C)*Proj4js.common.srat(this.e*Math.sin(a),this.ratexp))-Proj4js.common.HALF_PI;b.x=this.C*d;return b},inverse:function(b){for(var d=b.x/this.C,a=b.y,f=Math.pow(Math.tan(0.5*a+Proj4js.common.FORTPI)/this.K,1/this.C),e=Proj4js.common.MAX_ITER;0<e;--e){a=2*Math.atan(f*Proj4js.common.srat(this.e*Math.sin(b.y),-0.5*this.e))-Proj4js.common.HALF_PI;if(1E-14>Math.abs(a-b.y))break;b.y=a}if(!e)return Proj4js.reportError("gauss:inverse:convergence failed"),null;b.x=d;b.y=a;return b}};
Proj4js.Proj.omerc={init:function(){this.mode||(this.mode=0);this.lon1||(this.lon1=0,this.mode=1);this.lon2||(this.lon2=0);this.lat2||(this.lat2=0);var b=1-Math.pow(this.b/this.a,2);Math.sqrt(b);this.sin_p20=Math.sin(this.lat0);this.cos_p20=Math.cos(this.lat0);this.con=1-this.es*this.sin_p20*this.sin_p20;this.com=Math.sqrt(1-b);this.bl=Math.sqrt(1+this.es*Math.pow(this.cos_p20,4)/(1-b));this.al=this.a*this.bl*this.k0*this.com/this.con;Math.abs(this.lat0)<Proj4js.common.EPSLN?this.el=this.d=this.ts=
1:(this.ts=Proj4js.common.tsfnz(this.e,this.lat0,this.sin_p20),this.con=Math.sqrt(this.con),this.d=this.bl*this.com/(this.cos_p20*this.con),this.f=0<this.d*this.d-1?0<=this.lat0?this.d+Math.sqrt(this.d*this.d-1):this.d-Math.sqrt(this.d*this.d-1):this.d,this.el=this.f*Math.pow(this.ts,this.bl));0!=this.mode?(this.g=0.5*(this.f-1/this.f),this.gama=Proj4js.common.asinz(Math.sin(this.alpha)/this.d),this.longc-=Proj4js.common.asinz(this.g*Math.tan(this.gama))/this.bl,this.con=Math.abs(this.lat0),this.con>
Proj4js.common.EPSLN&&Math.abs(this.con-Proj4js.common.HALF_PI)>Proj4js.common.EPSLN?(this.singam=Math.sin(this.gama),this.cosgam=Math.cos(this.gama),this.sinaz=Math.sin(this.alpha),this.cosaz=Math.cos(this.alpha),this.u=0<=this.lat0?this.al/this.bl*Math.atan(Math.sqrt(this.d*this.d-1)/this.cosaz):-(this.al/this.bl)*Math.atan(Math.sqrt(this.d*this.d-1)/this.cosaz)):Proj4js.reportError("omerc:Init:DataError")):(this.sinphi=Math.sin(this.at1),this.ts1=Proj4js.common.tsfnz(this.e,this.lat1,this.sinphi),
this.sinphi=Math.sin(this.lat2),this.ts2=Proj4js.common.tsfnz(this.e,this.lat2,this.sinphi),this.h=Math.pow(this.ts1,this.bl),this.l=Math.pow(this.ts2,this.bl),this.f=this.el/this.h,this.g=0.5*(this.f-1/this.f),this.j=(this.el*this.el-this.l*this.h)/(this.el*this.el+this.l*this.h),this.p=(this.l-this.h)/(this.l+this.h),this.dlon=this.lon1-this.lon2,this.dlon<-Proj4js.common.PI&&(this.lon2-=2*Proj4js.common.PI),this.dlon>Proj4js.common.PI&&(this.lon2+=2*Proj4js.common.PI),this.dlon=this.lon1-this.lon2,
this.longc=0.5*(this.lon1+this.lon2)-Math.atan(this.j*Math.tan(0.5*this.bl*this.dlon)/this.p)/this.bl,this.dlon=Proj4js.common.adjust_lon(this.lon1-this.longc),this.gama=Math.atan(Math.sin(this.bl*this.dlon)/this.g),this.alpha=Proj4js.common.asinz(this.d*Math.sin(this.gama)),Math.abs(this.lat1-this.lat2)<=Proj4js.common.EPSLN?Proj4js.reportError("omercInitDataError"):this.con=Math.abs(this.lat1),this.con<=Proj4js.common.EPSLN||Math.abs(this.con-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN?Proj4js.reportError("omercInitDataError"):
Math.abs(Math.abs(this.lat0)-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN&&Proj4js.reportError("omercInitDataError"),this.singam=Math.sin(this.gam),this.cosgam=Math.cos(this.gam),this.sinaz=Math.sin(this.alpha),this.cosaz=Math.cos(this.alpha),this.u=0<=this.lat0?this.al/this.bl*Math.atan(Math.sqrt(this.d*this.d-1)/this.cosaz):-(this.al/this.bl)*Math.atan(Math.sqrt(this.d*this.d-1)/this.cosaz))},forward:function(b){var d,a,f,e,g;f=b.x;a=b.y;d=Math.sin(a);e=Proj4js.common.adjust_lon(f-this.longc);
f=Math.sin(this.bl*e);Math.abs(Math.abs(a)-Proj4js.common.HALF_PI)>Proj4js.common.EPSLN?(d=Proj4js.common.tsfnz(this.e,a,d),d=this.el/Math.pow(d,this.bl),g=0.5*(d-1/d),d=(g*this.singam-f*this.cosgam)/(0.5*(d+1/d)),a=Math.cos(this.bl*e),1E-7>Math.abs(a)?f=this.al*this.bl*e:(f=this.al*Math.atan((g*this.cosgam+f*this.singam)/a)/this.bl,0>a&&(f+=Proj4js.common.PI*this.al/this.bl))):(d=0<=a?this.singam:-this.singam,f=this.al*a/this.bl);Math.abs(Math.abs(d)-1)<=Proj4js.common.EPSLN&&Proj4js.reportError("omercFwdInfinity");
e=0.5*this.al*Math.log((1-d)/(1+d))/this.bl;f-=this.u;d=this.y0+f*this.cosaz-e*this.sinaz;b.x=this.x0+e*this.cosaz+f*this.sinaz;b.y=d;return b},inverse:function(b){var d,a,f,e;b.x-=this.x0;b.y-=this.y0;d=b.x*this.cosaz-b.y*this.sinaz;f=b.y*this.cosaz+b.x*this.sinaz;f+=this.u;a=Math.exp(-this.bl*d/this.al);d=0.5*(a-1/a);a=0.5*(a+1/a);f=Math.sin(this.bl*f/this.al);e=(f*this.cosgam+d*this.singam)/a;Math.abs(Math.abs(e)-1)<=Proj4js.common.EPSLN?(d=this.longc,e=0<=e?Proj4js.common.HALF_PI:-Proj4js.common.HALF_PI):
(a=1/this.bl,e=Math.pow(this.el/Math.sqrt((1+e)/(1-e)),a),e=Proj4js.common.phi2z(this.e,e),d=this.longc-Math.atan2(d*this.cosgam-f*this.singam,a)/this.bl,d=Proj4js.common.adjust_lon(d));b.x=d;b.y=e;return b}};
Proj4js.Proj.lcc={init:function(){this.lat2||(this.lat2=this.lat0);this.k0||(this.k0=1);if(Math.abs(this.lat1+this.lat2)<Proj4js.common.EPSLN)Proj4js.reportError("lcc:init: Equal Latitudes");else{var b=this.b/this.a;this.e=Math.sqrt(1-b*b);var b=Math.sin(this.lat1),d=Math.cos(this.lat1),d=Proj4js.common.msfnz(this.e,b,d),a=Proj4js.common.tsfnz(this.e,this.lat1,b),f=Math.sin(this.lat2),e=Math.cos(this.lat2),e=Proj4js.common.msfnz(this.e,f,e),f=Proj4js.common.tsfnz(this.e,this.lat2,f),g=Proj4js.common.tsfnz(this.e,
this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>Proj4js.common.EPSLN?Math.log(d/e)/Math.log(a/f):b;this.f0=d/(this.ns*Math.pow(a,this.ns));this.rh=this.a*this.f0*Math.pow(g,this.ns);this.title||(this.title="Lambert Conformal Conic")}},forward:function(b){var d=b.x,a=b.y;if(!(90>=a&&-90<=a&&180>=d&&-180<=d))return Proj4js.reportError("lcc:forward: llInputOutOfRange: "+d+" : "+a),null;var f=Math.abs(Math.abs(a)-Proj4js.common.HALF_PI);if(f>Proj4js.common.EPSLN)a=Proj4js.common.tsfnz(this.e,
a,Math.sin(a)),a=this.a*this.f0*Math.pow(a,this.ns);else{f=a*this.ns;if(0>=f)return Proj4js.reportError("lcc:forward: No Projection"),null;a=0}d=this.ns*Proj4js.common.adjust_lon(d-this.long0);b.x=this.k0*a*Math.sin(d)+this.x0;b.y=this.k0*(this.rh-a*Math.cos(d))+this.y0;return b},inverse:function(b){var d,a,f,e=(b.x-this.x0)/this.k0,g=this.rh-(b.y-this.y0)/this.k0;0<this.ns?(d=Math.sqrt(e*e+g*g),a=1):(d=-Math.sqrt(e*e+g*g),a=-1);f=0;0!=d&&(f=Math.atan2(a*e,a*g));if(0!=d||0<this.ns){if(a=1/this.ns,
d=Math.pow(d/(this.a*this.f0),a),d=Proj4js.common.phi2z(this.e,d),-9999==d)return null}else d=-Proj4js.common.HALF_PI;f=Proj4js.common.adjust_lon(f/this.ns+this.long0);b.x=f;b.y=d;return b}};
Proj4js.Proj.laea={S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4,init:function(){var b=Math.abs(this.lat0);this.mode=Math.abs(b-Proj4js.common.HALF_PI)<Proj4js.common.EPSLN?0>this.lat0?this.S_POLE:this.N_POLE:Math.abs(b)<Proj4js.common.EPSLN?this.EQUIT:this.OBLIQ;if(0<this.es)switch(this.qp=Proj4js.common.qsfnz(this.e,1),this.mmf=0.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(0.5*this.qp);this.dd=1/this.rq;this.xmf=
1;this.ymf=0.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(0.5*this.qp),b=Math.sin(this.lat0),this.sinb1=Proj4js.common.qsfnz(this.e,b)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*b*b)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode==this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(b){var d,a,f=b.x,e=b.y,f=Proj4js.common.adjust_lon(f-this.long0);if(this.sphere){var g,
h,k;k=Math.sin(e);h=Math.cos(e);g=Math.cos(f);switch(this.mode){case this.OBLIQ:case this.EQUIT:a=this.mode==this.EQUIT?1+h*g:1+this.sinph0*k+this.cosph0*h*g;if(a<=Proj4js.common.EPSLN)return Proj4js.reportError("laea:fwd:y less than eps"),null;a=Math.sqrt(2/a);d=a*h*Math.sin(f);a*=this.mode==this.EQUIT?k:this.cosph0*k-this.sinph0*h*g;break;case this.N_POLE:g=-g;case this.S_POLE:if(Math.abs(e+this.phi0)<Proj4js.common.EPSLN)return Proj4js.reportError("laea:fwd:phi < eps"),null;a=Proj4js.common.FORTPI-
0.5*e;a=2*(this.mode==this.S_POLE?Math.cos(a):Math.sin(a));d=a*Math.sin(f);a*=g}}else{var l=h=0,p=0;g=Math.cos(f);f=Math.sin(f);k=Math.sin(e);k=Proj4js.common.qsfnz(this.e,k);if(this.mode==this.OBLIQ||this.mode==this.EQUIT)h=k/this.qp,l=Math.sqrt(1-h*h);switch(this.mode){case this.OBLIQ:p=1+this.sinb1*h+this.cosb1*l*g;break;case this.EQUIT:p=1+l*g;break;case this.N_POLE:p=Proj4js.common.HALF_PI+e;k=this.qp-k;break;case this.S_POLE:p=e-Proj4js.common.HALF_PI,k=this.qp+k}if(Math.abs(p)<Proj4js.common.EPSLN)return Proj4js.reportError("laea:fwd:b < eps"),
null;switch(this.mode){case this.OBLIQ:case this.EQUIT:p=Math.sqrt(2/p);a=this.mode==this.OBLIQ?this.ymf*p*(this.cosb1*h-this.sinb1*l*g):(p=Math.sqrt(2/(1+l*g)))*h*this.ymf;d=this.xmf*p*l*f;break;case this.N_POLE:case this.S_POLE:0<=k?(d=(p=Math.sqrt(k))*f,a=g*(this.mode==this.S_POLE?p:-p)):d=a=0}}b.x=this.a*d+this.x0;b.y=this.a*a+this.y0;return b},inverse:function(b){b.x-=this.x0;b.y-=this.y0;var d=b.x/this.a,a=b.y/this.a,f;if(this.sphere){var e=0,g,h=0;g=Math.sqrt(d*d+a*a);f=0.5*g;if(1<f)return Proj4js.reportError("laea:Inv:DataError"),
null;f=2*Math.asin(f);if(this.mode==this.OBLIQ||this.mode==this.EQUIT)h=Math.sin(f),e=Math.cos(f);switch(this.mode){case this.EQUIT:f=Math.abs(g)<=Proj4js.common.EPSLN?0:Math.asin(a*h/g);d*=h;a=e*g;break;case this.OBLIQ:f=Math.abs(g)<=Proj4js.common.EPSLN?this.phi0:Math.asin(e*this.sinph0+a*h*this.cosph0/g);d=d*h*this.cosph0;a=(e-Math.sin(f)*this.sinph0)*g;break;case this.N_POLE:a=-a;f=Proj4js.common.HALF_PI-f;break;case this.S_POLE:f-=Proj4js.common.HALF_PI}d=0!=a||this.mode!=this.EQUIT&&this.mode!=
this.OBLIQ?Math.atan2(d,a):0}else{f=0;switch(this.mode){case this.EQUIT:case this.OBLIQ:d/=this.dd;a*=this.dd;h=Math.sqrt(d*d+a*a);if(h<Proj4js.common.EPSLN)return b.x=0,b.y=this.phi0,b;g=2*Math.asin(0.5*h/this.rq);e=Math.cos(g);d*=g=Math.sin(g);this.mode==this.OBLIQ?(f=e*this.sinb1+a*g*this.cosb1/h,a=h*this.cosb1*e-a*this.sinb1*g):(f=a*g/h,a=h*e);break;case this.N_POLE:a=-a;case this.S_POLE:f=d*d+a*a;if(!f)return b.x=0,b.y=this.phi0,b;f=1-f/this.qp;this.mode==this.S_POLE&&(f=-f)}d=Math.atan2(d,a);
f=this.authlat(Math.asin(f),this.apa)}b.x=Proj4js.common.adjust_lon(this.long0+d);b.y=f;return b},P00:0.3333333333333333,P01:0.17222222222222222,P02:0.10257936507936508,P10:0.06388888888888888,P11:0.0664021164021164,P20:0.016415012942191543,authset:function(b){var d,a=[];a[0]=b*this.P00;d=b*b;a[0]+=d*this.P01;a[1]=d*this.P10;d*=b;a[0]+=d*this.P02;a[1]+=d*this.P11;a[2]=d*this.P20;return a},authlat:function(b,d){var a=b+b;return b+d[0]*Math.sin(a)+d[1]*Math.sin(a+a)+d[2]*Math.sin(a+a+a)}};
Proj4js.Proj.aeqd={init:function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)},forward:function(b){var d=b.x,a,f=Math.sin(b.y),e=Math.cos(b.y),d=Proj4js.common.adjust_lon(d-this.long0),g=Math.cos(d),h=this.sin_p12*f+this.cos_p12*e*g;if(Math.abs(Math.abs(h)-1)<Proj4js.common.EPSLN){if(a=1,0>h){Proj4js.reportError("aeqd:Fwd:PointError");return}}else a=Math.acos(h),a/=Math.sin(a);b.x=this.x0+this.a*a*e*Math.sin(d);b.y=this.y0+this.a*a*(this.cos_p12*f-this.sin_p12*e*g);return b},
inverse:function(b){b.x-=this.x0;b.y-=this.y0;var d=Math.sqrt(b.x*b.x+b.y*b.y);if(d>2*Proj4js.common.HALF_PI*this.a)Proj4js.reportError("aeqdInvDataError");else{var a=d/this.a,f=Math.sin(a),a=Math.cos(a),e=this.long0,g;if(Math.abs(d)<=Proj4js.common.EPSLN)g=this.lat0;else{g=Proj4js.common.asinz(a*this.sin_p12+b.y*f*this.cos_p12/d);var h=Math.abs(this.lat0)-Proj4js.common.HALF_PI;Math.abs(h)<=Proj4js.common.EPSLN?e=0<=this.lat0?Proj4js.common.adjust_lon(this.long0+Math.atan2(b.x,-b.y)):Proj4js.common.adjust_lon(this.long0-
Math.atan2(-b.x,b.y)):(h=a-this.sin_p12*Math.sin(g),Math.abs(h)<Proj4js.common.EPSLN&&Math.abs(b.x)<Proj4js.common.EPSLN||(Math.atan2(b.x*f*this.cos_p12,h*d),e=Proj4js.common.adjust_lon(this.long0+Math.atan2(b.x*f*this.cos_p12,h*d))))}b.x=e;b.y=g;return b}}};
Proj4js.Proj.moll={init:function(){},forward:function(b){for(var d=b.y,a=Proj4js.common.adjust_lon(b.x-this.long0),f=d,e=Proj4js.common.PI*Math.sin(d),g=0;;g++){var h=-(f+Math.sin(f)-e)/(1+Math.cos(f)),f=f+h;if(Math.abs(h)<Proj4js.common.EPSLN)break;50<=g&&Proj4js.reportError("moll:Fwd:IterationError")}f/=2;Proj4js.common.PI/2-Math.abs(d)<Proj4js.common.EPSLN&&(a=0);d=0.900316316158*this.a*a*Math.cos(f)+this.x0;f=1.4142135623731*this.a*Math.sin(f)+this.y0;b.x=d;b.y=f;return b},inverse:function(b){var d;
b.x-=this.x0;d=b.y/(1.4142135623731*this.a);0.999999999999<Math.abs(d)&&(d=0.999999999999);d=Math.asin(d);var a=Proj4js.common.adjust_lon(this.long0+b.x/(0.900316316158*this.a*Math.cos(d)));a<-Proj4js.common.PI&&(a=-Proj4js.common.PI);a>Proj4js.common.PI&&(a=Proj4js.common.PI);d=(2*d+Math.sin(2*d))/Proj4js.common.PI;1<Math.abs(d)&&(d=1);d=Math.asin(d);b.x=a;b.y=d;return b}};function WMTSLayer(b,d,a,f){function e(b){b=b.Contents.TileMatrixSet;if("undefined"!=typeof b.length)for(var d=0;d<b.length;d++){var e=b[d]["ows:Identifier"];if(e&&e==a.matrixSet){G=b[d];break}G=b[0]}else G=b;return G}var g=f.left,h=f.top,k=f.right,l=f.bottom,p="auto",m=[],n=document.createElement("div"),u,s=!1,q=this,w=0,C=0,B=0,H=0,A=1;f.opacity&&(A=f.opacity);var I=0,G=null;n.style.position="absolute";n.style.left="0px";n.style.top="0px";n.style.width="100%";n.style.height="100%";document.createElement("img");
var D;this.getMatrixSetId=function(){return G["ows:Identifier"]};this.getThemeTile=function(){};this.setTileOpacity=function(a){if("number"==typeof a)for(A=a,a=0;a<m.length;a++)for(var b=0;b<m[a].length;b++)null!=m[a][b]&&(m[a][b].style.opacity=A,m[a][b].style.filter="alpha(opacity="+100*A+")")};this.setZIndex=function(a){p=a;n&&(n.style.zIndex=p)};this.getZIndex=function(){return p};this.RemoveSelf=function(){u.getHObject().removeChild(n)};this.getTiles=function(d,f,g,h,m,k){TGOS.getJSON(b,function(l){var n=
l.Capabilities,q=l=0,p=[],s=[];if(!n)throw"Service Error";var n=e(n),u=n.TileMatrix[m].TopLeftCorner,A=parseFloat(u.split(" ")[0]),w=parseFloat(u.split(" ")[1]),u=parseFloat(n.TileMatrix[m].ScaleDenominator),D=0.07168*u,B,A=d<A?0:Math.floor((d-A)/D);B=A+Math.ceil(Math.abs(d-g)/D);w=f>w?0:Math.floor((w-f)/D)-1;D=w+Math.ceil(Math.abs(h-f)/D);idxRange={lowerX:A,upperX:B,lowerY:w,upperY:D};for(D=idxRange.lowerY;D<idxRange.upperY;D++)for(A=idxRange.lowerX;A<idxRange.upperX;A++)l+=A*u,q+=D*u,s.push(l+","+
q),p.push(b+"?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&Layer="+a.layer+"&Style=default&Format=image/png&TileMatrixSet="+a.matrixSet+"&TileMatrix="+n.TileMatrix[m]["ows:Identifier"]+"&TileRow="+D+"&TileCol="+A);k.call(this,{leftTopAnchor:s,imageUrl:p})},TGOS.PROXY_SERVICE2)};this.Initialize=function(a){u=a;n.style.zIndex=this.getZIndex();u.getHObject().appendChild(n);TGOS.getJSON(b,function(a){D=a.Capabilities;if(!D)throw"Service Error";e(D);f&&(g=f.left,k=f.right,h=f.top,l=f.bottom);s=!0;q.RebuildElement()},
TGOS.PROXY_SERVICE2)};this.UpdateElement=function(){if(s&&G)for(var a=G.TileMatrix[I].TopLeftCorner,b=parseFloat(a.split(" ")[0]),a=parseFloat(a.split(" ")[1]),b=u.FromMapPoint(b,a),a=0;a<m.length;a++)for(var d=0;d<m[a].length;d++){var e=256*m[a][d].yIdx;m[a][d].style.left=b.x+256*m[a][d].xIdx+"px";m[a][d].style.top=b.y+e+"px"}};this.putVisible=function(a){n.style.display=a?"inline":"none"};this.RebuildElement=function(){if(s&&G){for(var d=u.ToMapDistX(256),e=0,f=Infinity,t=0;t<G.TileMatrix.length;t++){var v=
0.07168*parseFloat(G.TileMatrix[t].ScaleDenominator),v=Math.abs(v-d);v<f&&(f=v,e=t)}if(!(f>d/2)){var f=G.TileMatrix[e].TopLeftCorner,v=parseFloat(f.split(" ")[0]),t=parseFloat(f.split(" ")[1]),f=u.FromMapPoint(v,t),q=u.ToMapPoint(0,0),E=u.ToMapPoint(u.getClientWidth(),u.getClientHeight()),p,D,U,Y,M;p=q.x<v?0:Math.floor((g-v)/d);D=p+Math.ceil(Math.abs(g-k)/d);U=q.y>t?0:Math.floor((t-h)/d);Y=U+Math.ceil(Math.abs(l-h)/d);M=q.x<v?0:Math.floor((q.x-v)/d);v=M+Math.ceil(Math.abs(q.x-E.x)/d);t=q.y>t?0:Math.floor((t-
q.y)/d);q=t+Math.ceil(Math.abs(E.y-q.y)/d);d=Math.max(M,p);D=Math.min(v,D);t=Math.max(t,U);Y=Math.min(q,Y);if(w!=d||C!=D||B!=t||H!=Y||e!=I){w=d;C=D;B=t;H=Y;I=e;parseFloat(G.TileMatrix[e].MatrixWidth);parseFloat(G.TileMatrix[e].MatrixHeight);var N;U=[];q=p=0;for(E=t;E<=Y;E++){U.push([]);for(M=d;M<=D;M++)v=f.x+256*M,t=f.y+256*E,N=document.createElement("img"),N.style.display="none",N.onload=function(){var a=this,b=0;a.style.opacity=b;var d=A/7,e=setInterval(function(){b>=A?(N.style.filter="alpha(opacity="+
100*A+")",a.style.opacity=A,clearInterval(e)):(a.style.opacity=b,a.style.filter="alpha(opacity="+100*b+")",b+=d)},33);a.style.filter="alpha(opacity=0)";this.style.display="block"},N.xIdx=M,N.yIdx=E,N.style.position="absolute",N.style.left=v+"px",N.style.top=t+"px",N.galleryImg=!1,N.hideFocus=!0,N.style.MozUserSelect="none",N.border="0px",U[q].push(N),N.src=b+"?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&Layer="+a.layer+"&Style=default&Format=image/png&TileMatrixSet="+a.matrixSet+"&TileMatrix="+G.TileMatrix[e]["ows:Identifier"]+
"&TileRow="+E+"&TileCol="+M,n.appendChild(N),N.style.opacity=A,N.style.filter="alpha(opacity="+100*A+")",p++;q++}if(0<m.length){for(E=0;E<m.length;E++){for(M=0;M<m[E].length;M++)n.removeChild(m[E][M]);m[E][M]=null}m=[]}m=U}}}}};(function(){var b=function(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom;this.src=b.src;this.width=b.width;this.height=b.height;this.layer=b.layer;this.cancel=this.loaded=!1;this.node=document.createElement("img");this.node.style.position="absolute";this.setSource=function(a){this.loaded=!1;this.node.src=a};var a=this;this.node.onload=function(){a.cancel?a.loaded=!1:(a.loaded=!0,b.onload&&b.onload.call(a))};this.src&&(this.node.src=this.src);"number"==typeof this.width&&
(this.node.width=this.width);"number"==typeof this.height&&(this.node.height=this.height);this.destroy=function(){this.node&&this.node.parentNode&&this.node.parentNode.removeChild(this.node)}};TGOS.TGWmsLayer=function(d,a,f){function e(){if(l){var a=k.getClientWidth(),b=k.getClientHeight(),d=k.ToMapPoint(0,0),e=k.ToMapPoint(a,b);g();switch(l.getCoordSys()){case TGOS.TGCoordSys.EPSG3857:d=TGOS.GooToWGS84(d.x,d.y);e=TGOS.GooToWGS84(e.x,e.y);console.log(d);console.log(e);break;case TGOS.TGCoordSys.EPSG3826:0>
C.indexOf("3826")&&(0<=C.indexOf("3825")?(d=TGOS.TWD97toTWD97_119(d.x,d.y),e=TGOS.TWD97toTWD97_119(e.x,e.y)):0<=C.indexOf("4326")&&(d=TGOS.TWD97toWGS84(d.x,d.y),e=TGOS.TWD97toWGS84(e.x,e.y)));break;case TGOS.TGCoordSys.EPSG3825:0>C.indexOf("3825")&&(0<=C.indexOf("3826")?(d=TGOS.TWD97_119toTWD97(d.x,d.y),e=TGOS.TWD97_119toTWD97(e.x,e.y)):0<=C.indexOf("4326")&&(d=TGOS.TWD97_119toWGS84(d.x,d.y),e=TGOS.TWD97_119toWGS84(e.x,e.y)))}var f=d.x,n=e.y,q=e.x,p=d.y;"1.3.0"==w&&0>C.indexOf("CRS:84")&&0<=C.indexOf("EPSG:4326")&&
(f=e.y,n=d.x,q=d.y,p=e.x);a=h+"?BBOX="+(f+","+n+","+q+","+p)+"&WIDTH="+a+"&HEIGHT="+b+"&SIZE="+a+","+b;a+="&"+B.join("&");m&&(a=m+"?"+a);return a}}function g(){if(l){var a=k.getClientWidth(),b=k.getClientHeight(),d=k.ToMapPoint(0,0),e=k.ToMapPoint(a,b);console.log(d);console.log(e);return{left:d.x,top:d.y,right:e.x,bottom:e.y,width:a,height:b}}}var h,k,l=null,p=!0,m,n="auto",u,s=1,l=a.map,q=l.getPanes().overlayviewLayer;a&&(void 0!==a.opacity&&"number"==typeof a.opacity&&(s=a.opacity),void 0!==a.visible&&
"boolean"==typeof a.visible&&(p=a.visible),void 0!==a.zIndex&&"number"==typeof a.zIndex&&(n=a.zIndex),void 0!==a.container&&(q=a.container),void 0!==a.proxy&&(m=0<a.proxy.indexOf("?")?a.proxy.slice(0,a.proxy.indexOf("?")):a.proxy));var w="VERSION=1.3.0",C="",B=[];f=d;if(-1<f.indexOf("?")){var H=f.indexOf("?");d=f.substring(0,H);H=f.substr(H+1,f.length-H);f=d;f=H.split("&");for(H=0;H<f.length;H++)0<=f[H].toUpperCase().indexOf("BBOX")&&!(0<=f[H].toUpperCase().indexOf("BBOXSR"))||0<=f[H].toUpperCase().indexOf("WIDTH")||
0<=f[H].toUpperCase().indexOf("HEIGHT")||(0<=f[H].toUpperCase().indexOf("VERSION")&&(w=f[H].toUpperCase()),0<=f[H].toUpperCase().indexOf("CRS")&&(C=f[H].toUpperCase()),B.push(f[H]))}var A;this.moveToTop=function(){q&&(q.removeChild(A),q.appendChild(A))};this.moveLayerTo=function(a){if(q&&layerContainer){var b=q.childNodes.length,d=null;a&&(0>a?d=q.firstChild:a>=b||(d=q.childNodes[a]));q.removeChild(layerContainer);d?q.insertBefore(layerContainer,d):q.appendChild(layerContainer)}};this.RemoveSelf=
function(){q&&A&&q.removeChild(A)};this.getLayerId=function(){return layerID};this.getNode=function(){return A};this.getDefaultViewport=function(){};this.getUrl=function(){return h};this.removeWmsLayer=function(){l.removeLayer(this)};this.getZIndex=function(){return n};this.setZIndex=function(a){n=a;A&&(A.style.zIndex=n)};this.getWmsVisible=function(){return this.getVisible()};this.getVisible=function(){return p};this.setWmsVisible=function(a){this.setVisible(a)};this.setVisible=function(a){p=a;A&&
(A.style.display=p?"block":"none")};this.putVisible=function(a){this.setVisible(a)};this.setProxy=function(a){a&&(m=0<a.indexOf("?")?a.slice(0,a.indexOf("?")):a)};this.getProxy=function(){return m};var I=function(a){if(a){var b=k.FromMapPoint(a.left,a.top);a.node.style.left=b.x+"px";a.node.style.top=b.y+"px"}};this.setOpacity=function(a){if(A){var b=parseInt(100*a);A.style.filter="alpha(opacity="+b+")";A.style.opacity=a}s=a};this.getOpacity=function(){return s};var G,D;this.UpdateElement=function(){var a=
k.getScale(),b=u/a;D&&(D.node.width/=b,D.node.height/=b);I(G);I(D);u=a};this.RebuildElement=function(){var a=this;this.temp&&!this.temp.loaded&&(this.temp.cancel=!0);var d=g();this.temp=new b({left:d.left,right:d.right,top:d.top,bottom:d.bottom,width:d.width,height:d.height,src:e(),onload:function(){G=D;A.appendChild(a.temp.node);D=a.temp;G&&G.destroy();a.temp=null;TGOS.TGEvent.trigger(a,"image_loaded")}})};A=document.createElement("div");A.style.position="absolute";A.style.left="0px";A.style.top=
"0px";A.style.width="100%";A.style.height="100%";A.className="TGOS_WMS";A.style.zIndex=n;"number"==typeof a.opacity&&(s=a.opacity);A.style.opacity=s;parseInt(100*s);k=l.getMapBase();h=0<d.indexOf("?")?d.slice(0,d.indexOf("?")):d;q.appendChild(A);l.addLayer(this,!0)};TGOS.RegisterEvent(TGOS.TGWmsLayer,["image_loaded"])})();
TGOS.WMSLayer=function(b,d,a,f,e,g,h){function k(a){var b=null,e="",f="",g=0;a&&(e=GetXMLNodeAttribute(a,"Name"),g=parseInt(GetXMLNodeAttribute(a,"FeatureType")),f=GetXMLNodeAttribute(a,"SRName"));var h=e;if(a=FindXMLNodes(GetXMLChildNode(a,"Fields"),"Field"))for(var b=[],m=0;m<a.length;m++)b.push(GetXMLNodeAttribute(a.item(m),"Name"));this.getName=function(){return e};this.putName=function(a){e=a};this.getTitle=function(){return h};this.putTitle=function(a){h=a};this.getFields=function(){return b};
this.getFeatureType=function(){return g};this.getSRName=function(){return f};this.ExecuteQuery=function(a,b,e,f){window.open(d+"/Query?V="+U+"&S="+Y.valueOf()+"&Layer="+escape(this.getName())+(b?"&GEOM=":"&EXPR=")+escape(a));pAgent=new AjaxAgent(d+"/Query",!0,!0);pAgent.SendRequest("V="+U+"&S="+Y.valueOf()+"&Layer="+escape(this.getName())+(b?"&GEOM=":"&EXPR=")+escape(a),e,null,f)};this.ExecuteUpdate=function(a,b,e,f,g){window.open(d+"/Update?V="+U+"&S="+Y.valueOf()+"&Layer="+escape(this.getName())+
"&ID="+a+"&GEOM="+b+"&Values="+e);pAgent=new AjaxAgent(d+"/Update",!1,!0);pAgent.SendRequest("V="+U+"&S="+Y.valueOf()+"&Layer="+escape(this.getName())+"&ID="+a+"&GEOM="+b+"&Values="+e,f,null,g);Reget()};this.ExecuteDelete=function(a,b,e){pAgent=new AjaxAgent(d+"/Delete",!1,!0);pAgent.SendRequest("V="+U+"&S="+Y.valueOf()+"&Layer="+escape(this.getName())+"&ID="+a,b,null,e);Reget()}}var l=new MercatorProjection(0,0,0,1),p=new HorizontalDatum(6378137,0),m=this,n=null,u=b,s=b,q=g.left,w=g.top,C=g.right,
B=g.bottom,H=!0,A=a,I=null==e?TGOS.WMSLayer.enumCoordinate.TWD97:e,G=null==f?TGOS.WMSLayer.enumCoordinate.TWD97:f,D="auto",J=[];if(-1<A.indexOf("?"))for(a=A.indexOf("?"),b=A.substring(0,a),a=A.substr(a+1,A.length-a),A=b,b=a.split("&"),a=0;a<b.length;a++)0!=b[a].toUpperCase().indexOf("BBOX")&&0!=b[a].toUpperCase().indexOf("WIDTH")&&0!=b[a].toUpperCase().indexOf("HEIGHT")&&J.push(b[a]);var K=0,F=0,t=0,v=0,z=0,E=0,L=0,P=0,U=0,Y=new Date,M=null,N=[],Q=null,$=100;this.setZIndex=function(a){D=a;M&&(M.style.zIndex=
D)};this.getZIndex=function(){return D};this.getName=function(){return u};this.putName=function(a){u=a};this.getTitle=function(){return s};this.putTitle=function(a){s=a};this.getVisible=function(){return H};this.putVisible=function(a){H=a;M&&(M.style.visibility=a?"":"hidden")};this.putTransparent=function(a){$=a;this.SetTransparent(a)};this.putShpPath=function(a){m_shpPath=a};this.putLabelName=function(a){};this.getLeft=function(){return q};this.getTop=function(){return w};this.getRight=function(){return C};
this.getBottom=function(){return B};this.getLayers=function(){return N};this.getThematicLayer=function(){return Q};this.Initialize=function(a){n=a;a=n.getHObject();M=a.ownerDocument.createElement("img");a.appendChild(M);M.galleryImg=!1;M.hideFocus=!0;M.style.MozUserSelect="none";M.border="0px";M.style.position="absolute";M.style.width="100%";M.style.height="100%";M.style.zIndex=D;M.style.visibility=H?"":"hidden";M.onmousedown=function(){return!1};M.galleryImg=!1;this.SetTransparent($)};this.RemoveSelf=
function(){null!=M&&(null!=n&&n.getHObject().removeChild(M),M=null)};this.SetTransparent=function(a){if(M){var b=parseFloat(a,10)/100;M.style.filter="alpha(opacity="+a+")";M.style.opacity=b}};this.UpdateElement=function(){var a,b;"97"!=h?(a=l.Forward(p,new CPoint3(parseFloat(K),parseFloat(F),0)),b=l.Forward(p,new CPoint3(parseFloat(t),parseFloat(v),0)),a=n.FromMapPoint(a.X,a.Y),b=n.FromMapPoint(b.X,b.Y)):(a=n.FromMapPoint(K,F),b=n.FromMapPoint(t,v));M.style.zIndex=D;M.style.width=parseInt(Math.abs(b.x-
a.x))+"px";M.style.height=parseInt(Math.abs(b.y-a.y))+"px";M.style.left=Math.round(Math.min(a.x,b.x))+"px";M.style.top=Math.round(Math.min(a.y,b.y))+"px"};var T=function(){if("complete"==M.readyState||M.complete&&null==M.readyState)"MSIE"==DeviceTest()?DetachEvent(M,"readystatechange",T,!1):DetachEvent(M,"load",T,!1),K=z,F=E,t=L,v=P,m.UpdateElement&&m.UpdateElement()};this.RebuildElement=function(){if(!1!=this.getVisible()){var a=n.FromMapPoint(q,w),b=n.FromMapPoint(C,B);0>a.x?a.x=0:a.x>n.getClientWidth()&&
(a.x=n.getClientWidth());0>a.y?a.y=0:a.y>n.getClientHeight()&&(a.y=n.getClientHeight());0>b.x?b.x=0:b.x>n.getClientWidth()&&(b.x=n.getClientWidth());0>b.y?b.y=0:b.y>n.getClientHeight()&&(b.y=n.getClientHeight());if(!(a.x>b.x||a.y>b.y)){var d=n.ToMapPoint(a.x,a.y),e=n.ToMapPoint(b.x,b.y);z=d.x;E=d.y;L=e.x;P=e.y;nWidth=parseInt(b.x-a.x);nHeight=parseInt(b.y-a.y);"MSIE"==DeviceTest()?AttachEvent(M,"readystatechange",T,!1):AttachEvent(M,"load",T,!1);I==G&&(a="?"+J.join("&"),"97"!=h&&(b=l.Inverse(p,new CPoint3(z,
E,0)),d=l.Inverse(p,new CPoint3(L,P,0)),z=b.X,E=b.Y,L=d.X,P=d.Y),a+="&BBOX="+z+","+P+","+L+","+E+"&WIDTH="+nWidth+"&HEIGHT="+nHeight,M.src=A+a)}}};var aa=function(a,b){Q=b};this.CreateLegend=function(a){if(1<N.length)for(var b=0;b<N.length;b++)a.CreateSubLegend(N[b],aa)};this.ExecuteQuery=function(a,b,d,e){if(null!=Q)return Q.ExecuteQuery(a,b,d,e)};this.ExecuteUpdate=function(a,b,d,e,f){if(null!=Q)return Q.ExecuteUpdate(a,b,d,e,f)};this.ExecuteDelete=function(a,b,d){if(null!=Q)return Q.ExecuteDelete(a,
b,d)};this.getFeatureType=function(){if(null!=Q)return Q.getFeatureType()};this.getFields=function(){if(null!=Q)return Q.getFields()};N=[];0==N.length?N.push(new k(null)):1==N.length&&(N[0].putName(""),N[0].putTitle(s));Q=N[N.length-1]};TGOS.WMSLayer.enumCoordinate={WGS84:0,TWD97:1,GOOGLE:2,TWD97_119:3};MapLayer.enumFeatureType={Unknown:0,Point:1,LineString:2,Polygon:3};
function MapLayer(b,d){function a(a){var b=null,e="",g="",h=0;a&&(e=GetXMLNodeAttribute(a,"Name"),h=parseInt(GetXMLNodeAttribute(a,"FeatureType")),g=GetXMLNodeAttribute(a,"SRName"));var m=e;if(a=FindXMLNodes(GetXMLChildNode(a,"Fields"),"Field"))for(var b=[],k=0;k<a.length;k++)b.push(GetXMLNodeAttribute(a.item(k),"Name"));this.getName=function(){return e};this.putName=function(a){e=a};this.getTitle=function(){return m};this.putTitle=function(a){m=a};this.getFields=function(){return b};this.getFeatureType=
function(){return h};this.getSRName=function(){return g};this.ExecuteQuery=function(a,b,e,f){z=new AjaxAgent(d+"/Query",!0,!0);z.SendRequest("V="+G+"&S="+D.valueOf()+"&Layer="+escape(this.getName())+(b?"&GEOM=":"&EXPR=")+escape(a),e,null,f)};this.ExecuteUpdate=function(a,b,e,g,h){z=new AjaxAgent(d+"/Update",!1,!0);z.SendRequest("V="+G+"&S="+D.valueOf()+"&Layer="+escape(this.getName())+"&ID="+a+"&GEOM="+b+"&Values="+e,g,null,h);f()};this.ExecuteDelete=function(a,b,e){z=new AjaxAgent(d+"/Delete",!1,
!0);z.SendRequest("V="+G+"&S="+D.valueOf()+"&Layer="+escape(this.getName())+"&ID="+a,b,null,e);f()}}function f(){G++;(new AjaxAgent(d,!1,!0)).SendRequest("V="+G+"&S="+D.valueOf(),function(a){a=GetXMLChildNode(a.responseXML.documentElement,"Infomation");a=GetXMLChildNode(a,"Envelope");l=parseFloat(GetXMLNodeAttribute(a,"Left"));p=parseFloat(GetXMLNodeAttribute(a,"Top"));m=parseFloat(GetXMLNodeAttribute(a,"Right"));n=parseFloat(GetXMLNodeAttribute(a,"Bottom"));e.RebuildElement()})}var e=this,g=null,
h=b,k=b,l=0,p=0,m=1,n=1,u=!0,s=0,q=0,w=0,C=0,B=0,H=0,A=0,I=0,G=0,D=new Date,J=null,K=[],F=null;this.getName=function(){return h};this.putName=function(a){h=a};this.getTitle=function(){return k};this.putTitle=function(a){k=a};this.getVisible=function(){return u};this.putVisible=function(a){u=a;J&&(J.style.visibility=a?"":"hidden")};this.getResourcePath=function(){return d};this.getNode=function(){return J};this.getLeft=function(){return l};this.getTop=function(){return p};this.getRight=function(){return m};
this.getBottom=function(){return n};this.getLayers=function(){return K};this.getThematicLayer=function(){return F};this.Initialize=function(a){g=a;a=g.getHObject();J=a.ownerDocument.createElement("img");a.appendChild(J);J.galleryImg=!1;J.hideFocus=!0;J.style.MozUserSelect="none";J.border="0px";J.style.position="absolute";J.style.width="100%";J.style.height="100%";J.style.visibility=u?"":"hidden";J.onmousedown=function(){return!1};J.galleryImg=!1};this.RemoveSelf=function(){null!=J&&(null!=g&&g.getHObject().removeChild(J),
J=null)};this.UpdateElement=function(){var a=g.FromMapPoint(s,q),b=g.FromMapPoint(w,C);J.style.width=parseInt(Math.abs(b.x-a.x))+"px";J.style.height=parseInt(Math.abs(b.y-a.y))+"px";J.style.left=Math.round(Math.min(a.x,b.x))+"px";J.style.top=Math.round(Math.min(a.y,b.y))+"px"};var t=function(){if("complete"==J.readyState||J.complete&&null==J.readyState)"MSIE"==DeviceTest()?DetachEvent(J,"readystatechange",t,!1):DetachEvent(J,"load",t,!1),s=B,q=H,w=A,C=I,e.UpdateElement&&e.UpdateElement()};this.RebuildElement=
function(){if(!1!=this.getVisible()){var a=g.FromMapPoint(l,p),b=g.FromMapPoint(m,n);0>a.x?a.x=0:a.x>g.getClientWidth()&&(a.x=g.getClientWidth());0>a.y?a.y=0:a.y>g.getClientHeight()&&(a.y=g.getClientHeight());0>b.x?b.x=0:b.x>g.getClientWidth()&&(b.x=g.getClientWidth());0>b.y?b.y=0:b.y>g.getClientHeight()&&(b.y=g.getClientHeight());if(!(a.x>b.x||a.y>b.y)){var e=g.ToMapPoint(a.x,a.y),f=g.ToMapPoint(b.x,b.y);B=e.x;H=e.y;A=f.x;I=f.y;nWidth=parseInt(b.x-a.x);nHeight=parseInt(b.y-a.y);a="/GetImage?V="+
G+"&S="+D.valueOf()+"&Width="+nWidth+"&Height="+nHeight+"&Left="+B+"&Top="+H+"&Right="+A+"&Bottom="+I;"MSIE"==DeviceTest()?AttachEvent(J,"readystatechange",t,!1):AttachEvent(J,"load",t,!1);J.src=d+a}}};var v=function(a,b){F=b};this.CreateLegend=function(a){if(1<K.length)for(var b=0;b<K.length;b++)a.CreateSubLegend(K[b],v)};this.ExecuteQuery=function(a,b,d,e){if(null!=F)return F.ExecuteQuery(a,b,d,e)};this.ExecuteUpdate=function(a,b,d,e,f){if(null!=F)return F.ExecuteUpdate(a,b,d,e,f)};this.ExecuteDelete=
function(a,b,d){if(null!=F)return F.ExecuteDelete(a,b,d)};this.getFeatureType=function(){if(null!=F)return F.getFeatureType()};this.getFields=function(){if(null!=F)return F.getFields()};var K=[],z=new AjaxAgent(d,!1,!0);z.SendRequest("V="+G+"&S="+D.valueOf(),function(b){b=GetXMLChildNode(b.responseXML.documentElement,"Infomation");var d=GetXMLChildNode(b,"Envelope");l=parseFloat(GetXMLNodeAttribute(d,"Left"));p=parseFloat(GetXMLNodeAttribute(d,"Top"));m=parseFloat(GetXMLNodeAttribute(d,"Right"));
n=parseFloat(GetXMLNodeAttribute(d,"Bottom"));if(b=FindXMLNodes(GetXMLChildNode(b,"Layers"),"Layer"))for(d=0;d<b.length;d++)K.push(new a(b.item(d)))});0==K.length?K.push(new a(null)):1==K.length&&(K[0].putName(""),K[0].putTitle(k));F=K[K.length-1]};function CPoint3(b,d,a){this.X=b;this.Y=d;this.Z=a;return this}CPoint3.prototype.toString=function(){return"("+this.X+","+this.Y+","+this.Z+")"};CPoint3.prototype.Distance=function(){return Math.sqrt(this.X*this.X+this.Y*this.Y+this.Z*this.Z)};
function GeographicTransform(b,d,a,f,e,g,h){this.BursaWolfTransform=function(k){var l=Math.sin(f),p=Math.cos(f);k=new CPoint3(k.X,p*k.Y+l*k.Z,-l*k.Y+p*k.Z);l=Math.sin(e);p=Math.cos(e);k=new CPoint3(p*k.X-l*k.Z,k.Y,l*k.X+p*k.Z);l=Math.sin(g);p=Math.cos(g);k=new CPoint3(p*k.X+l*k.Y,-l*k.X+p*k.Y,k.Z);return new CPoint3(b+(1+h)*k.X,d+(1+h)*k.Y,a+(1+h)*k.Z)};this.MolodenskyBadekasTransform=function(k){return new CPoint3(b+h*k.X+(k.X+g*k.Y-e*k.Z),d+h*k.Y+(-g*k.X+k.Y+f*k.Z),a+h*k.Z+(e*k.X-f*k.Y+k.Z))};return this}
function HorizontalDatum(b,d){this.SemiMajorAxis=b;this.Flattening=d;this.SemiMinorAxis=this.SemiMajorAxis*(1-this.Flattening);this.es=1-(1-this.Flattening)*(1-this.Flattening);this.et2=this.es/(1-this.es);return this}
HorizontalDatum.prototype.CartesianFromGeodetic=function(b){if(90==b.Y||-90==b.Y)return new CPoint3(0,0,(-90==b.Y?-1:1)*this.SemiMajorAxis*(1-this.es)+b.Z);var d=b.Y*Math.PI/180,a=b.X*Math.PI/180,f=Math.sin(d),e=Math.cos(d),d=this.SemiMajorAxis/Math.sqrt(1-this.es*f*f),g=(d+b.Z)*e*Math.cos(a),a=(d+b.Z)*e*Math.sin(a);return new CPoint3(g,a,((1-this.es)*d+b.Z)*f)};
HorizontalDatum.prototype.GeodeticFromCartesian=function(b){if(0==b.X&&0==b.Y)return new CPoint3(0,0<=b.Z?90:-90,Math.abs(b.Z)-this.SemiMinorAxis);var d=b.X*b.X+b.Y*b.Y,a=Math.sqrt(d),f=1.0026*b.Z,d=Math.sqrt(f*f+d),f=f/d,d=a/d,f=b.Z+this.SemiMinorAxis*this.et2*f*f*f,d=a-this.SemiMajorAxis*this.es*d*d*d,e=Math.sqrt(f*f+d*d),f=f/e,e=d/e,g=this.SemiMajorAxis/Math.sqrt(1-this.es*f*f),d=0,d=0.3826834323650898<=e?a/e-g:-0.3826834323650898>=e?a/-e-g:b.Z/f-g*(1-this.es),a=180*Math.atan(f/e)/Math.PI;b=0!=
b.X?180*Math.atan2(b.Y,b.X)/Math.PI:0<b.Y?90:-90;return new CPoint3(b,a,d)};
function TransverseMercatorProjection(b,d,a,f,e){function g(a,b,d,e){var f,g=(f=e*e)*(0.46875-e*(0.013020833333333334+0.007120768229166667*e)),u=(f*=e)*(0.3645833333333333-0.005696614583333333*e);d*=b;b*=b;return(1-e*(0.25+e*(0.046875+e*(0.01953125+0.01068115234375*e))))*a-d*(e*(0.75-e*(0.046875+e*(0.01953125+0.01068115234375*e)))+b*(g+b*(u+0.3076171875*b*f*e)))}this.centralMeridian=b;this.falseEasting=d;this.falseNorthing=a;this.latitudeOfOrigin=f;this.scaleFactor=e;this.Forward=function(h,k){var l=
CPoint3((k.X-b)*Math.PI/180,k.Y*Math.PI/180,k.Z),p=Math.sin(l.Y),m=Math.cos(l.Y),n=1E-10<Math.abs(m)?p/m:0,n=n*n,u=m*l.X,s=u*u,u=u/Math.sqrt(1-h.es*p*p),q=h.et2*m*m,w=u*(1+s/6*(1-n+q+s/20*(5+n*(n-18)+q*(14-58*n)+s/42*(61+n*(n*(179-n)-479))))),C=f*Math.PI/180,C=g(C,Math.sin(C),Math.cos(C),h.es),p=g(l.Y,p,m,h.es)-C+p*u*l.X/2*(1+s/12*(5-n+q*(9+4*q)+s/30*(61+n*(n-58)+q*(270-330*n)+s/56*(1385+n*(n*(543-n)-3111)))));k=new CPoint3(w,p,l.Z);k.X=k.X*e*h.SemiMajorAxis+d;k.Y=k.Y*e*h.SemiMajorAxis+a;return k};
this.Inverse=function(h,k){var l=CPoint3((k.X-d)/h.SemiMajorAxis/e,(k.Y-a)/h.SemiMajorAxis/e,k.Z),p=f*Math.PI/180,p=g(p,Math.sin(p),Math.cos(p),h.es)+l.Y,m=h.es,n=1/(1-m),u=p,s;for(s=10;s;--s){var q=Math.sin(u),w=1-m*q*q,u=u-(w=(g(u,q,Math.cos(u),m)-p)*w*Math.sqrt(w)*n);if(1E-11>Math.abs(w))break}p=u;m=Math.PI/2;Math.abs(p)>=m?k=new CPoint3(0,0>l.Y?-m:m,l.Z):(s=Math.sin(p),m=Math.cos(p),n=1E-10<Math.abs(m)?s/m:0,u=h.et2*m*m,s=1-h.es*s*s,q=l.X*Math.sqrt(s),s*=n,n*=n,w=q*q,p-=s*w/(1-h.es)/2*(1-w/12*
(5+n*(3-9*u)+u*(1-4*u)-w/30*(61+n*(90-252*u+45*n)+46*u-w/56*(1385+n*(3633+n*(4095+1574*n)))))),k=new CPoint3(q*(1-w/6*(1+2*n+u-w/20*(5+n*(28+24*n+8*u)+6*u-w/42*(61+n*(662+n*(1320+720*n))))))/m,p,l.Z));k.X=180*k.X/Math.PI+b;k.Y=180*k.Y/Math.PI;return k};return this}function CoordinateTransform(b,d,a,f,e,g){d&&(g=d.Inverse(b,g));b&&a&&b!=a&&(g=b.CartesianFromGeodetic(g),e&&(g=e.BursaWolfTransform(g)),g=a.GeodeticFromCartesian(g));f&&(g=f.Forward(a,g));return g};function MercatorProjection(b,d,a,f){function e(a,b,d){b*=d;return Math.tan(0.5*(g-a))/Math.pow((1-b)/(1+b),0.5*d)}this.centralMeridian=b;this.falseEasting=d;this.falseNorthing=a;this.scaleFactor=f;this.Forward=function(k,l){var p=CPoint3((l.X-b)*Math.PI/180,l.Y*Math.PI/180,l.Z);if(0==k.es)if(1E-10>=Math.abs(Math.abs(p.Y)-g))l=null;else{var m=p.X,n=Math.log(Math.tan(h+0.5*p.Y));l=new CPoint3(m,n,p.Z)}else 1E-10>=Math.abs(Math.abs(p.Y)-g)?l=null:(m=p.X,n=-Math.log(e(p.Y,Math.sin(p.Y),Math.sqrt(k.es))),
l=new CPoint3(m,n,p.Z));l.X=l.X*f*k.SemiMajorAxis+d;l.Y=l.Y*f*k.SemiMajorAxis+a;return l};this.Inverse=function(e,h){var p=CPoint3((h.X-d)/e.SemiMajorAxis/f,(h.Y-a)/e.SemiMajorAxis/f,h.Z);if(0==e.es){var m=g-2*Math.atan(Math.exp(-p.Y));h=new CPoint3(p.X,m,p.Z)}else{var m=Math.exp(-p.Y),n=Math.sqrt(e.es),u=0.5*n,s=g-2*Math.atan(m);i=15;do var q=n*Math.sin(s),q=g-2*Math.atan(m*Math.pow((1-q)/(1+q),u))-s,s=s+q;while(1E-10<Math.abs(q)&&--i);h=new CPoint3(p.X,s,p.Z)}h.X=180*h.X/Math.PI+b;h.Y=180*h.Y/Math.PI;
return h};var g=Math.PI/2,h=Math.PI/4;return this};function ScaleTransformation(b){var d=b,a=-b,f=1,e=1;this.getBaseScaleX=function(){return d};this.putBaseScaleX=function(a){d=a};this.getBaseScaleY=function(){return a};this.putBaseScaleY=function(b){a=b};this.getScale=function(){return d*f};this.putScale=function(b){f=b/d;e=b/Math.abs(a)};this.getScaleX=function(){return d*f};this.getScaleY=function(){return a*e}}
function LevelTransformation(b,d,a){var f=b,e=-b,g=d,h=Math.pow(2,g),k=a;this.FitLevel=function(){this.putMapLevel(Math.round(g))};this.getBaseScaleX=function(){return f};this.putBaseScaleX=function(a){f=a};this.getBaseScaleY=function(){return e};this.putBaseScaleY=function(a){e=a};this.getMapMaxLevel=function(){return k};this.putMapMaxLevel=function(a){k=a};this.getMapLevel=function(){return g};this.putMapLevel=function(a){if(g==a)return!0;var b=a>k-1?k-1:0>a?0:a;if((a>=k||0>a)&&g==b)return!1;g=
b;h=Math.pow(2,g);return!0};this.getScale=function(){return f*h};this.putScale=function(a){this.putMapLevel(Math.log(a/f)/Math.LN2)};this.getScaleX=function(){return f*h};this.getScaleY=function(){return e*h}}
function MapBase(b,d){var a,f,e,g,h,k=0,l=0,p=0,m=0,n=null;e=[];g=[];h=null;n=d;a=b.ownerDocument.createElement("div");b.appendChild(a);a.style.position="absolute";a.style.overflow="hidden";a.style.left="0px";a.style.top="0px";a.style.width="100%";a.style.height="100%";a.style.zIndex=0;f=a.ownerDocument.createElement("div");a.appendChild(f);f.style.position="absolute";f.style.left="0px";f.style.top="0px";f.style.width="100%";f.style.height="100%";f.style.zIndex=0;var k=Number(f.clientWidth),l=Number(f.clientHeight),
u,s=FuncAdapter(this,function(){if(k!=Number(f.clientWidth)||l!=Number(f.clientHeight))u&&clearTimeout(u),u=setTimeout(FuncAdapter(this,function(){this.RefreshMap(!0,!0)}),1E3),this.RefreshMap(!1,!1)});AttachEvent(f,"resize",s,!1);this.setColor=function(a){f.style.background=a};this.FinalRelease=function(){this.SelectMapTool(null);this.RemoveAllElements();DetachEvent(f,"resize",s,!1);a.removeChild(a)};this.getHObject=function(){return f};this.getHPackage=function(){return a};this.getClientWidth=function(){return k};
this.getClientHeight=function(){return l};this.getCenterX=function(){return p};this.putCenterX=function(a){p=a};this.getCenterY=function(){return m};this.putCenterY=function(a){m=a};this.getTransformation=function(){return n};this.putScale=function(a){n=a};this.getScale=function(){return n.getScale()};this.putScale=function(a){n.putScale(a)};this.getCellSizeX=function(){return this.ToMapDistX(1)};this.getCellSizeY=function(){return this.ToMapDistY(1)};this.MoveMapTo=function(a,b){this.putCenterX(a);
this.putCenterY(b)};this.ZoomMapTo=function(a){if(null!=a.left&&null!=a.top&&null!=a.right&&null!=a.bottom){this.MoveMapTo((a.right+a.left)/2,(a.bottom+a.top)/2);var b=l/(a.bottom-a.top);this.putScale(Math.min(Math.abs(k/(a.right-a.left)),Math.abs(b)))}};this.getPackageOffset=function(){var b=0,d=0,d=a.getBoundingClientRect(),b=d.left,d=d.top;return new TGOS.TGPoint(b,d)};this.getCursorPosition=function(a){if(null==a)return null;var b=this.getPackageOffset();return new TGOS.TGPoint(a.clientX-b.x,
a.clientY-b.y)};this.ToMapPoint=function(a,b){return new TGOS.TGPoint(this.ToMapDistX(a-k/2)+p,this.ToMapDistY(b-l/2)+m)};this.FromMapPoint=function(a,b){return new TGOS.TGPoint(this.FromMapDistX(a-p)+k/2,this.FromMapDistY(b-m)+l/2)};this.ToMapDistX=function(a){return a/n.getScaleX()};this.ToMapDistY=function(a){return a/n.getScaleY()};this.FromMapDistX=function(a){return a*n.getScaleX()};this.FromMapDistY=function(a){return a*n.getScaleY()};this.SelectMapTool=function(a){if(a){if(a.InitMapEvent)return h&&
h.ExitMapEvent&&h.ExitMapEvent(),a.InitMapEvent(this),h=a,!0}else h&&h.ExitMapEvent&&(h.ExitMapEvent(),h=null);return!1};this.getLayers=function(){return e};this.AddLayer=function(a){null!=a&&(a.Initialize&&a.Initialize(this),e.push(a))};this.RemoveLayer=function(a){var b,d=e.length;for(b=0;b<d;b++)if(e[b]==a){e.splice(b,1);break}a.RemoveSelf&&a.RemoveSelf()};this.RemoveAllLayers=function(){var a,b=e.length;for(a=0;a<b;a++)e[a].RemoveSelf&&e[a].RemoveSelf();e=[]};this.getElements=function(a){return g};
this.AddElement=function(a){a.Initialize&&a.Initialize(this);g.push(a)};this.RemoveElement=function(a){var b,d=g.length;for(b=0;b<d;b++)if(g[b]==a){g.splice(b,1);break}a.RemoveSelf&&a.RemoveSelf()};this.RemoveAllElements=function(){var a,b=g.length;for(a=0;a<b;a++)g[a].RemoveSelf&&g[a].RemoveSelf();g=[]};this.getExtent=function(){for(var a=null,b=null,d=null,f=null,g=0;g<e.length;g++){var h=e[g];h.getLeft&&(null==a||this.FromMapDistX(a)>this.FromMapDistX(h.getLeft()))&&(a=h.getLeft());h.getTop&&(null==
b||this.FromMapDistY(b)>this.FromMapDistY(h.getTop()))&&(b=h.getTop());h.getRight&&(null==d||this.FromMapDistX(d)<this.FromMapDistX(h.getRight()))&&(d=h.getRight());h.getBottom&&(null==f||this.FromMapDistY(f)<this.FromMapDistY(h.getBottom()))&&(f=h.getBottom())}return new TGOS.TGEnvelope(a,b,d,f)};this.RefreshMap=function(a){w=!0;a&&(k=Number(f.clientWidth),l=Number(f.clientHeight));if(e&&0<e.length){var b=e.length;if(a)for(var d=0;d<b;d++)e[d].RebuildElement&&e[d].RebuildElement();for(d=0;d<b;d++)e[d].UpdateElement&&
e[d].UpdateElement(1)}if(g&&0<g.length){b=g.length;if(a)for(d=0;d<b;d++)g[d].RebuildElement&&g[d].RebuildElement();for(d=0;d<b;d++)g[d].UpdateElement&&g[d].UpdateElement(1)}};var q=null,w=!1,C=null,B=null,H=null;this.MoveToAnimation=function(a,b,d){w=!1;C=a.x;B=a.y;H=b;if(null==q){var e=function(){if(!w){var a=this.getCenterX(),b=this.getCenterY(),f=this.getScale();if(5<=this.FromMapDistX(Math.abs(a-C))||5<=this.FromMapDistY(Math.abs(b-B))||0.03125<=Math.abs(Math.log(f/H)))if(this.putScale(2/(1/f+
1/H)),f!=this.getScale()){this.MoveMapTo((a+C)/2,(b+B)/2);this.RefreshMap(!1,!0);w=!1;q=setTimeout(FuncAdapter(this,e),100);return}this.putScale(H);this.MoveMapTo(C,B);this.RefreshMap(!0,!0);w=!1}q=null;d&&d()};e.call(this)}};this.getExtendedClientRect=function(){var a=TGOS.math.length(this.getClientWidth(),this.getClientHeight())/2,b=this.getClientWidth()/2,d=this.getClientHeight()/2;return{xmin:b-a,ymin:d-a,xmax:b+a,ymax:d+a}};this.getExtendedViewport=function(){var a=this.getExtendedClientRect(),
b=this.ToMapPoint(a.xmin,a.ymin),a=this.ToMapPoint(a.xmax,a.ymax);return{xmin:b.x,ymin:a.y,xmax:a.x,ymax:b.y}};this.getTileViewport=function(){var a=Math.floor(Math.abs(this.getAngle())%90),b=TGOS.math.length(this.getClientWidth(),this.getClientHeight())/2,d=(b-this.getClientWidth()/2)*(a/90),b=(b-this.getClientHeight()/2)*(a/90),a=this.ToMapPoint(0-d,0-b),d=this.ToMapPoint(this.getClientWidth()+d,this.getClientHeight()+b);return{xmin:a.x,ymin:d.y,xmax:d.x,ymax:a.y}};this.getAngle=function(){return 0}}
function MapPoint(b,d){this.x=b;this.y=d;this.Diff=function(a){return a.constructor!=TGOS.TGPoint?this:new TGOS.TGPoint(this.x-a.x,this.y-a.y)};this.Plus=function(a){return a.constructor!=TGOS.TGPoint?this:new TGOS.TGPoint(this.x+a.x,this.y+a.y)};this.toString=function(){return this.x+" "+this.y}}
function MapEnvelope(b,d,a,f){this.Left=b;this.Top=d;this.Right=a;this.Bottom=f;this.Extend=function(a){a.constructor==TGOS.TGEnvelope&&(!a.Left||null!=this.Left&&this.Left>a.Left!=this.Right>this.Left||(this.Left=a.Left),!a.Top||null!=this.Top&&this.Top<a.Top!=this.Bottom<this.Top||(this.Top=a.Top),!a.Right||null!=this.Right&&this.Right<a.Right!=this.Left<this.Right||(this.Right=a.Right),!a.Bottom||null!=this.Bottom&&this.Bottom>a.Bottom!=this.Top>this.Bottom||(this.Bottom=a.Bottom))};this.Shrink=
function(a){a.constructor==TGOS.TGEnvelope&&(!a.Left||null!=this.Left&&this.Left<a.Left!=this.Right>this.Left||(this.Left=a.Left),!a.Top||null!=this.Top&&this.Top>a.Top!=this.Bottom<this.Top||(this.Top=a.Top),!a.Right||null!=this.Right&&this.Right>a.Right!=this.Left<this.Right||(this.Right=a.Right),!a.Bottom||null!=this.Bottom&&this.Bottom<a.Bottom!=this.Top>this.Bottom||(this.Bottom=a.Bottom))};this.toString=function(){return Math.min(this.Left,this.Right)+" "+Math.min(this.Top,this.Bottom)+","+
Math.max(this.Left,this.Right)+" "+Math.max(this.Top,this.Bottom)}};function Overview(b,d,a,f,e,g){function h(a,b){var d,e,f=!1;this.ExitMapEvent=null;this.IsMapAction=function(){return f};this.InitMapEvent=function(g){var h=g.getHObject(),m=function(a){var b=a.screenX-d,f=a.screenY-e;d=a.screenX;e=a.screenY;g.MoveMapTo(g.getCenterX()-g.ToMapDistX(b),g.getCenterY()-g.ToMapDistY(f));g.RefreshMap(!1)},k=function(a){DetachEvent(h,"mousemove",m,!0);DetachEvent(h,"mouseup",k,!1);g.RefreshMap(!0);f=!1},l=function(a){util.disableDefault(a);f=!0;d=a.screenX;e=a.screenY;AttachEvent(h,
"mouseup",k,!1);AttachEvent(h,"mousemove",m,!0)},v=function(b){a&&(f=!0,b=g.getCursorPosition(b),b=g.ToMapPoint(b.X,b.Y),g.MoveToAnimation(b,g.getScale(),function(){f=!1}))},n=function(a){if(b){f=!0;var d=g.getCursorPosition(a),d=g.ToMapPoint(d.X,d.Y),e=g.getScale(),h=a.wheelDelta?a.wheelDelta:-a.detail;a=0;0<h?a=1:0>h&&(a=-1);h=1;h=g.getTransformation();h=null!=h&&null!=h.getLevelScale&&null!=h.getMapLevel?h.getLevelScale(h.getMapLevel()+a)/e:Math.pow(2,a);e*=h;d=new MapPoint((g.getCenterX()-d.X)/
h+d.X,(g.getCenterY()-d.Y)/h+d.Y);g.MoveToAnimation(d,e,function(){f=!1})}};this.ExitMapEvent=function(){b&&DetachEvent(h.ownerDocument,"mousewheel",n,!1);DetachEvent(h,"mousedown",l,!1);a&&DetachEvent(h,"dblclick",v,!1)};AttachEvent(h,"mousedown",l,!1);a&&AttachEvent(h,"dblclick",v,!1);b&&AttachEvent(h.ownerDocument,"mousewheel",n,!1)}}function k(a){switch(a){case "Open":b.style.width=f+"px";b.style.height=e+"px";b.style.border="2px solid";l.style.width=f+"px";l.style.height=e+"px";u.alt="Open";
u.src=TGOS.RES_PATH+"ShowClose.gif";u.status=!0;break;case "Close":b.style.width="11px",b.style.height="11px",b.style.border="0px",l.style.width="11px",l.style.height="11px",u.alt="Open",u.src=TGOS.RES_PATH+"ShowOpen.gif",u.status=!1}}var l=null,p=null,m=null,n=null,u,s=null,q=null;this.Show=function(a){a?(b.style.display="inline",k("Open")):b.style.display="none"};this.Minimize=function(){k("Close")};this.FinalRelease=function(){d.RemoveElement(this);n&&n.FinalRelease&&n.FinalRelease();n=null;m&&
m.FinalRelease&&m&&m.FinalRelease&&m.FinalRelease();m=null;p&&b.removeChild(p);p=null};this.CenterXY=function(){return new MapPoint(m.getCenterX(),m.getCenterY())};this.SelectAreaHide=function(){m_IndexObj.style.visibility="hidden"};this.SelectAreaShow=function(){m_IndexObj.style.visibility="visible"};this.getTarget=function(){return d};this.getMapDiv=function(){return p};this.getMapBase=function(){return m};this.UpdateElement=function(){n.UpdateElement()};this.RebuildElement=function(){null!=n&&
n.RebuildElement();if(null!=m){var a=d.getScale()/Math.pow(2,g);m.MoveToAnimation(new MapPoint(d.getCenterX(),d.getCenterY()),a)}};var w=new ScaleTransformation(1);w.putBaseScaleX(a.getBaseScaleX());w.putBaseScaleY(a.getBaseScaleY());l=document.createElement("div");b.appendChild(l);l.style.position="absolute";l.style.right="0px";l.style.bottom="0px";this.setColor=function(a){l.style.backgroundColor=a};this.getZoom=function(){var a=this.getTarget().getTransformation(),b=a.getMapLevel()-g;b>a.getMapMaxLevel()&&
(b=a.getMapMaxLevel());b<a.getMapMinLevel()&&(b=a.getMapMinLevel());return b};l.style.width=f-10+"px";l.style.height=e-10+"px";l.style.overflow="hidden";p=document.createElement("div");l.appendChild(p);p.style.position="absolute";p.style.overflow="hidden";p.style.right="0px";p.style.bottom="0px";p.style.width=f+"px";p.style.height=e+"px";u=l.ownerDocument.createElement("img");u.onreadystatechange=function(){p.style.right=u.offsetWidth-10+"px";p.style.width=f+"px";p.style.height=e+"px";u.onstatechange=
null};l.appendChild(u);u.style.position="absolute";u.style.right="0px";u.style.bottom="0px";u.status=!0;u.alt="Close";u.style.cursor="pointer";var C=null;this.setStyle=function(a){};u.onclick=function(){var a=function(d,e){var f=parseInt(l.style.width),g=parseInt(l.style.height),h=d-f,m=e-g;10>Math.abs(h)||10>Math.abs(m)?(b.style.width=d+"px",b.style.height=e+"px",l.style.width=d+"px",l.style.height=e+"px",b.style.border="0px",C=null,u.status&&(b.style.border="2px solid",b.style.width=d+"px",b.style.height=
e+"px",l.style.width=d+"px",l.style.height=e+"px")):(b.style.width=f+h/2+"px",b.style.height=g+m/2+"px",l.style.width=f+h/2+"px",l.style.height=g+m/2+"px",C=setTimeout(function(){a(d,e)},50))};null!=C&&clearTimeout(C);C=null;(u.status=!u.status)?(u.alt="Close",u.src=TGOS.RES_PATH+"ShowClose.gif",a(f,e)):(u.alt="Open",u.src=TGOS.RES_PATH+"ShowOpen.gif",b.style.border="2px solid",a(parseInt(u.offsetWidth),parseInt(u.offsetHeight)))};m=new MapBase(p,w,"0px","0px","100%","100%");m.MoveMapTo(d.getCenterX(),
d.getCenterY());m.RefreshMap(!0);n=new function(a){var b=a.getTarget(),d=a.getMapBase(),e=!1,f=new h(!1,!1),g=d.getHPackage(),m=document.createElement("div");g.appendChild(m);m.style.position="absolute";m.style.overflow="hidden";m.style.width="40px";m.style.height="40px";m.style.left="15px";m.style.top="15px";m.style.border="inset 1px #0300FA";a=m.ownerDocument.createElement("div");m.appendChild(a);a.style.filter="Alpha(Opacity=35)";a.style.opacity=0.35;a.style.MozOpacity=0.35;a.style.MozUserSelect=
"none";a.style.backgroundColor="#5e38ff";a.style.width="100%";a.style.height="100%";var k,l,n=function(a){var e=a.screenX-k,f=a.screenY-l;k=a.screenX;l=a.screenY;b.MoveMapTo(b.getCenterX()+d.ToMapDistX(e),b.getCenterY()+d.ToMapDistY(f));b.RefreshMap(!1)},v=function(a){m.style.cursor="default";DetachEvent(m,"mousemove",n,!0);DetachEvent(m,"mouseup",v,!1);b.RefreshMap(!0)},p=function(a){util.disableDefault(a);k=a.screenX;l=a.screenY;m.style.cursor="move";AttachEvent(m,"mousemove",n,!0);AttachEvent(m,
"mouseup",v,!1)};AttachEvent(m,"mousedown",p,!1);d.SelectMapTool(f);d.AddElement(this);this.FinalRelease=function(){d.RemoveElement(this);DetachEvent(m,"mousedown",p,!1);f&&f.FinalRelease&&f.FinalRelease();f=null;m&&g.removeChild(m);m=null};this.UpdateElement=function(){if(f.IsMapAction())e||(e=!0,s.x=parseInt(m.style.left)+parseInt(m.style.width)/2,s.y=parseInt(m.style.top)+parseInt(m.style.height)/2,a=d.ToMapPoint(s.x,s.y),b.MoveMapTo(a.x,a.y),b.RefreshMap(!1),e=!1);else{var a=b.ToMapPoint(0,0),
g=b.ToMapPoint(b.getClientWidth(),b.getClientHeight());s=d.FromMapPoint(a.x,a.y);q=d.FromMapPoint(g.x,g.y);s.x&&s.y&&q.x&&q.y&&(m.style.left=s.x+"px",m.style.top=s.y+"px",m.style.width=q.x-s.x+"px",m.style.height=q.y-s.y+"px")}};this.RebuildElement=function(){f.IsMapAction()&&!e&&(e=!0,b.RefreshMap(!0),e=!1)}}(this);d.AddElement(this);this.RebuildElement()};TGOS.CTRL_ZINDEX=214748364;
TGOS.HtmlControl=function(b,d,a,f,e){this.getDiv=function(){return k};this.getPosition=function(){return g};this.setPosition=function(a){var e=b.controls[g].indexOf(k);d in TGOS.TGControlPosition&&(0<=e&&b.controls[g].removeAt(e),b.controls[a].push(k),g=a)};this.setContent=function(a){"string"==typeof a&&(h.innerHTML=a)};this.remove=function(){b.getMapBase().RemoveElement(this);var a=b.controls[g];a.removeAt(a.indexOf(k))};var g=null,h=null,k=null,g=TGOS.TGControlPosition.BOTTOM_LEFT;d in TGOS.TGControlPosition&&
(g=d);k=document.createElement("div");util.disableSelect(k);k.style.width="250px";k.style.height="50px";h=document.createElement("div");k.appendChild(h);h.innerHTML=a;h.style.position="absolute";h.style.fontFamily="calibri,\u5fae\u8edf\u6b63\u9ed1\u9ad4";h.style.fontWeight="600";h.style.left="5px";k.style.position="absolute";this.setPosition(g)};
TGOS.CopyrightControl=function(b,d){this.getDiv=function(){return e};this.getPosition=function(){return a};this.setPosition=function(f){var g=b.controls[a].indexOf(e);d in TGOS.TGControlPosition&&(0<=g&&b.controls[a].removeAt(g),b.controls[f].push(e),a=f)};var a=null,f=null,e=null,g=(new Date).getFullYear(),a=TGOS.TGControlPosition.BOTTOM_LEFT;d in TGOS.TGControlPosition&&(a=d);e=document.createElement("div");util.disableSelect(e);e.style.width="250px";e.style.height="20px";f=document.createElement("div");
e.appendChild(f);f.innerHTML="TGOS \u00a9 "+g+" \u5167\u653f\u90e8";f.style.position="absolute";f.style.fontFamily="calibri,\u5fae\u8edf\u6b63\u9ed1\u9ad4";f.style.fontWeight="900";f.style.left="5px";e.style.position="absolute";this.setPosition(a)};
TGOS.MapTypeBarControl=function(b,d,a,f){function e(a){q=document.createElement("div");q.style.position="absolute";q.style.overflow="hidden";w=document.createElement("table");w.style.borderSpacing="0";w.border="0";q.appendChild(w);for(var d=w.insertRow(-1),e=0;e<a.length;e++)if(a[e]in b.getDocName()){var f=d.insertCell(0);f.width=l+"px";f.height=p+"px";f.style.padding="0px";f.style.backgroundRepeat="no-repeat";f.style.cursor="pointer";f.mapTypeId=a[e];var g=document.createElement("img");f.appendChild(g);
f.imgElem=g;g.mapTypeId=a[e];AttachEvent(g,"click",function(a){a=util.eventTarget(a);if(m.getMapTypeId()!=a.mapTypeId||m.getMapTypeId()==TGOS.TGMapTypeId.NLSCMAP)a.src=k[a.mapTypeId+"_IMG_D"],h(a.mapTypeId)});m.getMapTypeId()==a[e]?g.src=k[a[e]+"_IMG_D"]:g.src=k[a[e]+"_IMG"]}AttachEvent(s,"mouseover",function(a){u.mapTypeControlStyle!=TGOS.TGMapTypeControlStyle.DROPDOWN_MENU&&I.expand()});AttachEvent(s,"mouseout",function(a){u.mapTypeControlStyle!=TGOS.TGMapTypeControlStyle.DROPDOWN_MENU&&I.minimize()});
s.appendChild(q);util.disableSelect(q)}function g(a){C=document.createElement("div");C.style.position="absolute";C.style.right="0px";C.style.backgroundColor="#CCCCDD";C.style.borderStyle="solid";C.style.borderColor="#888888";C.style.fontFamily="Times New Roman,\u5fae\u8edf\u6b63\u9ed1\u9ad4";H=document.createElement("div");H.innerHTML="\u5730\u5716\u985e\u578b";H.style.margin="5px";B=document.createElement("select");B.style.margin="5px";B.style.marginTop="0px";C.appendChild(H);C.appendChild(B);util.disableSelect(H);
AttachEvent(B,"change",function(a){h(B.value)});for(var d=0;d<a.length;d++)if(a[d]in b.getDocName()){var e=new Option(TGOS.TGMapTypeId_zh_TW[a[d]],a[d]);B.add(e)}s.appendChild(C)}function h(b){var d="",d=b==TGOS.TGMapTypeId.TGOSMAP||b==TGOS.TGMapTypeId.MOTCMAP?TGOS.TGMapTypeId.NLSCMAP:b;I.setActiveType(b);m.setMapTypeId(b);b=d;for(d=0;d<f.length;d++)f[d].mapTypeId==b?f[d].putVisible(!0):f[d].putVisible(!1);a.getMapBase().RefreshMap(!0)}var k={ROADMAP_IMG_D:TGOS.RES_PATH+"ROADMAP_d.png",SATELLITE_IMG_D:TGOS.RES_PATH+
"SATELLITE_d.png",HYBRID_IMG_D:TGOS.RES_PATH+"HYBRID_d.png",TGOSMAP_IMG_D:TGOS.RES_PATH+"NLSCMAP_d.png",NLSCMAP_IMG_D:TGOS.RES_PATH+"NLSCMAP_d.png",MOTCMAP_IMG_D:TGOS.RES_PATH+"NLSCMAP_d.png",F2IMAGE_IMG_D:TGOS.RES_PATH+"F2IMAGE_d.png",HILLSHADE_IMG_D:TGOS.RES_PATH+"HILLSHADE_d.png",SEGISMAP_IMG_D:TGOS.RES_PATH+"SEGISMAP_d.png",HILLSHADEMIX_IMG_D:TGOS.RES_PATH+"HILLSHADEMIX_d.png",IMAGENLSC_IMG_D:TGOS.RES_PATH+"IMAGENLSC_d.png",ROADMAP_IMG:TGOS.RES_PATH+"ROADMAP_n.png",SATELLITE_IMG:TGOS.RES_PATH+
"SATELLITE_n.png",HYBRID_IMG:TGOS.RES_PATH+"HYBRID_n.png",TGOSMAP_IMG:TGOS.RES_PATH+"NLSCMAP_n.png",NLSCMAP_IMG:TGOS.RES_PATH+"NLSCMAP_n.png",MOTCMAP_IMG:TGOS.RES_PATH+"NLSCMAP_n.png",F2IMAGE_IMG:TGOS.RES_PATH+"F2IMAGE_n.png",HILLSHADE_IMG:TGOS.RES_PATH+"HILLSHADE_n.png",SEGISMAP_IMG:TGOS.RES_PATH+"SEGISMAP_n.png",HILLSHADEMIX_IMG:TGOS.RES_PATH+"HILLSHADEMIX_n.png",IMAGENLSC_IMG:TGOS.RES_PATH+"IMAGENLSC_n.png"},l=70,p=70,m=b;m.getDiv();var n=m.getMapBase(),u=d,s=null,q=null,w=null,C=null,B=null,H=
null,A=d.controlPosition,I=this;this.ani=null;this.expand=function(){for(var a=0,b=0,b=0;b<w.rows[0].cells.length;b++)w.rows[0].cells[b].style.display="table-cell",a+=l;var d=parseInt(s.style.width),e=a-d;this.ani&&this.ani.stop();this.ani=TGOS.fx.createAnimation({easing:TGOS.fx.easing.quadOut,type:window.requestAnimationFrame?"req":"setTimeout",duration:200,onAnimation:function(a){s.style.width=d+parseInt(e*a)+"px"},onEnd:function(){s.style.width=a+"px"}});this.ani.play()};this.minimize=function(){for(var a=
0;a<w.rows[0].cells.length;a++)m.getMapTypeId()==w.rows[0].cells[a].mapTypeId?w.rows[0].cells[a].style.display="table-cell":w.rows[0].cells[a].style.display="none";var b=parseInt(s.style.width),d=b-l;this.ani&&this.ani.stop();this.ani=TGOS.fx.createAnimation({easing:TGOS.fx.easing.quadOut,type:window.requestAnimationFrame?"req":"setTimeout",duration:200,onAnimation:function(a){s.style.width=b-parseInt(d*a)+"px"},onEnd:function(){s.style.width=l+"px"}});this.ani.play()};this.getDiv=function(){return s};
this.init=function(){s=document.createElement("div");s.style.position="absolute";s.style.padding="5px";s.setAttribute("class","tgMapTypeCtrl");e(d.mapTypeIds);g(d.mapTypeIds);this.setStyle(TGOS.TGMapTypeControlStyle.DEFAULT);this.setPosition(A)};this.setWms=function(a,b){for(var d=defaultLayer;d<pLyr.length;d++)pLyr[d].getName()==a&&pLyr[d].putVisible(b);n.RefreshMap(!0)};this.removeWms=function(a){for(var b=defaultLayer;b<pLyr.length;b++){if(pLyr[b].getName()==a){n.RemoveLayer(pLyr[b]);for(var d=
pLyr,e=b,f=Array(d.length-1),g=0,h=0;h<d.length-1;h++)h!=e&&(f[g]=d[h],g++);pLyr=f}n.RefreshMap(!0)}};this.setPosition=function(a){var d=b.controls[A].indexOf(s);a in TGOS.TGControlPosition&&(0<=d&&b.controls[A].removeAt(d),b.controls[a].push(s),A=a)};this.setStyle=function(a){if(a){this.ani&&this.ani.stop();q.style.display="inline";C.style.display="none";if(a==TGOS.TGMapTypeControlStyle.DEFAULT||a==TGOS.TGMapTypeControlStyle.HORIZONTAL_BAR)q.style.display="inline",C.style.display="none",s.style.width=
l+"px",s.style.height=l+"px";else if(a==TGOS.TGMapTypeControlStyle.DROPDOWN_MENU)q.style.display="none",C.style.display="inline",s.style.height=C.scrollHeight+10+"px",s.style.width=C.scrollWidth+10+"px";else throw"invalide map type control style";u.mapTypeControlStyle=a}};this.setMapTypeIds=function(a){s.removeChild(C);s.removeChild(q);e(a);g(a);u.mapTypeIds=a;var b=m.getDocName();a[0]in b&&(h(a[0]),this.minimize())};this.setActiveType=function(a){for(var b=0;b<w.rows[0].cells.length;b++){var d=w.rows[0].cells[b];
d.imgElem.src=d.mapTypeId==a?k[d.imgElem.mapTypeId+"_IMG_D"]:k[d.imgElem.mapTypeId+"_IMG"]}};this.remove=function(){var a=b.controls[A];a.removeAt(a.indexOf(s))};this.display=function(a){s.style.display=a?"inline":"none"};this.setOptions=function(a){void 0!=a.mapTypeIds&&(this.setMapTypeIds(a.mapTypeIds),this.setStyle(u.mapTypeControlStyle));void 0!=a.mapTypeControlStyle&&this.setStyle(a.mapTypeControlStyle);void 0!=a.controlPosition&&this.setPosition(a.controlPosition)};this.getDiv=function(){return s};
this.init()};
TGOS.LevelBarControl=function(b,d,a,f,e){function g(a){d.putMapLevel(d.getMapLevel()+a);d.FitLevel();p.RefreshMap(!0)}this.getDiv=function(){return k};var h=a,k=null,l=16,p=null,k=document.createElement("table");k.style.position="absolute";k.style.paddingLeft="20px";k.border="0";k.cellPadding="0";k.cellSpacing="0";k.id="pLevelBarBar";k.name="pLevelBarBar";util.disableSelect(k);b=k.insertRow(-1);var m=b.insertCell(-1);m.align="center";b=document.createElement("table");m.appendChild(b);b.border="0";
b.cellPadding="0";b.cellSpacing="0";b.width="34";m=b.insertRow(-1);b=m.insertCell(-1);b.style.padding="0px 4px 0px 0px";var n=b.ownerDocument.createElement("img");b.appendChild(n);AttachEvent(n,"click",function(){g(1)},!1);n.style.cursor="pointer";n.style["vertical-align"]="top";b=k.insertRow(-1);m=b.insertCell(-1);m.align="center";b=document.createElement("table");m.appendChild(b);b.border="0";b.cellPadding="0";b.cellSpacing="0";b.width="34";var m=b.insertRow(-1),u=m.insertCell(-1),s=u.ownerDocument.createElement("div");
u.appendChild(s);s.style.position="relative";s.style.width="12px";s.style.height="100%";var q=document.createElement("img");s.appendChild(q);q.style.position="absolute";q.src=TGOS.RES_PATH+"icons/bar_06.png";q.style.left="0px";q.style.bottom="0px";q.width="34";q.height="16";AttachEvent(s,"mousedown",function(a){function b(a){d.putMapLevel(Math.round(g+(f-a.clientY)/l));p.RefreshMap(!1)}function e(a){DetachEvent(q,"mousemove",b,!0);DetachEvent(q,"mouseup",e,!0);d.FitLevel();p.RefreshMap(!0)}util.disableDefault(a);
if(a.srcElement==q){var f=a.clientY,g=d.getMapLevel();AttachEvent(q,"mousemove",b,!0);AttachEvent(q,"mouseup",e,!0)}else d.putMapLevel((s.clientHeight-a.offsetY)/l-0.5),d.FitLevel(),p.RefreshMap(!0)},!1);u.align="center";u.style.height="0px";m=b.insertRow(-1);b=m.insertCell(-1);b.align="center";b.style.padding="0px 4px 0px 0px";var w=b.ownerDocument.createElement("img");b.appendChild(w);w.src=TGOS.RES_PATH+"/bar_bottom.png";AttachEvent(w,"click",function(){g(-1)},!1);w.style.cursor="pointer";this.Initialize=
function(a){p=a};this.UpdateElement=function(){var a,b=TGOS.MapTypeMaxZoomLevel[e.getCoordSys()][e.getMapTypeId()];a=Math.max(d.getMapMinLevel(),0);b=Math.min(d.getMapMaxLevel(),b)-a;u.style.height=(b+1)*l+"px";a=(d.getMapLevel()-a)*l;q.style.bottom=a+"px"};this.RebuildElement=function(){};this.display=function(a){k.style.display=a?"":"none"};this.setPosition=function(a){var b=e.controls[h].indexOf(k);a in TGOS.TGControlPosition&&(0<=b&&e.controls[h].removeAt(b),e.controls[a].push(k),h=a)};this.setStyle=
function(a){switch(a){case TGOS.TGNavigationControlStyle.SMALL:s.style.display="none";q.style.display="none";u.style.display="none";n.src=TGOS.RES_PATH+"/bar_head.png";n.onmousedown=null;n.onmouseup=null;w.src=TGOS.RES_PATH+"/bar_bottom.png";w.onmousedown=null;w.onmouseup=null;break;case TGOS.TGNavigationControlStyle.MEDIUM:s.style.display="none";q.style.display="none";u.style.display="none";n.src=TGOS.RES_PATH+"TGOS01_01.png";n.onmousedown=function(){this.src=TGOS.RES_PATH+"TGOS02_01.png"};n.onmouseup=
function(){this.src=TGOS.RES_PATH+"TGOS01_01.png"};w.src=TGOS.RES_PATH+"TGOS01_02.png";w.onmousedown=function(){this.src=TGOS.RES_PATH+"TGOS02_02.png"};w.onmouseup=function(){this.src=TGOS.RES_PATH+"TGOS01_02.png"};break;case TGOS.TGNavigationControlStyle.LARGE:n.src=TGOS.RES_PATH+"/bar_head.png";n.onmousedown=null;n.onmouseup=null;w.src=TGOS.RES_PATH+"/bar_bottom.png";w.onmousedown=null;w.onmouseup=null;a=Math.max(1,d.getMapMaxLevel())*l;s.style.display="";q.style.display="";u.style.display="";u.style.backgroundImage=
"url("+TGOS.RES_PATH+"bar_02.png)";u.style.height=a+"px";a=(d.getMapLevel()-0.5)*l-q.clientHeight/2;q.style.bottom=a+"px";break;default:s.style.display="none",q.style.display="none",u.style.display="none",n.src=TGOS.RES_PATH+"/bar_head.png",n.onmousedown=null,n.onmouseup=null,w.src=TGOS.RES_PATH+"/bar_bottom.png",w.onmousedown=null,w.onmouseup=null}this.UpdateElement()};this.setOptions=function(a){void 0!=a.navigationControlStyle&&this.setStyle(a.navigationControlStyle);void 0!=a.controlPosition&&
this.setPosition(a.controlPosition)};e.controls[h].push(k);this.setPosition(a);this.setStyle(f);this.UpdateElement()};
TGOS.ScaleBarControl=function(b,d,a,f,e){function g(a,b,d,e,f,g){var h=document.createElement("div");a.appendChild(h);h.style.position="relative";h.style.width=f+"px";h.style.height=g+"px";h.style.overflow="hidden";a=document.createElement("img");h.appendChild(a);a.src=b;a.style.position="absolute";a.style.left=-d+"px";a.style.top=-e+"px";h.Img=a;return h}this.getDiv=function(){return l};this.setPosition=function(a){var b=e.controls[p].indexOf(k);a in TGOS.TGControlPosition&&(0<=b&&e.controls[p].removeAt(b),
e.controls[a].push(k),p=a)};this.setStyle=function(a){};this.setOptions=function(a){void 0!=a.scaleControlStyle&&this.setStyle(a.scaleControlStyle);void 0!=a.controlPosition&&this.setPosition(a.controlPosition)};var h=document.createElement("div");h.style.position="relative";var k=document.createElement("div");util.disableSelect(k);k.style.overflow="visible";k.style.padding="10px";var l=null,p=a,l=document.createElement("div");l.style.position="relative";l.style.height="36px";l.style.overflow="hidden";
l.id="pScaleBar";l.name="pScaleBar";g(l,TGOS.RES_PATH+"scale.png",0,0,4,32).style.position="absolute";b=g(l,TGOS.RES_PATH+"scale.png",4,14,508,4);b.style.position="absolute";b.style.left="4px";b.style.top="14px";var m=g(l,TGOS.RES_PATH+"scale.png",0,0,4,15);m.style.position="absolute";m.style.left="0px";m.style.top="0px";var n=g(l,TGOS.RES_PATH+"scale.png",0,17,4,15);n.style.position="absolute";n.style.left="0px";n.style.top="17px";b=g(l,TGOS.RES_PATH+"scale.png",511,14,1,4);b.style.position="absolute";
b.style.right="0px";b.style.top="14px";var u=l.ownerDocument.createElement("div");l.appendChild(u);u.className="text";u.style.fontSize="0.7em";u.style.position="absolute";u.style.left="25px";u.style.top="18px";var s=l.ownerDocument.createElement("div");l.appendChild(s);s.className="text";s.style.fontSize="0.7em";s.style.position="absolute";s.style.left="25px";s.style.top="0px";k.appendChild(h);k.appendChild(l);var q=f?f:TGOS.TGScaleControlStyle.DEFAULT;this.setStyle=function(a){if(a){q=a;switch(q){case TGOS.TGScaleControlStyle.TEXT:h.style.display=
"block";l.style.display="none";break;default:h.style.display="none",l.style.display="block"}this.UpdateElement()}};var w=new HorizontalDatum(6378137,0),C=new MercatorProjection(0,0,0,1);this.UpdateElement=function(){if(q==TGOS.TGScaleControlStyle.TEXT){var a=TGOS.GetMapScale(e.getCoordSys(),e.getZoom());h.innerHTML=" 1 : "+a}else{var b=d.ToMapDistX(250),f=b,g=1,a="\u516c\u5c3a";6615<b&&(f/=1E3,g=1E3,a="\u516c\u91cc");var k=Math.floor(Math.log(f)/Math.LN10),k=Math.pow(10,k),f=Math.floor(f/k),f=(2>
f?1:5>f?2:5)*k,g=d.FromMapDistX(f*g)+2,p=b/0.3048,k=p,J=1,b="\u82f1\u544e";21702<p&&(k/=5280,J=5280,b="\u82f1\u91cc");p=Math.floor(Math.log(k)/Math.LN10);p=Math.pow(10,p);k=Math.floor(k/p);k=(2>k?1:5>k?2:5)*p;J=d.FromMapDistX(0.3048*k*J)+2;C.Inverse(w,new CPoint3(d.getCenterX(),d.getCenterY(),0));l.style.width=Math.round(Math.max(g,J))+"px";m.style.left=Math.round(g-4)+"px";n.style.left=Math.round(J-4)+"px";s.innerHTML=f+a;u.innerHTML=k+b;Math.round(Math.max(g,J))}};this.display=function(a){k.style.display=
!1==a?"none":""};this.ControlOptionsChang=function(a,b){Location(b.getClientWidth(),b.getClientHeight())};this.setPosition(p);this.setStyle(q);this.UpdateElement()};function initControlArray(b){var d=b.controls,a=function(){f.BOTTOM_CENTER_update.call(d.BOTTOM_CENTER);f.BOTTOM_LEFT_update.call(d.BOTTOM_LEFT);f.BOTTOM_RIGHT_update.call(d.BOTTOM_RIGHT);f.LEFT_BOTTOM_update.call(d.LEFT_BOTTOM);f.LEFT_CENTER_update.call(d.LEFT_CENTER);f.LEFT_TOP_update.call(d.LEFT_TOP);f.RIGHT_BOTTOM_update.call(d.RIGHT_BOTTOM);f.RIGHT_CENTER_update.call(d.RIGHT_CENTER);f.RIGHT_TOP_update.call(d.RIGHT_TOP);f.TOP_CENTER_update.call(d.TOP_CENTER);f.TOP_LEFT_update.call(d.TOP_LEFT);
f.TOP_RIGHT_update.call(d.TOP_RIGHT)},f={BOTTOM_CENTER_update:function(){var a=0,e=0;d.BOTTOM_CENTER.forEach(function(d,f){var p=parseInt(d.clientWidth,10),m=parseInt(d.clientHeight,10),n=0<=b.getMapSize().width/2-p/2?b.getMapSize().width/2-p/2:0;a+=p;e=Math.max(e,m);d.style.right="auto";d.style.left=n+"px";d.style.top="auto";d.style.bottom="0px"});d.BOTTOM_CENTER.totalWidth=a;d.BOTTOM_CENTER.totalHeight=e},BOTTOM_LEFT_update:function(){var a=0,b=0;d.BOTTOM_LEFT.forEach(function(d,e){var f=parseInt(d.scrollWidth,
10),m=parseInt(d.scrollHeight,10);a+=f;b=Math.max(b,m);d.style.right="auto";d.style.left=a-f+"px";d.style.top="auto";d.style.bottom="0px"});d.BOTTOM_LEFT.totalWidth=a;d.BOTTOM_LEFT.totalHeight=b},BOTTOM_RIGHT_update:function(){var a=0,b=0;d.BOTTOM_RIGHT.forEach(function(d,e){var f=parseInt(d.clientWidth,10),m=parseInt(d.clientHeight,10);a+=f;b=Math.max(b,m);d.style.left="auto";d.style.right=a-f+"px";d.style.top="auto";d.style.bottom="0px"});d.BOTTOM_RIGHT.totalWidth=a;d.BOTTOM_RIGHT.totalHeight=b},
TOP_LEFT_update:function(){var a=0,b=0;d.TOP_LEFT.forEach(function(d,e){var f=parseInt(d.clientWidth,10),m=parseInt(d.clientHeight,10);a+=f;b=Math.max(b,m);d.style.right="auto";d.style.left=a-f+"px";d.style.bottom="auto";d.style.top="0px"});d.TOP_LEFT.totalWidth=a;d.TOP_LEFT.totalHeight=b},TOP_CENTER_update:function(){var a=0,e=0;d.TOP_CENTER.forEach(function(d,f){var p=parseInt(d.clientWidth,10),m=parseInt(d.clientHeight,10),n=0<=b.getMapSize().width/2-p/2?b.getMapSize().width/2-p/2:0;a+=p;e=Math.max(e,
m);d.style.right="auto";d.style.left=n+"px";d.style.bottom="auto";d.style.top="0px"});d.TOP_CENTER.totalWidth=a;d.TOP_CENTER.totalHeight=e},TOP_RIGHT_update:function(){var a=0,b=0;d.TOP_RIGHT.forEach(function(d,e){var f=parseInt(d.clientWidth,10),m=parseInt(d.clientHeight,10);a+=f;b=Math.max(b,m);d.style.left="auto";d.style.right=a-f+"px";d.style.bottom="auto";d.style.top="0px"});d.TOP_RIGHT.totalWidth=a;d.TOP_RIGHT.totalHeight=b},LEFT_TOP_update:function(){var a=0,b=0,e=0;0<d.TOP_LEFT.getLength()&&
(e=parseInt(d.TOP_LEFT.totalHeight));d.LEFT_TOP.forEach(function(d,f){var m=parseInt(d.clientWidth,10),n=parseInt(d.clientHeight,10);a+=m;b+=n;d.style.bottom="auto";d.style.right="auto";d.style.left="0px";d.style.top=b-n+e+"px"});d.LEFT_TOP.totalWidth=a;d.LEFT_TOP.totalHeight=b},LEFT_CENTER_update:function(){var a=0,e=0;d.LEFT_CENTER.forEach(function(d,f){var p=parseInt(d.clientWidth,10),m=parseInt(d.clientHeight,10);a+=p;e+=m;p=0<=b.getMapSize().height/2-m/2?b.getMapSize().height/2-m/2:0;d.style.bottom=
"auto";d.style.right="auto";d.style.left="0px";d.style.top=p+"px"});d.LEFT_CENTER.totalWidth=a;d.LEFT_CENTER.totalHeight=e},LEFT_BOTTOM_update:function(){var a=0,b=0,e=0;0<d.BOTTOM_LEFT.getLength()&&(e=parseInt(d.BOTTOM_LEFT.totalHeight));d.LEFT_BOTTOM.forEach(function(d,f){var m=parseInt(d.clientWidth,10),n=parseInt(d.clientHeight,10);a+=m;b+=n;d.style.top="auto";d.style.right="auto";d.style.left="0px";d.style.bottom=e+b-n+"px"});d.LEFT_BOTTOM.totalWidth=a;d.LEFT_BOTTOM.totalHeight=b},RIGHT_TOP_update:function(){var a=
0,b=0,e=0;0<d.TOP_RIGHT.getLength()&&(e=parseInt(d.TOP_RIGHT.totalHeight));d.RIGHT_TOP.forEach(function(d,f){var m=parseInt(d.clientWidth,10),n=parseInt(d.clientHeight,10);a+=m;b+=n;d.style.bottom="auto";d.style.left="auto";d.style.right="0px";d.style.top=e+b-n+"px"});d.RIGHT_TOP.totalWidth=a;d.RIGHT_TOP.totalHeight=b},RIGHT_CENTER_update:function(){var a=0,e=0;d.RIGHT_CENTER.forEach(function(d,f){var p=parseInt(d.clientWidth,10),m=parseInt(d.clientHeight,10),n=0<=b.getMapSize().height/2-m/2?b.getMapSize().height/
2-m/2:0;a+=p;e+=m;d.style.bottom="auto";d.style.left="auto";d.style.right="0px";d.style.top=n+"px"});d.RIGHT_CENTER.totalWidth=a;d.RIGHT_CENTER.totalHeight=e},RIGHT_BOTTOM_update:function(){var a=0,b=0,e=0;0<d.BOTTOM_RIGHT.getLength()&&(e=parseInt(d.BOTTOM_RIGHT.totalHeight));d.RIGHT_BOTTOM.forEach(function(d,f){var m=parseInt(d.clientWidth,10),n=parseInt(d.clientHeight,10);a+=m;b+=n;d.style.top="auto";d.style.left="auto";d.style.right="0px";d.style.bottom=b-n+e+"px"});d.RIGHT_BOTTOM.totalWidth=a;
d.RIGHT_BOTTOM.totalHeight=b}},e;for(e in d)TGOS.TGEvent.addListener(d[e],"insert_at",function(){return function(d){d=this.getAt(d);d.style.position="absolute";b.getHPackage().appendChild(d);a()}}()),TGOS.TGEvent.addListener(d[e],"remove_at",function(){return function(d,e){b.getHPackage().removeChild(e);a()}}()),TGOS.TGEvent.addListener(b,"resize",function(){a()})};(function(){TGOS.MVCArray=function(){this.arr_=[]};var b=TGOS.MVCArray.prototype;b.getAt=function(b){return this.arr_[b]};b.getLength=function(){return this.arr_.length};b.push=function(b){var a=this.arr_.length;0>=a&&(a=0);return this.insertAt(a,b)};b.pop=function(){var b=this.arr_.length-1;if(!(0>b))return this.removeAt(b)};b.forEach=function(b){for(var a=0;a<this.arr_.length;a++)b.call(this,this.arr_[a],a)};b.getArray=function(){return this.arr_};b.removeAt=function(b){if(!(b>this.arr_.length-
1)){var a=this.arr_.splice(b,1);TGOS.TGEvent.trigger_(this,"remove_at",b,a[0]);TGOS.TGEvent.trigger_(this,"changed");return a}};b.insertAt=function(b,a){b>this.arr_.length||(this.arr_.splice(b,0,a),TGOS.TGEvent.trigger_(this,"insert_at",b),TGOS.TGEvent.trigger_(this,"changed"))};b.setAt=function(b,a){if(!(b>this.arr_.length-1)){var f=this.arr_[b];this.arr_.splice(b,1,a);TGOS.TGEvent.trigger_(this,"set_at",b,f);TGOS.TGEvent.trigger_(this,"changed")}};b.indexOf=function(b){return this.arr_.indexOf(b)};
TGOS.RegisterEvent(TGOS.MVCArray,["insert_at","remove_at","set_at","changed"])})();(function(){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(a){for(var b=0;b<this.length;b++)if(a(this[b]))return this[b];return null}});Math.hypot||(Math.hypot=function(a,b){return Math.sqrt(a*a+b*b)});Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(a,b,d){if(null==this)throw new TypeError("this is null or not defined");var e=Object(this),f=e.length>>>0;b>>=0;b=0>b?Math.max(f+b,0):Math.min(b,f);d=void 0===d?f:d>>0;for(f=0>d?Math.max(f+
d,0):Math.min(d,f);b<f;)e[b]=a,b++;return e}});var b=new HorizontalDatum(6378137,0),d=new MercatorProjection(0,0,0,1),a=function(a,b){this.map=b;this.add=function(b){a.push(b)};this.remove=function(b){var d=this.map.getMapBase(),e=a.indexOf(b);-1!=e&&(a.splice(e,1),d.getHPackage().contains(b.getElement())&&d.getHPackage().removeChild(b.getElement()))};this.UpdateElement=function(){for(var b=0;b<a.length;b++)a[b].update()};this.containing=function(b){return 0<=a.indexOf(b)}},f=function(a){this.getArray=
function(){return a};this.add=function(a){this.updateArrayOrder(a);this.updateElementOrder(a)};this.push=function(b){a.push(b)};this.sortElement=function(){if(!(1>=a.length)){var b=a[0].getEventElement();if(b)for(var d=a.length,e=1;e<d;e++){var f=a[e].getEventElement();f&&(f.insertAfter(b),b=f)}}};this.updateArrayOrder=function(b){var d=a.indexOf(b);0<=d&&a.splice(d,1);d=b.getZIndex();if(0===a.length)a.push(b);else for(var e=a.length,f=0;f<e;f++)if(a[f].getZIndex()>d){a.splice(f,0,b);break}else if(f==
a.length-1){a.push(b);break}};this.updateElementOrder=function(b){if(b){var d=b.getEventElement();if(d&&(b=b.getZIndex(),0!==a.length))for(var e=a.length,f=0;f<e;f++){var g=a[f].getZIndex(),h=a[f].getEventElement();if(h)if(g>b){d.insertBefore(h);break}else if(f==a.length-1){d.toFront();break}}}};this.containing=function(b){return 0<=a.indexOf(b)};this.remove=function(b){b=a.indexOf(b);a.splice(b,1)};this.UpdateElement=function(){for(var b=a.length,d=0;d<b;d++)a[d].update&&a[d].update()};this.RebuildElement=
function(){for(var b=a.length,d=0;d<b;d++)a[d].redraw&&a[d].redraw()}};TGOS.TGTransStatus={ERROR:"ERROR",INVALID_REQUEST:"INVALID_REQUEST",OK:"OK",OVER_QUERY_LIMIT:"OVER_QUERY_LIMIT",REQUEST_DENIED:"REQUEST_DENIED",UNKNOWN_ERROR:"UNKNOWN_ERROR"};TGOS.TGIndexViewControlOptions={NORMAL:"NORMAL",MINIMIZED:"MINIMIZED"};TGOS.tgHash="1nBuF52l1+8H5hiU6yInLdgbEgh30t5A1urKQ+SrpyY=";TGOS.APPID="oDPRlyfRCxJU0WQzbGoT3czIVKKrgazXufYoMUqrDunDU2wyZUyqxw%3d%3d";TGOS.APIKEY="cGEErDNy5yN%2f1fQ0vyTOZrghjE+jIU6uS7KRkVhjgR%2fntPjyeD8YxxHYg1KKKleBfFzZXzdKa+lLYqXilegwIyGqxEvsAh2EMbmq6EwdwDTiDm60cp+yszESTJxPlZKZMK3AOXn%2f4+1mPbjG80Zat%2f4gbGPeq6JR%2fJoLQ5GYl0c6TNYJmMO2QUFhblC07k2bWf1i6O+5fG4JAZso3rkF7HrF%2f019fX48OVcWy5jMgAQwYeqqCUPDigCWjGwUHmHpstsyrkkzWSd4KDP+xoXnPfAyFa3TFJb4F4%2fvMH5TlpyKkaiel3L6XumiZkXz%2fXfOAUbsFb3j54s3NHZrUXYmJdMkAsXMAvwwOmD55lq24dRoW4AvHDre%2fW48vLPn43i%2fbJFXnUcH9oULLHp30UXz26pAZ2DbKg9ds6Z%2fmNy1JWOHG5YY8sfcKTbjVImrnhBLdxSyCPdWDvcHskzcGVqMWowNd2WUZ7w4AnlWecbvAPWLb1W3Vp3oDZLH5CgEWFhiqgN5Sw8iHup483IWjaY0yS6OfoYSimgFJZV7k+lUZBy0aGQFCEO+fvpNHf%2fQQihcO%2fMiGTSQEgExV9usFFKn3+zytFwoEEqU+AqyDNjqP7bGAOz%2fL0VJvbWhQpbfJfyklrI8wSYDmfunBQ+X0pqne4KzFy2S%2fgXUpkqL1VbjGanDwHEHGUYtiO82o7jTVmIx3FuZ0iD4Q3+WPz8J+7nZU%2fj++aIgBhFJwKX35UHuNA2NYJbXqpn36Ef19oEwvF5NuiiJf%2ffxPitqg82LLSa+NNWbCYUZE4iJrgGl8C2LYhyW1NFcMcLbfQbOiiP3EMG0vnPuuEja1anVEp+JBAcn%2fi9cS3pmrmrldyk0XA5SQ6YE%2fX3LCVAkMO5ndzRjN3o%2fYfBb3aWE2u%2fRUQ9S3fleZTBCAxY4IpMHWzaUAv9tYuuT52DkuonN%2fK4MXARFwn19kd7VPrWoG64BfJQh9ZKgzj8Q4zcxhNtdlTw321v506b%2f1OVQQ+Thy3pa+RBcBpSiWYFx+szgEyP3wol0CimHooLtjJ9nyl1NCrw6wq1L3gqFBaNDYX11TXgBPsgCmqn+bzI7ObMnH49lz5rZBd85Rq0nz5L2ybCtMEHHrRZ0gsw%2fTLlPT3D9xAtBe8afuLYhakqrNC6%2frhKh38KHckbRRony53xjM6kua5ANRfoxeOabBBuNKnvtKJMJgcmmy+hE4RpCwljQTmlveiRoL2q81cHSVCOwLZ+yieNr8uidUD1Slk8ASuP0TUcOuc8Csc4dJzc1zUh8Y9qXAVCRr3iOx7DuGdxsc8+jsYD06JkTKoUO6VqkZoOgbRnWbd1JkF5BbQfrAx8Ov8N6dV%2fjaIWZZPfQLfWseL88";TGOS.MapTypeScales={EPSG3825:{scales:[500,1E3,2500,5E3,1E4,25E3,5E4,1E5,25E4,5E5,1E6,25E5,5E6,1E7,125E5],levelX:846666.666666667,
levelY:-846666.666666667},EPSG3826:{scales:[500,1E3,2500,5E3,1E4,25E3,5E4,1E5,25E4,5E5,1E6,25E5,5E6,1E7,125E5],levelX:846666.666666667,levelY:-846666.666666667},EPSG3857:{scales:[1128,2257,4514,9028,18056,36112,72224,144448,288896,577792,1155583,2311167,4622334,9244667,18489335,36978669,73957339,147914678,295829355,591658711],levelX:4.00750166855785E7,levelY:-4.00750166855785E7,factors:[0.298582141727292,0.597164283481042,1.19432856696208,2.38865713392417,4.77731426782187,9.55462853564375,19.1092570712875,
38.2185141426015,76.4370282851765,152.874056570353,305.748113140706,611.496226281412,1222.99245256282,2445.98490512565,4891.96981025127,9783.93962050256,19567.8792410051,39135.7584820103,78271.5169640206,156543.033928041]}};TGOS.TGControlPosition={BOTTOM_CENTER:"BOTTOM_CENTER",BOTTOM_LEFT:"BOTTOM_LEFT",BOTTOM_RIGHT:"BOTTOM_RIGHT",LEFT_BOTTOM:"LEFT_BOTTOM",LEFT_CENTER:"LEFT_CENTER",LEFT_TOP:"LEFT_TOP",RIGHT_BOTTOM:"RIGHT_BOTTOM",RIGHT_CENTER:"RIGHT_CENTER",RIGHT_TOP:"RIGHT_TOP",TOP_CENTER:"TOP_CENTER",
TOP_LEFT:"TOP_LEFT",TOP_RIGHT:"TOP_RIGHT"};TGOS.TGMapTypeControlStyle={DEFAULT:"DEFAULT",DROPDOWN_MENU:"DROPDOWN_MENU",HORIZONTAL_BAR:"HORIZONTAL_BAR"};TGOS.TGNavigationControlStyle={DEFAULT:"DEFAULT",LARGE:"LARGE",MEDIUM:"MEDIUM",SMALL:"SMALL"};TGOS.TGScaleControlStyle={DEFAULT:"DEFAULT",TEXT:"TEXT",BAR:"BAR",HD:"HD"};TGOS.TGCoordSys={EPSG3825:"EPSG3825",EPSG3826:"EPSG3826",EPSG3857:"EPSG3857"};TGOS.KeyboardEditor={NONE:"NONE",UP:"UP",DOWN:"DOWN",LEFT:"LEFT",RIGHT:"RIGHT",DEL:"DEL"};TGOS.GetMapScale=
function(a,b){try{return TGOS.MapTypeScales[a].scales[TGOS.MapTypeScales[a].scales.length-1-b]}catch(d){throw"[GetMapScale] Invalid Parameters";}};TGOS.TGOnlineMap=function(e,g,h){var k=this;this.getCurrentMapType=function(){return currentMapType};var l,p;this.getMapTypeTag=function(){return ba};this.overlayForwardEvent=this.baseMapVisible=!0;this.setOverlayForwardEvent=function(a){this.overlayForwardEvent=a};this.getOverlayForwardEvent=function(){return this.overlayForwardEvent};this.overlayStopClick=
!1;this.setOverlayStopClick=function(){this.overlayStopClick=!0};this.overlayForwardEvents=["click"];this.addOverlayForwardEvent=function(a){if(a instanceof Array)for(var b=0;b<a.length;b++)0>this.overlayForwardEvents.indexOf(a[b])&&this.overlayForwardEvents.push(a[b]);else a instanceof String&&0>this.overlayForwardEvents.indexOf(a)&&this.overlayForwardEvents.push(a)};this.getOverlayForwardEvents=function(){return this.overlayForwardEvents};this.controls={BOTTOM_CENTER:new TGOS.MVCArray,BOTTOM_LEFT:new TGOS.MVCArray,
BOTTOM_RIGHT:new TGOS.MVCArray,LEFT_BOTTOM:new TGOS.MVCArray,LEFT_CENTER:new TGOS.MVCArray,LEFT_TOP:new TGOS.MVCArray,RIGHT_BOTTOM:new TGOS.MVCArray,RIGHT_CENTER:new TGOS.MVCArray,RIGHT_TOP:new TGOS.MVCArray,TOP_CENTER:new TGOS.MVCArray,TOP_LEFT:new TGOS.MVCArray,TOP_RIGHT:new TGOS.MVCArray};this.setKeyboardEdit=function(a,b){S.OpenCloseKeyboardEditor(a,b)};this.getMapSize=function(){var a=parseInt(V.offsetWidth),b=parseInt(V.offsetHeight);return new TGOS.TGSize(a,b)};this.IndexViewControl={Show:function(a){Z.Show(a);
Z.getMapBase().RefreshMap(!0)},Minimize:function(){Z.Minimize();Z.getMapBase().RefreshMap(!0)}};this.setCoordSys=function(a){a instanceof TGOS.TGCoordSys&&(v=a,TGOS.TGEvent.trigger(this,"projection_changed"))};this.getDocName=function(){var a;switch(v){case TGOS.TGCoordSys.EPSG3826:a=TGOS.MapTypeDocumentName;ba="97";break;case TGOS.TGCoordSys.EPSG3825:a=TGOS.MapTypeDocumentNameTWD97_119;ba="97_119";break;case TGOS.TGCoordSys.EPSG3857:a=TGOS.MapTypeDocumentNameGoogle,ba="google"}return a};this.getCoordSys=
function(){return v};this.getOPackage=function(){return ia};this.getMapOptions=function(){return Q};this.getMapTypeId=function(){return W};this.getHPackage=function(){return V};this.getHPack=function(){return R.getHPackage()};this.getHObj=function(){return R.getHObject()};this.getHMap=function(){return R.getHObject()};this.getMapBase=function(){return R};this.getMap=function(){return this};this.ZoomTo=function(a){F(a)};this.ZoomIn=function(){F(fa.getMapLevel()+1)};this.ZoomOut=function(){F(fa.getMapLevel()-
1)};this.setOptions=function(a){var b=function(a){var b;switch(v){case TGOS.TGCoordSys.EPSG3857:b=TGOS.WGS84ToGoo(a.left,a.top);a=TGOS.WGS84ToGoo(a.right,a.bottom);b=new TGOS.TGEnvelope(b.x,b.y,a.x,a.y);break;default:b=a}fa.setMapBoundsLevel(b);S.setMapBounds(b);R.RefreshMap(!0)},d=function(a,b){var d=a,e=b;null!=d&&null!=e&&d>e&&(d=b,e=a);fa.setMapMinMaxLevel(d,e);R.RefreshMap(!0)},e=function(a){"string"==typeof a&&(R.setColor(a),Q.backgroundColor=a)},f=function(a){"boolean"==typeof a&&(a?(ja.display(!1),
X.display(!1),da.display(!1)):(ja.display(!0),X.display(!0),da.display(!0)),Q.disableDefaultUI=a,R.RefreshMap(!0))},g=function(a){"boolean"==typeof a&&(aa=a,Q.scrollwheel=a,S.OpenCloseWheel(a))},h=function(a){"boolean"==typeof a&&(X.display(a),Q.mapTypeControl=a)},m=function(a){X.setOptions(a);Q.mapTypeControlOptions=a;R.RefreshMap(!0)},k=function(a){"boolean"==typeof a&&(da.display(a),Q.navigationControl=a);R.RefreshMap(!0)},l=function(a){da.setOptions(a);Q.navigationControlOptions=a},n=function(a){"boolean"==
typeof a&&(ja.display(a),Q.scaleControl=a)},t=function(a){ja.setOptions(a);Q.scaleControlOptions=a},q=function(a){"boolean"==typeof a&&(Z.Show(a),Q.indexViewControl=a)},p=function(a){a==TGOS.TGIndexViewControlOptions.MINIMIZED&&(Z.Minimize(),Q.indexViewControlOptions=a)},z=function(a){"boolean"==typeof a&&(T=a,Q.draggable=a,S.OpenCloseMove(a))},s=function(a){"boolean"==typeof a&&(S.allowKeyboard(a),Q.keyboardShortcuts=a)},E=function(a){"boolean"==typeof a&&(S.setDragInertia(a),Q.dragInertia=a)},u=
function(a){"string"==typeof a&&(S.changeDraggableCursor(a),Q.draggableCursor=a)},w=function(a){"string"==typeof a&&(S.changeDraggingCursor(a),Q.draggingCursor=a)};void 0!=a&&(void 0!=a.backgroundColor&&e(a.backgroundColor),void 0!=a.disableDefaultUI&&f(a.disableDefaultUI),void 0!=a.scrollwheel&&g(a.scrollwheel),void 0!=a.mapTypeControl&&h(a.mapTypeControl),void 0!=a.mapTypeControlOptions&&m(a.mapTypeControlOptions),void 0!=a.navigationControl&&k(a.navigationControl),void 0!=a.navigationControlOptions&&
l(a.navigationControlOptions),void 0!=a.scaleControl&&n(a.scaleControl),void 0!=a.scaleControlOptions&&t(a.scaleControlOptions),void 0!=a.indexViewControl&&q(a.indexViewControl),void 0!=a.indexViewControlOptions&&p(a.indexViewControlOptions),void 0!=a.draggable&&z(a.draggable),void 0!=a.keyboardShortcuts&&s(a.keyboardShortcuts),void 0!=a.draggableCursor&&u(a.draggableCursor),void 0!=a.dragInertia&&E(a.dragInertia),void 0!=a.draggingCursor&&w(a.draggingCursor),void 0!=a.center&&ka.setCenter(a.center),
void 0!=a.dbClickZoomIn&&S.OpenCloseDblClick(a.dbClickZoomIn),void 0!==a.maxZoom&&void 0!==a.minZoom?d(a.minZoom,a.maxZoom):(void 0!==a.maxZoom&&(fa.setMapMaxLevel(a.maxZoom),R.RefreshMap(!0)),void 0!==a.minZoom&&(fa.setMapMinLevel(a.minZoom),R.RefreshMap(!0))),void 0!==a.mapBounds&&b(a.mapBounds))};this.freezeMap=function(){oa||(S.ExitMapEvent(),oa=!0)};this.unFreezeMap=function(){oa&&(S.InitMapEvent(this),oa=!1)};this.loopThroughOverlay=function(){};this.resize=function(a,b){V.style.width=a+"px";
V.style.height=b+"px";l=V.clientWidth;p=V.clientHeight};this.getBoundary=function(){return R.getExtent()};this.getLevel=function(){return fa.getMapLevel()};this.getDiv=function(){return ya};this.getEventElement=function(){return this.getHObj()};this.getTransformation=function(){return fa};this.fitBounds=function(a){if(null!=a.left&&null!=a.top&&null!=a.right&&null!=a.bottom){var e={X:0,Y:0},f={X:0,Y:0};v==TGOS.TGCoordSys.EPSG3857?(e=d.Forward(b,new CPoint3(a.left,a.top,0)),f=d.Forward(b,new CPoint3(a.right,
a.bottom,0))):(e.X=a.left,e.Y=a.top,f.X=a.right,f.Y=a.bottom);TGOS.moveMapTo_(this,(f.X+e.X)/2,(f.Y+e.Y)/2);a=Number(V.clientHeight)/(f.Y-e.Y);R.putScale(Math.min(Math.abs(Number(V.clientWidth)/(f.X-e.X)),Math.abs(a)));fa.FitLevel();R.RefreshMap(!0)}};this.getRawBound=function(){var a=l,b=p,d=R.ToMapPoint(0,0),a=R.ToMapPoint(a,b);return new TGOS.TGEnvelope(d.x,d.y,a.x,a.y)};this.getBounds=function(){var a=l,b=p,d=R.ToMapPoint(0,0),a=R.ToMapPoint(a,b),e,f,g,h;switch(v){case TGOS.TGCoordSys.EPSG3857:f=
TGOS.GooToWGS84(d.x,d.y);d=TGOS.GooToWGS84(a.x,a.y);e=f.x;f=f.y;g=d.x;h=d.y;break;case TGOS.TGCoordSys.EPSG3826:e=d.x;f=d.y;g=a.x;h=a.y;break;case TGOS.TGCoordSys.EPSG3825:e=d.x,f=d.y,g=a.x,h=a.y}return new TGOS.TGEnvelope(e,f,g,h)};this.checkMapBoundsRestrict=function(a,b,d){var e=null;if(a){var f=0,g=0,h=this.getRawBound(),m=h.top-h.bottom,k=a.top-a.bottom;h.right-h.left>a.right-a.left?(f=1,b=(a.left+a.right)/2):h.left<a.left?(f=h.left-a.left,b-=f):h.right>a.right&&(f=h.right-a.right,b-=f);m>k?
(g=1,d=(a.top+a.bottom)/2):h.top>a.top?(g=h.top-a.top,d-=g):h.bottom<a.bottom&&(g=h.bottom-a.bottom,d-=g);if(0!=f||0!=g)e=new TGOS.TGPoint(b,d)}return e};this.getCenter=function(a){a=R.getCenterX();var b=R.getCenterY(),d,e;switch(v){case TGOS.TGCoordSys.EPSG3857:e=TGOS.GooToWGS84(a,b);d=e.x;e=e.y;break;case TGOS.TGCoordSys.EPSG3826:d=a;e=b;break;case TGOS.TGCoordSys.EPSG3825:d=a,e=b}return new TGOS.TGPoint(d,e)};this.setCenter=function(a){switch(v){case TGOS.TGCoordSys.EPSG3826:TGOS.moveMapTo_(this,
a.x,a.y);break;case TGOS.TGCoordSys.EPSG3825:TGOS.moveMapTo_(this,a.x,a.y);break;case TGOS.TGCoordSys.EPSG3857:a=d.Forward(b,new CPoint3(a.x,a.y,0)),TGOS.moveMapTo_(this,a.X,a.Y)}R.RefreshMap(!0)};this.getZoom=function(){return fa.getMapLevel()};this.setZoom=function(a){this.ZoomTo(a)};this.setBaseMapVisible=function(a){this.baseMapVisible=a;this.setMapTypeId()};this.setMapTypeId=function(a){if(!a||W!==a){void 0===a&&(a=W);var b=ga,d=t?Q.backgroundColor:TGOS.MapTypeBackgroundColor[a];Q.backgroundColor=
d;R.setColor(d);Z.setColor(d);for(d=0;d<b.length;d++)!b[d].skip&&b[d].putVisible&&(b[d].mapTypeId==a?this.baseMapVisible?b[d].putVisible(!0):b[d].putVisible(!1):b[d].putVisible(!1));TGOS.TGEvent.trigger(this,"maptypeid_changed");W=a;b=fa.getMapLevel();this.getCoordSys();fa.getMapMinLevel();d=fa.getMapMaxLevel();b>d&&(b=d);fa.putMapLevel(b);X.setActiveType(a);this.changeOverviewMapType(ha,a);R.RefreshMap(!0)}};this.panBy=function(a,b){S.panBy(a,b);R.RefreshMap(!0)};this.panToBounds=function(a){if(null!=
a.left&&null!=a.top&&null!=a.right&&null!=a.bottom){var b,d;switch(v){case TGOS.TGCoordSys.EPSG3857:a=TGOS.WGS84ToGoo(a.left,a.top);b=a.x;d=a.y;break;case TGOS.TGCoordSys.EPSG3826:b=a.left;d=a.top;break;case TGOS.TGCoordSys.EPSG3825:b=a.left,d=a.top}TGOS.moveMapTo_(this,b,d);R.RefreshMap(!0)}};this.getLayerList=function(){return ga};this.setMapAction=function(a,b){if(1==a){var d=R.getHObject(),e=function(a,e,g,h){DetachEvent(d,"mousedown",f,!1);freezeMap||S.InitMapEvent(this);null!=b&&b(a,e,g,h)},
f=function(a){RectangleTracker(R,a,e)};S.ExitMapEvent();AttachEvent(d,"mousedown",f,!1)}else freezeMap||S.InitMapEvent(this)};this.getCoordinateString=function(a,b){var d=R.ToMapPoint(a,b);return d.x+","+d.y};this.changeOverviewMapType=function(a,b){for(var d=0;d<a.length;d++)a[d].mapTypeId==b?a[d].putVisible(!0):a[d].putVisible(!1);Z.getMapBase().RefreshMap(!0)};var C=function(a,b){var d=TGOS.MapTypeDocumentName,e;switch(v){case TGOS.TGCoordSys.EPSG3826:d=TGOS.MapTypeDocumentName;break;case TGOS.TGCoordSys.EPSG3825:d=
TGOS.MapTypeDocumentNameTWD97_119;break;case TGOS.TGCoordSys.EPSG3857:d=TGOS.MapTypeDocumentNameGoogle,e=TGOS.CacheExtend3857}for(var f=0;f<a.length;f++)if(a[f]in d)if(a[f]!=TGOS.TGMapTypeId.IMAGENLSC&&a[f]!=TGOS.TGMapTypeId.NLSCMAP){var g;void 0!==e&&(g=e[a[f]]);var h=new MapCachedLayer(TGOS.TGMapTypeId_zh_TW[a[f]],d[a[f]],!1,ka,b,null,g);h.mapTypeId=a[f];ga.push(h)}else ga.push(a[f])},B=function(a,b){var d,e=TGOS.MapTypeIndexViewDocumentName;switch(v){case TGOS.TGCoordSys.EPSG3826:e=TGOS.MapTypeIndexViewDocumentName;
b="97";break;case TGOS.TGCoordSys.EPSG3825:e=TGOS.MapTypeIndexViewDocumentName;b="97_119";break;case TGOS.TGCoordSys.EPSG3857:e=TGOS.MapTypeIndexViewDocumentNameGoogle,b="google",d=TGOS.CacheExtend3857}for(var f=0;f<a.length;f++)if(a[f]in e)if(a[f]!=TGOS.TGMapTypeId.IMAGENLSC&&a[f]!=TGOS.TGMapTypeId.NLSCMAP){var g;void 0!==d&&(g=d[a[f]]);var h=new MapCachedLayer(TGOS.TGMapTypeId_zh_TW[a[f]],e[a[f]],!1,ka,b,null,g);h.mapTypeId=a[f];ha.push(h)}else ha.push(a[f])},H=[{z:0,x:5E4,y:3E6,sd:1.1811755952381E7},
{z:1,x:5E4,y:3E6,sd:9449404.76190475},{z:2,x:5E4,y:3E6,sd:4724702.38095239},{z:3,x:5E4,y:3E6,sd:2362351.19047619},{z:4,x:5E4,y:3E6,sd:944940.47619048},{z:5,x:5E4,y:3E6,sd:472470.23809524},{z:6,x:5E4,y:3E6,sd:236235.11904762},{z:7,x:5E4,y:3E6,sd:94494.04761905},{z:8,x:5E4,y:3E6,sd:47247.02380952},{z:9,x:5E4,y:3E6,sd:23623.51190476},{z:10,x:5E4,y:3E6,sd:9449.4047619},{z:11,x:5E4,y:3E6,sd:4724.70238095},{z:12,x:5E4,y:3E6,sd:2362.35119048},{z:13,x:5E4,y:3E6,sd:944.94047619}],A=function(a,b,d){var e=null;
b={container:b,visible:!0,addToMap:!1};void 0!==d&&(b.fitDiv=d);switch(v){case TGOS.TGCoordSys.EPSG3826:d={dpi:"OGC",levels:H,yNorthPositive:!1};e=new TGOS.TMSLayer("EMAP3826","https://wmts.nlsc.gov.tw/97/wmts/EMAP3826/default/default028mm/{z}/{y}/{x}",a,d,b);break;case TGOS.TGCoordSys.EPSG3825:d={dpi:"OGC",levels:H,yNorthPositive:!1};e=new TGOS.TMSLayer("EMAP3825","https://wmts.nlsc.gov.tw/97/wmts/EMAP3825/default/default028mm/{z}/{y}/{x}",a,d,b);break;case TGOS.TGCoordSys.EPSG3857:cacheExtendSetting=
TGOS.CacheExtend3857,d={yNorthPositive:!1},e=new TGOS.TMSLayer("EMAP","https://wmts.nlsc.gov.tw/wmts/EMAP/default/GoogleMapsCompatible/{z}/{y}/{x}",a,d,b)}return e},I=function(a,b,d){var e=null;b={container:b,visible:!0,addToMap:!1};void 0!==d&&(b.fitDiv=d);switch(v){case TGOS.TGCoordSys.EPSG3857:e=new TGOS.TMSLayer("PHOTO2","https://wmts.nlsc.gov.tw/wmts/PHOTO2/default/GoogleMapsCompatible/{z}/{y}/{x}",a,{yNorthPositive:!1},b)}return e},G=function(a,b,d){var e=null;b={container:b,visible:!0,addToMap:!1};
void 0!==d&&(b.fitDiv=d);switch(v){case TGOS.TGCoordSys.EPSG3826:d={matrixSet:"default028mm",layer:"EMAP3826",format:"image/jpeg"};e=new TGOS.WMTSLayer("\u901a\u7528\u7248\u96fb\u5b50\u5730\u5716","https://wmts.nlsc.gov.tw/97/wmts/EMAP3826",a,d,b);break;case TGOS.TGCoordSys.EPSG3825:d={matrixSet:"default028mm",layer:"EMAP3825",format:"image/jpeg"};e=new TGOS.WMTSLayer("\u901a\u7528\u7248\u96fb\u5b50\u5730\u5716","https://wmts.nlsc.gov.tw/97/wmts/EMAP3826",a,d,b);break;case TGOS.TGCoordSys.EPSG3857:d=
{matrixSet:"GoogleMapsCompatible",layer:"EMAP",format:"image/jpeg"},e=new TGOS.WMTSLayer("\u901a\u7528\u7248\u96fb\u5b50\u5730\u5716","https://wmts.nlsc.gov.tw/wmts",a,d,b)}return e},D=function(a,b,d){var e=null;b={container:b,visible:!0,addToMap:!1};void 0!==d&&(b.fitDiv=d);switch(v){case TGOS.TGCoordSys.EPSG3857:e=new TGOS.WMTSLayer("\u822a\u7167\u5716","https://wmts.nlsc.gov.tw/wmts",a,{matrixSet:"GoogleMapsCompatible",layer:"PHOTO2",format:"image/jpeg"},b)}return e},J=function(){V.style.width=
e.offsetWidth+"px";V.style.height=e.offsetHeight+"px";p=V.clientHeight;l=V.clientWidth;U.style.width=e.offsetWidth+"px";U.style.height=e.offsetHeight+"px";L.style.width=e.offsetWidth+"px";L.style.height=e.offsetHeight+"px";P.style.width=e.offsetWidth+"px";P.style.height=e.offsetHeight+"px";if(M)for(var a=0;a<M.length;a++){var b=M[a];if(b){var d=b.div.main;d.style.width=e.offsetWidth+"px";d.style.height=e.offsetHeight+"px";d=b.div.shadow;d.style.width=e.offsetWidth+"px";d.style.height=e.offsetHeight+
"px";d=b.paper.main;d.setSize(V.offsetWidth,V.offsetHeight);d=b.paper.shadow;d.setSize(V.offsetWidth,V.offsetHeight)}}z.setSize(V.offsetWidth,V.offsetHeight);E.setSize(V.offsetWidth,V.offsetHeight);ka.getMapBase().RefreshMap(!0);TGOS.TGEvent.trigger(ka,"idle")},K=function(){ia=document.createElement("div");V.appendChild(ia);ia.style.position="absolute";ia.style.right="0px";ia.style.bottom="0px";ia.style.width="145px";ia.style.height="145px";ia.style.display="inline";ia.style.backgroundColor="#ADD8E6";
ia.style.margin="5px";ia.style.border="2px solid";ia.style.zIndex=1E7;Z=new Overview(ia,R,fa,150,150,4);for(var a=0;a<ha.length;a++){var b=ha[a];if("string"==typeof b){var d=b;ha.splice(a,1);b==TGOS.TGMapTypeId.NLSCMAP?b="TMS"==k.getMapTypeNLSC()?A(Z,Z.getMapDiv().childNodes[0].childNodes[0],!0):G(Z,Z.getMapDiv().childNodes[0].childNodes[0],!0):b==TGOS.TGMapTypeId.IMAGENLSC&&(b="TMS"==k.getMapTypeNLSC()?I(Z,Z.getMapDiv().childNodes[0].childNodes[0],!0):D(Z,Z.getMapDiv().childNodes[0].childNodes[0],
!0));b.mapTypeId=d;a>=ha.length?ha[a]=b:ha.splice(a,0,b)}Z.getMapBase().AddLayer(ha[a]);ha[a].putVisible(!1)}},F=function(a){!oa&&fa.putMapLevel(a)&&(a=fa.getScale(),R.putScale(a),R.RefreshMap(!0))},t;this.setBackgroundColor=function(a){"string"==typeof a&&(t=!0,R.setColor(a),Q.backgroundColor=a)};this.getBackgroundColor=function(){return Q.backgroundColor};this.bcTimer=null;this.refreshMapWithIdle=function(a){clearTimeout(this.bcTimer);R.RefreshMap(!1);if(a){var b=this;this.bcTimer=setTimeout(function(){R.RefreshMap(!0);
TGOS.TGEvent.trigger(b,"idle")},20)}};this.setMapTypeNLSC=function(a){Ba=a};this.getMapTypeNLSC=function(){return Ba};this.initialize_=function(g){this.infoWindowLayer=new a(na,this);this.overlay=new f(la);if("EPSG3857"==v){ba="google";var h=d.Forward(b,new CPoint3(118.9940295414,25.30028310652,0)),k=d.Forward(b,new CPoint3(122.0064955717,21.896606644941,0));xa=new TGOS.TGEnvelope(k.X,k.Y,h.X,h.Y);var h=TGOS.MapTypeScales.EPSG3857.levelX,k=TGOS.MapTypeScales.EPSG3857.levelY,n=TGOS.MapTypeScales.EPSG3857.scales}else"EPSG3825"==
v?(ba="97_119",xa=new TGOS.TGEnvelope(339023.59349082,2425702.7292442,51368.8242689183,2799323.57990279),h=TGOS.MapTypeScales.EPSG3825.levelX,k=TGOS.MapTypeScales.EPSG3825.levelY,n=TGOS.MapTypeScales.EPSG3825.scales):(ba="97",xa=new TGOS.TGEnvelope(339023.59349082,2425702.7292442,51368.8242689183,2799323.57990279),h=TGOS.MapTypeScales.EPSG3826.levelX,k=TGOS.MapTypeScales.EPSG3826.levelY,n=TGOS.MapTypeScales.EPSG3826.scales);for(var t in TGOS.MapTypeMaxZoomLevel[v])Da=Math.max(TGOS.MapTypeMaxZoomLevel[v][t],
Da);t=[TGOS.TGMapTypeId.TGOSMAP,TGOS.TGMapTypeId.NLSCMAP,TGOS.TGMapTypeId.MOTCMAP,TGOS.TGMapTypeId.F2IMAGE,TGOS.TGMapTypeId.ROADMAP,TGOS.TGMapTypeId.HILLSHADEMIX,TGOS.TGMapTypeId.HILLSHADE,TGOS.TGMapTypeId.SEGISMAP,TGOS.TGMapTypeId.IMAGENLSC,TGOS.TGMapTypeId.TGOSMAP_NP];void 0!==g&&(void 0!==g.mapTypeNLSC&&this.setMapTypeNLSC(g.mapTypeNLSC),void 0!==g.mapTypeControlOptions&&void 0!==g.mapTypeControlOptions.mapTypeIds&&(t=g.mapTypeControlOptions.mapTypeIds));C(t,ba);B(t,ba);V=document.createElement("div");
e.appendChild(V);V.style.position="relative";V.style.overflow="hidden";V.style.width=e.offsetWidth+"px";V.style.height=e.offsetHeight+"px";V.style.border="0px";V.style.left="0px";V.style.top="0px";V.unselectable="on";V.className="hpack";l=V.clientWidth;p=V.clientHeight;fa=new TGOS.MapScaleLevel(Aa,Da,h,k,n);R=new MapBase(V,fa);this.bindEvents(this.getEventElement());e.style.overflow="hidden";R.AddElement(this.overlay);R.AddElement(this.infoWindowLayer);R.setColor("#a5bfdd");R.ZoomMapTo(xa);fa.FitLevel();
initControlArray(this);for(h=0;h<ga.length;h++)k=ga[h],"string"==typeof k&&(n=k,k==TGOS.TGMapTypeId.NLSCMAP?k="TMS"==this.getMapTypeNLSC()?A(this,this.getPanes().mapLayer):G(this,this.getPanes().mapLayer):k==TGOS.TGMapTypeId.IMAGENLSC&&(k="TMS"==this.getMapTypeNLSC()?I(this,this.getPanes().mapLayer):D(this,this.getPanes().mapLayer)),k.mapTypeId=n,k.skip=!1,ga[h]=k),R.AddLayer(k),1<R.getLayers().length&&k.putVisible(!1);K();this.IndexViewControl.Show(!0);h=this.getMapBase().getHObject();this.getMapBase().getHPackage().oncontextmenu=
function(){return!1};U=document.createElement("div");U.style.position="absolute";U.style.width="100%";U.style.height="100%";U.style.pointerEvents="auto";U.className="tgoverlayview";h.appendChild(U);P=document.createElement("div");P.style.position="absolute";P.style.width="100%";P.style.height="100%";P.className="tgshadow";P.style.pointerEvents="auto";h.appendChild(P);E=Raphael(P);E.canvas.setAttribute("fill-rule","evenodd");E.canvas.setAttribute("pointer-events","auto");E.rect(0,0,300,300).hide();
L=document.createElement("div");L.style.position="absolute";L.style.width="100%";L.style.height="100%";L.style.pointerEvents="auto";L.className="tgoverlay";h.appendChild(L);Raphael.fn.createMarker=function(a){var b=this.canvas.getElementsByTagName("defs")[0],d=document.createElementNS("http://www.w3.org/2000/svg","marker");d.setAttribute("id",Raphael.createUUID());d.setAttribute("markerWidth",22);d.setAttribute("markerHeight",22);d.setAttribute("viewBox","-11 -11 22 22");d.setAttribute("orient","auto");
var e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("fill",a.fillColor);e.setAttribute("fill-opacity",a.fillOpacity);e.setAttribute("stroke",a.strokeColor);e.setAttribute("stroke-width",a.strokeWeight);e.setAttribute("stroke-opacity",a.strokeOpacity);e.setAttribute("d",a.symbolStyle);d.appendChild(e);b.appendChild(d);return d.id};Raphael.fn.removeMarker=function(a){(a=def.getElementById(a))&&a.parentNode.removeChild(a)};z=Raphael(L);z.canvas.setAttribute("fill-rule",
"evenodd");z.canvas.setAttribute("pointer-events","auto");z.rect(0,0,300,300).hide();0<=t.length&&this.changeOverviewMapType(ha,t[0]);ua=new TGOS.CopyrightControl(this,TGOS.TGControlPosition.BOTTOM_LEFT);R.AddElement(ua);ja=new TGOS.ScaleBarControl(V,R,N.scaleControlOptions.controlPosition,N.scaleControlOptions.scaleControlStyle,this);R.AddElement(ja);X=new TGOS.MapTypeBarControl(this,N.mapTypeControlOptions,Z,ha);da=new TGOS.LevelBarControl(this.getHPackage(),fa,N.navigationControlOptions.controlPosition,
N.navigationControlOptions.style,this);R.AddElement(da);S=new TGOS.TGMapMove(fa,$,T,aa,O,N.draggableCursor,N.draggingCursor,X,this);S.InitMapEvent(this);this.setOptions(N);this.setOptions(g);R.RefreshMap(!0);window.onresize=function(){TGOS.TGEvent.trigger(ka,"resize")};TGOS.TGEvent.addListener(this,"resize",J);this.dataManager=new TGOS.TGData({map:this,style:null})};this.addIndependentContainer=function(a,b){var d=this.getMapBase().getHObject(),e=document.getElementsByClassName("tgoverlay")[0];document.getElementsByClassName("tgshadow");
Y||(Y=[]);var f;b&&(b.getLayerId&&(f=b.getLayerId()),Y.push(b));M||(M=[]);var g=document.createElement("div");g.style.position="absolute";g.style.width="100%";g.style.height="100%";g.style.pointerEvents="auto";g.className="IndependentContainerShadow";a&&(g.className=g.className+"_"+a);0>=M.length?d.insertBefore(g,e):d.insertBefore(g,M[0].div.main);var h=Raphael(g);h.canvas.setAttribute("fill-rule","evenodd");h.canvas.setAttribute("pointer-events","auto");h.rect(0,0,300,300).hide();var m=document.createElement("div");
m.style.position="absolute";m.style.width="100%";m.style.height="100%";m.style.pointerEvents="auto";m.className="IndependentContainer";a&&(m.className=m.className+"_"+a);d.insertBefore(m,e);d=Raphael(m);d.canvas.setAttribute("fill-rule","evenodd");d.canvas.setAttribute("pointer-events","auto");d.rect(0,0,300,300).hide();f={layerId:f,div:{main:m,shadow:g},paper:{main:d,shadow:h}};M.push(f);return f};this.removeAdvancedLayer=function(a){Y&&(a=Y.indexOf(a),0<=a&&Y.splice(a,1))};this.removeIndependentContainer=
function(a){var b=this.getMapBase().getHObject();if(M){var d=M.indexOf(a);0<=d&&(b.removeChild(a.div.main),b.removeChild(a.div.shadow),M.splice(d,1))}};this.getAdvancedLayers=function(){return Y};this.getIndependentContainers=function(){return M};this.moveIndependentContainerToTop=function(a){var b=this.getMapBase().getHObject();if(null!=b&&M&&null!=a){var d=M.indexOf(a);if(0<=d&&0<M.length){var e=document.getElementsByClassName("tgoverlay")[0];b.insertBefore(a.div.shadow,M[0].div.main);b.removeChild(a.div.main);
b.insertBefore(a.div.main,e);M.splice(d,1,a)}}};this.getPanes=function(){return{graphicLayer:L,mapLayer:ka.getHObj(),shadowLayer:P,controlLayer:ka.getHPackage(),overlayviewLayer:U}};this.addLayer=function(a,b){a.skip=b;ga.push(a);R.AddLayer(a);R.RefreshMap(!0)};this.removeLayer=function(a){var b=ga.indexOf(a);0<=b&&(ga.splice(b,1),R.RemoveLayer(a));R.RefreshMap(!0)};this.getShadowPaper=function(){return E};this.getPaper=function(){return z};var v=g,z,E,L,P,U,Y,M,N={backgroundColor:"#a5bfdd",disableDefaultUI:!1,
draggable:!0,scrollwheel:!0,keyboardShortcuts:!0,draggableCursor:"",draggingCursor:"",mapTypeControl:!0,mapTypeControlOptions:{mapTypeIds:"EPSG3825"==v?[TGOS.TGMapTypeId.TGOSMAP,TGOS.TGMapTypeId.NLSCMAP]:[TGOS.TGMapTypeId.TGOSMAP,TGOS.TGMapTypeId.NLSCMAP,TGOS.TGMapTypeId.MOTCMAP,TGOS.TGMapTypeId.F2IMAGE,TGOS.TGMapTypeId.ROADMAP,TGOS.TGMapTypeId.HILLSHADEMIX,TGOS.TGMapTypeId.HILLSHADE,TGOS.TGMapTypeId.IMAGENLSC],controlPosition:TGOS.TGControlPosition.TOP_RIGHT,mapTypeControlStyle:TGOS.TGMapTypeControlStyle.DROPDOWN_MENU},
navigationControl:!0,navigationControlOptions:{controlPosition:TGOS.TGControlPosition.LEFT_CENTER,navigationControlStyle:TGOS.TGNavigationControlStyle.DEFAULT},scaleControl:!0,scaleControlOptions:{controlPosition:TGOS.TGControlPosition.LEFT_BOTTOM,scaleControlstyle:TGOS.TGScaleControlStyle.DEFAULT},indexViewControl:!1,indexViewControlOptions:TGOS.TGIndexViewControlOptions.MINIMIZED,maxZoom:null,minZoom:null,dbClickZoomIn:!0},Q={backgroundColor:"#a5bfdd",disableDefaultUI:!0,draggable:!0,scrollwheel:!0,
keyboardShortcuts:!0,draggableCursor:"",dragInertia:!0,draggingCursor:"",mapTypeControl:!0,mapTypeControlOptions:{mapTypeIds:[TGOS.TGMapTypeId.TGOSMAP,TGOS.TGMapTypeId.NLSCMAP,TGOS.TGMapTypeId.MOTCMAP,TGOS.TGMapTypeId.F2IMAGE,TGOS.TGMapTypeId.ROADMAP,TGOS.TGMapTypeId.HILLSHADEMIX,TGOS.TGMapTypeId.HILLSHADE,TGOS.TGMapTypeId.IMAGENLSC],controlPosition:TGOS.TGControlPosition.RIGHT_TOP,mapTypeControlStyle:TGOS.TGMapTypeControlStyle.DEFAULT},navigationControl:!0,navigationControlOptions:{controlPosition:TGOS.TGControlPosition.LEFT_TOP,
navigationControlStyle:TGOS.TGNavigationControlStyle.DEFAULT},scaleControl:!0,scaleControlOptions:{controlPosition:TGOS.TGControlPosition.LEFT_BOTTOM,scaleControlstyle:TGOS.TGScaleControlStyle.DEFAULT},indexViewControl:!1,indexViewControlOptions:TGOS.TGIndexViewControlOptions.NORMAL,maxZoom:null,minZoom:null,dbClickZoomIn:!0},$=!0,T=!0,aa=!0,O=!1,S=null,R=null,ka=this,V=null,ia=null,na=[],la=[],W=TGOS.TGMapTypeId.NLSCMAP,ba="97",ga=[],ha=[],Aa=this,ya=e,xa=null,Da=0,fa=null,oa=!1,ua=null,da=null,
X=null,ja=null,Z=null,Ba="WMTS";this.initialize_(h);TGOS.Log("web","A01","")};TGOS.TGOnlineMap.prototype=new TGOS.MVCObject;var e=TGOS.TGOnlineMap.prototype;e.triggerEvent=function(a,b){var d=this.getMapBase();if(d){var e=d.getPackageOffset(),f,g;a.changedTouches&&a.changedTouches.length?(f=a.changedTouches[0].clientX,g=a.changedTouches[0].clientY):(f=a.clientX,g=a.clientY);var h=d.ToMapDistX(1),d=d.ToMapPoint(f-e.x,g-e.y),k;switch(this.getMap().getCoordSys()){case TGOS.TGCoordSys.EPSG3857:k=TGOS.GooToWGS84(d.x,
d.y);break;case TGOS.TGCoordSys.EPSG3826:k=d;break;case TGOS.TGCoordSys.EPSG3825:k=d}d=!1;if(!0==this.overlayForwardEvent&&0<=this.overlayForwardEvents.indexOf(b)){if(!1==this.overlayStopClick){if(DEBUG_MODE){console.log("Map Event = "+b);var l=performance.now()}f-=e.x;var p=g-e.y,I=this.overlay.getArray(),e=I.length;for(g=e-1;0<=g;g--){var G=I[g];if(G.isPointInEnvelope){var D=G.isPointInEnvelope(k.x,k.y,h);if(null!=D&&!0==D&&(D=G.elem,void 0!==D&&D.isPointInside(f,p))){d=!0;D=new TGOS.TGMouseEvent(a);
D.point=new TGOS.TGPoint(k.x,k.y);D.target=G;TGOS.TGEvent.trigger_(G,b,D);break}}else D=new TGOS.TGMouseEvent(a),D.point=new TGOS.TGPoint(k.x,k.y),D.target=G,TGOS.TGEvent.trigger_(G,b,D)}DEBUG_MODE&&(h=performance.now()-l,console.log(b+" map.overlay "+g+" in "+e+" = "+h))}this.overlayStopClick=!1}d||(D=new TGOS.TGMouseEvent(a,b),D.point=new TGOS.TGPoint(k.x,k.y),D.target=this,TGOS.TGEvent.trigger_(this,b,D))}};e.onMouseUp=function(a){this.triggerEvent.call(this,a,"mouseup")};e.onMouseMove=function(a){this.triggerEvent.call(this,
a,"mousemove")};e.onMouseDown=function(a){this.__downE=a;this.triggerEvent.call(this,a,"mousedown");var b=this;a=function(a){b.onDrag.apply(b,arguments)};var d=function(a){b.onDragEnd.apply(b,arguments);DetachEvent(b.elem,"mousemove",b.elem.dragWrapper);DetachEvent(b.elem,"mouseup",b.elem.dragEndWrapper);DetachEvent(b.elem,"touchmove",b.elem.dragWrapper);DetachEvent(b.elem,"touchend",b.elem.dragEndWrapper)};this.elem.dragWrapper=a;this.elem.dragEndWrapper=d;AttachEvent(this.elem,"mousemove",a);AttachEvent(this.elem,
"mouseup",d);AttachEvent(this.elem,"touchmove",a);AttachEvent(this.elem,"touchend",d)};e.onMouseOver=function(a){this.triggerEvent.call(this,a,"mouseover")};e.onMouseOut=function(a){this.triggerEvent.call(this,a,"mouseout")};e.onDblClick=function(a){this.triggerEvent.call(this,a,"dblclick")};e.isNearPosition=function(a,b){var d=!1,e,f,g,h;a.changedTouches&&b.changedTouches&&a.changedTouches.length&&b.changedTouches.length?(e=a.changedTouches[0].screenX,f=a.changedTouches[0].screenY,g=b.changedTouches[0].screenX,
h=b.changedTouches[0].screenY):(e=a.screenX,f=a.screenY,g=b.screenX,h=b.screenY);e-1!==g&&e!==g&&e+1!==g||f-1!==h&&f!==h&&f+1!==h||(d=!0);return d};e.isSamePosition=function(a,b){var d,e,f,g;a.changedTouches&&b.changedTouches&&a.changedTouches.length&&b.changedTouches.length?(d=a.changedTouches[0].screenX,e=a.changedTouches[0].screenY,f=b.changedTouches[0].screenX,g=b.changedTouches[0].screenY):(d=a.screenX,e=a.screenY,f=b.screenX,g=b.screenY);return d===f&&e===g};e.onDrag=function(a){this.isSamePosition(this.__downE,
a)||(DetachEvent(this.elem,"mousemove",this.elem.dragWrapper),DetachEvent(this.elem,"mouseup",this.elem.dragEndWrapper),DetachEvent(this.elem,"touchmove",this.elem.dragWrapper),DetachEvent(this.elem,"touchend",this.elem.dragEndWrapper))};e.onDragEnd=function(a){DetachEvent(this.elem,"mousemove",this.elem.dragWrapper);DetachEvent(this.elem,"mouseup",this.elem.dragEndWrapper);DetachEvent(this.elem,"touchmove",this.elem.dragWrapper);DetachEvent(this.elem,"touchend",this.elem.dragEndWrapper);this.isNearPosition(this.__downE,
a)&&(a.button==TGOS.TGEvent.RIGHTBUTTON?this.triggerEvent.call(this,a,"rightclick"):this.triggerEvent.call(this,a,"click"))};e.bindEvents=function(){if(this.elem=this.getEventElement()){var a=this;AttachEvent(this.elem,"mouseup",function(b){DEBUG_MODE&&console.log("Map mouseup.");a.onMouseUp.apply(a,arguments)});AttachEvent(this.elem,"mousemove",function(b){DEBUG_MODE&&console.log("Map mousemove.");a.onMouseMove.apply(a,arguments)});AttachEvent(this.elem,"mousedown",function(b){DEBUG_MODE&&console.log("Map mousedown.");
a.onMouseDown.apply(a,arguments)});AttachEvent(this.elem,"mouseover",function(b){DEBUG_MODE&&console.log("Map mouseover.");a.onMouseOver.apply(a,arguments)});AttachEvent(this.elem,"mouseout",function(b){DEBUG_MODE&&console.log("Map mouseout.");a.onMouseOut.apply(a,arguments)});AttachEvent(this.elem,"dblclick",function(b){DEBUG_MODE&&console.log("Map dblclick.");a.onDblClick.apply(a,arguments)});AttachEvent(this.elem,"touchstart",function(b){DEBUG_MODE&&console.log("Map touchstart.");a.onMouseDown.apply(a,
arguments)});AttachEvent(this.elem,"touchend",function(b){DEBUG_MODE&&console.log("Map touchend.");a.onMouseUp.apply(a,arguments)});AttachEvent(this.elem,"touchmove",function(b){a.onMouseMove.apply(a,arguments)})}};TGOS.RegisterEvent(TGOS.TGOnlineMap,"bounds_changed center_changed zoom_changed maptypeid_changed tilesloaded click mousedown mousemove mouseout mouseover projection_changed dragstart drag dragend idle resize dblclick rightclick".split(" "));TGOS.moveMapTo_=function(a,b,d){var e=a.getMapBase().getCenterX(),
f=a.getMapBase().getCenterY(),g=a.getBounds().toString();a.getMapBase().MoveMapTo(b,d);var h=a.getBounds().toString();e==b&&f==d||TGOS.TGEvent.trigger(a,"center_changed");g!=h&&TGOS.TGEvent.trigger(a,"bounds_changed")};TGOS.TGIndexViewControl=function(a){this.show=function(b){a.IndexViewControl&&a.IndexViewControl.Show(b)};this.minimize=function(){a.IndexViewControl.minimize()}};TGOS.TGMapMove=function(a,b,d,e,f,g,h,k,l,p){var I,G=!1,D,J=0,K,F,t,v,z,E,L=!1,P=!1,U,Y,M=!1,N="",Q="",$=!0,T=!1,aa=null,
O,S=!1,R=0,ka=0,V=0,ia=null,na=null,la=null,W=null,ba=function(){var a=W-na;ka=(la-ia)/50;V=a/50};this.ExitMapEvent=null;this.IsMapAction=function(){return M};var ga=function(a,b,d){var e=l.getMapBase(),f=e.getCenterX(),g=e.getCenterY(),h=a.x-f,m=a.y-g;d=1E3/d;var k=(new Date).getTime(),v=setInterval(function(){var d=(new Date).getTime();d-k>1E3*b?(TGOS.moveMapTo_(l,a.x,a.y),l.refreshMapWithIdle(!0),clearInterval(v)):(d=(d-k)/(1E3*b),e.putCenterX(f+d*h),e.putCenterY(g+d*m),l.refreshMapWithIdle(!1))},
d)};this.panBy=function(a,b){var d=l.getMapBase(),e=d.getClientWidth(),f=d.getClientHeight(),g=d.getCenterX()+a,h=d.getCenterY()+b,d=d.FromMapPoint(g,h);0<=d.x&&d.x<=e&&0<=d.y&&d.y<=f?ga({x:g,y:h},0.5,30):TGOS.moveMapTo_(l,g,h)};this.panToBounds=function(a){var b=l.getMapBase();a=b.getClientWidth();var d=b.getClientHeight(),e=b.getCenterX()+offsetX,f=b.getCenterY()+offsetY,b=b.FromMapPoint(e,f);0<=b.x&&b.x<=a&&0<=b.y&&b.y<=d?ga({x:e,y:f},0.5,30):TGOS.moveMapTo_(l,e,f)};this.setMapBounds=function(a){p=
a;var b=l.getMapBase();a=b.getCenterX();b=b.getCenterY();a=l.checkMapBoundsRestrict(p,a,b);null!=a&&(TGOS.moveMapTo_(l,a.x,a.y),l.refreshMapWithIdle(!0))};this.allowKeyboard=function(a){"boolean"==typeof a&&($=a)};this.clearNum=function(){c=0};var ha=!0;this.setDragInertia=function(a){"boolean"==typeof a&&(ha=a)};this.changeDraggableCursor=function(a){N=a;O.style.cursor=N};this.changeDraggingCursor=function(a){Q=a};this.InitMapEvent=function(g){var h=g.getMapBase();O=h.getHObject();h.getHPackage();
var k=[],w=function(a){setTimeout(function(){J=0},a)},B=function(a,b,d){var e=20;d&&(e=d);return Math.abs(a.X-b.X)<=e&&Math.abs(a.Y-b.Y)<=e?!0:!1},C=function(a,b){var d=h.getCursorPosition(a),e=h.getCursorPosition(b),f=parseFloat((d.x+e.x)/2),g=parseFloat((d.y+e.y)/2),d=Math.sqrt((d.x-e.x)*(d.x-e.x)+(d.y-e.y)*(d.y-e.y));return{scrCenter:{X:f,Y:g},length:d}},ga=function(a){var b;k=a.touches;ma&&ma.stop();V=ka=0;a=k[0];b={X:a.clientX,Y:a.clientY,MX:h.getCenterX(),MY:h.getCenterY()};0==J?J=1:2==J&&!0==
B(b,I)?(J=3,D=a):J=0;I=b;if(1<k.length){b=C(a,k[1]);a=b.scrCenter;var d=b.length;K=b=h.ToMapPoint(a.X,a.Y);F=a;t=d;v=h.getCellSizeX();z=h.getCellSizeY();E=h.getScale();L=!0}else la=k[0].clientX,W=k[0].clientY,ia=la,na=W,ra=setInterval(ba,50),Ca=!1,Ea=0;G=!0},da=function(a){if(G)if(a.preventDefault(),k=a.touches,a=k[0],0==J||B({X:a.clientX,Y:a.clientY},I)||(J=0),1<k.length){if(!P){P=!0;var b=k[1];if(L&&(a=C(a,b),b=a.scrCenter,!B(b,F,5))){a=parseFloat(a.length/t);var d=h.getClientWidth()/2-b.X,b=h.getClientHeight()/
2-b.Y,b=new TGOS.TGPoint(K.x+d*v/a,K.y+b*z/a);h.putScale(E*a);TGOS.moveMapTo_(l,b.x,b.y);l.refreshMapWithIdle(!1)}P=!1}}else Ia&&(clearTimeout(Ia),Ca=!1),setTimeout(Z,500),Ea++,ia=la,na=W,la=a.clientX,W=a.clientY,TGOS.moveMapTo_(l,I.MX-h.ToMapDistX(a.clientX-I.X),I.MY-h.ToMapDistY(a.clientY-I.Y)),l.refreshMapWithIdle(!1)},X=function(b){if(G)if(L=G=!1,b.preventDefault(),k=b.touches,3==J)J=0,va(D),l.onDblClick(D);else{if(ha&&!L&&Math.hypot(ka,V)>ta&&2<Ea&&!Ca){var d=h.getCenterX(),e=h.getCenterY(),
f=h.ToMapDistX(-ka*pa),g=h.ToMapDistY(-V*pa);b=l.checkMapBoundsRestrict(p,d+f,e+g);null!=b&&(f=b.x-d,g=b.y-e);ma=TGOS.fx.createAnimation({easing:TGOS.fx.easing.quadOut,type:window.requestAnimationFrame?"req":"setTimeout",duration:pa,repeat:!1,onAnimation:function(a){TGOS.moveMapTo_(l,d+f*a,e+g*a);l.refreshMapWithIdle(!1)},onEnd:function(){a.FitLevel();l.refreshMapWithIdle(!0)}});ma.play()}else{b=h.getCenterX();var v=h.getCenterY();b=l.checkMapBoundsRestrict(p,b,v);null!=b&&TGOS.moveMapTo_(l,b.x,b.y);
a.FitLevel();l.refreshMapWithIdle(!0)}clearInterval(ra);J=1==J?2:0;w(500)}},ja=function(a){k=[];l.refreshMapWithIdle(!0);G=!1},Z=function(){Ca=!0},Ba=function(a){a.preventDefault();util.disableDefault(a);if(d){var b=a.screenX-U,e=a.screenY-Y;U=a.screenX;Y=a.screenY;Ia&&(clearTimeout(Ia),Ca=!1);setTimeout(Z,500);Ea++;ia=la;na=W;la=a.screenX;W=a.screenY;S=!0;O.style.cursor=Q?Q:"url("+TGOS.RES_PATH+"catch.cur),default";a=h.getCenterX()-h.ToMapDistX(b);e=h.getCenterY()-h.ToMapDistY(e);TGOS.moveMapTo_(l,
a,e);l.refreshMapWithIdle(!1);1>R&&TGOS.TGEvent.trigger(l,"dragstart");TGOS.TGEvent.trigger(l,"drag");R++}},ma,pa=500,ta=0.08,za=function(b){util.disableDefault(b);if(d){DetachEvent(O,"mousemove",Ba,!0);DetachEvent(O,"mouseup",za,!0);O.style.cursor=N?N:"default";M=!1;if(ha&&Math.hypot(ka,V)>ta&&2<Ea&&!Ca){var e=h.getCenterX(),f=h.getCenterY(),g=h.ToMapDistX(-ka*pa),k=h.ToMapDistY(-V*pa);b=l.checkMapBoundsRestrict(p,e+g,f+k);null!=b&&(g=b.x-e,k=b.y-f);ma=TGOS.fx.createAnimation({easing:TGOS.fx.easing.quadOut,
type:window.requestAnimationFrame?"ra":"setTimeout",duration:pa,repeat:!1,onAnimation:function(a){TGOS.moveMapTo_(l,e+g*a,f+k*a);l.refreshMapWithIdle(!1)},onEnd:function(){a.FitLevel();l.refreshMapWithIdle(!0)}});ma.play()}else b=l.checkMapBoundsRestrict(p,h.getCenterX(),h.getCenterY()),null!=b&&TGOS.moveMapTo_(l,b.x,b.y),a.FitLevel(),l.refreshMapWithIdle(!0);clearInterval(ra);S&&TGOS.TGEvent.trigger(l,"dragend");TGOS.Log("web","A01","")}},ra,Ia,Ea=0,Ca=!0,Ha=function(a){a.preventDefault();util.disableDefault(a);
ma&&ma.stop();Ca=!1;V=ka=Ea=0;la=a.screenX;W=a.screenY;ia=la;na=W;ra=setInterval(ba,50);d&&(M=!0,S=!1,R=0,AttachEvent(O,"mouseup",za,!0),AttachEvent(O,"mousemove",Ba,!0),O.focus())},Ma=function(a){a.preventDefault();util.disableDefault(a);d&&(M=!0,U=a.screenX,Y=a.screenY)},va=function(d){util.disableDefault(d);b&&(M=!0,d=h.getCursorPosition(d),d=h.ToMapPoint(d.x,d.y),a.putMapLevel(a.getMapLevel()+1),TGOS.moveMapTo_(l,d.x,d.y),l.refreshMapWithIdle(!0))},Fa=function(b){util.disableDefault(b);if(e){M=
!0;var d=h.getCursorPosition(b),f=h.getClientWidth()/2,g=h.getClientHeight()/2;h.FromMapPoint(f,g);d=h.ToMapPoint(d.x,d.y);f=h.getScale();b=b.wheelDelta?b.wheelDelta:-b.detail;g=0;0<b?g=1:0>b&&(g=-1);a.putMapLevel(a.getMapLevel()+g);b=h.getScale()/f;d=new TGOS.TGPoint((h.getCenterX()-d.x)/b+d.x,(h.getCenterY()-d.y)/b+d.y);p&&(b=l.checkMapBoundsRestrict(p,d.x,d.y),null!=b&&(d.x=b.x,d.y=b.y));TGOS.moveMapTo_(l,d.x,d.y);l.refreshMapWithIdle(!0)}},qa=0,Na=function(a){$&&(qa=0)},Ja=function(a){function b(a,
d){TGOS.moveMapTo_(l,h.getCenterX()+a,h.getCenterY()+d);l.refreshMapWithIdle(!1)}if($&&!T){var d=h.getTransformation();qa+=4;24<qa&&(qa=24);var e=1/d.getScaleX()*qa,f=1/d.getScaleY()*qa;switch(a.keyCode){case 37:b(-e,0);break;case 38:b(0,-f);break;case 39:b(e,0);break;case 40:b(0,f);break;case 107:d.putMapLevel(d.getMapLevel()+1);l.refreshMapWithIdle(!0);break;case 109:d.putMapLevel(d.getMapLevel()+-1),l.refreshMapWithIdle(!0)}}};this.isDblClickEnabled=function(){return b};this.OpenCloseDblClick=
function(a){b&&a||((b=a)?AttachEvent(O,"dblclick",va,!1):DetachEvent(O,"dblclick",va,!1))};var Oa=function(a){if(T){var b=TGOS.KeyboardEditor.NONE;switch(a.keyCode){case 37:b=TGOS.KeyboardEditor.LEFT;break;case 38:b=TGOS.KeyboardEditor.UP;break;case 39:b=TGOS.KeyboardEditor.RIGHT;break;case 40:b=TGOS.KeyboardEditor.DOWN;break;case 46:b=TGOS.KeyboardEditor.DEL}aa&&aa.call(this,b,l)}};this.OpenCloseKeyboardEditor=function(a,b){T&&a||(T=a,aa=b,a?AttachEvent(O,"keydown",Oa,!1):DetachEvent(O,"keydown",
Oa,!1))};this.OpenCloseMove=function(a){d&&a||((d=a)?(AttachEvent(O,"mousedown",Ha,!1),AttachEvent(O,"touchstart",ga,!1),AttachEvent(O,"touchend",X,!1),AttachEvent(O,"touchcancel",ja,!1),AttachEvent(O,"touchleave",X,!1),AttachEvent(O,"touchmove",da,!1)):(DetachEvent(O,"mousedown",Ha,!1),DetachEvent(O,"touchstart",ga,!1),DetachEvent(O,"touchend",X,!1),DetachEvent(O,"touchcancel",ja,!1),DetachEvent(O,"touchleave",X,!1),DetachEvent(O,"touchmove",da,!1)))};this.OpenCloseWheel=function(a){e&&a||(a?AttachEvent(O,
"mousewheel",Fa,!1):DetachEvent(O,"mousewheel",Fa,!1),e=a)};this.OpenClosekeyboard=function(a){f&&a||(f=a,!1==a?(DetachEvent(O,"keydown",Ja,!1),DetachEvent(O,"keyup",Na,!1)):(AttachEvent(O,"keydown",Ja,!1),AttachEvent(O,"keyup",Na,!1)))};this.ExitMapEvent=function(){e&&DetachEvent(O,"mousewheel",Fa,!1);DetachEvent(O,"mousedown",Ha,!1);DetachEvent(O,"mousedown",Ma,!1);b&&DetachEvent(O,"dblclick",va,!1);DetachEvent(O,"touchstart",ga,!1);DetachEvent(O,"touchend",X,!1);DetachEvent(O,"touchcancel",ja,
!1);DetachEvent(O,"touchleave",X,!1);DetachEvent(O,"touchmove",da,!1)};AttachEvent(O,"mousedown",Ha,!1);AttachEvent(O,"mousedown",Ma,!1);AttachEvent(O,"contextmenu",function(a){},!1);AttachEvent(O,"keydown",Ja,!1);AttachEvent(O,"keyup",Na,!1);b&&AttachEvent(O,"dblclick",va,!1);e&&AttachEvent(O,"mousewheel",Fa,!1);AttachEvent(O,"touchstart",ga,!1);AttachEvent(O,"touchend",X,!1);AttachEvent(O,"touchcancel",ja,!1);AttachEvent(O,"touchleave",X,!1);AttachEvent(O,"touchmove",da,!1)}};TGOS.MapScaleLevel=
function(a,b,d,e,f){function g(a){for(var b=0,b=0;b<D.length-1&&!(a<D[b+1]);b++);if(b<D.length-1)var d=D[b],e=D[b+1],b=b+Math.log(a/d)/Math.log(e/d);return b}function h(a){var b=Math.floor(Math.max(0,Math.min(a,D.length-2))),d=D[b];return d*Math.pow(D[b+1]/d,a-b)}var k=1,l=b,p=null,I=256/d,G=256/e,D=[];for(b=0;b<f.length;b++)D.push(f[f.length-1]/f[b]);D.reverse();var J=1,K;this.FitLevel=function(){this.putMapLevel(Math.round(k))};this.setMapBoundsLevel=function(b){if(K=b)b=a.getMapBase(),b.getClientHeight(),
b=b.getClientWidth()/(K.right-K.left),b=Math.ceil(g(b/I)),b<p&&(b=p),b>l&&(b=l),this.setMapMinLevel(b)};this.getBaseScaleX=function(){return I};this.putBaseScaleX=function(a){I=a};this.getBaseScaleY=function(){return G};this.putBaseScaleY=function(a){G=a};this.getMapMinLevel=function(){return p};this.setMapMinMaxLevel=function(b,d){l=null==d?TGOS.MapTypeMaxZoomLevel[a.getCoordSys()][a.getMapTypeId()]:Math.min(d,TGOS.MapTypeMaxZoomLevel[a.getCoordSys()][a.getMapTypeId()]);p=null==b?0:b;k>l?(this.putMapLevel(l),
a.setZoom(l)):k<p&&(this.putMapLevel(p),a.setZoom(p))};this.setMapMaxLevel=function(b){l=null==b?TGOS.MapTypeMaxZoomLevel[a.getCoordSys()][a.getMapTypeId()]:Math.min(b,TGOS.MapTypeMaxZoomLevel[a.getCoordSys()][a.getMapTypeId()]);k>l&&(this.putMapLevel(l),a.setZoom(l))};this.getMapMaxLevel=function(){Math.min(l,TGOS.MapTypeMaxZoomLevel[a.getCoordSys()][a.getMapTypeId()]);return l};this.setMapMinLevel=function(b){p=null==b?0:b;k<p&&(this.putMapLevel(p),a.setZoom(p))};this.getLevelNumber=function(){return this.getMapMaxLevel()-
this.getMapMinLevel()};this.getMapLevel=function(){return k};this.putMapLevel=function(b){var d=a.getMapBase().getCenterX(),e=a.getMapBase().getCenterY(),f=a.getBounds().toString(),g=TGOS.MapTypeMaxZoomLevel[a.getCoordSys()][a.getMapTypeId()],g=null==l?g:g>l?l:g,n=null==p?0:p,q=b>g?g:b<n?n:b,s=k!==b;k=q;J=h(k);var u=a.getMapTypeId(),w=a.getCoordSys();TGOS.Log("web","A02",TGOS.TGMapTypeIdCode[u]);"EPSG3826"==w||"EPSG3825"==w?"TGOSMAP"==u&&13==q&&TGOS.Log("web","A02",TGOS.TGMapTypeIdCode.NLSCMAP):"EPSG3857"==
w&&"TGOSMAP"==u&&19==q&&TGOS.Log("web","A02",TGOS.TGMapTypeIdCode.NLSCMAP);q=a.getMapBase().getCenterX();u=a.getMapBase().getCenterY();w=a.getBounds().toString();d==q&&e==u||TGOS.TGEvent.trigger(a,"center_changed");f!=w&&TGOS.TGEvent.trigger(a,"bounds_changed");s&&TGOS.TGEvent.trigger(a,"zoom_changed");K&&(d=a.getMapBase().getCenterX(),e=a.getMapBase().getCenterY(),d=a.checkMapBoundsRestrict(K,d,e),null!=d&&(TGOS.moveMapTo_(a,d.x,d.y),a.getMapBase().RefreshMap(!1)));TGOS.TGEvent.trigger(a,"idle");
return b>g||b<n?!1:!0};this.getScale=function(){return I*J};this.putScale=function(a){this.putMapLevel(g(a/I))};this.getScaleX=function(){return I*J};this.getScaleY=function(){return G*J};this.getLevelScale=function(a){return I*h(a)}};TGOS.TGTransStatus={OK:"OK",INVALID_REQUEST:"INVALID_REQUEST"};TGOS.TGMaxZoomLevel=function(){this.getMaxZoomLevel=function(a,b,d){return d.call(this,TGOS.MapTypeMaxZoomLevel[b][a])}};Proj4js.defs["EPSG:3826"]="+title=TWD97 TM2+proj=tmerc +lat_0=0 +lon_0=121 +k=0.9999 +x_0=250000 +y_0=0 +ellps=GRS80 +units=\u516c\u5c3a +no_defs";
Proj4js.defs["EPSG:3857"]="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs";Proj4js.defs["EPSG:3825"]="+title=\u4e8c\u5ea6\u5206\u5e36\uff1aTWD97 TM2 \u6f8e\u6e56 +proj=tmerc +lat_0=0 +lon_0=119 +k=0.9999 +x_0=250000 +y_0=0 +ellps=GRS80 +units=\u516c\u5c3a +no_defs";Proj4js.defs["EPSG:3828"]="+proj=tmerc +lat_0=0 +lon_0=121 +k=0.9999 +x_0=250000 +y_0=0 +ellps=aust_SA +towgs84=-752,-358,-179,-0.0000011698,0.0000018398,0.0000009822,0.00002329 +units=m +no_defs";
var g=new Proj4js.Proj("EPSG:3828"),h=new Proj4js.Proj("EPSG:3826"),k=new Proj4js.Proj("EPSG:3825"),l=new Proj4js.Proj("EPSG:3857"),p=new Proj4js.Proj("EPSG:4326");TGOS.TWD97toWGS84=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(h,p,d);return d};TGOS.WGS84toTWD97=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(p,h,d);return d};TGOS.TWD97_119toWGS84=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(k,
p,d);return d};TGOS.TWD67toWGS84=TGOS.TWD97_119toWGS84;TGOS.WGS84toTWD97_119=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(p,k,d);return d};TGOS.WGS84toTWD67=TGOS.WGS84toTWD97_119;TGOS.TWD97toTWD97_119=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(h,k,d);return d};TGOS.TWD97toTWD67=TGOS.TWD97toTWD97_119;TGOS.TWD97_119toTWD97=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(EPSG4325,h,
d);return d};TGOS.TWD67toTWD97=TGOS.TWD97_119toTWD97;TGOS.GooToWGS84=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(l,p,d);return d};TGOS.WGS84ToGoo=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(p,l,d);return d};TGOS.TGTransformation=function(){this.twd97towgs84=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(h,p,d);this.transResult=new TGOS.TGPoint(d.x,d.y);TGOS.Log("web","A06","")};
this.twd97totwd67=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(h,g,d);this.transResult=new TGOS.TGPoint(d.x,d.y);TGOS.Log("web","A06","")};this.twd67totwd97=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(g,h,d);this.transResult=new TGOS.TGPoint(d.x,d.y);TGOS.Log("web","A06","")};this.wgs84totwd67=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(p,g,d);this.transResult=new TGOS.TGPoint(d.x,
d.y);TGOS.Log("web","A06","")};this.twd67towgs84=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(g,p,d);this.transResult=new TGOS.TGPoint(d.x,d.y);TGOS.Log("web","A06","")};this.wgs84totwd97=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(p,h,d);this.transResult=new TGOS.TGPoint(d.x,d.y);TGOS.Log("web","A06","")};this.twd97_119towgs84=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(k,p,d);
this.transResult=new TGOS.TGPoint(d.x,d.y);TGOS.Log("web","A06","")};this.wgs84totwd97_119=function(a,b){var d=new Proj4js.Point(parseFloat(a),parseFloat(b));Proj4js.transform(p,k,d);this.transResult=new TGOS.TGPoint(d.x,d.y);TGOS.Log("web","A06","")};this.transResult=null}})();TGOS.Graphic=function(){var b=function(){this.type="TGGraphic"};TGOS.extend(TGOS.MVCObject,b);var d=b.prototype;d.triggerEvent=function(a,b){var d=this.getMapBase();if(d){var g=d.getPackageOffset(),h,k;a.changedTouches&&a.changedTouches.length?(h=a.changedTouches[0].clientX,k=a.changedTouches[0].clientY):(h=a.clientX,k=a.clientY);var d=d.ToMapPoint(h-g.x,k-g.y),l;switch(this.getMap().getCoordSys()){case TGOS.TGCoordSys.EPSG3857:l=TGOS.GooToWGS84(d.x,d.y);break;case TGOS.TGCoordSys.EPSG3826:l=d;break;
case TGOS.TGCoordSys.EPSG3825:l=d}d=new TGOS.TGMouseEvent(a);d.point=new TGOS.TGPoint(l.x,l.y);d.target=this;TGOS.TGEvent.trigger_(this,b,d)}};d.onMouseUp=function(a){this.triggerEvent.call(this,a,"mouseup")};d.onMouseMove=function(a){this.triggerEvent.call(this,a,"mousemove")};d.onMouseDown=function(a){this.__downE=a;this.triggerEvent.call(this,a,"mousedown");var b=this;a=function(){b.onDrag.apply(b,arguments)};var d=function(){b.onDragEnd.apply(b,arguments)};this.elem.dragWrapper=a;this.elem.dragEndWrapper=
d;this.elem.mousemove(a);this.elem.mouseup(d)};d.onMouseOver=function(a){this.triggerEvent.call(this,a,"mouseover")};d.onMouseOut=function(a){this.triggerEvent.call(this,a,"mouseout")};d.onDblClick=function(a){this.triggerEvent.call(this,a,"dblclick")};d.onClick=function(a){this.triggerEvent.call(this,a,"click")};d.onMoved=function(a){this.triggerEvent.call(this,a,"moved")};d.isSamePosition=function(a,b){var d,g,h,k;a.changedTouches&&b.changedTouches&&a.changedTouches.length&&b.changedTouches.length?
(d=a.changedTouches[0].screenX,g=a.changedTouches[0].screenY,h=b.changedTouches[0].screenX,k=b.changedTouches[0].screenY):(d=a.screenX,g=a.screenY,h=b.screenX,k=b.screenY);return d===h&&g===k};d.onDrag=function(a){this.isSamePosition(this.__downE,a)||(this.elem.unmousemove(this.elem.dragWrapper),this.elem.unmouseup(this.elem.dragEndWrapper))};d.onDragEnd=function(a){this.elem.unmousemove(this.elem.dragWrapper);this.elem.unmouseup(this.elem.dragEndWrapper);a.button==TGOS.TGEvent.RIGHTBUTTON?(this.map&&
this.map.setOverlayStopClick(),this.triggerEvent.call(this,a,"rightclick")):(this.map&&this.map.setOverlayStopClick(),this.triggerEvent.call(this,a,"click"))};d.bindEvents=function(){if(this.elem=this.getEventElement()){var a=this;this.elem.mouseup(function(b){a.onMouseUp&&a.onMouseUp.apply(a,arguments)});this.elem.mousemove(function(b){a.onMouseMove&&a.onMouseMove.apply(a,arguments)});this.elem.mousedown(function(b){a.onMouseDown&&a.onMouseDown.apply(a,arguments)});this.elem.mouseover(function(b){a.onMouseOver&&
a.onMouseOver.apply(a,arguments)});this.elem.mouseout(function(b){a.onMouseOut&&a.onMouseOut.apply(a,arguments)});this.elem.dblclick(function(b){a.onDblClick&&a.onDblClick.apply(a,arguments)})}};d.annotation=null;return b}();TGOS.TGGraphic=function(){var b=function(a){this.gs_=[];a&&(this.geometry=a,a.geometry instanceof TGOS.TGGeometry&&(this.geometry=a.geometry),a.properties&&(this.properties=a.properties),a.id&&(this.id=a.id))},d=b.prototype;d.id=null;d.geometry=null;d.properties=null;d.style=null;d.gs_=null;d.getGeometry=function(){return this.geoemtry};d.getProperty=function(a){if(this.properties)return this.properties[a]};d.setProperty=function(a,b){if(this.properties&&a){var d=this.properties[a];this.properties[a]=
b;TGOS.TGEvent.trigger_(this,"setproperty",{graphic:this,name:a,oldValue:d,newValue:b})}};d.redraw=function(a){this.clear();this.draw(a)};d.setGeometry=function(a){if(!a){var b=this.geometry;this.geometrty=a;TGOS.TGEvent.trigger_(this,"setgeometry",{graphic:this,oldGeometry:b,newGeometry:value})}};d.removeProperty=function(a){if(this.properties&&a&&a in this.properties){var b=this.properties[a];this.properties[a]=void 0;TGOS.TGEvent.trigger_(this,"removeproperty",{graphic:this,name:a,oldValue:b})}};
d.setStyle=function(a){this.style=a};d.clear=function(){for(var a=0;a<this.gs_.length;a++)this.gs_[a].setMap(null);this.gs_=[]};d.bindEvents=function(a){var b=this;TGOS.TGEvent.addListener(a,"mousedown",function(a){TGOS.TGEvent.trigger_(b,"mousedown",a)});TGOS.TGEvent.addListener(a,"mouseup",function(a){TGOS.TGEvent.trigger_(b,"mouseup",a)});TGOS.TGEvent.addListener(a,"mousemove",function(a){TGOS.TGEvent.trigger_(b,"mousemove",a)});TGOS.TGEvent.addListener(a,"mouseover",function(a){TGOS.TGEvent.trigger_(b,
"mouseover",a)});TGOS.TGEvent.addListener(a,"dblclick",function(a){TGOS.TGEvent.trigger_(b,"dblclick",a)});TGOS.TGEvent.addListener(a,"click",function(a){TGOS.TGEvent.trigger_(b,"click",a)});TGOS.TGEvent.addListener(a,"rightclick",function(a){TGOS.TGEvent.trigger_(b,"rightclick",a)});TGOS.TGEvent.addListener(a,"mouseout",function(a){TGOS.TGEvent.trigger_(b,"mouseout",a)})};d.style_changed=function(){};d.ownStyle=null;d.draw=function(a,b){if(a&&(b=b?b:this.geometry)){var d=this.ownStyle||this.style;
"function"==typeof d&&(d=d(this));if(b instanceof TGOS.TGPoint)d=new TGOS.TGMarker(a,b,null,null,d),this.bindEvents(d),this.gs_.push(d);else if(b instanceof TGOS.TGLineString)d=new TGOS.TGLine(a,b,d),this.bindEvents(d),this.gs_.push(d);else if(b instanceof TGOS.TGPolygon)d=new TGOS.TGFill(a,b,d),this.bindEvents(d),this.gs_.push(d);else if(b instanceof TGOS.TGMultiLineString)d=new TGOS.TGLine(a,b,d),this.bindEvents(d),this.gs_.push(d);else if(b instanceof TGOS.TGMultiPolygon)d=new TGOS.TGFill(a,b,
d),this.bindEvents(d),this.gs_.push(d);else if(b instanceof TGOS.TGMultiPoint)for(var d=b.getArray(),g=0;g<d.length;g++)this.draw(a,d[g]);else if(b instanceof TGOS.TGGeometryCollection)for(d=b.getArray(),g=0;g<d.length;g++)this.draw(a,d[g])}};TGOS.RegisterEvent(b,"setproperty removeproperty click dblclick mousedown mouseup mouseout mouseover mousemove rightclick".split(" "));return b}();(function(){function b(a){a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation()}var d=function(a,b){switch(a){case TGOS.TGCoordSys.EPSG3857:var d=TGOS.WGS84ToGoo(b.x,b.y);break;case TGOS.TGCoordSys.EPSG3826:d=b;break;case TGOS.TGCoordSys.EPSG3825:d=b}return d},a=function(a,b,g,h,k){var l="";h=h.getPath().getPath();g=TGOS.simplifyLineString(h,g);h=k?d(b,g[g.length-1]):d(b,g[0]);h=a.FromMapPoint(h.x,h.y);l=l+"M"+h.x+" "+h.y;for(k=0;k<g.length;k++)h=d(b,g[k]),h=a.FromMapPoint(h.x,h.y),l=l+"L"+h.x+
" "+h.y;return l+" Z "};TGOS.TGFill=function(f,e,g){var h=0,k=0,l=f,p,m=e,n=!0,u=1,s=1,q="#88ff88",w="1",C="#000000",B=1,H="square",A="miter",I=1,G="none",D=0,J="",K=!0,F=!0;this.getEventElement=function(){return null==l?null:z};var t=this;this.endDrag=function(a){if(2<t.sclientx-a.clientX||2<t.sclienty-a.clientY||-2>t.sclientx-a.clientX||-2>t.sclienty-a.clientY)t.dragMoved=!0;b(a);DetachEvent(document.body,"mousemove",t.markMove,!0);DetachEvent(document.body,"mouseup",t.endDrag,!0);!t.dragMoved&&
t.editable?null!=t.clickCallback&&t.clickCallback.call(this,t):null!=t.movedCallback&&t.movedCallback.call(this,t)};this.markMove=function(a){b(a);var d=l.getMapBase(),e=d.getPackageOffset(),f;switch(l.getCoordSys()){case TGOS.TGCoordSys.EPSG3857:f=d.ToMapPoint(a.clientX-e.x,a.clientY-e.y);f=TGOS.GooToWGS84(f.x,f.y);f=new TGOS.TGPoint(f.x,f.y);break;case TGOS.TGCoordSys.EPSG3826:f=d.ToMapPoint(a.clientX-e.x,a.clientY-e.y);break;case TGOS.TGCoordSys.EPSG3825:f=d.ToMapPoint(a.clientX-e.x,a.clientY-
e.y)}a=f.x-t.spos.x;f=f.y-t.spos.y;d=m.getBounds();m.transform(1,0,0,1,a-(d.left-t.senv.left),f-(d.top-t.senv.top));t.update();t.editable&&null!=t.moveCallback&&t.moveCallback.call(this,t)};this.markDrag=function(a){b(a);t.sclientx=a.clientX;t.sclienty=a.clientY;t.dragMoved=!1;var d=l.getMapBase(),e=d.getPackageOffset(),f;switch(l.getCoordSys()){case TGOS.TGCoordSys.EPSG3857:a=d.ToMapPoint(a.clientX-e.x,a.clientY-e.y);a=TGOS.GooToWGS84(a.x,a.y);f=new TGOS.TGPoint(a.x,a.y);break;case TGOS.TGCoordSys.EPSG3826:f=
d.ToMapPoint(a.clientX-e.x,a.clientY-e.y);break;case TGOS.TGCoordSys.EPSG3825:f=d.ToMapPoint(a.clientX-e.x,a.clientY-e.y)}t.spos=f;a=m.getBounds();t.senv=new TGOS.TGEnvelope(a.left,a.top,a.right,a.bottom);AttachEvent(document.body,"mousemove",t.markMove,!0);AttachEvent(document.body,"mouseup",t.endDrag,!0)};this.clone=function(){var a={opacity:this.getOpacity(),fillColor:this.getFillColor(),fillOpacity:this.getFillOpacity(),fillOutline:this.getFillOutline(),strokeColor:this.getStrokeColor(),strokeWeight:this.getStrokeWeight(),
strokeOpacity:this.getStrokeOpacity(),strokeLinejoin:this.getStrokeLinejoin(),strokeLinecap:this.getStrokeLinecap(),strokeDasharray:this.getStrokeDasharray()},a=new TGOS.TGFill(null,this.getPath(),a);a.setTitle(this.getTitle());return a};this.setClickCallback=function(a){this.clickCallback=a};this.setMoveCallback=function(a){this.moveCallback=a};this.setMovedCallback=function(a){this.movedCallback=a};this.getEditable=function(){return this.editable};this.setEditable=function(a){this.editable=a;this.setDraggable(a)};
this.getDraggable=function(){return this.draggable};this.setDraggable=function(a){void 0!==a&&(this.draggable=a,this.elem&&(!0==a&&this.elem?this.elem.mousedown(this.markDrag):!1==a&&this.elem&&this.elem.unmousedown(this.markDrag)))};this.getVisible=function(){return K};this.setVisible=function(a){switch(a){case !0:K=!0;z.show();this.redraw();this.update();break;case !1:z.hide(),K=!1,this.redraw(),this.update()}};this.getAdvancedLayer=function(){return p};this.setAdvancedLayer=function(a){p=a};this.getPaper=
function(){return null!=p?p.paper.main:l.getPaper()};this.getMap=function(){return l};this.setMap=function(a){z&&z.remove();if(null==a){if(!l)return;l.overlay.containing(this)&&l.overlay.remove(this);TGOS.TGEvent.clearInstanceListeners(this);l=null}a instanceof TGOS.TGOnlineMap&&(l=a,this.init())};this.getPath=function(){return m};this.setPath=function(a){m=a;this.redraw(!0)};this.isPointInEnvelope=function(a,b){var d=null,e=m;void 0!==e&&null!=e&&(e.getEnvelope&&(e=e.getEnvelope()),e.left&&(d=a>=
e.left&&a<=e.right&&b>=e.bottom&&b<=e.top?!0:!1));return d};this.getEnvelope=function(){if(this.getPath){var a=this.getPath();if(void 0!==a)return void 0!==a.Envelope?a.Envelope:a}return null};this.getBounds=function(){if(m){var a=null;m instanceof TGOS.TGCircle?(a=l.getCoordSys(),a=m.getBounds(a)):a=m.getBounds();return a}};this.setClickable=function(a){"boolean"===typeof a&&((n=a)?TGOS.TGEvent.releaseEventLock(this,"click"):TGOS.TGEvent.lockEvent(this,"click"),TGOS.TGEvent.trigger(this,"clickable_changed"))};
this.getOpacity=function(){return u};this.setOpacity=function(a){u=a;z&&z.attr({opacity:u})};this.getFillOpacity=function(){return s};this.setFillOpacity=function(a){s=a;z&&z.attr({"fill-opacity":s})};this.getFillOutline=function(){return w};/*this.setFillOpacity=function(a){w=a;z&&z.attr({"stroke-opacity":u})};*/this.getTitle=function(){return J};this.setTitle=function(a){J=a;z&&(z.attr({title:J}),TGOS.TGEvent.trigger(this,"title_changed"))};this.getClickable=function(){return n};this.getFillColor=function(){return q};
this.setFillColor=function(a){q=a;z&&z.attr({fill:q})};this.getStrokeColor=function(){return C};this.setStrokeColor=function(a){C=a;z&&z.attr({stroke:a})};this.getStrokeWeight=function(){return B};this.setStrokeWeight=function(a){B=a;z&&z.attr({"stroke-width":B})};this.getStrokeOpacity=function(){return I};this.setStrokeOpacity=function(a){I=a;z&&z.attr({"stroke-opacity":I})};this.getStrokeLinecap=function(){return H};this.setStrokeLinecap=function(a){H=a;z&&z.attr({"stroke-linecap":H})};this.getStrokeLinejoin=
function(){return A};this.setStrokeLinejoin=function(a){A=a;z&&z.attr({"stroke-linejoin":A})};this.getStrokeDasharray=function(){return G};this.setStrokeDasharray=function(a){G=a;z&&z.attr({"stroke-dasharray":G})};this.getZIndex=function(){return D};this.setZIndex=function(a,b){"number"===typeof a&&z&&(D=parseFloat(a),l.overlay.updateArrayOrder(this),l.overlay.updateElementOrder(this),TGOS.TGEvent.trigger(this,"zindex_changed"))};this.update=function(){if(m&&l)if(K){var a=l.getMapBase(),b=this.getAnchorPoint(),
a=a.FromMapPoint(b.x,b.y);z.transform("t"+(a.x-h)+","+(a.y-k))}else z.hide()};this.createPathStr=function(){var b="",e=l.getCoordSys(),f=l.getMapBase(),g=f.getCellSizeX();e==TGOS.TGCoordSys.EPSG3857&&(g/=111E4);if(m instanceof TGOS.TGPolygon)for(var b=b+a(f,e,g,m.getExteriorRing()),h=m.getInteriorRings(),k=0;k<h.length;k++)b+=a(f,e,g,h[k],!0);else if(m instanceof TGOS.TGMultiPolygon){for(var v="",b=0;b<m.getLength();b++)for(h=m.getArray()[b],v+=a(f,e,g,h.getExteriorRing()),h=h.getInteriorRings(),
k=0;k<h.length;k++)v+=a(f,e,g,h[k],!0);b=v}else if(m instanceof TGOS.TGCircle){var g=m.getVertexCount(),h=360/g,t=m.getRadius(),n=m.getCenter(),b=d(e,n),k=f.FromMapPoint(b.x,b.y),v=f.FromMapDistX(t),q=f.FromMapDistY(t);"EPSG3857"==e&&(v=TGOS.WGS84toTWD97(n.x,n.y),v=TGOS.TWD97toWGS84(v.x+t,v.y+t),e=d(e,{x:v.x,y:v.y}),v=f.FromMapDistX(e.x-b.x),q=f.FromMapDistY(e.y-b.y));n=0;f=Math.cos(0)*v+k.x;n=Math.sin(0)*q+k.y;b="M"+Math.round(f)+" "+Math.round(n);e=h;for(t=0;t<g;t++)n=e/180*Math.PI,f=Math.round(v*
Math.cos(n)+k.x),n=Math.round(q*Math.sin(n)+k.y),b=b+"L"+f+" "+n,e+=h;b+=" Z"}else m instanceof TGOS.TGEnvelope&&(h=d(e,new TGOS.TGPoint(m.left,m.top)),k=d(e,new TGOS.TGPoint(m.right,m.top)),g=d(e,new TGOS.TGPoint(m.right,m.bottom)),e=d(e,new TGOS.TGPoint(m.left,m.bottom)),h=f.FromMapPoint(h.x,h.y),k=f.FromMapPoint(k.x,k.y),g=f.FromMapPoint(g.x,g.y),f=f.FromMapPoint(e.x,e.y),b="M"+Math.round(h.x)+" "+Math.round(h.y)+"L"+Math.round(k.x)+" "+Math.round(k.y)+"L"+Math.round(g.x)+" "+Math.round(g.y)+"L"+
Math.round(f.x)+" "+Math.round(f.y)+" Z");return b};this.getAnchorPoint=function(){var a,b=l.getCoordSys();m instanceof TGOS.TGPolygon?a=d(b,m.getExteriorRing().getPath().getPath()[0]):m instanceof TGOS.TGMultiPolygon?a=d(b,m.getArray()[0].getExteriorRing().getPath().getPath()[0]):m instanceof TGOS.TGCircle?a=d(b,m.getCenter()):m instanceof TGOS.TGEnvelope&&(a=d(b,new TGOS.TGPoint(m.left,m.top)));return a};this.redraw=function(a){if(z&&l&&m)if(K){var b=l.getMapBase();a=l.getCoordSys();var d=m.getBounds(a);
a=Math.abs(b.FromMapDistX(d.right-d.left));var e=Math.abs(b.FromMapDistY(d.top-d.bottom)),f=this.getAnchorPoint(),g=l.getMapSize().width,v=l.getMapSize().height,t;l.getCoordSys()==TGOS.TGCoordSys.EPSG3857?(t=TGOS.WGS84ToGoo(d.left,d.top),d=TGOS.WGS84ToGoo(d.right,d.bottom),t=b.FromMapPoint(t.x-500,t.y+500),d=b.FromMapPoint(d.x+500,d.y-500)):(t=b.FromMapPoint(d.left,d.top),d=b.FromMapPoint(d.right,d.bottom));util.intersectRect({left:t.x,top:t.y,right:d.x,bottom:d.y},{left:0,top:0,right:g,bottom:v})?
(z.show(),b=b.FromMapPoint(f.x,f.y),h=b.x,k=b.y,b=this.createPathStr(),z.attr({"stroke-width":B,stroke:C,"stroke-opacity":I,"stroke-linejoin":A,"stroke-linecap":H,"stroke-dasharray":G,fill:q,"fill-opacity":s,opacity:u,width:a,height:e,path:b})):z.hide()}else z.hide()};this.getMapBase=function(){if(l)return l.getMapBase()};var v,z;this.init=function(){l&&(v=void 0===p?l.getPaper():p.paper.main,z=v.path(""),F&&(l.overlay.updateArrayOrder(this),l.overlay.updateElementOrder(this)),l.overlay[l.overlay.length]=
this,this.bindEvents(z),this.redraw(),this.update(),this.setDraggable(this.draggable))};void 0!=g&&("undefined"!=typeof g.advancedLayer&&(p=g.advancedLayer),"undefined"!=typeof g.updateOrder&&"boolean"==typeof g.updateOrder&&(F=g.updateOrder),"undefined"!=typeof g.visible&&"boolean"==typeof g.visible&&(K=g.visible),"undefined"!=typeof g.path&&g.path instanceof TGOS.TGPolygon&&(m=g.path),"undefined"!=typeof g.clickable&&"boolean"==typeof g.clickable&&(n=g.clickable),"undefined"!=typeof g.fillColor&&
"string"==typeof g.fillColor&&(q=g.fillColor),"undefined"!=typeof g.fillOpacity&&"number"==typeof g.fillOpacity&&(s=g.fillOpacity),"undefined"!=typeof g.opacity&&"number"==typeof g.opacity&&(u=g.opacity),"undefined"!=typeof g.strokeWeight&&"number"==typeof g.strokeWeight&&(B=g.strokeWeight),"undefined"!=typeof g.strokeLinecap&&"string"==typeof g.strokeLinecap&&(H=g.strokeLinecap),"undefined"!=typeof g.strokeLinejoin&&"string"==typeof g.strokeLinejoin&&(A=g.strokeLinejoin),"undefined"!=typeof g.strokeOpacity&&
"number"==typeof g.strokeOpacity&&(I=g.strokeOpacity),"undefined"!=typeof g.zIndex&&"number"==typeof g.zIndex&&(D=g.zIndex),"undefined"!=typeof g.strokeColor&&"string"==typeof g.strokeColor&&(C=g.strokeColor),"undefined"!=typeof g.strokeDasharray&&"string"==typeof g.strokeDasharray&&(G=g.strokeDasharray),"undefined"!=typeof g.draggable&&"boolean"==typeof g.draggable&&this.setDraggable(g.draggable));this.init()};TGOS.extend(TGOS.Graphic,TGOS.TGFill);TGOS.RegisterEvent(TGOS.TGFill,"click mousedown mouseup mousemove mouseout mouseover dblclick rightclick zindex_changed".split(" "))})();(function(){function b(a){a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation()}var d=function(a,b){var d;switch(a){case TGOS.TGCoordSys.EPSG3857:d=TGOS.WGS84ToGoo(b.x,b.y);break;case TGOS.TGCoordSys.EPSG3826:d=b;break;case TGOS.TGCoordSys.EPSG3825:d=b}return d};TGOS.TGLine=function(a,f,e){var g=new TGOS.TGPoint(0,0),h=a,k,l=f,p=!0,m=!0,n=1,u=1,s="#000000",q="none",w="square",C="miter",B=1,H,A=new TGOS.TGEnvelope(0,0,0,0),I=0,G="",D=0,J=0;this.setBeforeDraw=function(a){this.beforeDraw=a};this.setCallOptions=
function(a){this.callOptions=a};this.getBeforeDraw=function(){return this.beforeDraw};this.getCallOptions=function(){return this.callOptions};var K=this;this.getEnvelope=function(){return this.getPath?this.getPath().Envelope:null};this.getBounds=function(){this.calEnv();return A};this.endDrag=function(a){if(2<K.sclientx-a.clientX||2<K.sclienty-a.clientY||-2>K.sclientx-a.clientX||-2>K.sclienty-a.clientY)K.dragMoved=!0;b(a);DetachEvent(document.body,"mousemove",K.markMove,!0);DetachEvent(document.body,
"mouseup",K.endDrag,!0);!K.dragMoved&&K.editable?null!=K.clickCallback&&K.clickCallback.call(this,K):null!=K.movedCallback&&K.movedCallback.call(this,K)};this.markMove=function(a){b(a);var d=h.getMapBase(),e=d.getPackageOffset(),f;switch(h.getCoordSys()){case TGOS.TGCoordSys.EPSG3857:f=d.ToMapPoint(a.clientX-e.x,a.clientY-e.y);f=TGOS.GooToWGS84(f.x,f.y);f=new TGOS.TGPoint(f.x,f.y);break;case TGOS.TGCoordSys.EPSG3826:f=d.ToMapPoint(a.clientX-e.x,a.clientY-e.y);break;case TGOS.TGCoordSys.EPSG3825:f=
d.ToMapPoint(a.clientX-e.x,a.clientY-e.y)}a=l.Envelope;l.transform(1,0,0,1,f.x-K.spos.x-(a.left-K.senv.left),f.y-K.spos.y-(a.top-K.senv.top));K.update();K.editable&&null!=K.moveCallback&&K.moveCallback.call(this,K)};this.markDrag=function(a){K.sclientx=a.clientX;K.sclienty=a.clientY;K.dragMoved=!1;K.selected=!1;b(a);var d=h.getMapBase(),e=d.getPackageOffset(),f;switch(h.getCoordSys()){case TGOS.TGCoordSys.EPSG3857:a=d.ToMapPoint(a.clientX-e.x,a.clientY-e.y);a=TGOS.GooToWGS84(a.x,a.y);f=new TGOS.TGPoint(a.x,
a.y);break;case TGOS.TGCoordSys.EPSG3826:f=d.ToMapPoint(a.clientX-e.x,a.clientY-e.y);break;case TGOS.TGCoordSys.EPSG3825:f=d.ToMapPoint(a.clientX-e.x,a.clientY-e.y)}K.spos=f;a=l.Envelope;K.senv=new TGOS.TGEnvelope(a.left,a.top,a.right,a.bottom);AttachEvent(document.body,"mousemove",K.markMove,!0);AttachEvent(document.body,"mouseup",K.endDrag,!0)};this.clone=function(){var a={opacity:this.getOpacity(),strokeWeight:this.getStrokeWeight(),strokeOpacity:this.getStrokeOpacity(),strokeLinecap:this.getStrokeLinecap(),
strokeLinejoin:this.getStrokeLinejoin(),strokeColor:this.getStrokeColor(),strokeDasharray:this.getStrokeDasharray(),icons:this.getIcons()},a=new TGOS.TGLine(null,this.getPath(),a);a.setTitle(this.getTitle());return a};this.setClickCallback=function(a){this.clickCallback=a};this.setMoveCallback=function(a){this.moveCallback=a};this.setMovedCallback=function(a){this.movedCallback=a};this.getEditable=function(){return this.editable};this.setEditable=function(a){this.editable=a;this.setDraggable(a)};
this.getDraggable=function(){return this.draggable};this.setDraggable=function(a){this.draggable=a;F&&(a&&F?F.mousedown(this.markDrag):F.unmousedown(this.markDrag))};this.isPointInEnvelope=function(a,b){var d=null,e=l;void 0!==e&&null!=e&&(e.getEnvelope&&(e=e.getEnvelope()),e.left&&(d=a>=e.left&&a<=e.right&&b>=e.bottom&&b<=e.top?!0:!1));return d};this.getEventElement=function(){return F};this.calEnv=function(){for(var a=l.getPath(),b=Infinity,d=-Infinity,e=-Infinity,f=Infinity,g=0;g<a.length;g++)b=
Math.min(b,a[g].x),f=Math.min(f,a[g].y),d=Math.max(d,a[g].x),e=Math.max(e,a[g].y);A.left=b;A.right=d;A.top=e;A.bottom=f;return new TGOS.TGEnvelope(b,e,d,e)};this.getMap=function(){return h};this.setMap=function(a){F&&F.remove();if(null==a){if(!h)return;h.overlay.containing(this)&&h.overlay.remove(this);TGOS.TGEvent.clearInstanceListeners(this);h=null}a instanceof TGOS.TGOnlineMap&&(h=a,this.init())};this.getPath=function(){return l};this.setPath=function(a){if(a instanceof TGOS.TGLineString||a instanceof
TGOS.TGMultiLineString)l=a,this.redraw()};this.getVisible=function(){return p};this.setVisible=function(a){switch(a){case !0:p=!0;this.update();this.redraw();break;case !1:p=!1,this.update(),this.redraw()}};this.getClickable=function(){return m};this.setClickable=function(a){"boolean"===typeof a&&((m=a)?TGOS.TGEvent.releaseEventLock(this,"click"):TGOS.TGEvent.lockEvent(this,"click"),TGOS.TGEvent.trigger(this,"clickable_changed"))};this.getStrokeColor=function(){return s};this.setStrokeColor=function(a){s=
a;F&&F.attr({stroke:s})};this.getStrokeOpacity=function(){return B};this.setStrokeOpacity=function(a){B=a;F&&F.attr({"stroke-opacity":B})};this.getStrokeLinecap=function(){return w};this.setStrokeLinecap=function(a){w=a;F&&F.attr({"stroke-linecap":w})};this.getStrokeLinejoin=function(){return C};this.setStrokeLinejoin=function(a){C=a;F&&F.attr({"stroke-linejoin":C})};this.getOpacity=function(){return n};this.setOpacity=function(a){n=a;F&&F.attr({opacity:n})};this.getStrokeWeight=function(){return u};
this.setStrokeWeight=function(a){u=a;F&&F.attr({"stroke-width":u})};this.getStrokeDasharray=function(){return q};this.setStrokeDasharray=function(a){q=a;F&&F.attr({"stroke-dasharray":q})};this.getIcons=function(){return H};this.setIcons=function(a){H=a};this.getTitle=function(){return G};this.setTitle=function(a){G=a;F&&(F.attr({title:G}),TGOS.TGEvent.trigger(this,"title_changed"))};this.getZIndex=function(){return I};this.setZIndex=function(a,b){"number"===typeof a&&F&&(I=parseFloat(a),h.overlay.updateArrayOrder(this),
h.overlay.updateElementOrder(this),TGOS.TGEvent.trigger(this,"zindex_changed"))};this.redraw=function(){if(l)if(p){var a=h.getMapBase(),a=a.FromMapPoint(100,100);if(a.x||a.y){var b=l.getBounds(),e,a=h.getMapBase(),f=l instanceof TGOS.TGMultiLineString?l.getArray()[0].getPath():l.getPath(),m=a.FromMapPoint(f[0].x,f[0].y);Math.abs(m.x-g.x);Math.abs(m.y-g.y);g.x=m.x;g.y=m.y;a.FromMapPoint(b.left,b.top);a.FromMapPoint(b.right,b.right);a.getClientWidth();a.getClientHeight();var k=h.getMapSize().width,
t=h.getMapSize().height,A,m=a.getCellSizeX(),G=h.getCoordSys();G==TGOS.TGCoordSys.EPSG3857?(m/=111E4,A=TGOS.WGS84ToGoo(b.left,b.top),b=TGOS.WGS84ToGoo(b.right,b.bottom),A=a.FromMapPoint(A.x,A.y),b=a.FromMapPoint(b.x,b.y)):(A=a.FromMapPoint(b.left,b.top),b=a.FromMapPoint(b.right,b.bottom));if(util.intersectRect({left:A.x,top:A.y,right:b.x,bottom:b.y},{left:0,top:0,right:k,bottom:t})){F.show();e=d(G,f[0]);A=a.FromMapPoint(e.x,e.y);D=A.x;J=A.y;k=l instanceof TGOS.TGMultiLineString?l.getArray():[l];t=
"";for(b=0;b<k.length;b++)if(f=k[b].getPath(),f=TGOS.simplifyLineString(f,m),A=this.getBeforeDraw(),e=this.getCallOptions(),null!=A&&null!=e&&1<f.length&&(f=A.call(this,h,f,e)),null!=f&&1<f.length)for(A=d(G,f[0]),A=a.FromMapPoint(A.x,A.y),t=t+"M"+A.x+","+A.y,A=1;A<f.length;A++){e=f[A];var I;0<A&&(I=f[A-1]);e=d(G,e);e=a.FromMapPoint(e.x,e.y);if(I)var H=d(G,I),H=a.FromMapPoint(H.x,H.y),t=t+"L"+(H.x+e.x)/2+","+(H.y+e.y)/2;t=t+"L"+e.x+","+e.y}F.attr({opacity:n,"stroke-opacity":B,stroke:s,"stroke-width":u,
"stroke-dasharray":q,"stroke-linecap":w,"stroke-linejoin":C,path:t})}else F.hide()}}else F.hide()};this.getPaper=function(){return null!=k?k.paper.main:h.getPaper()};this.getAdvancedLayer=function(){return k};this.setAdvancedLayer=function(a){k=a};this.update=function(){if(l)if(p){l.getBounds();var a=h.getMapBase(),b=(l instanceof TGOS.TGMultiLineString?l.getArray()[0].getPath():l.getPath())[0],b=d(h.getCoordSys(),b),a=a.FromMapPoint(b.x,b.y);F.transform("t"+(a.x-D)+","+(a.y-J))}else F.hide()};var F,
t;this.init=function(){h&&(h.getMapBase().getHObject(),t=void 0!==k?k.paper.main:h.getPaper(),H&&(this.marker=t.createMarker(icons)),F=t.path(),this.marker&&(F.node.style.marker="url(#"+this.marker+")"),h.overlay.add(this),this.bindEvents(F),this.redraw(),this.update(),this.setDraggable(this.draggable))};this.getMapBase=function(){if(h)return h.getMapBase()};this.getEventElement=function(){return null==h?null:F};if(void 0!=e){e.map instanceof TGOS.TGOnlineMap&&this.setMap(e.map);void 0!==typeof e.advancedLayer&&
this.setAdvancedLayer(e.advancedLayer);if("undefined"!=typeof e.visible&&"boolean"==typeof e.visible)switch(e.visible){case !0:p=!0;break;case !1:p=!1}"undefined"!=typeof e.path&&e.path instanceof TGOS.TGLineString&&this.setPath(e.path);"undefined"!=typeof e.clickable&&"boolean"==typeof e.clickable&&(m=e.clickable);"undefined"!=typeof e.strokeWeight&&"number"==typeof e.strokeWeight&&(u=e.strokeWeight);"undefined"!=typeof e.strokeOpacity&&"number"==typeof e.strokeOpacity&&(B=e.strokeOpacity);"undefined"!=
typeof e.zIndex&&"number"==typeof e.zIndex&&(I=e.zIndex);"undefined"!=typeof e.strokeColor&&"string"==typeof e.strokeColor&&(s=e.strokeColor);"undefined"!=typeof e.strokeLinecap&&"string"==typeof e.strokeLinecap&&(w=e.strokeLinecap);"undefined"!=typeof e.strokeLinejoin&&"string"==typeof e.strokeLinejoin&&(C=e.strokeLinejoin);"undefined"!=typeof e.strokeDasharray&&"string"==typeof e.strokeDasharray&&(q=e.strokeDasharray);"undefined"!=typeof e.draggable&&"boolean"==typeof e.draggable&&this.setDraggable(e.draggable);
"undefined"!=typeof e.beforeDraw&&this.setBeforeDraw(e.beforeDraw);"undefined"!=typeof e.options&&this.setCallOptions(e.options);e&&e.icons&&(H=e.icons)}this.init()};TGOS.extend(TGOS.Graphic,TGOS.TGLine);TGOS.RegisterEvent(TGOS.TGLine,"click mousedown mouseup mousemove mouseout mouseover dblclick rightclick zindex_changed".split(" "))})();(function(){TGOS.TGGroundOverlay=function(b,d,a,f,e){var g=["MSIE","Gecko","Edge"],h=DeviceTest(),k=1,l=null,p=null,m,n,u=0,s=!0,q=this;this.url=this.map=null;this.layerID;this.params=[];this.coordSys=this.advLayer=this.advancedLayer=null;this.mapBounds=new TGOS.TGEnvelope(0,0,0,0);this.getUrl=function(){var a=null;if(this.map){this.mapBounds=this.getMapBound(this.map.getBounds());var b=this.map.getMapBase(),a=b.getClientWidth(),b=b.getClientHeight(),a=this.url+"?Left="+this.mapBounds.left+"&Top="+
this.mapBounds.top+"&Right="+this.mapBounds.right+"&Bottom="+this.mapBounds.bottom+"&Width="+a+"&Height="+b;0<this.params.length&&(a+="&"+this.params.join("&"))}return a};this.getMapBound=function(a){var b=new TGOS.TGEnvelope(0,0,0,0);if(void 0!==a)switch(this.coordSys){case TGOS.TGCoordSys.EPSG3857:var d=TGOS.WGS84ToGoo(a.left,a.top);a=TGOS.WGS84ToGoo(a.right,a.bottom);b.left=d.x;b.top=d.y;b.right=a.x;b.bottom=a.y;break;case TGOS.TGCoordSys.EPSG3826:b=a;break;case TGOS.TGCoordSys.EPSG3825:b=a}return b};
this.getMap=function(){return this.map};this.getEventElement=function(){return n};this.getPaper=function(){var a=null;this.advLayer?(this.setAdvancedLayer(this.advLayer),a=this.getAdvancedLayer().paper.main):a=this.map.getPaper();return a};this.showGraphic=function(a){a.target&&a.target.graphic.show()};this.setMap=function(a){n&&(null!=n.node&&n.node.setAttribute("href",""),n.remove());null==a?this.map&&(this.map.overlay.containing(this)&&this.map.overlay.remove(this),TGOS.TGEvent.clearInstanceListeners(this),
this.removeAdvancedLayer(),this.map=null):a instanceof TGOS.TGOnlineMap&&!a.overlay.containing(this)&&(this.map=a,this.coordSys=this.map.getCoordSys(),m=this.getPaper(),a=null,null!=this.url?a=this.getUrl():(this.mapBounds=this.getMapBound(p),a=l.getUrl()),n=m.image(a,10,10,80,80),null!=this.url&&(a=n.node,a.graphic=n,a.setAttribute("externalResourcesRequired","true"),0<=g.indexOf(h)||a.addEventListener("load",q.showGraphic)),n.attr({opacity:k}),this.map.overlay.add(this),this.bindEvents(n),this.redraw(),
this.update())};this.getClickable=function(){return s};this.setClickable=function(a){"boolean"===typeof a&&((s=a)?TGOS.TGEvent.releaseEventLock(this,"click"):TGOS.TGEvent.lockEvent(this,"click"),TGOS.TGEvent.trigger(this,"clickable_changed"))};this.getOpacity=function(){return k};this.setZIndex=function(a){"number"===typeof a&&n&&(u=parseFloat(a),this.map.overlay.updateArrayOrder(this),this.map.overlay.updateElementOrder(this),TGOS.TGEvent.trigger(this,"zindex_changed"))};this.getMapBase=function(){if(this.map)return this.map.getMapBase()};
this.getZIndex=function(){return u};this.setOpacity=function(a){"number"==typeof a&&1>a&&0<=a&&(k=a,n&&n.attr({opacity:a}),this.redraw(),this.update())};this.getImage=function(){return null!=this.url?this.url:l};this.setImage=function(a){if(a instanceof TGOS.TGImage)l=a,n&&(n.attr({src:l.getUrl()}),this.redraw(),this.update());else if("string"==typeof a&&(this.url=a,-1<this.url.indexOf("?"))){var b=this.url.indexOf("?");a=this.url.substring(0,b);b=this.url.substr(b+1,this.url.length-b);this.url=a;
if(0<b.length)for(a=b.split("&"),b=0;b<a.length;b++){var d=a[b];0<d.length&&!(0<=d.toUpperCase().indexOf("LEFT"))&&(0<=d.toUpperCase().indexOf("TOP")||0<=d.toUpperCase().indexOf("RIGHT")||0<=d.toUpperCase().indexOf("BOTTOM")||0<=d.toUpperCase().indexOf("WIDTH")||0<=d.toUpperCase().indexOf("HEIGHT")||this.params.push(d))}}};this.getBounds=function(){return p};this.setBounds=function(a){a instanceof TGOS.TGEnvelope&&(p=a,this.map&&(this.mapBounds=this.getMapBound(p)),this.redraw(),this.update())};this.redraw=
function(){if(this.map){DEBUG_MODE&&console.log("redraw");var a=this.map.getMapBase(),b=a.FromMapPoint(100,100);if(b.x||b.y){var d=b=1;if(null!=this.url)if(b=a.getClientWidth(),d=a.getClientHeight(),0<=g.indexOf(h)){n.node.style.display="none";var e=new Image;e.addEventListener("load",function(){n.node.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.src);n.node.setAttribute("width",e.width);n.node.setAttribute("height",e.height);n.node.style.display="";e=null},!1);e.src=this.getUrl()}else n.hide(),
n.attr({width:b,height:d,src:this.getUrl()});else this.map.getMapBase().FromMapPoint(this.mapBounds.left,this.mapBounds.top),b=Math.abs(this.map.getMapBase().FromMapDistX(Math.abs(this.mapBounds.right-this.mapBounds.left))),d=Math.abs(this.map.getMapBase().FromMapDistY(Math.abs(this.mapBounds.bottom-this.mapBounds.top))),n.attr({width:b,height:d})}}};this.update=function(){if(this.map){DEBUG_MODE&&console.log("update");var a=this.map.getMapBase().FromMapPoint(this.mapBounds.left,this.mapBounds.top);
n.attr({x:a.x,y:a.y});g.indexOf(h)}};this.getLayerId=function(){return this.layerID};this.setLayerId=function(a){this.layerID=a};this.getAdvancedLayer=function(){return this.advancedLayer};this.setAdvancedLayer=function(a){this.advLayer=a;null!=this.map&&(this.removeAdvancedLayer(),a&&(this.advancedLayer=this.map.addIndependentContainer("GOverlay",this)))};this.removeAdvancedLayer=function(){null!=this.advancedLayer&&(this.map.removeIndependentContainer(this.advancedLayer),this.map.removeAdvancedLayer(this),
this.advancedLayer=null)};this.removeLayer=function(){this.removeAdvancedLayer();void 0!==this.map&&this.map.removeLayer(this)};this.getNode=function(){if(this.map){if(this.advancedLayer){var a=this.getAdvancedLayer();return null!=a?[a.div.main,a.div.shadow]:this.map.getPanes().graphicLayer}return this.map.getPanes().graphicLayer}};this.setImage(d);this.setBounds(a);this.setAdvancedLayer(e);this.setMap(b);this.setZIndex(u);this.setOpacity(f);this.redraw()};TGOS.extend(TGOS.Graphic,TGOS.TGGroundOverlay);
TGOS.RegisterEvent(TGOS.TGGroundOverlay,"zindex_changed click dblclick rightclick mousemove mousedown mouseup mouseover mouseout".split(" "))})();TGOS.TGGeometry=function(){};TGOS.Geometry=TGOS.TGGeometry;TGOS.TGGeometry.prototype.srs=null;TGOS.TGGeometry.prototype.lon=NaN;TGOS.TGGeometry.prototype.lat=NaN;TGOS.TGGeometry.prototype.getType=function(){return this.type};
TGOS.TGGeometry.prototype.fromWKT=function(b){var d=function(a,b){return a.slice(0,b.length)==b},a=/^\s*\(?(.*?)\)?\s*$/,f=/\s+/,e=/\s*,\s*/,g=/\)\s*,\s*\(/,h=/\)\s*\)\s*,\s*\(\s*\(/,k=/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/.exec(b);if(!k||0>=k.length)throw"Invalid WKT : "+b;b=k[1].toUpperCase();var l=k[2];if(d(b,"POINT"))return d=l.split(f),{type:"POINT",geometry:new TGOS.TGPoint(parseFloat(d[0]),parseFloat(d[1]))};if(d(b,"LINESTRING")){k=[];b=l.split(e);for(h=0;h<b.length;h++)d=b[h].split(f),k.push(new TGOS.TGPoint(parseFloat(d[0]),
parseFloat(d[1])));if(d=new TGOS.TGLineString(k))return{type:"LINESTRING",geometry:d}}else if(d(b,"POLYGON")){for(var p=a.exec(l)[1].split(g),m=[],n=0;n<p.length;n++){b=p[n].split(e);k=[];for(h=0;h<b.length;h++)d=b[h].split(f),k.push(new TGOS.TGPoint(parseFloat(d[0]),parseFloat(d[1])));d=new TGOS.TGLineString(k);d=new TGOS.TGLinearRing(d);m.push(d)}if(d=new TGOS.TGPolygon(m))return{type:"POLYGON",geometry:d}}else{if(d(b,"MULTIPOINT")){e=l.split(e);g=[];for(h=0;h<e.length;h++)d=a.exec(e[h])[1].split(f),
g.push(new TGOS.TGPoint(parseFloat(d[0]),parseFloat(d[1])));return{type:"MULTIPOINT",geometry:new TGOS.TGMultiPoint(g)}}if(d(b,"MULTILINESTRING")){a=a.exec(l)[1].split(g);g=[];for(l=0;l<a.length;l++){k=[];b=a[l].split(e);for(h=0;h<b.length;h++)d=b[h].split(f),k.push(new TGOS.TGPoint(parseFloat(d[0]),parseFloat(d[1])));(d=new TGOS.TGLineString(k))&&g.push(d)}return{type:"MULTILINESTRING",geometry:new TGOS.TGMultiLineString(g)}}if(d(b,"MULTIPOLYGON")){for(var l=a.exec(l)[1].split(h),u=[],s=0;s<l.length;s++){p=
a.exec(l[s])[1].split(g);m=[];for(n=0;n<p.length;n++){b=p[n].split(e);k=[];for(h=0;h<b.length;h++)d=b[h].split(f),k.push(new TGOS.TGPoint(parseFloat(d[0]),parseFloat(d[1])));d=new TGOS.TGLineString(k);d=new TGOS.TGLinearRing(d);m.push(d)}(d=new TGOS.TGPolygon(m))&&u.push(d)}return{type:"MULTIPOLYGON",geometry:new TGOS.TGMultiPolygon(u)}}if(d(b,"GEOMETRYCOLLECTION"))return null;throw"Unknown WKT geometry type : "+b;}};TGOS.TGGeometry.prototype.toWkt=function(b){if(b.toWkt)return b.toWkt()};
TGOS.TGGeometry.Rotate=function(b,d,a,f){if(b){var e=TGOS.math.Matrix;d=e.translate(d,a).product(e.rotate(-f)).product(e.translate(-d,-a));b.matrixTransform(d)}};TGOS.TGGeometry.PointToLineSegment=function(b,d,a){var f=0,e=a.x-d.x,g=a.y-d.y,h=((b.x-d.x)*e+(b.y-d.y)*g)/(e*e+g*g);0>h||d.x==a.x&&d.y==a.y?(f=-1,e=d.x,d=d.y):1<h?(f=1,e=a.x,d=a.y):(e=d.x+h*e,d=d.y+h*g);a=b.x-e;b=b.y-d;b=Math.sqrt(a*a+b*b);return{fit:f,point:{x:e,y:d},distance:b}};
TGOS.TGGeometry.Transform=function(b,d){if(b&&d){if(b instanceof TGOS.TGPoint){var a=d(b.x,b.y);return new TGOS.TGPoint(a.x,a.y)}if(b instanceof TGOS.TGLineString){for(var f=[],e=0;e<b.path.length;e++)a=b.path[e],a=d(a.x,a.y),f.push(new TGOS.TGPoint(a.x,a.y));return new TGOS.TGLineString(f)}if(b instanceof TGOS.TGLinearRing)return e=TGOS.TGGeometry.Transform(b.linestring,d),new TGOS.TGLinearRing(e);if(b instanceof TGOS.TGEnvelope)return e=new TGOS.TGPoint(b.left,b.top),f=new TGOS.TGPoint(b.right,
b.bottom),e=TGOS.TGGeometry.Transform(e,d),f=TGOS.TGGeometry.Transform(f,d),new TGOS.TGEnvelope(e.x,e.y,f.x,f.y);if(b instanceof TGOS.TGCircle)return e=new TGOS.TGCircle,a=b.getCenter(),f=b.getRadius(),a=TGOS.TGGeometry.Transform(a,d),e.setCenter(a),e.setRadius(f),e;if(b instanceof TGOS.TGPolygon){a=[];for(e=0;e<b.rings_.length;e++)f=b.rings_[e],f=TGOS.TGGeometry.Transform(f,d),a.push(f);return new TGOS.TGPolygon(a)}if(b instanceof TGOS.TGMultiPoint){f=[];for(e=0;e<b.geoms.length;e++)f.push(TGOS.TGGeometry.Transform(b.geoms[e],
d));return new TGOS.TGMultiPoint(f)}if(b instanceof TGOS.TGMultiLineString){f=[];for(e=0;e<b.geoms.length;e++)f.push(TGOS.TGGeometry.Transform(b.geoms[e],d));return new TGOS.TGMultiLineString(f)}if(b instanceof TGOS.TGMultiPolygon){f=[];for(e=0;e<b.geoms.length;e++)f.push(TGOS.TGGeometry.Transform(b.geoms[e],d));return new TGOS.TGMultiPolygon(f)}}};
TGOS.TGPoint=function(b,d,a){this.srs=a?a:null;this.srs==TGOS.TGCoordSys.EPSG3857&&(this.lon=parseFloat(b),this.lat=parseFloat(d));this.x=parseFloat(b);this.y=parseFloat(d);this.Envelope=new TGOS.TGEnvelope(this.x,this.y,this.x,this.y)};TGOS.extend(TGOS.TGGeometry,TGOS.TGPoint);TGOS.TGPoint.prototype.updateEnvelope=function(){this.Envelope=new TGOS.TGEnvelope(this.x,this.y,this.x,this.y)};
TGOS.TGPoint.prototype.transform=function(b,d,a,f,e,g){var h=this.x,k=this.y;this.x=h*b+k*a+e;this.y=h*d+k*f+g};TGOS.TGPoint.prototype.nearestPoint=function(b,d,a){var f=null,e=null,g=Infinity;void 0!==d&&(g=d);d=!0;void 0!==a.snapPoint&&(d=a.snapPoint);if(b instanceof TGOS.TGPoint&&d){a=this.x;d=this.y;var h=b.x-a;b=b.y-d;b=Math.sqrt(h*h+b*b);b<=g&&(f=new TGOS.TGPoint(a,d),e=b)}return null!=f?{point:f,distance:e}:null};
TGOS.TGPoint.prototype.isEmpty=function(){return IsNumeric(this.x)||IsNumeric(this.y)?!0:!1};TGOS.TGPoint.prototype.setEmpty=function(){this.y=this.x=null};TGOS.TGPoint.prototype.isSimple=function(){return!0};TGOS.TGPoint.prototype.getEnvelope=function(){return this.Envelope};TGOS.TGPoint.prototype.getBounds=function(){return this.Envelope};TGOS.TGPoint.prototype.type="TGPoint";TGOS.TGPoint.prototype.toGeoJson=function(){return{type:"Point",coordinates:[this.x,this.y]}};
TGOS.TGPoint.prototype.toWkt=function(){return"POINT("+this.x+" "+this.y+")"};TGOS.TGPoint.prototype.clone=function(){return new TGOS.TGPoint(this.x,this.y)};TGOS.TGPoint.prototype.matrixTransform=function(b,d,a,f,e,g,h,k,l){b=(b instanceof TGOS.math.Matrix?b:TGOS.math.Matrix([[b,d,a],[f,e,g],[h,k,l]])).transform(this.x,this.y);this.x=b.x;this.y=b.y};TGOS.TGSize=function(b,d){this.width=parseFloat(b);this.height=parseFloat(d)};
TGOS.TGEnvelope=function(b,d,a,f){this.left=parseFloat(b);this.right=parseFloat(a);this.top=parseFloat(d);this.bottom=parseFloat(f);this.renderer=null};TGOS.extend(TGOS.TGGeometry,TGOS.TGEnvelope);TGOS.TGEnvelope.prototype.type="TGEnvelope";
TGOS.TGEnvelope.prototype.Intersect=function(b){return!(b instanceof TGOS.TGEnvelope)||b.left&&(null==this.left||this.left>b.right==this.right>this.left)||b.top&&(null==this.top||this.top<b.bottom==this.bottom<this.top)||b.right&&(null==this.right||this.right<b.left==this.left<this.right)||b.bottom&&(null==this.bottom||this.bottom>b.top==this.top>this.bottom)?!1:!0};
TGOS.TGEnvelope.prototype.Extend=function(b){b.constructor==TGOS.TGEnvelope&&(!b.left||null!=this.left&&this.left>b.left!=this.right>this.left||(this.left=b.left),!b.top||null!=this.top&&this.top<b.top!=this.bottom<this.top||(this.top=b.top),!b.right||null!=this.right&&this.right<b.right!=this.left<this.right||(this.right=b.right),!b.bottom||null!=this.bottom&&this.bottom>b.bottom!=this.top>this.bottom||(this.bottom=pEnv.bottom))};
TGOS.TGEnvelope.prototype.Shrink=function(b){b.constructor==TGOS.TGEnvelope&&(!b.left||null!=this.left&&this.left<b.left!=this.right>this.left||(this.left=b.left),!b.top||null!=this.top&&this.top>b.top!=this.bottom<this.top||(this.top=b.top),!b.right||null!=this.right&&this.right>b.right!=this.left<this.right||(this.right=b.right),!b.bottom||null!=this.bottom&&this.bottom<b.bottom!=this.top>this.bottom||(this.bottom=b.bottom))};
TGOS.TGEnvelope.prototype.toString=function(){return Math.min(this.left,this.right)+" "+Math.min(this.top,this.bottom)+","+Math.max(this.left,this.right)+" "+Math.max(this.top,this.bottom)};
TGOS.TGEnvelope.prototype.nearestPoint=function(b,d,a){var f=null,e=null,g=Infinity;void 0!==d&&(g=d);if(b instanceof TGOS.TGPoint){d=new TGOS.TGPoint(this.left,this.top);var h=new TGOS.TGPoint(this.right,this.top),k=new TGOS.TGPoint(this.right,this.bottom),l=new TGOS.TGPoint(this.left,this.bottom),p=new TGOS.TGPoint(this.left,this.top);d=new TGOS.TGLineString([d,h,k,l,p]);d.nearestPoint&&(b=d.nearestPoint(b,g,a),null!=b&&(null!=b.point&&(f=b.point),null!=b.distance&&(e=b.distance)))}return null!=
f?{point:f,distance:e}:null};TGOS.TGEnvelope.prototype.transform=function(b,d,a,f,e,g){var h=new TGOS.TGPoint(this.left,this.top),k=new TGOS.TGPoint(this.right,this.bottom);h.transform(b,d,a,f,e,g);k.transform(b,d,a,f,e,g);this.left=h.x;this.top=h.y;this.right=k.x;this.bottom=k.y;this.renderer&&this.renderer.redraw()};TGOS.TGEnvelope.prototype.isEmpty=function(){var b=IsNumeric(this.left),d=IsNumeric(this.top),a=IsNumeric(this.right),f=IsNumeric(this.bottom);return!0==b&&!0==d&&!0==a&&!0==f?!0:!1};
TGOS.TGEnvelope.prototype.setEmpty=function(){this.bottom=this.right=this.top=this.left=null};TGOS.TGEnvelope.prototype.getLeft=function(){return this.left};TGOS.TGEnvelope.prototype.getTop=function(){return this.top};TGOS.TGEnvelope.prototype.getRight=function(){return this.right};TGOS.TGEnvelope.prototype.getBottom=function(){return this.bottom};TGOS.TGEnvelope.prototype.setLeft=function(b){this.left=b};TGOS.TGEnvelope.prototype.setTop=function(b){this.top=b};
TGOS.TGEnvelope.prototype.setRight=function(b){this.right=b};TGOS.TGEnvelope.prototype.setBottom=function(b){this.bottom=b};TGOS.TGEnvelope.prototype.getWidth=function(){return Math.abs(this.left-this.right)};TGOS.TGEnvelope.prototype.getHeight=function(){return Math.abs(this.top-this.bottom)};TGOS.TGEnvelope.prototype.getEnvelope=function(){return this};TGOS.TGEnvelope.prototype.getBounds=function(){return this};
TGOS.TGEnvelope.prototype.contains=function(b){return b.x>=this.left&&b.x<=this.right&&b.y>=this.bottom&&b.y<=this.top};TGOS.TGLineString=function(b){this.path=b;this.renderer=null;this.Envelope=new TGOS.TGEnvelope(0,0,0,0);this.updateEnvelope()};TGOS.extend(TGOS.TGGeometry,TGOS.TGLineString);TGOS.TGLineString.prototype.type="TGLineString";
TGOS.TGLineString.prototype.nearestPoint=function(b,d,a){var f=null,e=null,g=Infinity;void 0!==d&&(g=d);var h=!0;void 0!==a.snapEdge&&(h=a.snapEdge);d=!0;void 0!==a.snapVertex&&(d=a.snapVertex);if(b instanceof TGOS.TGPoint&&(h||d)){if(d){var k=b.x,l=b.y;a=Infinity;var p;for(d=0;d<this.path.length;d++){var m=this.path[d].x,n=this.path[d].y,u=Math.sqrt((k-m)*(k-m)+(l-n)*(l-n));u<a&&(a=u,p=new TGOS.TGPoint(m,n))}a<=g&&(f=new TGOS.TGPoint(p.x,p.y),e=a)}if(h){a=Infinity;for(d=0;d<this.path.length-1;d++)h=
this.path[d],k=this.path[d+1],h=TGOS.TGGeometry.PointToLineSegment(b,h,k),0==h.fit&&h.distance<a&&(a=h.distance,p=new TGOS.TGPoint(h.point.x,h.point.y));a<=g&&(null!=e?a<e&&(f=new TGOS.TGPoint(p.x,p.y),e=a):(f=new TGOS.TGPoint(p.x,p.y),e=a))}}return null!=f?{point:f,distance:e}:null};TGOS.TGLineString.prototype.getPath=function(){return this.path};TGOS.TGLineString.prototype.setPath=function(b){this.path=b;this.updateEnvelope();this.renderer&&this.renderer.redraw()};
TGOS.TGLineString.prototype.isEmpty=function(){};TGOS.TGLineString.prototype.setEmpty=function(){};TGOS.TGLineString.prototype.getLength=function(){for(var b=0,d=0,a=d=0,f=0;f<this.path.length-1;f++)d=this.path[f].x-this.path[f+1].x,a=this.path[f].y-this.path[f+1].y,d=Math.sqrt(d*d+a*a),b+=d;return b};TGOS.TGLineString.prototype.startPoint=function(){return this.path[0]};TGOS.TGLineString.prototype.endPoint=function(){return this.path[this.path.length-1]};TGOS.TGLineString.prototype.isSimple=function(){};
TGOS.TGLineString.prototype.transform=function(b,d,a,f,e,g){for(var h=0;h<this.path.length;h++)this.path[h].transform(b,d,a,f,e,g);this.updateEnvelope();this.renderer&&this.renderer.redraw()};TGOS.TGLineString.prototype.clone=function(){for(var b=[],d=0;d<this.path.length;d++){var a=this.path[d],a=new TGOS.TGPoint(a.x,a.y);b.push(a)}return new TGOS.TGLineString(b)};
TGOS.TGLineString.prototype.matrixTransform=function(b,d,a,f,e,g,h,k,l){b=b instanceof TGOS.math.Matrix?b:TGOS.math.Matrix([[b,d,a],[f,e,g],[h,k,l]]);for(d=0;d<this.path.length;d++)this.path[d].matrixTransform(b);this.updateEnvelope()};TGOS.TGLineString.prototype.value=function(b){return this.path[b]};TGOS.TGLineString.prototype.getEnvelope=function(){return this.Envelope};TGOS.TGLineString.prototype.getBounds=function(){return this.Envelope};
TGOS.TGLineString.prototype.isClosed=function(){return this.path[0].x==this.path[this.path.length-1].x&&this.path[0].y==this.path[this.path.length-1].y?!0:!1};TGOS.TGLineString.prototype.updateEnvelope=function(){for(var b=this.path,d=Infinity,a=-Infinity,f=-Infinity,e=Infinity,g=0;g<b.length;g++)d=Math.min(d,b[g].x),e=Math.min(e,b[g].y),a=Math.max(a,b[g].x),f=Math.max(f,b[g].y);this.Envelope.setLeft(d);this.Envelope.setRight(a);this.Envelope.setTop(f);this.Envelope.setBottom(e)};
TGOS.TGLineString.prototype.toGeoJson=function(){for(var b=[],d=0;d<this.path.length;d++)b.push([this.path[d].x,this.path[d].y]);return{type:"LineString",coordinates:b}};TGOS.TGLineString.prototype.toWkt=function(){for(var b="LINESTRING(",d=0;d<this.path.length;d++)b+=this.path[d].x+" "+this.path[d].y+",";","==b[b.length-1]&&(b=b.substring(0,b.length-1));return b+")"};TGOS.TGLinearRing=function(b){this.linestring=b;this.linestring.updateEnvelope();this.renderer=null};TGOS.extend(TGOS.TGGeometry,TGOS.TGLinearRing);
TGOS.TGLinearRing.prototype.nearestPoint=function(b,d,a){var f=this.getPath();return void 0!==f&&f.nearestPoint?f.nearestPoint(b,d,a):null};TGOS.TGLinearRing.prototype.getPath=function(){return this.linestring};TGOS.TGLinearRing.prototype.setPath=function(b){this.linestring=b;this.linestring.updateEnvelope();this.renderer&&this.renderer.redraw()};TGOS.TGLinearRing.prototype.getBounds=function(){return this.linestring.getBounds()};TGOS.TGLinearRing.prototype.getEnvelope=function(){return this.linestring.getEnvelope()};
TGOS.TGLinearRing.prototype.type="TGLinearRing";TGOS.TGPolygon=function(b){this.rings_=b;this.empty_=!0;this.Envelope=new TGOS.TGEnvelope(0,0,0,0);this.extIdx=0;b?(this.ext_=b[this.extIdx],this.renderer=b.renderer,this.updateEnvelope()):this.renderer=this.ext_=null};TGOS.extend(TGOS.TGGeometry,TGOS.TGPolygon);TGOS.TGPolygon.prototype.type="TGPolygon";
TGOS.TGPolygon.prototype.nearestPoint=function(b,d,a){var f=null,e=null,g=Infinity;void 0!==d&&(g=d);for(var h=Infinity,k,l=0;l<this.rings_.length;l++){var p=this.rings_[l];if(p.nearestPoint&&(p=p.nearestPoint(b,d,a),null!=p)){var m,n;null!=p.point&&(m=p.point);null!=p.distance&&(n=p.distance);null!=n&&n<h&&(k=m,h=n)}}h<=g&&(f=new TGOS.TGPoint(k.x,k.y),e=h);return null!=f?{point:f,distance:e}:null};TGOS.TGPolygon.prototype.getEnvelope=function(){return this.Envelope};
TGOS.TGPolygon.prototype.getBounds=function(){return this.Envelope};TGOS.TGPolygon.prototype.isEmpty=function(){return!0};TGOS.TGPolygon.prototype.setEmpty=function(){this.empty_=!0};TGOS.TGPolygon.prototype.getArea=function(){for(var b=0,d=this.rings_[this.extIdx].getPath().getPath(),a=d.length,f=d[a-1],e=0;e<a;e++)var g=d[e],b=b+(g.x*f.y-f.x*g.y),f=g;return Math.abs(0.5*b)};TGOS.TGPolygon.prototype.isSimple=function(){};
TGOS.TGPolygon.prototype.updateEnvelope=function(){for(var b=Infinity,d=-Infinity,a=-Infinity,f=Infinity,e=0;e<this.rings_.length;e++)for(var g=this.rings_[e].getPath().getPath(),h=0;h<g.length;h++)b=Math.min(b,g[h].x),f=Math.min(f,g[h].y),d=Math.max(d,g[h].x),a=Math.max(a,g[h].y);this.Envelope.left=b;this.Envelope.right=d;this.Envelope.top=a;this.Envelope.bottom=f};
TGOS.TGPolygon.prototype.transform=function(b,d,a,f,e,g){for(var h=0;h<this.rings_.length;h++)this.rings_[h].getPath().transform(b,d,a,f,e,g);this.updateEnvelope();this.renderer&&this.renderer.redraw()};TGOS.TGPolygon.prototype.clone=function(){for(var b=[],d=this.rings_.length,a=0;a<d;a++)b.push(new TGOS.TGLinearRing(this.rings_[a].linestring.clone()));return new TGOS.TGPolygon(b)};
TGOS.TGPolygon.prototype.matrixTransform=function(b,d,a,f,e,g,h,k,l){b=b instanceof TGOS.math.Matrix?b:TGOS.math.Matrix([[b,d,a],[f,e,g],[h,k,l]]);console.log();d=this.rings_.length;for(a=0;a<d;a++)this.rings_[a].linestring.matrixTransform(b);this.updateEnvelope()};TGOS.TGPolygon.prototype.setExterior=function(b){this.extIdx=this.rings_[this.rings_.indexOf(b)];this.updateEnvelope();this.renderer&&this.renderer.redraw()};TGOS.TGPolygon.prototype.setInterior=function(b,d){this.rings_[b].setPath(d)};
TGOS.TGPolygon.prototype.addInterior=function(b){this.rings_.push(b);this.updateEnvelope();this.renderer&&this.renderer.redraw()};TGOS.TGPolygon.prototype.removeInterior=function(b){this.rings_.splice(b,1);this.updateEnvelope();this.renderer&&this.renderer.redraw()};TGOS.TGPolygon.prototype.removeAllInterior=function(){var b=this.rings_.length-this.extIdx+1;this.rings_.splice(0,this.extIdx);this.rings_.splice(1,b);this.updateEnvelope();this.renderer&&this.renderer.redraw()};
TGOS.TGPolygon.prototype.getExteriorRing=function(){return this.rings_[this.extIdx]};TGOS.TGPolygon.prototype.getInteriorRings=function(){var b=this.rings_.slice(0,this.extIdx),d=this.rings_.slice(this.extIdx+1,this.rings_.length-this.extIdx+1);return b.concat(d)};TGOS.TGPolygon.prototype.getNumInteriorRing=function(){return path_.length-1};TGOS.TGPolygon.prototype.type="TGPolygon";
TGOS.TGPolygon.prototype.toGeoJson=function(){for(var b=[],d=0;d<this.rings_.length;d++){for(var a=[],f=this.rings_[d].getPath().getPath(),e=0;e<f.length;e++)a.push([f[e].x,f[e].y]);f.length-1&&f[0].x!=f[f.length-1].x&&f[0].y!=f[f.length-1].y&&a.push([f[0].x,f[0].y]);b.push(a)}return{type:"Polygon",coordinates:b}};
TGOS.TGPolygon.prototype.toWkt=function(){for(var b="POLYGON(",d=0;d<this.rings_.length;d++){for(var b=b+"(",a=this.rings_[d].getPath().getPath(),f=0;f<a.length;f++)b+=a[f].x+" "+a[f].y+",",f==a.length-1&&a[0].x!=a[f].x&&a[0].y!=a[f].y&&(b+=a[0].x+" "+a[0].y+",");","==b[b.length-1]&&(b=b.substring(0,b.length-1));b+="),"}","==b[b.length-1]&&(b=b.substring(0,b.length-1));return b+")"};
TGOS.TGCircle=function(){var b=36,d=new TGOS.TGPoint(0,0),a=0;this.renderer=null;this.getBounds=function(b){if(b==TGOS.TGCoordSys.EPSG3857){var e=TGOS.WGS84ToGoo(d.x,d.y);b=e.x+a;var g=e.y-a,e=TGOS.GooToWGS84(e.x-a,e.y+a);b=TGOS.GooToWGS84(b,g);return new TGOS.TGEnvelope(e.x,e.y,b.x,b.y)}return new TGOS.TGEnvelope(d.x-a,d.y+a,d.x+a,d.y-a)};this.setCenter=function(a){a instanceof TGOS.TGPoint&&(d=a,this.renderer&&this.renderer.update())};this.getCenter=function(){return d};this.setRadius=function(b){"number"==
typeof b&&(a=b,this.renderer&&this.renderer.redraw())};this.getRadius=function(){return a};this.setVertexCount=function(a){"number"==typeof a&&(b=a,30>b&&(b=30),120<b&&(b=120),this.renderer&&this.renderer.redraw())};this.getVertexCount=function(){return b};this.transform=function(a,b,g,h,k,l){d.transform(a,b,g,h,k,l);this.renderer&&this.renderer.redraw()}};TGOS.extend(TGOS.TGGeometry,TGOS.TGCircle);TGOS.TGCircle.prototype.type="TGCircle";
TGOS.TGCircle.prototype.nearestPoint=function(b,d,a){var f=null,e=null,g=Infinity;void 0!==d&&(g=d);var h=!0;void 0!==a.snapPoint&&(h=a.snapPoint);var k=!0;void 0!==a.snapEdge&&(k=a.snapEdge);a=Infinity;d=null;if(b instanceof TGOS.TGPoint&&(k||h)){var l=this.getCenter(),p=this.getRadius(),m=b.x-l.x;b=b.y-l.y;var n=Math.sqrt(m*m+b*b);h&&n<=g&&(a=n,d=new TGOS.TGPoint(l.x,l.y));k&&(h=Infinity,k=null,h=p/n,k=new TGOS.TGPoint(l.x+m*h,l.y+b*h),h=0<n-p?n-p:p-n,h<=g&&(null!=d?h<a&&(a=h,d=k):(a=h,d=k)))}a<=
g&&(f=new TGOS.TGPoint(d.x,d.y),e=a);return null!=f?{point:f,distance:e}:null};TGOS.TGMultiGeometry=function(){};TGOS.extend(TGOS.TGGeometry,TGOS.TGMultiGeometry);TGOS.TGMultiGeometry.prototype.getArray=function(){return this.geoms};TGOS.TGMultiGeometry.prototype.getAt=function(b){return this.geoms[b]};TGOS.TGMultiGeometry.prototype.getLength=function(){return this.geoms.length};TGOS.TGMultiGeometry.prototype.getBounds=function(){return this.Envelope};TGOS.TGMultiGeometry.prototype.getEnvelope=function(){return this.Envelope};
TGOS.TGMultiGeometry.prototype.transform=function(b,d,a,f,e,g){for(var h=0;h<this.geoms.length;h++)this.geoms[h].transform(b,d,a,f,e,g);this.updateEnvelope();this.renderer&&this.renderer.redraw()};
TGOS.TGMultiGeometry.prototype.updateEnvelope=function(){if(!this.geoms||!this.geoms.length)return null;for(var b=Infinity,d=-Infinity,a=-Infinity,f=Infinity,e=0;e<this.geoms.length;e++)var g=this.geoms[e].getBounds(),b=Math.min(b,g.left),d=Math.max(d,g.top),a=Math.max(a,g.right),f=Math.min(f,g.bottom);this.Envelope=new TGOS.TGEnvelope(b,d,a,f)};TGOS.TGMultiPoint=function(b){this.geoms=b;this.updateEnvelope()};TGOS.extend(TGOS.TGMultiGeometry,TGOS.TGMultiPoint);TGOS.TGMultiPoint.prototype.type="TGMultiPoint";
TGOS.TGMultiPoint.prototype.matrixTransform=function(b,d,a,f,e,g,h,k,l){b=b instanceof TGOS.math.Matrix?b:TGOS.math.Matrix([[b,d,a],[f,e,g],[h,k,l]]);d=this.geoms.length;for(a=0;a<d;a++)for(f=this.geoms[a],e=f.length,g=0;g<e;g++)f[g].matrixTransform(b);this.updateEnvelope()};TGOS.TGMultiPoint.prototype.clone=function(){for(var b=[],d=this.geoms.length,a=0;a<d;a++)b.push(this.geoms[a].clone());return new TGOS.TGMultiPoint(b)};
TGOS.TGMultiPoint.prototype.toGeoJson=function(){for(var b=[],d=0;d<this.geoms.length;d++){var a=this.geoms[d];b.push([a.x,a.y])}return{type:"MultiPoint",coordinates:b}};TGOS.TGMultiPoint.prototype.toWkt=function(){for(var b="MULTIPOINT(",d=0;d<this.geoms.length;d++)b+=this.geoms[d].x+" "+this.geoms[d].y+",";","==b[b.length-1]&&(b=b.substring(0,b.length-1));return b+")"};TGOS.TGMultiPolygon=function(b){this.geoms=b;this.updateEnvelope()};TGOS.extend(TGOS.TGMultiGeometry,TGOS.TGMultiPolygon);
TGOS.TGMultiPolygon.prototype.type="TGMultiPolygon";TGOS.TGMultiPolygon.prototype.toGeoJson=function(){for(var b=[],d=0;d<this.geoms.length;d++){for(var a=this.geoms[d],f=[],e=0;e<a.rings_.length;e++){for(var g=[],h=a.rings_[e].getPath().getPath(),k=0;k<h.length;k++)g.push([h[k].x,h[k].y]);f.push(g)}b.push(f)}return{type:"MultiPolygon",coordinates:b}};
TGOS.TGMultiPolygon.toWkt=function(){for(var b="MULTIPOLYGON(",d=0;d<this.geoms.length;d++){for(var b=b+"(",a=this.geoms[d],f=0;f<a.rings_.length;f++){for(var b=b+"(",e=a.rings_[f].getPath().getPath(),g=0;g<e.length;g++)b+=e[g].x+" "+e[g].y+",";","==b[b.length-1]&&(b=b.substring(0,b.length-1));b+="),"}","==b[b.length-1]&&(b=b.substring(0,b.length-1));b+="),"}","==b[b.length-1]&&(b=b.substring(0,b.length-1));return b+")"};
TGOS.TGMultiPolygon.prototype.matrixTransform=function(b,d,a,f,e,g,h,k,l){b=b instanceof TGOS.math.Matrix?b:TGOS.math.Matrix([[b,d,a],[f,e,g],[h,k,l]]);d=this.geoms.length;for(a=0;a<d;a++)for(f=this.geoms[a],e=f.rings_.length,g=0;g<e;g++)f.rings_[g].linestring.matrixTransform(b);this.updateEnvelope()};TGOS.TGMultiPolygon.prototype.clone=function(){for(var b=[],d=this.geoms.length,a=0;a<d;a++)b.push(this.geoms[a].clone());return new TGOS.TGMultiPolygon(b)};
TGOS.TGMultiLineString=function(b){this.geoms=b;this.updateEnvelope()};TGOS.extend(TGOS.TGMultiGeometry,TGOS.TGMultiLineString);TGOS.TGMultiLineString.prototype.type="TGMultiLineString";TGOS.TGMultiLineString.prototype.toGeoJson=function(){for(var b=[],d=0;d<this.geoms.length;d++){for(var a=this.geoms[d],f=[],e=0;e<a.path.length;e++){var g=a.path[e];f.push([g.x,g.y])}b.push(f)}return{type:"MultiLineString",coordinates:b}};
TGOS.TGMultiLineString.prototype.toWkt=function(){for(var b="MULTILINESTRING(",d=0;d<this.geoms.length;d++){for(var b=b+"(",a=this.geoms[d],f=0;f<a.path.length;f++)b+=a.path[f].x+" "+a.path[f].y+",";","==b[b.length-1]&&(b=b.substring(0,b.length-1));b+="),"}","==b[b.length-1]&&(b=b.substring(0,b.length-1));return b+")"};
TGOS.TGMultiLineString.prototype.matrixTransform=function(b,d,a,f,e,g,h,k,l){b=b instanceof TGOS.math.Matrix?b:TGOS.math.Matrix([[b,d,a],[f,e,g],[h,k,l]]);d=this.geoms.length;for(a=0;a<d;a++)this.geoms[a].matrixTransform(b);this.updateEnvelope()};TGOS.TGMultiLineString.prototype.clone=function(){for(var b=[],d=this.geoms.length,a=0;a<d;a++)b.push(this.geoms[a].clone());return new TGOS.TGMultiLineString(b)};TGOS.TGGeometryCollection=function(b){this.geoms=b;this.updateEnvelope()};
TGOS.extend(TGOS.TGMultiGeometry,TGOS.TGGeometryCollection);TGOS.TGGeometryCollection.prototype.type="TGGeometryCollection";TGOS.TGGeometryCollection.prototype.toGeoJson=function(){for(var b=[],d=0;d<this.geoms.length;d++)b.push(this.geoms[d].toGeoJson());return{type:"GeometryCollection",geometries:b}};(function(){TGOS.TGLabel=function(b){var a=this;this.toMapPoint=function(b,d){var g,h=a.map.getMapBase(),k=h.getPackageOffset(),h=h.ToMapPoint(b-k.x,d-k.y);switch(a.map.getCoordSys()){case TGOS.TGCoordSys.EPSG3857:g=TGOS.GooToWGS84(h.x,h.y);g=new TGOS.TGPoint(g.x,g.y);break;case TGOS.TGCoordSys.EPSG3826:g=h;break;case TGOS.TGCoordSys.EPSG3825:g=h}return g};this.endDrag=function(b){if(2<a.sclientx-b.clientX||2<a.sclienty-b.clientY||-2>a.sclientx-b.clientX||-2>a.sclienty-b.clientY)a.dragMoved=!0;DetachEvent(document.body,
"mousemove",a.textMove,!0);DetachEvent(document.body,"mouseup",a.endDrag,!0);!a.dragMoved&&a.editable?null!=a.clickCallback&&a.clickCallback.call(this,a):null!=a.movedCallback&&a.movedCallback.call(this,a)};this.textMove=function(b){b=a.toMapPoint(b.clientX,b.clientY);b.x-=a.soffsetx;b.y-=a.soffsety;a.setPosition(b);a.editable&&null!=a.moveCallback&&a.moveCallback.call(this,a)};this.textDrag=function(b){a.sclientx=b.clientX;a.sclienty=b.clientY;var d=a.toMapPoint(a.sclientx,a.sclienty);a.soffsetx=
d.x-a.position.x;a.soffsety=d.y-a.position.y;a.dragMoved=!1;b.cancelBubble=!0;b.stopPropagation&&b.stopPropagation();AttachEvent(document.body,"mousemove",a.textMove,!0);AttachEvent(document.body,"mouseup",a.endDrag,!0)};this.setClickCallback=function(a){this.clickCallback=a};this.setMoveCallback=function(a){this.moveCallback=a};this.setMovedCallback=function(a){this.movedCallback=a};b&&this.setOptions(b)};TGOS.extend(TGOS.Graphic,TGOS.TGLabel);var b=TGOS.TGLabel.prototype;b.font="";b.fontSize=12;
b.fontWeight="normal";b.fontColor="#000000";b.opacity=1;b.backgroundColor="";b.position=null;b.label="";b.title="";b.zIndex;b.offset=null;b.visible=!0;b.map=null;b.mapbase=null;b.elem=null;b.clone=function(){var b={font:this.getFont(),fontSize:this.getFontSize(),fontWeight:this.getFontWeight(),fontColor:this.getFontColor(),opacity:this.getOpacity(),backgroundColor:this.getBackgroundColor(),position:this.getPosition(),label:this.getLabel(),title:this.getTitle(),offset:this.getOffset()};return new TGOS.TGLabel(b)};
b.getEventElement=function(){return this.elem};b.isPointInEnvelope=function(){return null};b.update=function(){if(this.map){switch(this.map.getCoordSys()){case TGOS.TGCoordSys.EPSG3857:this.mapbase.FromMapPoint(this.position.x,this.position.y);var b=TGOS.WGS84ToGoo(this.position.x,this.position.y),a=this.mapbase.FromMapPoint(b.x,b.y);break;case TGOS.TGCoordSys.EPSG3826:a=this.mapbase.FromMapPoint(this.position.x,this.position.y);break;case TGOS.TGCoordSys.EPSG3825:a=this.mapbase.FromMapPoint(this.position.x,
this.position.y)}b=a.x;a=a.y;this.offset&&(b+=this.offset.x,a+=this.offset.y);this.elem.transform("t"+b+","+a)}};b.setVisible=function(b){this.elem&&(!0==b?this.elem.show():!1==b&&this.elem.hide());this.visible=b;TGOS.TGEvent.trigger(this,"visible_changed")};b.getVisible=function(){return this.visible};b.setZIndex=function(b,a){void 0!=b&&this.elem&&(this.zIndex=b,this.map.overlay.updateArrayOrder(this),this.map.overlay.updateElementOrder(this),TGOS.TGEvent.trigger(this,"zindex_changed"))};b.getZIndex=
function(){return this.zIndex};b.setFont=function(b){this.font=b;this.elem&&this.elem.attr({"font-family":this.font})};b.getFont=function(){return this.font};b.setFontSize=function(b){this.fontSize=b;this.elem&&this.elem.attr({"font-size":this.fontSize})};b.getFontSize=function(){return this.fontSize};b.setSize=function(b){this.size=b};this.getSize=function(){return this.size};b.setFontColor=function(b){this.fontColor=b;this.elem&&this.elem.attr({fill:this.fontColor})};b.getFontColor=function(){return this.fontColor};
b.setOpacity=function(b){this.opacity=b;this.elem&&this.elem.attr({opacity:this.opacity})};b.getOpacity=function(){return this.opacity};b.setBackgroundColor=function(b){this.backgroundColor=b};b.getBackgroundColor=function(){return this.backgroundColor};b.setPosition=function(b){this.position=b;this.update();TGOS.TGEvent.trigger(this,"position_changed")};b.getPosition=function(){return this.position};b.setLabel=function(b){this.label=b;this.elem&&this.elem.attr({text:this.label});TGOS.TGEvent.trigger(this,
"label_changed")};b.getLabel=function(){return this.label};b.setTitle=function(b){this.title=b;this.elem&&(this.elem.attr({title:this.title}),TGOS.TGEvent.trigger(this,"title_changed"))};b.getTitle=function(){return this.title};b.setFontWeight=function(b){this.fontWeight=b;this.elem&&this.elem.attr({"font-weight":this.fontWeight})};b.getFontWeight=function(){return this.fontWeight};b.destroy=function(){this.map&&(this.map.overlay.remove(this),this.elem&&this.elem.remove())};b.getOffset=function(){return this.offset};
b.setOffset=function(b){b instanceof TGOS.TGPoint&&(this.offset=b,this.update())};b.setMap=function(b){this.destroy();null==b&&this.map?(this.map=null,TGOS.TGEvent.clearInstanceListeners(this)):b instanceof TGOS.TGOnlineMap&&(this.map=b,paper=this.getPaper(),this.elem=paper.text(0,0,this.label),this.map.overlay.add(this),this.mapbase=this.map.getMapBase(),this.elem.attr({"font-family":this.font,fill:this.fontColor,"font-weight":this.fontWeight,"font-size":this.fontSize,text:this.label,opacity:this.opacity}),
this.bindEvents(),this.update())};b.getMap=function(){return this.map};b.getMapBase=function(){return this.mapbase};b.editable=!1;b.getEditable=function(){return this.editable};b.setEditable=function(b){this.editable=b;this.setDraggable(b)};b.draggable=!1;b.getDraggable=function(){return this.draggable};b.setDraggable=function(b){this.draggable=b;TGOS.TGEvent.trigger(this,"draggable_changed");this.elem&&(this.elem&&!0==b?this.elem.mousedown(this.textDrag):this.elem&&!1==b&&this.elem.unmousedown(this.textDrag))};
b.clickable=!1;b.getClickable=function(){return this.clickable};b.setClickable=function(b){"boolean"===typeof b&&((this.clickable=b)?TGOS.TGEvent.releaseEventLock(this,"click"):TGOS.TGEvent.lockEvent(this,"click"),TGOS.TGEvent.trigger(this,"clickable_changed"))};b.advancedLayer=null;b.getAdvancedLayer=function(){return this.advancedLayer};b.setAdvancedLayer=function(b){this.advancedLayer=b};b.getPaper=function(){return null!=this.advancedLayer?this.advancedLayer.paper.main:this.map.getPaper()};b.getShadowPaper=
function(){return null!=this.advancedLayer?this.advancedLayer.paper.shadow:this.map.getShadowPaper()};b.setOptions=function(b){void 0!==b.zIndex&&this.setZIndex(b.zIndex);b.font&&this.setFont(b.font);b.fontColor&&this.setFontColor(b.fontColor);b.fontWeight&&this.setFontWeight(b.fontWeight);b.fontSize&&this.setFontSize(b.fontSize);b.label&&this.setLabel(b.label);b.backgroundColor&&this.setBackgroundColor(b.backgroundColor);void 0!==b.opacity&&this.setOpacity(b.opacity);void 0!==b.clickable&&this.setClickable(b.clickable);
void 0!==b.draggable&&this.setDraggable(b.draggable);b.position&&this.setPosition(b.position);b.map&&this.setMap(b.map);this.update()};TGOS.RegisterEvent(TGOS.TGLabel,"label_changed zindex_changed click dblclick rightclick mousemove mousedown mouseup mouseover mouseout".split(" "))})();TGOS.TGInfoWindow=function(b,d,a){var f="",e,g,h,k,l=this,p,m;k=document.createElement("img");e=document.createElement("div");g=document.createElement("div");h=document.createElement("div");document.createElement("div");k.src=TGOS.RES_PATH+"Sample/Angle.png";k.style.position="absolute";k.style.height="21px";k.style.width="34px";k.style.zIndex=1E6;e.style.position="absolute";e.style.border="solid 1px #AAAAAA";e.style.backgroundColor="#ffffff";e.style.opacity=1;e.style.borderRadius="5px";e.style.overflow=
"auto";g.style.width="auto";g.style.height="auto";g.style.position="absolute";g.style.overflow="auto";g.style.margin="10px";g.style["word-break"]="break-all";h.style.position="absolute";h.top="5px";h.style.width="15px";h.style.height="15px";h.style.overflow="auto";h.style.right="5px";h.style.zIndex=1E6;h.style.backgroundImage='url("'+TGOS.RES_PATH+'Sample/Close.png")';this.onCloseClick=function(a){l.close()};AttachEvent(h,"click",this.onCloseClick);e.appendChild(g);var n=100,u=new TGOS.TGSize(0,0),
s=1E6;if(void 0!==a||null!=a)void 0!==a.maxWidth&&(n=a.maxWidth),void 0!==a.pixelOffset&&(u=a.pixelOffset),void 0!==a.optzIndex&&(s=a.optzIndex);var q=n,w=d||new TGOS.TGPoint(0,0),C=u,B=s,H=!0;this.getElement=function(){return e};this.open=function(a){a.infoWindowLayer.containing(this)?this.update():(a.getHPack().appendChild(e),a.getHPack().appendChild(k),a.getHPack().appendChild(h),a.infoWindowLayer.add(this),p=a,m=p.getMapBase(),e.style.zIndex=B,g.innerHTML="<p>"+f+"</p>",800<q?(e.style.width="800px",
e.style.maxWidth="800px"):40<q&&800>q?(e.style.width=q+20+"px",e.style.maxWidth=q+20+"px"):(e.style.width="40px",e.style.maxWidth="40px"),k.style.display="inline",h.style.display="inline",e.style.height=g.scrollHeight+20+"px",this.update(),this.panToCenter())};this.close=function(){p&&p.infoWindowLayer.containing(this)&&(TGOS.TGEvent.trigger(this,"closeclick"),p.infoWindowLayer.remove(this),k.parentNode&&k.parentNode.removeChild(k),h.parentNode&&h.parentNode.removeChild(h))};this.setContent=function(a){"string"==
typeof a?f=a:a instanceof HTMLElement&&g.appendChild(a);f=a;g.innerHTML='<p style="white-space: nowrap">'+f+"</p>";e.style.width=g.scrollWidth+40>q?q+40+"px":g.scrollWidth+40+"px";e.style.height=g.scrollHeight+30+"px";TGOS.TGEvent.trigger(this,"content_changed")};this.setPosition=function(a){a instanceof TGOS.TGPoint&&(a.x!==w.x||a.y!==w.y)&&(w=a,this.update(),TGOS.TGEvent.trigger(this,"position_changed"))};this.getPosition=function(){return w};this.getContentPane=function(){return g};this.setMaxWidth=
function(a){q=a;e.style.width=g.scrollWidth+40>q?q+40+"px":g.scrollWidth+40+"px";e.style.height=g.scrollHeight+30+"px"};this.setZIndex=function(a){a!==B&&(B=a,e.style.zIndex=a,k.style.zIndex=a,h.style.zIndex=a,this.update(),TGOS.TGEvent.trigger(this,"zindex_changed"))};this.getZIndex=function(){return B};this.setPixelOffset=function(a){C=a;this.update()};this.disableAutoPan=function(a){"boolean"==typeof a&&(H=a)};this.putOpacity=function(a){e.style.opacity=a;k.style.opacity=a;h.style.opacity=a;e.style.filter=
"alpha(opacity="+100*a+")";k.style.filter="alpha(opacity="+100*a+")";h.style.filter="alpha(opacity="+100*a+")"};this.panToCenter=function(){if(!1==H&&m&&p){var a=m.FromMapPoint(w.x,w.y),b=parseInt(a.x)-e.offsetWidth/2,a=parseInt(a.y)-e.offsetHeight/2;m.ToMapPoint(b,a);p.setCenter(w)}};this.setMessageText=function(a){this.setContent(a)};this.setOptions=function(a){void 0!=a&&("boolean"==typeof a.disableAutoPan&&this.disableAutoPan(a.disableAutoPan),a.position instanceof TGOS.TGPoint&&this.setPosition(a.position),
"number"==typeof a.maxWidth&&this.setMaxWidth(a.maxWidth),a.pixelOffset instanceof TGOS.TGSize&&this.setPixelOffset(a.pixelOffset),"number"==typeof a.zIndex&&this.setZIndex(a.zIndex),"string"==typeof a.messageText&&this.setMessageText(a.messageText),"number"==typeof a.opacity&&this.putOpacity(a.opacity),this.update())};this.update=function(){if("undefined"!=typeof m&&p){switch(p.getCoordSys()){case TGOS.TGCoordSys.EPSG3857:var a=TGOS.WGS84ToGoo(w.x,w.y),a=m.FromMapPoint(a.x,a.y);break;case TGOS.TGCoordSys.EPSG3826:a=
m.FromMapPoint(w.x,w.y);break;case TGOS.TGCoordSys.EPSG3825:a=m.FromMapPoint(w.x,w.y)}e.style.left=parseInt(a.x)+C.width+"px";e.style.top=parseInt(a.y)-19-parseInt(e.offsetHeight)+C.height+"px";k.style.left=parseInt(a.x)+C.width+"px";k.style.top=parseInt(a.y)-19+C.height+"px";h.style.left=parseInt(a.x)+e.clientWidth+C.width-20+"px";h.style.top=parseInt(e.style.top)+5+"px"}};this.setContent(b);this.setOptions({position:d});this.setOptions(a)};
TGOS.RegisterEvent(TGOS.TGInfoWindow,["closeclick","content_changed","position_changed","zindex_changed","domready"]);TGOS.TGImage=function(b,d,a,f,e){var g="";this.size=d instanceof TGOS.TGSize?d:new TGOS.TGSize(32,32);e instanceof TGOS.TGSize&&(this.scaledSize=e);this.anchor=f instanceof TGOS.TGPoint?f:new TGOS.TGPoint(this.size.width/2-1,this.size.height-1);this.origin=a instanceof TGOS.TGPoint?a:new TGOS.TGPoint(0,0);this.setOptions=function(a){a.scale&&(this.scale=a.scale);a.hotSpot&&(this.hotSpot=a.hotSpot)};this.setUrl=function(a){"string"==typeof a&&(g=a)};this.getUrl=function(){return g};this.setUrl(b)};
TGOS.extend(TGOS.MVCObject,TGOS.TGImage);TGOS.TGSymbol=function(){var b={FORWARD_OPEN_ARROW:1,BACKWARD_OPEN_ARROW:3};TGOS.TGSymbolStyle={FORWARD_CLOSED_ARROW:0,FORWARD_OPEN_ARROW:1,BACKWARD_CLOSED_ARROW:2,BACKWARD_OPEN_ARROW:3,CIRCLE:4,DOUBLE_CIRCLE:5,TRIPLE_CIRCLE:6,CIRCLE_SPOT:7,TRIANGLE:8,INVERT_TRIANGLE:9,SQUARE:10,PENTAGON:11,HEXAGON:12,OCTAGON:13,PENTASTAR:14,HEXASTAR:15};var d=function(){this.anchor=new TGOS.TGPoint(0,0);this.symbolStyle=TGOS.TGSymbolStyle.CIRCLE;this.yPixel=this.xPixel=48;this.rotation=0;this.opacity=1;this.fillColor=
"#ffffff";this.fillOpacity=0;this.strokeColor="#000000";this.strokeWeight=2;this.strokeOpacity=1};TGOS.extend(TGOS.MVCObject,d);d.noFill=function(a){for(var d in b)if(b[d]==a)return!0;return!1};d.SymbolPath="M0 0 L 100 50 L0 100L50 50Z;M0 0 L 100 50 L0 100;M100 0 L 0 50 L100 100L50 50Z;M100 0 L 0 50 L100 100;M0 50 A 50 50 0 0 1 100 50 A50 50 0 0 1 0 50z;M0 50A50 50 0 0 1 100 50 A50 50 0 0 1 0 50zM25 50A25 25 0 0 1 75 50 A25 25 0 0 1 25 50z;M0 50A50 50 0 0 1 100 50 A50 50 0 0 1 0 50zM16.67 50A33.33 33.33 0 0 1 83.33 50 A33.33 33.33 0 0 1 16.67 50zM33.33 50A16.67 16.67 0 0 1 66.67 50 A16.67 16.67 0 0 1 33.33 50z;M0 50A50 50 0 0 1 100 50 A50 50 0 0 1 0 50ZM45 45L55 55M55 45L45 55;M50 0L7 75L93 75Z;M93 25L7 25L50 100Z;M0 0L100 0L100 100L0 100Z;M50 0L2 35L21 90L79 90L98 35Z;M50 0L7 25L7 75L50 100L93 75L93 25Z;M50 0L15 15L0 50L15 85L50 100L85 85L100 50L85 15Z;M50 0L35 30L2 35 L26 58L21 90L50 75L79 90L74\t58L98 35L65\t30Z;M50,0L38,28L7,25L25,50L7,75L37,72L50,100L62,72L93,75L75,50L93,25L63,28Z".split(";");
return d}();TGOS.TGEvent=function(){var b=0>util.getInternetExplorerVersion()?0:1,d={standardDomMouseEvents:{click:"click",mousemove:"mousemove",mousedown:"mousedown",mouseover:"mouseover",mouseout:"mouseout",mouseup:"mouseup",dblclick:"dblclick",rightclick:"rightclick"},RIGHTBUTTON:2};d.LEFTBUTTON=b;TGOS.MapsEventListener=function(){};TGOS.OverlayCompleteEvent=function(a,b,d){this.overlay=a;this.type=b;this.action=d?d:""};TGOS.TGMouseEvent=function(a,b){Object.defineProperty(this,"type",{value:b||a.type});this.mapListener_=
null;this.stop=function(){d.removeListener(this.mapListener_);this.mapListener_=null};this.stopPropagation=function(){a.stopPropagation&&a.stopPropagation();a.cancelBubble=!0};this.point=new TGOS.TGPoint};d.addListener_=function(a,b,d,g,h){if(a&&b&&a.events&&!(0>a.events.indexOf(b))){var k=a[b+"_"],l=null;k||(a[b+"_"]=[],k=a[b+"_"]);if(k)return l={target_:a,eventName_:b,targetQueue_:b+"_",handler_:d,executeLimit:h,capture:g},k.push(l),l}};d.addDomListener=function(a,b,e,g){return d.addListener_(a,
b,e,g,Infinity)};d.addDomListenerOnce=function(a,b,e,g){return d.addListener_(a,b,e,g,1)};d.addListener=function(a,b,e,g){return d.addListener_(a,b,e,g,Infinity)};d.addListenerOnce=function(a,b,e,g){return d.addListener_(a,b,e,g,1)};d.clearInstanceListeners=function(a){if(a.events)for(var b=0;b<a.events.length;b++)d.clearListeners(a,a.events[b])};d.copyEvent=function(a,b){for(var e=0;e<a.events.length;e++){var g=a.events[e],h=a[g+"_"];if(h)for(var k=0;k<h.length;k++){var l=h[k];d.addListener_(b,g,
l.handler_,l.capture,l,l.executeLimit)}}};d.clearListeners=function(a,b){var e=a[b+"_"];if(e)for(var g=e.length-1;0<=g;g--)d.removeListener(e[g])};d.removeListener=function(a){var b=null;a&&(b=a.target_[a.targetQueue_],a=b.indexOf(a),0>a||b.splice(a,1))};d.trigger_=function(a,b){var e=null,e=a[b+"_"];if(!e||0>=e.length)return!1;for(var g=0;g<e.length;g++)e[g].handler_.apply(a,Array.prototype.slice.call(arguments).slice(2)),0<e.length&&void 0!==e[g].executeLimit&&(e[g].executeLimit--,0>=e[g].executeLimit&&
d.removeListener(e[g]))};d.trigger=function(a,b){d.trigger_(a,b)};d.releaseEventLock=function(a,b){if(a&&a.events&&a.events.length&&b&&a.lockEvt&&0<=a.lockEvt.indexOf(b)){var d=a.lockEvt.indexOf(b);0>d||a.lockEvt.splice(d,1)}};d.lockEvent=function(a,b){a&&a.events&&a.events.length&&b&&(a.lockEvt||(a.lockEvt=[]),0<=a.lockEvt.indexOf(b)||a.lockEvt.push(b))};return d}();(function(){var b=TGOS.RES_PATH+"marker2.png",d=TGOS.RES_PATH+"shadow2.png";TGOS.TGMarker=function(a,b,d,h,k){var l=this;this.toMapPoint=function(a,b){var d,e=l.map.getMapBase(),f=e.getPackageOffset(),e=e.ToMapPoint(a-f.x,b-f.y);switch(l.map.getCoordSys()){case TGOS.TGCoordSys.EPSG3857:d=TGOS.GooToWGS84(e.x,e.y);d=new TGOS.TGPoint(d.x,d.y);break;case TGOS.TGCoordSys.EPSG3826:d=e;break;case TGOS.TGCoordSys.EPSG3825:d=e}return d};this.endDrag=function(a){if(2<l.sclientx-a.clientX||2<l.sclienty-a.clientY||
-2>l.sclientx-a.clientX||-2>l.sclienty-a.clientY)l.dragMoved=!0;DetachEvent(document.body,"mousemove",l.markMove,!0);DetachEvent(document.body,"mouseup",l.endDrag,!0);!l.dragMoved&&l.editable?null!=l.clickCallback&&l.clickCallback.call(this,l):null!=l.movedCallback&&l.movedCallback.call(this,l)};this.markMove=function(a){a=l.toMapPoint(a.clientX,a.clientY);a.x-=l.soffsetx;a.y-=l.soffsety;l.setPosition(a);l.editable&&null!=l.moveCallback&&l.moveCallback.call(this,l)};this.markDrag=function(a){l.sclientx=
a.clientX;l.sclienty=a.clientY;var b=l.toMapPoint(l.sclientx,l.sclienty);l.soffsetx=b.x-l.position.x;l.soffsety=b.y-l.position.y;l.dragMoved=!1;a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();AttachEvent(document.body,"mousemove",l.markMove,!0);AttachEvent(document.body,"mouseup",l.endDrag,!0)};this.setClickCallback=function(a){this.clickCallback=a};this.setMoveCallback=function(a){this.moveCallback=a};this.setMovedCallback=function(a){this.movedCallback=a};b instanceof TGOS.TGPoint&&(this.position=
b);void 0!==h&&null!=h&&(this.icon=h);void 0!==d&&null!=d&&(this.title=d);this.getNode=function(){if(this.map&&this.advancedLayer){var a=this.getAdvancedLayer();return null!=a?[a.div.main,a.div.shadow]:this.map.getPanes().graphicLayer}};k&&this.setMarkerOptions(k);a&&this.setMap(a)};TGOS.extend(TGOS.Graphic,TGOS.TGMarker);var a=TGOS.TGMarker.prototype;a.elem=null;a.map=null;a.gPos=null;a.clone=function(){var a=new TGOS.TGMarker(null,this.getPosition(),this.getTitle(),this.getIcon());a.setShadow(this.getShadow());
a.setInfoAnchorPoint(this.getInfoAnchorPoint());a.setFlat(this.getFlat());return a};a.isPointInEnvelope=function(a,b,d){var h=null,k=this.position;if(void 0!==k&&null!=k){var l=this.icon;if(void 0!==l&&null!=l){var h=k.x-l.anchor.x*d,p=k.x+l.anchor.x*d,m=k.y+l.anchor.y*d,n=k.y-l.anchor.y*d;this.icon instanceof TGOS.TGImage?(p=k.x+(l.size.width-l.anchor.x)*d,n=k.y-(l.size.height-l.anchor.y)*d):this.icon instanceof TGOS.TGSymbol&&(p=k.x+(l.xPixel-l.anchor.x)*d,n=k.y-(l.yPixel-l.anchor.y)*d);h=a>=h&&
a<=p&&b>=n&&b<=m?!0:!1}}return h};a.getEnvelope=function(){return new TGOS.TGEnvelope(this.position.x,this.position.y,this.position.x,this.position.y)};a.getBounds=function(){return new TGOS.TGEnvelope(this.position.x,this.position.y,this.position.x,this.position.y)};a.setMap=function(a){if(null===a)this.destroy(),this.map=null;else if(this.destroy(),a instanceof TGOS.TGOnlineMap){(this.map=a)&&this.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(this.gPos=TGOS.WGS84ToGoo(this.position.x,this.position.y));
this.map.overlay.add(this);this.getPaper();a=this.getShadowPaper();var b=this.shadow?this.shadow.getUrl():d;this.sImg=a.image(b,0,0,this.shadow.size.width,this.shadow.size.height);!0!=this.flat&&!1!=this.visible||this.sImg.hide();this.redrawMarker();this.update()}};a.getMap=function(){return this.map};a.getMapBase=function(){if(this.map)return this.map.getMapBase()};a.destroy=function(){this.map&&(this.elem&&this.elem.remove(),this.sImg&&this.sImg.remove(),this.map.overlay.remove(this),this.sImg=
this.elem=null)};a.getEventElement=function(){return this.elem};a.title="";a.getTitle=function(){return this.title};a.setTitle=function(a){this.title=a;this.elem&&(this.elem.attr({title:this.title}),TGOS.TGEvent.trigger(this,"title_changed"))};a.setPath=function(a){this.setPosition(a)};a.position=null;a.getPosition=function(){return this.position};a.setPosition=function(a){a instanceof TGOS.TGPoint&&(this.position=a,this.map&&this.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(this.gPos=TGOS.WGS84ToGoo(this.position.x,
this.position.y)),this.update(),TGOS.TGEvent.trigger(this,"position_changed"))};this.infoAnchorPosition=null;a.getInfoAnchorPoint=function(){return this.infoAnchorPoint};a.setInfoAnchorPoint=function(a){this.infoAnchorPoint=a};a.icon=new TGOS.TGImage(b,new TGOS.TGSize(31,30),new TGOS.TGPoint(0,0),new TGOS.TGPoint(9,28));a.getIcon=function(){return this.icon};a.setIcon=function(a){if(a instanceof TGOS.TGImage||a instanceof TGOS.TGSymbol)this.icon=a,this.redrawMarker(),this.update(),TGOS.TGEvent.trigger(this,
"icon_changed")};a.clickable=!1;a.getClickable=function(){return this.clickable};a.setClickable=function(a){"boolean"===typeof a&&((this.clickable=a)?TGOS.TGEvent.releaseEventLock(this,"click"):TGOS.TGEvent.lockEvent(this,"click"),TGOS.TGEvent.trigger(this,"clickable_changed"))};a.redrawMarker=function(){if((this.icon instanceof TGOS.TGImage||this.icon instanceof TGOS.TGSymbol)&&this.map){this.elem&&this.elem.remove();var b=this.getPaper();if(this.icon instanceof TGOS.TGImage)if(this.fitImageSize){var d=
document.createElement("img"),g=this;d.onload=function(){var d=a.icon.size.width,e=a.icon.size.height;try{d=this.width,e=this.height}catch(l){}a.elem=b.image(g.icon.getUrl(),0,0,d,e);!1===a.visible?a.elem.hide():a.elem.show();null!=a.cursor&&a.elem.attr({cursor:a.cursor});null!=a.title&&a.elem.attr({title:a.title});g.map.overlay.updateElementOrder(g);g.bindEvents();g.update()};d.src=this.icon.getUrl()}else this.icon.scale?(d=document.createElement("img"),g=this,d.onload=function(d){g.icon.size.width=
d.srcElement.width*g.icon.scale;g.icon.size.height=d.srcElement.height*g.icon.scale;a.elem=g.icon.scaledSize?b.image(g.icon.getUrl(),0,0,g.icon.scaledSize.width,g.icon.scaledSize.height):b.image(g.icon.getUrl(),0,0,g.icon.size.width,g.icon.size.height);!1===a.visible?a.elem.hide():a.elem.show();null!=a.cursor&&a.elem.attr({cursor:a.cursor});null!=a.title&&a.elem.attr({title:a.title});g.map.overlay.updateElementOrder(g);g.bindEvents();g.update()},d.src=this.icon.getUrl()):(this.elem=this.icon.scaledSize?
b.image(this.icon.getUrl(),0,0,this.icon.scaledSize.width,this.icon.scaledSize.height):b.image(this.icon.getUrl(),0,0,this.icon.size.width,this.icon.size.height),!1===this.visible?this.elem.hide():this.elem.show(),void 0!==this.cursor&&null!=this.cursor&&this.elem.attr({cursor:this.cursor}),void 0!==this.title&&null!=this.title&&this.elem.attr({title:this.title}),this.map.overlay.updateElementOrder(this),this.bindEvents(),this.update());else if(this.icon instanceof TGOS.TGSymbol){d=this.icon.symbolStyle in
TGOS.TGSymbol.SymbolPath?TGOS.TGSymbol.SymbolPath[this.icon.symbolStyle]:this.icon.symbolStyle;if(!d)throw"Invalid SymbolStyle or path";this.elem=b.path(d);this.bbox_=this.elem.getBBox(!0);d=TGOS.TGSymbol.noFill(this.icon.symbolStyle);this.elem.attr({opacity:this.icon.opacity,fill:this.icon.fillColor,"fill-opacity":d?0:this.icon.fillOpacity,stroke:this.icon.strokeColor,"stroke-opacity":this.icon.strokeOpacity,"stroke-width":this.icon.strokeWeight});!1===this.visible?this.elem.hide():this.elem.show();
void 0!==this.cursor&&null!=this.cursor&&this.elem.attr({cursor:this.cursor});void 0!==this.title&&null!=this.title&&this.elem.attr({title:this.title});this.map.overlay.updateElementOrder(this);this.bindEvents();this.update()}}};a.icon_changed=function(){this.redrawMarker()};a.visible=!0;a.getVisible=function(){return this.visible};a.setVisible=function(a,b){this.visible=a;this.map&&(!0===this.visible?(this.elem.show(),!1===this.flat&&this.sImg.show()):(this.elem.hide(),this.sImg.hide()),b||this.update(),
TGOS.TGEvent.trigger(this,"visible_changed"))};a.cursor=null;a.getCursor=function(){return this.cursor};a.setCursor=function(a){this.cursor=a;this.elem&&(this.elem.attr({cursor:this.cursor}),TGOS.TGEvent.trigger(this,"cursor_changed"))};a.zIndex=0;a.getZIndex=function(){return this.zIndex};a.setZIndex=function(a){this.zIndex=parseInt(a);this.map&&(this.map.overlay.updateArrayOrder(this),this.map.overlay.updateElementOrder(this),TGOS.TGEvent.trigger(this,"zindex_changed"))};a.editable=!1;a.getEditable=
function(){return this.editable};a.setEditable=function(a){this.editable=a;this.setDraggable(a)};a.draggable=!1;a.getDraggable=function(){return this.draggable};a.setDraggable=function(a){this.draggable=a;TGOS.TGEvent.trigger(this,"draggable_changed");this.elem&&(this.elem&&!0==a?this.elem.mousedown(this.markDrag):this.elem&&!1==a&&this.elem.unmousedown(this.markDrag))};a.flat=!1;a.getFlat=function(){return this.flat};a.setFlat=function(a){this.flat=a;this.sImg&&(!0===this.flat?this.sImg.hide():this.sImg.show(),
TGOS.TGEvent.trigger(this,"flat_changed"))};a.shadow=new TGOS.TGImage(d,new TGOS.TGSize(31,30),new TGOS.TGPoint(0,0),new TGOS.TGPoint(9,25));a.getShadow=function(){return this.shadow};a.setShadow=function(a){this.shadow=a;TGOS.TGEvent.trigger(this,"shadow_changed")};a.advancedLayer=null;a.getAdvancedLayer=function(){return this.advancedLayer};a.setAdvancedLayer=function(a){this.advancedLayer=a};a.getPaper=function(){return null!=this.advancedLayer?this.advancedLayer.paper.main:this.map.getPaper()};
a.getShadowPaper=function(){return null!=this.advancedLayer?this.advancedLayer.paper.shadow:this.map.getShadowPaper()};a.fitImageSize=!1;a.setFitImageSize=function(a){this.fitImageSize=a};a.setMarkerOptions=function(a){a&&(void 0!==a.advancedLayer&&this.setAdvancedLayer(a.advancedLayer),void 0!==a.visible&&this.setVisible(a.visible),void 0!=a.icon&&this.setIcon(a.icon),void 0!==a.shadow&&this.setShadow(a.shadow),void 0!=a.title&&this.setTitle(a.title),void 0!==a.position&&this.setPosition(a.position),
void 0!==a.infoAnchor&&this.setInfoAnchorPoint(a.infoAnchor),void 0!==a.clickable&&this.setClickable(a.clickable),void 0!==a.cursor&&this.setCursor(a.cursor),void 0!=a.zIndex&&this.setZIndex(a.zIndex),void 0!==a.draggable&&this.setDraggable(a.draggable),void 0!==a.flat&&this.setFlat(a.flat),void 0!==a.shape&&this.setShape(a.shape),void 0!==a.fitImageSize&&this.setFitImageSize(a.fitImageSize))};a.update=function(){if(this.position&&this.visible&&this.elem&&this.map){var a;switch(this.map.getCoordSys()){case TGOS.TGCoordSys.EPSG3857:a=
this.gPos;break;default:a=this.position}var b=this.map.getMapBase();if(this.map.getRawBound().contains(a)){this.visible&&(this.elem.show(),!0!==this.flat&&this.sImg.show());a=b.FromMapPoint(a.x,a.y);if(this.icon instanceof TGOS.TGImage){var b=a.x-this.icon.anchor.x,d=a.y-this.icon.anchor.y;this.icon.hotSpot&&(b=a.x-this.icon.hotSpot.x,d=a.y-this.icon.hotSpot.y);this.elem.attr({x:b,y:d});this.elem.attr({"clip-rect":b+","+d+","+this.icon.size.width+","+this.icon.size.height})}else if(this.icon instanceof
TGOS.TGSymbol){if(!this.bbox_){this.bbox_=this.elem.getBBox(!0);return}this.elem.transform("t"+(a.x-this.icon.anchor.x)+","+(a.y-this.icon.anchor.y)+"r"+this.icon.rotation+","+this.icon.anchor.x+","+this.icon.anchor.y+"s"+this.icon.xPixel/this.bbox_.width+","+this.icon.yPixel/this.bbox_.height+",0,0")}else return;!1===this.flat&&this.sImg.attr({x:a.x-this.shadow.anchor.x,y:a.y-this.shadow.anchor.y})}else this.elem.hide(),this.sImg.hide()}};TGOS.RegisterEvent(TGOS.TGMarker,"clickable_changed icon_changed position_changed title_changed visible_changed zindex_changed click mousedown mouseup mouseover mouseout mousemove cursor_changed draggable_changed flat_changed shadow_changed shape_changed dblclick rightclick".split(" "))})();TGOS.TGDrawing=function(){TGOS.TGOverlayType={NONE:"NONE",CIRCLE:"CIRCLE",MARKER:"MARKER",POLYGON:"POLYGON",LINESTRING:"LINESTRING",ENVELOPE:"ENVELOPE",LABEL:"LABEL",EDIT:"EDIT",MODIFY:"MODIFY"};TGOS.TGModifyType={STARTED:"STARTED",ATTRIBUTE:"ATTRIBUTE",SAVE:"SAVE",DELETE:"DELETE",CANCEL:"CANCEL"};var b=function(a,b,d,e){var f=this;this.manager=a;this.mode=b;this.active=!1;this.activeImage=d;this.inactiveImage=e;this.div=document.createElement("div");this.img=document.createElement("img");this.div.appendChild(this.img);
this.setActive=function(a){this.active=a;this.img.src=this.active?f.activeImage:f.inactiveImage};this.destructor=function(){div.parentNode&&div.parentNode.removeChild(this.div);this.img=this.div=null};this.setActive(!1);this.div.onclick=function(){var a=f.manager.getDrawingMode()==f.mode?TGOS.TGOverlayType.NONE:f.mode;f.manager.setDrawingMode(a)}},d=function(a,b,d,e){var f=this;this.manager=a;this.mode=b;this.active=!0;this.enabledImage=d;this.disabledImage=e;this.div=document.createElement("div");
this.img=document.createElement("img");this.div.appendChild(this.img);this.setActive=function(a){this.active=a;this.img.src=this.active?f.enabledImage:f.disabledImage};this.destructor=function(){div.parentNode&&div.parentNode.removeChild(this.div);this.img=this.div=null};this.setActive(!0);this.div.onclick=function(){f.active&&f.manager.setModifyMode(f.mode)}},a=function(a){a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation()},f=function(a,b){this.buttons=[];a&&(this.manager=a);this.position=
TGOS.TGControlPosition.BOTTOM_RIGHT;this.div=document.createElement("div");util.disableSelect(this.div);this.table=document.createElement("table");this.div.appendChild(this.table);this.row=this.table.insertRow(-1);a.map&&this.setMap(a.map);b&&this.setOptions(b)},e=f.prototype;e.setMap=function(a){this.map!=a&&(this.map=a,this.position&&a.controls[this.position].push(this.div))};e.setImages=function(a){this.images=a};e.setVisible=function(a){this.div.style.display=a?"":"none"};e.setPosition=function(a){if(this.manager.map){var b=
this.manager.map.controls[this.position].indexOf(this.div);0<=b&&(this.manager.map.controls[this.position].removeAt(b),this.manager.map.controls[a].push(this.div),this.position=a)}};e.setOptions=function(a){a.images&&this.setImages(a.images);a.controlPosition&&this.setPosition(a.controlPosition);a.modifyModes&&this.setModes(a.modifyModes)};e.setButtonState=function(a,b){for(var d=!1,e=0;e<this.buttons.length;e++){var f=this.buttons[e];f.mode==a&&(f.setActive(b),d=!0)}return d};e.setModes=function(a){this.div.innerHTML=
"";this.table=document.createElement("table");this.div.appendChild(this.table);this.buttons=[];this.row=this.table.insertRow(-1);for(var b=0;b<a.length;b++){var e=new d(this.manager,a[b],this.images.enabled[a[b]],this.images.disabled[a[b]]);this.row.insertCell(-1).appendChild(e.div);this.buttons.push(e)}};var g=function(a,b){this.buttons=[];a&&(this.manager=a);this.labelEnabled=!0;this.position=TGOS.TGControlPosition.BOTTOM_RIGHT;this.div=document.createElement("div");util.disableSelect(this.div);
this.table=document.createElement("table");this.div.appendChild(this.table);this.row=this.table.insertRow(-1);a.map&&this.setMap(a.map);b&&this.setOptions(b)},e=g.prototype;e.setMap=function(a){this.map!=a&&(this.map=a,this.position&&a.controls[this.position].push(this.div))};e.setImages=function(a){this.images=a};e.setVisible=function(a){this.div.style.display=a?"":"none"};e.setPosition=function(a){if(this.manager.map){var b=this.manager.map.controls[this.position].indexOf(this.div);0<=b&&(this.manager.map.controls[this.position].removeAt(b),
this.manager.map.controls[a].push(this.div),this.position=a)}};e.clearAllGraphics=function(){};e.getAllGraphics=function(){};e.setOptions=function(a){a.images&&this.setImages(a.images);a.controlPosition&&this.setPosition(a.controlPosition);a.drawingModes&&this.setModes(a.drawingModes)};e.toggleMode=function(a){for(var b=0;b<this.buttons.length;b++){var d=this.buttons[b];d.setActive(a==d.mode)}};e.setModes=function(a){this.div.innerHTML="";this.table=document.createElement("table");this.div.appendChild(this.table);
this.buttons=[];this.row=this.table.insertRow(-1);for(var d=0;d<a.length;d++)if("LABEL"!=a[d]||this.labelEnabled){var e=new b(this.manager,a[d],this.images.active[a[d]],this.images.inactive[a[d]]);this.row.insertCell(-1).appendChild(e.div);this.buttons.push(e)}};var h=TGOS.RES_PATH+"marker2.png",k=TGOS.RES_PATH+"shadow2.png",l=function(a){var b=0,d=0;a.getBoundingClientRect&&(a=a.getBoundingClientRect(),b=a.left,d=a.top);return new TGOS.TGPoint(b,d)},e=function(b){DEBUG_MODE&&console.log("TGDrawing : "+
b);var d=this,e=!1,p,q,w,C,B,H,A,I=null,G,D;this.overlayForwardEvent=!0;this.envelopeDblClick=this.circleDblClick=!1;this.drawingMode=TGOS.TGOverlayType.NONE;this.useDefaultControl=!0;this.graphicSelectedCallback=null;this.moveGraphicByKey=!0;this.moveNodeByKey=!1;var J=[],K=null,F=TGOS.TGOverlayType.MODIFY,t=[],v=-1,z=[],E=null,L=null,P={flat:!0,draggable:!0},U={flat:!0,draggable:!1,clickable:!0},Y=function(a){d.getDrawingMode()!=TGOS.TGOverlayType.MODIFY&&d.setDrawingMode(TGOS.TGOverlayType.MODIFY);
if(d.getDrawingMode()==TGOS.TGOverlayType.MODIFY){d.moveNodeByKey&&d.selectVertex(!1,null);var b;if(a instanceof TGOS.TGMarker){if(b=a.position,void 0!==b){d.clearModifies();K=a;F=TGOS.TGOverlayType.MARKER;var e=d.options.modifyIndicateOptions.circleCenter,f=new TGOS.TGPoint(b.x,b.y);t.push(new TGOS.TGMarker(d.map,f,"",e,U))}}else if(a instanceof TGOS.TGLabel)b=a.position,void 0!==b&&(d.clearModifies(),K=a,F=TGOS.TGOverlayType.LABEL,e=d.options.modifyIndicateOptions.circleCenter,f=new TGOS.TGPoint(b.x,
b.y),t.push(new TGOS.TGMarker(d.map,f,"",e,U)));else if(a.getPath&&(b=a.getPath()),void 0!==b){d.clearModifies();K=a;var f=d.options.modifyDrawingOptions.lineOptions,g=d.options.modifyDrawingOptions.circleOptions,h=d.options.modifyIndicateOptions.node,e=d.options.modifyIndicateOptions.circleCenter;E=new TGOS.TGLine(d.map,null,f);L=new TGOS.TGFill(d.map,null,g);if(b instanceof TGOS.TGPolygon){if(F=TGOS.TGOverlayType.POLYGON,e=b.getExteriorRing(),null!=e&&(e=e.getPath(),null!=e&&(b=e.getPath(),null!=
b)))for(e=0;e<b.length;e++)f=new TGOS.TGPoint(b[e].x,b[e].y),t.push(new TGOS.TGMarker(d.map,f,"",h,P))}else if(b instanceof TGOS.TGLineString)for(F=TGOS.TGOverlayType.LINESTRING,b=b.getPath(),e=0;e<b.length;e++)f=new TGOS.TGPoint(b[e].x,b[e].y),t.push(new TGOS.TGMarker(d.map,f,"",h,P));else b instanceof TGOS.TGEnvelope?(F=TGOS.TGOverlayType.ENVELOPE,g=b.top,f=b.right,e=b.bottom,t.push(new TGOS.TGMarker(d.map,new TGOS.TGPoint(b.left,g),"",h,P)),t.push(new TGOS.TGMarker(d.map,new TGOS.TGPoint(f,e),
"",h,P))):b instanceof TGOS.TGCircle&&(F=TGOS.TGOverlayType.CIRCLE,g=b.getCenter(),f=b.getRadius(),b=new TGOS.TGPoint(g.x,g.y),d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857?(g=TGOS.Geometry.Transform(g,TGOS.WGS84ToGoo),f=new TGOS.TGPoint(g.x+f,g.y),f=TGOS.Geometry.Transform(f,TGOS.GooToWGS84),g=new TGOS.TGPoint(f.x,f.y)):g=new TGOS.TGPoint(g.x+f,g.y),t.push(new TGOS.TGMarker(d.map,b,"",e,P)),t.push(new TGOS.TGMarker(d.map,g,"",h,P)))}for(e=0;e<t.length;e++)(h=t[e])&&h.setEditable&&(h.setEditable(!0),
d.moveNodeByKey&&h.setClickCallback(d.vertexSelected),h.setMoveCallback(d.vertexDragged),TGOS.TGEvent.addListener(h,"rightclick",d.vertexRemove));d.redrawModifies();d.moveGraphicByKey&&null!=K&&d.map.setKeyboardEdit(!0,d.onKeyboardKey);d.graphicSelectedCallback&&d.graphicSelectedCallback.call(this,a)}};this.snapToGraphics=function(a){var b=new TGOS.TGPoint(a.x,a.y),e=new TGOS.TGPoint(a.x,a.y);if(d.options.snapOptions.snapping){var f=d.map.getMapBase();if(null!=f){var f=f.ToMapDistX(d.options.snapOptions.tolerance),
g,h;if(0<f){if(d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857){var m=new TGOS.TGPoint(a.x,a.y);h=TGOS.Geometry.Transform(m,TGOS.GooToWGS84);m=new TGOS.TGPoint(m.x+f,m.y);m=TGOS.Geometry.Transform(m,TGOS.GooToWGS84);g=m.x-h.x}a=Infinity;for(var k=0;k<J.length;k++)if(m=J[k],null!=m){var l;m.getPath?l=m.getPath():m.position&&(l=m.position);if(void 0!==l&&null!=l){var t=null;if(l.nearestPoint)if(d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857)if(l instanceof TGOS.TGCircle){var m=l.getCenter(),m=TGOS.Geometry.Transform(m,
TGOS.WGS84ToGoo),t=l.getRadius(),v=new TGOS.TGCircle;v.setCenter(m);v.setRadius(t);t=v.nearestPoint(e,f,d.options.snapOptions)}else t=l.nearestPoint(h,g,d.options.snapOptions);else t=l.nearestPoint(e,f,d.options.snapOptions);null!=t&&(m=t.point,t=t.distance,void 0!==m&&t<a&&(a=t,b=new TGOS.TGPoint(m.x,m.y),d.map.getCoordSys()!=TGOS.TGCoordSys.EPSG3857||l instanceof TGOS.TGCircle||(b=TGOS.Geometry.Transform(b,TGOS.WGS84ToGoo))))}}}}}return b};this.onKeyboardKey=function(a,b){var e=b.getMapBase();if(a==
TGOS.KeyboardEditor.DEL)!d.moveGraphicByKey&&!d.moveNodeByKey||d.moveNodeByKey&&0<=v&&v<t.length||d.moveGraphicByKey&&0<t.length&&null!=K&&d.setModifyMode(TGOS.TGModifyType.DELETE);else{var f=0,g=0;a==TGOS.KeyboardEditor.UP?g=1:a==TGOS.KeyboardEditor.DOWN?g=-1:a==TGOS.KeyboardEditor.LEFT?f=-1:a==TGOS.KeyboardEditor.RIGHT&&(f=1);e=e.ToMapDistX(1);f*=e;g*=e;if(d.moveGraphicByKey||d.moveNodeByKey)if(d.moveNodeByKey&&0<=v&&v<t.length){var e=t[v],h=e.getPosition();b.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&
(h=TGOS.Geometry.Transform(h,TGOS.WGS84ToGoo));h.transform(1,0,0,1,f,g);b.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(h=TGOS.Geometry.Transform(h,TGOS.GooToWGS84));e.setPosition(h);e.update();d.redrawModifies()}else if(d.moveGraphicByKey&&0<t.length){for(var m=0;m<t.length;m++)e=t[m],h=e.getPosition(),b.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(h=TGOS.Geometry.Transform(h,TGOS.WGS84ToGoo)),h.transform(1,0,0,1,f,g),b.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(h=TGOS.Geometry.Transform(h,TGOS.GooToWGS84)),
e.setPosition(h),e.update();d.redrawModifies()}}};this.selectVertex=function(a,b){if(d.moveNodeByKey){if(0<=v&&v<t.length){var e=t[v];void 0!==e&&e.setIcon(d.options.modifyIndicateOptions.node);v=-1}a&&void 0!==b&&(e=t.indexOf(b),0<=e&&(v=e,b.setIcon(d.options.modifyIndicateOptions.move)))}};this.vertexSelected=function(a){d.selectVertex(!0,a);d.redrawModifies()};this.vertexDragged=function(a){d.moveNodeByKey&&d.selectVertex(!1,null);var b=a.getPosition();d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&
(b=TGOS.Geometry.Transform(b,TGOS.WGS84ToGoo));b=d.snapToGraphics(b);d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(b=TGOS.Geometry.Transform(b,TGOS.GooToWGS84));a.setPosition(b);a.update();d.redrawModifies()};this.vertexRemove=function(a){a=a.target;if(null!=a){var b=t.indexOf(a);0<=b&&(d.moveNodeByKey&&b==v&&selecteVertex(!1,null),F==TGOS.TGOverlayType.POLYGON||F==TGOS.TGOverlayType.LINESTRING)&&(a.setEditable&&(d.moveNodeByKey&&a.setClickCallback(null),a.setMoveCallback(null),a.setEditable(!1),
a.setMap(null)),t.splice(b,1))}d.redrawModifies()};this.pseudoAdd=function(a){var b=a.target;null!=b&&(a=z.indexOf(b),0<=a&&(F==TGOS.TGOverlayType.POLYGON||F==TGOS.TGOverlayType.LINESTRING)&&(b=new TGOS.TGMarker(d.map,b.position,"",d.options.modifyIndicateOptions.node,P),b.setEditable&&(b.setEditable(!0),d.moveNodeByKey&&b.setClickCallback(d.vertexSelected),b.setMoveCallback(d.vertexDragged),TGOS.TGEvent.addListener(b,"rightclick",d.vertexRemove)),t.splice(a+1,0,b)));d.redrawModifies()};this.redrawModifies=
function(){null!=E&&E.setPath(null);null!=L&&L.setPath(null);for(i=0;i<z.length;i++){var a=z[i];a&&a.setMap(null)}z=[];var b=!0;1>=t.length&&(b=!1);!d.moveGraphicByKey||F!=TGOS.TGOverlayType.MARKER&&F!=TGOS.TGOverlayType.LABEL||1>=t.length&&(b=!0);var e,a=[],f=d.options.modifyIndicateOptions.pseudo;switch(F){case TGOS.TGOverlayType.POLYGON:3>t.length&&(b=!1);for(i=0;i<t.length;i++)a.push(t[i].position),0<i&&(e=new TGOS.TGPoint((t[i].position.x+t[i-1].position.x)/2,(t[i].position.y+t[i-1].position.y)/
2),z.push(new TGOS.TGMarker(d.map,e,"",f,U)));a.push(t[0].position);e=new TGOS.TGPoint((t[0].position.x+t[t.length-1].position.x)/2,(t[0].position.y+t[t.length-1].position.y)/2);z.push(new TGOS.TGMarker(d.map,e,"",f,U));e=new TGOS.TGLineString(a);break;case TGOS.TGOverlayType.LINESTRING:2>t.length&&(b=!1);for(i=0;i<t.length;i++)a.push(t[i].position),0<i&&(e=new TGOS.TGPoint((t[i].position.x+t[i-1].position.x)/2,(t[i].position.y+t[i-1].position.y)/2),z.push(new TGOS.TGMarker(d.map,e,"",f,U)));e=new TGOS.TGLineString(a);
break;case TGOS.TGOverlayType.ENVELOPE:a.push(new TGOS.TGPoint(t[0].position.x,t[0].position.y));a.push(new TGOS.TGPoint(t[1].position.x,t[0].position.y));a.push(new TGOS.TGPoint(t[1].position.x,t[1].position.y));a.push(new TGOS.TGPoint(t[0].position.x,t[1].position.y));a.push(new TGOS.TGPoint(t[0].position.x,t[0].position.y));e=new TGOS.TGLineString(a);break;case TGOS.TGOverlayType.CIRCLE:a.push(new TGOS.TGPoint(t[0].position.x,t[0].position.y)),a.push(new TGOS.TGPoint(t[1].position.x,t[1].position.y)),
e=new TGOS.TGLineString(a),a=d.createCircle(t[0].position,t[1].position),null!=L&&L.setPath(a)}for(i=0;i<z.length;i++)(a=z[i])&&TGOS.TGEvent.addListener(a,"click",d.pseudoAdd);null!=E&&E.setPath(e);d.modifyControl&&d.modifyControl.setButtonState("SAVE",b)};this.createCircle=function(a,b){var e=a,f=b;d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857?(e=TGOS.Geometry.Transform(a,TGOS.WGS84ToGoo),f=TGOS.Geometry.Transform(b,TGOS.WGS84ToGoo)):(e=a,f=b);var g=e.x-f.x,f=e.y-f.y,g=Math.sqrt(g*g+f*f),f=new TGOS.TGCircle;
f.setCenter(e);f.setRadius(g);d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(f=TGOS.Geometry.Transform(f,TGOS.GooToWGS84));return f};this.createEnvelope=function(a,b){return new TGOS.TGEnvelope(a.x>b.x?b.x:a.x,a.y<b.y?b.y:a.y,a.x<b.x?b.x:a.x,a.y>b.y?b.y:a.y)};this.getAllGraphics=function(){return J};this.takeAllGraphics=function(){this.setDrawingMode(TGOS.TGOverlayType.NONE,!0);var a=[];for(i=0;i<J.length;i++){var b=J[i];b&&(b.setEditable&&b.setEditable(!1),a.push(b))}J=[];b=new TGOS.OverlayCompleteEvent(d.map,
"GRAPHICS","TAKE");TGOS.TGEvent.trigger_(d,"overlay_complete",b);return a};this.cloneAllGraphics=function(){var a=[];for(i=0;i<J.length;i++){var b=J[i];if(b&&b.clone){var e=b.clone();b.geoJsonProperties&&(e.geoJsonProperties=b.geoJsonProperties);a.push(e)}}b=new TGOS.OverlayCompleteEvent(d.map,"GRAPHICS","CLONE");TGOS.TGEvent.trigger_(d,"overlay_complete",b);return a};this.clearAllGraphics=function(){this.getDrawingMode()==TGOS.TGOverlayType.MODIFY&&this.setModifyMode(TGOS.TGModifyType.CANCEL,!1);
for(i=0;i<J.length;i++){var a=J[i];a&&(a.setEditable&&a.setEditable(!1),a.setMap(null))}J=[];a=new TGOS.OverlayCompleteEvent(d.map,"GRAPHICS","CLEAR");TGOS.TGEvent.trigger_(d,"overlay_complete",a)};this.clearModifies=function(){d.moveNodeByKey&&d.selectVertex(!1,null);for(i=0;i<t.length;i++){var a=t[i];a&&(a.setEditable&&a.setEditable(!1),a.click_&&TGOS.TGEvent.removeListener(a.click_[0]),a.setMap(null))}t=[];null!=E&&(E.click_&&TGOS.TGEvent.removeListener(E.click_[0]),E.setMap(null),E=null);null!=
L&&(L.click_&&TGOS.TGEvent.removeListener(L.click_[0]),L.setMap(null),L=null);for(i=0;i<z.length;i++)if(a=z[i])a.click_&&TGOS.TGEvent.removeListener(a.click_[0]),a.setMap(null);z=[]};var M="{}";this.setModifyMode=function(a,b){var e=!0;void 0!==b&&"boolean"==typeof b&&(e=b);switch(a){case TGOS.TGModifyType.SAVE:var f;if(null!=E){var g=E.getPath();switch(F){case TGOS.TGOverlayType.POLYGON:f=g.getPath();f.splice(-1,1);g=new TGOS.TGLineString(f);f=new TGOS.TGLinearRing(g);f=new TGOS.TGPolygon([f]);break;
case TGOS.TGOverlayType.LINESTRING:f=g;break;case TGOS.TGOverlayType.ENVELOPE:f=g.path[0].x;var h=g.path[0].y,m=g.path[2].x,g=g.path[2].y;if(f>=m){var k=f;f=m;m=k}h<g&&(k=h,h=g,g=k);f=new TGOS.TGEnvelope(f,h,m,g);break;case TGOS.TGOverlayType.CIRCLE:f=d.createCircle(g.path[0],g.path[1])}}else if(F==TGOS.TGOverlayType.MARKER||F==TGOS.TGOverlayType.LABEL)f=new TGOS.TGPoint(t[0].position.x,t[0].position.y);void 0!==f&&(null!=K&&(h=J.indexOf(K),0<=h&&(m=J[h],M=m.geoJsonProperties,g=new TGOS.OverlayCompleteEvent(m,
F,"DEL"),TGOS.TGEvent.trigger_(d,"overlay_complete",g),m.setMap(null),J.splice(h,1)),K=null),d.addGraphic(f,F));break;case TGOS.TGModifyType.DELETE:null!=K&&(h=J.indexOf(K),0<=h&&(m=J[h],g=new TGOS.OverlayCompleteEvent(m,F,"DEL"),TGOS.TGEvent.trigger_(d,"overlay_complete",g),m.setMap(null),J.splice(h,1)),K=null);break;case TGOS.TGModifyType.CANCEL:K=null}a!=TGOS.TGModifyType.STARTED&&a!=TGOS.TGModifyType.ATTRIBUTE&&(d.moveGraphicByKey&&null==K&&d.map.setKeyboardEdit(!1,null),d.clearModifies(),e&&
d.getDrawingMode()!=TGOS.TGOverlayType.EDIT&&(g=new TGOS.OverlayCompleteEvent(d.map,a),TGOS.TGEvent.trigger_(d,"modify_complete",g),d.setDrawingMode(TGOS.TGOverlayType.EDIT)))};this.addGraphic=function(a,b,e,f){if(a){var g,h,m=null;e&&(m=e);switch(b){case TGOS.TGOverlayType.POLYGON:g=new TGOS.TGFill(d.map,a,null==m?d.options.polygonOptions:m);h="polygon_complete";break;case TGOS.TGOverlayType.LINESTRING:g=new TGOS.TGLine(d.map,a,null==m?d.options.polylineOptions:m);h="linestring_complete";break;case TGOS.TGOverlayType.ENVELOPE:g=
new TGOS.TGFill(d.map,a,null==m?d.options.envelopeOptions:m);h="envelope_complete";break;case TGOS.TGOverlayType.CIRCLE:g=new TGOS.TGFill(d.map,a,null==m?d.options.circleOptions:m);h="circle_complete";break;case TGOS.TGOverlayType.MARKER:g=new TGOS.TGMarker(d.map,a);g.setMarkerOptions(null==m?d.options.markerOptions:m);h="marker_complete";break;case TGOS.TGOverlayType.LABEL:g=new TGOS.TGLabel(null==m?d.options.labelOptions:m),g.setPosition(a),g.setMap(d.map),h="label_complete"}g.graphicType=b;g.geoJson=
N(g,b);g.geoJsonProperties=f?f:"{}"!=M?M:"{}";J.push(g);a=new TGOS.OverlayCompleteEvent(g,b,"ADD");TGOS.TGEvent.trigger_(d,h,a);TGOS.TGEvent.trigger_(d,"overlay_complete",a)}};this.load=function(a){var b=function(a){var b;a.geoJsonProperties?b=a.geoJsonProperties:a.properties&&(b=a.properties);if(a instanceof TGOS.TGMarker)d.addGraphic(a.position,TGOS.TGOverlayType.MARKER,null,b);else if(a instanceof TGOS.TGLabel)d.addGraphic(a.position,TGOS.TGOverlayType.LABEL,null,b);else if(a instanceof TGOS.TGLine)d.addGraphic(a.getPath(),
TGOS.TGOverlayType.LINESTRING,null,b);else if(a instanceof TGOS.TGFill)a=a.getPath(),a instanceof TGOS.TGEnvelope?d.addGraphic(a,TGOS.TGOverlayType.ENVELOPE,null,b):a instanceof TGOS.TGCircle?d.addGraphic(a,TGOS.TGOverlayType.CIRCLE,null,b):a instanceof TGOS.TGPolygon&&d.addGraphic(a,TGOS.TGOverlayType.POLYGON,null,b);else if(a.geometry instanceof TGOS.TGMultiPoint)for(var e=0;e<a.geometry.geoms.length;e++)d.addGraphic(a.geometry.geoms[e],TGOS.TGOverlayType.MARKER,null,b);else if(a.geometry instanceof
TGOS.TGPoint)d.addGraphic(a.geometry,TGOS.TGOverlayType.MARKER,null,b);else if(a.geometry instanceof TGOS.TGMultiLineString)for(e=0;e<a.geometry.geoms.length;e++)d.addGraphic(a.geometry.geoms[e],TGOS.TGOverlayType.LINESTRING,null,b);else if(a.geometry instanceof TGOS.TGLineString)d.addGraphic(a.geometry,TGOS.TGOverlayType.LINESTRING,null,b);else if(a.geometry instanceof TGOS.TGEnvelope)d.addGraphic(a.geometry,TGOS.TGOverlayType.ENVELOPE,null,b);else if(a.geometry instanceof TGOS.TGCircle)d.addGraphic(a.geometry,
TGOS.TGOverlayType.CIRCLE,null,b);else if(a.geometry instanceof TGOS.TGMultiPolygon)for(e=0;e<a.geometry.geoms.length;e++)d.addGraphic(a.geometry.geoms[e],TGOS.TGOverlayType.POLYGON,null,b);else a.geometry instanceof TGOS.TGPolygon&&d.addGraphic(a.geometry,TGOS.TGOverlayType.POLYGON,null,b)};this.setDrawingMode(TGOS.TGOverlayType.NONE,!0);if(a instanceof Array)for(var e=a.length,f=0;f<e;f++)b(a[f]);else b(a);a=new TGOS.OverlayCompleteEvent(d.map,"GRAPHICS","LOAD");TGOS.TGEvent.trigger_(d,"overlay_complete",
a);this.getMap().getMapBase().RefreshMap()};var N=function(a,b){var e;if(b==TGOS.TGOverlayType.MARKER)e=a.position.toGeoJson();else if(b==TGOS.TGOverlayType.LABEL)e=a.getPosition().toGeoJson();else if(b==TGOS.TGOverlayType.ENVELOPE)e=[],a.getPath&&(a=a.getPath()),e.push([a.getLeft(),a.getTop()]),e.push([a.getRight(),a.getTop()]),e.push([a.getRight(),a.getBottom()]),e.push([a.getLeft(),a.getBottom()]),e.push([a.getLeft(),a.getTop()]),e={type:"Polygon",coordinates:[e]};else if(b==TGOS.TGOverlayType.CIRCLE){a.getPath&&
(a=a.getPath());e=d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857?TGOS.WGS84toTWD97(a.getCenter().x,a.getCenter().y):a.getCenter();var f=e.x,g=e.y,h=a.getRadius();e=[];for(var m=[],k=0;360>=k;k+=12){var l=f+Math.sin(k*Math.PI/180)*h,t=g+Math.cos(k*Math.PI/180)*h;d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857?(l=TGOS.TWD97toWGS84(l,t),l=new TGOS.TGPoint(l.x,l.y)):l=new TGOS.TGPoint(l,t);m.push(l)}f=new TGOS.TGLineString(m);f=new TGOS.TGLinearRing(f);e.push(f);e=(new TGOS.TGPolygon(e)).toGeoJson()}else if(b==
TGOS.TGOverlayType.POLYGON||b==TGOS.TGOverlayType.LINESTRING)e=a.getPath().toGeoJson();return e},Q,$=function(a,b){var e;e=a.slice();b&&e.pop();d.getDrawingMode()==TGOS.TGOverlayType.POLYGON?(e=new TGOS.TGLineString(e),e=new TGOS.TGLinearRing(e),e=new TGOS.TGPolygon([e])):e=new TGOS.TGLineString(e);d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(e=TGOS.Geometry.Transform(e,TGOS.GooToWGS84));return e},T;this.enterEnvMode=function(){this.setDrawingMode(TGOS.TGOverlayType.ENVELOPE)};this.enterEnvelopeMode=
function(){this.setDrawingMode(TGOS.TGOverlayType.ENVELOPE)};this.enterCircleMode=function(){this.setDrawingMode(TGOS.TGOverlayType.CIRCLE)};this.enterPolyMode=function(){this.setDrawingMode(TGOS.TGOverlayType.POLYGON)};this.enterPolygonMode=function(){this.setDrawingMode(TGOS.TGOverlayType.POLYGON)};this.enterLineStrMode=function(){this.setDrawingMode(TGOS.TGOverlayType.LINESTRING)};this.enterLineMode=function(){this.setDrawingMode(TGOS.TGOverlayType.LINESTRING)};this.enterMarkMode=function(){this.setDrawingMode(TGOS.TGOverlayType.MARKER)};
this.enterMarkerMode=function(){this.setDrawingMode(TGOS.TGOverlayType.MARKER)};this.enterLabelMode=function(){this.setDrawingMode(TGOS.TGOverlayType.LABEL)};this.enterEditMode=function(){this.setDrawingMode(TGOS.TGOverlayType.EDIT)};this.enterModifyMode=function(){this.setDrawingMode(TGOS.TGOverlayType.MODIFY)};this.graphicMoved=function(a){if(a){var b="UNKNOWN";if(a instanceof TGOS.TGMarker)b="MARKER";else if(a instanceof TGOS.TGLabel)b="LABEL";else if(a.getPath){var e=a.getPath();if(e instanceof
TGOS.TGEnvelope)b="ENVELOPE";else if(e instanceof TGOS.TGCircle)b="CIRCLE";else if(e instanceof TGOS.TGPolygon||e instanceof TGOS.TGMultiPolygon)b="POLYGON";else if(e instanceof TGOS.TGLineString||e instanceof TGOS.TGMultiLineString)b="LINESTRING"}a=new TGOS.OverlayCompleteEvent(a,b,"MOVED");TGOS.TGEvent.trigger_(d,"graphic_moved",a)}};this.cancelSegDrawing=function(){I=null;if(null!=T){T.setMap(null);var a=J.indexOf(T);0<=a&&J.splice(a,1);T=null}DetachEvent(D,"mousemove",S);DetachEvent(D,"dblclick",
aa)};this.cancelEditingMode=function(){this.useDefaultControl&&(D.style.cursor="default");for(i=0;i<J.length;i++){var a=J[i];a.setEditable&&(a.setEditable(!1),a.setClickCallback(null),a.setMovedCallback(null))}};this.setCircleDblClick=function(a){this.circleDblClick=a};this.setEnvelopeDblClick=function(a){this.envelopeDblClick=a};this.isCircleDblClick=function(){return this.circleDblClick};this.isEnvelopeDblClick=function(){return this.envelopeDblClick};var aa=function(b){if("tgoverlay"==b.currentTarget.className){util.disableDefault(b);
a(b);DEBUG_MODE&&console.log("drawEnd.");DetachEvent(D,"mousemove",S);DetachEvent(D,"dblclick",aa);var e=d.getDrawingMode(),f=d.map.getMapBase(),g=l(D);b=f.ToMapPoint(b.clientX-g.x,b.clientY-g.y);d.snapToGraphics(b);b=$(I,!0);I=null;d.addGraphic(b,e);null!=T&&(T.setMap(null),T=null)}},O=function(a){if("tgoverlay"==a.currentTarget.className&&(DEBUG_MODE&&console.log("drawSegment."),DetachEvent(D,"mouseup",O),!e)){var b=d.getDrawingMode();I||(I=[]);0>=I.length&&(AttachEvent(D,"dblclick",aa),b==TGOS.TGOverlayType.POLYGON?
T=new TGOS.TGFill(d.map,null,d.options.polygonOptions):b==TGOS.TGOverlayType.LINESTRING&&(T=new TGOS.TGLine(d.map,null,d.options.polylineOptions)));var f=d.map.getMapBase(),g=l(D),b=a.clientX-g.x;a=a.clientY-g.y;f=f.ToMapPoint(b,a);f=d.snapToGraphics(f);I.push(f);G||(G=d.map.getPaper().path("M"+b+","+a));b=$(I);null!=T&&T.setPath(b)}},S=function(a){var b=a.clientX;a=a.clientY;if(q!=b||w!=a){q=b;w=a;DEBUG_MODE&&console.log("drawMove.");e||(e=!ya(b,a,C,B))&&DEBUG_MODE&&console.log("drawMoved.");var f=
d.map.getMapBase(),g=l(D),b=f.ToMapPoint(b-g.x,a-g.y),b=d.snapToGraphics(b);!I||0>=I.length||!T||(b=$(I.concat(b)),T.setPath(b))}},R=function(a){"tgoverlay"==a.currentTarget.className&&(DEBUG_MODE&&console.log("drawStart."),util.disableDefault(a),q=C=a.clientX,w=B=a.clientY,e=!1,AttachEvent(D,"mouseup",O),AttachEvent(D,"mousemove",S))},ka=function(b){if("tgoverlay"==b.currentTarget.className){util.disableDefault(b);a(b);DEBUG_MODE&&console.log("drawEnd.");DetachEvent(D,"mousemove",ia);DetachEvent(D,
"dblclick",ka);var e=b.clientX;b=b.clientY;var f=d.map.getMapBase(),g=l(D),e=f.ToMapPoint(e-g.x,b-g.y),e=d.snapToGraphics(e);d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(e=TGOS.Geometry.Transform(e,TGOS.GooToWGS84),e=new TGOS.TGPoint(e.x,e.y));b=d.getDrawingMode();var h,f=I[0];b==TGOS.TGOverlayType.CIRCLE?h=d.createCircle(f,e):b==TGOS.TGOverlayType.ENVELOPE&&(h=d.createEnvelope(f,e));I=null;h&&d.addGraphic(h,b);null!=T&&(T.setMap(null),T=null)}},V=function(a){DEBUG_MODE&&console.log("simpleUp.");
DetachEvent(D,"mouseup",V);if(!e){var b=d.getDrawingMode();I||(I=[]);0>=I.length&&(AttachEvent(D,"dblclick",ka),b==TGOS.TGOverlayType.CIRCLE?T=new TGOS.TGFill(d.map,null,d.options.circleOptions):b==TGOS.TGOverlayType.ENVELOPE&&(T=new TGOS.TGFill(d.map,null,d.options.envelopeOptions)));var b=d.map.getMapBase(),f=l(D);a=b.ToMapPoint(a.clientX-f.x,a.clientY-f.y);a=d.snapToGraphics(a);d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(a=TGOS.Geometry.Transform(a,TGOS.GooToWGS84),a=new TGOS.TGPoint(a.x,a.y));
I.push(a)}},ia=function(a){var b=a.clientX;a=a.clientY;if(q!=b||w!=a)if(q=b,w=a,DEBUG_MODE&&console.log("simpleMove."),e||(e=!ya(b,a,C,B))&&DEBUG_MODE&&console.log("simpleMoved."),I&&!(0>=I.length)&&T){var f=d.map.getMapBase(),g=l(D),b=f.ToMapPoint(b-g.x,a-g.y),b=d.snapToGraphics(b);d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(b=TGOS.Geometry.Transform(b,TGOS.GooToWGS84),b=new TGOS.TGPoint(b.x,b.y));a=d.getDrawingMode();var h,f=I[0];a==TGOS.TGOverlayType.CIRCLE?h=d.createCircle(f,b):a==TGOS.TGOverlayType.ENVELOPE&&
(h=d.createEnvelope(f,b));T&&T.setPath(h)}},na=function(a){if("tgoverlay"==a.currentTarget.className){DEBUG_MODE&&console.log("simpleStart.");util.disableDefault(a);q=C=a.clientX;w=B=a.clientY;e=!1;a=d.map.getMapBase();var b=l(D);a=a.ToMapPoint(C-b.x,B-b.y);p=d.snapToGraphics(a);d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(a=TGOS.Geometry.Transform(p,TGOS.GooToWGS84),p=new TGOS.TGPoint(a.x,a.y));AttachEvent(D,"mousemove",ia);AttachEvent(D,"mouseup",V)}},la=function(b){if("tgoverlay"==b.currentTarget.className){util.disableDefault(b);
a(b);DetachEvent(D,"mousemove",W,!1);DetachEvent(D,"mouseup",la,!1);var e=b.clientX,f=b.clientY;DEBUG_MODE&&console.log("dragEnd X = "+e+", Y = "+f);b=null;var g=d.getDrawingMode();if(g==TGOS.TGOverlayType.CIRCLE||g==TGOS.TGOverlayType.ENVELOPE){var h=l(D),e=e-h.x,f=f-h.y,e=d.map.getMapBase().ToMapPoint(e,f),e=d.snapToGraphics(e);d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(e=TGOS.Geometry.Transform(e,TGOS.GooToWGS84),e=new TGOS.TGPoint(e.x,e.y));g==TGOS.TGOverlayType.CIRCLE?b=d.createCircle(p,
e):g==TGOS.TGOverlayType.ENVELOPE&&(b=d.createEnvelope(p,e))}b&&d.addGraphic(b,g);null!=Q&&(Q.setMap(null),Q=null)}},W=function(a){var b=a.clientX;a=a.clientY;if(q!=b||w!=a){q=b;w=a;DEBUG_MODE&&console.log("dragMove.");var e=l(D),b=b-e.x;a-=e.y;b=d.map.getMapBase().ToMapPoint(b,a);b=d.snapToGraphics(b);d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(b=TGOS.Geometry.Transform(b,TGOS.GooToWGS84),b=new TGOS.TGPoint(b.x,b.y));var f;a=d.getDrawingMode();DEBUG_MODE&&console.log("Move ("+b.x+","+b.y+")-("+
p.x+","+p.y+")");a==TGOS.TGOverlayType.CIRCLE?f=d.createCircle(p,b):a==TGOS.TGOverlayType.ENVELOPE&&(f=d.createEnvelope(p,b));Q&&Q.setPath(f)}},ba=function(b){if("tgoverlay"==b.currentTarget.className){util.disableDefault(b);a(b);q=H=b.clientX;w=A=b.clientY;DEBUG_MODE&&console.log("dragStart X = "+H+", Y = "+A);var e=l(D);b=H-e.x;e=A-e.y;b=d.map.getMapBase().ToMapPoint(b,e);p=d.snapToGraphics(b);d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(b=TGOS.Geometry.Transform(p,TGOS.GooToWGS84),p=new TGOS.TGPoint(b.x,
b.y));DEBUG_MODE&&console.log("clickPoint X= "+p.x+", Y = "+p.y);switch(d.getDrawingMode()){case TGOS.TGOverlayType.ENVELOPE:Q=new TGOS.TGFill(d.map,null,d.options.envelopeOptions);break;case TGOS.TGOverlayType.CIRCLE:Q=new TGOS.TGFill(d.map,null,d.options.circleOptions)}AttachEvent(D,"mousemove",W);AttachEvent(D,"mouseup",la)}},ga=function(b){if("tgoverlay"==b.currentTarget.className&&(util.disableDefault(b),a(b),DetachEvent(D,"mousemove",ha),DetachEvent(D,"mouseup",ga),!e)){var f=b.clientX;b=b.clientY;
DEBUG_MODE&&console.log("clickEnd X = "+f+", Y = "+b);var g=null,h=d.getDrawingMode();if(h==TGOS.TGOverlayType.MARKER||h==TGOS.TGOverlayType.LABEL)g=l(D),f-=g.x,b-=g.y,f=d.map.getMapBase().ToMapPoint(f,b),g=d.snapToGraphics(f),d.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(f=TGOS.Geometry.Transform(g,TGOS.GooToWGS84),g=new TGOS.TGPoint(f.x,f.y));null!==g&&(DEBUG_MODE&&console.log("Add Point X= "+g.x+", Y = "+g.y),d.addGraphic(g,d.drawingMode))}},ha=function(b){util.disableDefault(b);a(b);e||(e=!ya(b.clientX,
b.clientY,C,B))&&DEBUG_MODE&&console.log("clickMoved.")},Aa=function(a){"tgoverlay"==a.currentTarget.className&&(util.disableDefault(a),C=a.clientX,B=a.clientY,e=!1,DEBUG_MODE&&console.log("clickStart : X = "+C+", Y = "+B),AttachEvent(D,"mouseup",ga),AttachEvent(D,"mousemove",ha))},ya=function(a,b,d,e){var f=!1;a-1!==d&&a!==d&&a+1!==d||b-1!==e&&b!==e&&b+1!==e||(f=!0);return f};this.setDrawingMode=function(a,b){var e=this.drawingMode;if(e!=a){e!=TGOS.TGOverlayType.NONE&&(e==TGOS.TGOverlayType.POLYGON||
e==TGOS.TGOverlayType.LINESTRING?d.cancelSegDrawing():e==TGOS.TGOverlayType.EDIT?d.cancelEditingMode():e==TGOS.TGOverlayType.MODIFY&&(b?d.setModifyMode(TGOS.TGModifyType.CANCEL,!0):d.setModifyMode(TGOS.TGModifyType.CANCEL,!1)));D=this.map.getPanes().graphicLayer;DetachEvent(D,"mousedown",Aa);DetachEvent(D,"mousedown",ba);DetachEvent(D,"mousedown",R);DetachEvent(D,"mousemove",S);DetachEvent(D,"mousedown",na);DetachEvent(D,"mousemove",ia);d.useDefaultControl&&(D.style.cursor="crosshair");this.map.setOverlayForwardEvent(!1);
switch(a){case TGOS.TGOverlayType.ENVELOPE:this.envelopeDblClick?AttachEvent(D,"mousedown",na):AttachEvent(D,"mousedown",ba);this.drawingMode=TGOS.TGOverlayType.ENVELOPE;break;case TGOS.TGOverlayType.CIRCLE:this.circleDblClick?AttachEvent(D,"mousedown",na):AttachEvent(D,"mousedown",ba);this.drawingMode=TGOS.TGOverlayType.CIRCLE;break;case TGOS.TGOverlayType.POLYGON:AttachEvent(D,"mousedown",R);this.drawingMode=TGOS.TGOverlayType.POLYGON;break;case TGOS.TGOverlayType.LINESTRING:AttachEvent(D,"mousedown",
R);this.drawingMode=TGOS.TGOverlayType.LINESTRING;break;case TGOS.TGOverlayType.MARKER:AttachEvent(D,"mousedown",Aa);this.drawingMode=TGOS.TGOverlayType.MARKER;break;case TGOS.TGOverlayType.LABEL:AttachEvent(D,"mousedown",Aa);this.drawingMode=TGOS.TGOverlayType.LABEL;break;case TGOS.TGOverlayType.EDIT:d.useDefaultControl&&(this.modifyControl.setVisible(!1),this.drawingControl.setVisible(!0),D.style.cursor="pointer");for(i=0;i<J.length;i++)e=J[i],e.setEditable&&(e.setClickCallback(Y),e.setEditable(!0),
e.setMovedCallback(d.graphicMoved));this.drawingMode=TGOS.TGOverlayType.EDIT;break;case TGOS.TGOverlayType.MODIFY:d.useDefaultControl&&(this.modifyControl.setVisible(!0),this.drawingControl.setVisible(!1),D.style.cursor="default");for(i=0;i<J.length;i++)e=J[i],e.setEditable&&(e.setEditable(!1),e.setClickCallback(null));this.drawingMode=TGOS.TGOverlayType.MODIFY;break;case TGOS.TGOverlayType.NONE:for(d.cancelEditingMode(),this.map.setOverlayForwardEvent(this.overlayForwardEvent),this.drawingMode=TGOS.TGOverlayType.NONE,
i=0;i<J.length;i++)e=J[i],e.geoJson=N(e,e.graphicType)}e=new TGOS.OverlayCompleteEvent(d.map,this.drawingMode);TGOS.TGEvent.trigger_(d,"drawmodeChanged",e);TGOS.TGEvent.trigger_(d,"drawmode_changed",e);(a==TGOS.TGOverlayType.NONE||a==TGOS.TGOverlayType.MODIFY||TGOS.TGOverlayType.EDIT)&&TGOS.TGEvent.trigger(d.map,"resize");this.drawingControl&&this.drawingControl.toggleMode(a)}};this.defaultModifyModes=[TGOS.TGModifyType.DELETE,TGOS.TGModifyType.CANCEL,TGOS.TGModifyType.SAVE];this.defaultDrawingModes=
[TGOS.TGOverlayType.ENVELOPE,TGOS.TGOverlayType.POLYGON,TGOS.TGOverlayType.CIRCLE,TGOS.TGOverlayType.LINESTRING,TGOS.TGOverlayType.LABEL,TGOS.TGOverlayType.MARKER,TGOS.TGOverlayType.EDIT];var xa={inactive:{ENVELOPE:TGOS.RES_PATH+"rect.png",CIRCLE:TGOS.RES_PATH+"circle.png",MARKER:TGOS.RES_PATH+"mark.png",LABEL:TGOS.RES_PATH+"label.png",POLYGON:TGOS.RES_PATH+"poly.png",LINESTRING:TGOS.RES_PATH+"line.png",EDIT:TGOS.RES_PATH+"edit.png"},active:{ENVELOPE:TGOS.RES_PATH+"rect2.png",CIRCLE:TGOS.RES_PATH+
"circle2.png",MARKER:TGOS.RES_PATH+"mark2.png",LABEL:TGOS.RES_PATH+"label2.png",POLYGON:TGOS.RES_PATH+"poly2.png",LINESTRING:TGOS.RES_PATH+"line2.png",EDIT:TGOS.RES_PATH+"edit2.png"}},Da={enabled:{ATTRIBUTE:TGOS.RES_PATH+"attribute.png",SAVE:TGOS.RES_PATH+"save.png",CANCEL:TGOS.RES_PATH+"cancel.png",DELETE:TGOS.RES_PATH+"delete.png"},disabled:{ATTRIBUTE:TGOS.RES_PATH+"attribute2.png",SAVE:TGOS.RES_PATH+"save2.png",CANCEL:TGOS.RES_PATH+"cancel2.png",DELETE:TGOS.RES_PATH+"delete2.png"}},fa=TGOS.RES_PATH+
"vertex_move.png",oa=TGOS.RES_PATH+"vertex_add.png",ua=TGOS.RES_PATH+"circle_center.png",da=new TGOS.TGImage(TGOS.RES_PATH+"vertex_edit.png",new TGOS.TGSize(21,21),new TGOS.TGPoint(0,0),new TGOS.TGPoint(10,10)),fa=new TGOS.TGImage(fa,new TGOS.TGSize(21,21),new TGOS.TGPoint(0,0),new TGOS.TGPoint(10,10)),oa=new TGOS.TGImage(oa,new TGOS.TGSize(21,21),new TGOS.TGPoint(0,0),new TGOS.TGPoint(10,10)),ua=new TGOS.TGImage(ua,new TGOS.TGSize(21,21),new TGOS.TGPoint(0,0),new TGOS.TGPoint(10,10));this.options=
{drawingControl:!0,drawingControlOptions:{drawingModes:this.defaultDrawingModes,images:xa,controlPosition:TGOS.TGControlPosition.BOTTOM_RIGHT},modifyControl:!1,modifyControlOptions:{modifyModes:this.defaultModifyModes,images:Da,controlPosition:TGOS.TGControlPosition.BOTTOM_RIGHT},labelOptions:{fontSize:20,fontColor:"#FF0000",font:"\u5fae\u8edf\u6b63\u9ed1\u9ad4",fontWeight:"normal",opacity:1,label:"\u6587\u5b57\u6a19\u8a18"},markerOptions:{title:"",clickable:!0,cursor:"",zIndex:"auto",flat:!1,icon:new TGOS.TGImage(h,
new TGOS.TGSize(31,30),new TGOS.TGPoint(0,0),new TGOS.TGPoint(11,30)),shadow:new TGOS.TGImage(k,new TGOS.TGSize(31,30),new TGOS.TGPoint(0,0),new TGOS.TGPoint(9,25))},polylineOptions:{clickable:!1,strokeWeight:1,zIndex:"auto",strokeColor:"#555555",strokeLinecap:"round",strokeLinejoin:"round"},polygonOptions:{clickable:!1,opacity:1,fillColor:"#eeaaaa",fillOpacity:0.5,strokeWeight:2,zIndex:"auto",strokeColor:"#555555",strokeOpacity:1,strokeLinecap:"round",strokeLinejoin:"round"},circleOptions:{clickable:!1,
opacity:1,fillColor:"#eeaaaa",fillOpacity:0.5,strokeWeight:2,zIndex:"auto",strokeColor:"#555555",strokeOpacity:1},envelopeOptions:{clickable:!1,opacity:1,fillColor:"#eeaaaa",fillOpacity:0.5,strokeWeight:2,zIndex:"auto",strokeColor:"#555555",strokeOpacity:1},modifyDrawingOptions:{lineOptions:{clickable:!1,strokeWeight:1,zIndex:"auto",strokeColor:"#FFFF22",strokeOpacity:1},circleOptions:{clickable:!1,opacity:1,fillColor:"#00000000",fillOpacity:0,strokeWeight:1,zIndex:"auto",strokeColor:"#FFFF22",strokeOpacity:1}},
modifyIndicateOptions:{node:da,move:fa,pseudo:oa,circleCenter:ua},snapOptions:{snapping:!0,tolerance:10,snapPoint:!0,snapEdge:!0,snapVertex:!0}};this.modifyControl=new f(this,this.options.modifyControlOptions);this.modifyControl.setVisible(!1);this.drawingControl=new g(this,this.options.drawingControlOptions);this.useDefaultControl||this.drawingControl.setVisible(!1);b&&(this.map=null)},p=e.prototype;p.setGraphicSelectedCallback=function(a){this.graphicSelectedCallback=a};p.modifySelectedGraphic=
function(a){this.setModifyMode(a)};p.getDefaultControlVisible=function(){return this.useDefaultControl};p.setDefaultControlVisible=function(a){(this.useDefaultControl=a)?this.getDrawingMode()!=TGOS.TGOverlayType.MODIFY?(this.modifyControl&&this.modifyControl.setVisible(!1),this.drawingControl&&this.drawingControl.setVisible(!0)):(this.drawingControl&&this.drawingControl.setVisible(!1),this.modifyControl&&this.modifyControl.setVisible(!0)):(this.drawingControl&&this.drawingControl.setVisible(!1),this.modifyControl&&
this.modifyControl.setVisible(!1))};p.getDrawingMode=function(){return this.drawingMode};p.getMap=function(){return this.map};p.setMap=function(a){this.map=a;this.overlayForwardEvent=this.map.getOverlayForwardEvent();this.drawingControl&&this.drawingControl.setMap(this.map);this.modifyControl&&this.modifyControl.setMap(this.map)};p.clearAllGraphics=function(){this.drawingControl&&this.drawingControl.manager&&this.drawingControl.manager.clearAllGraphics()};p.getAllGraphics=function(){this.drawingControl&&
this.drawingControl.manager&&this.drawingControl.manager.getAllGraphics()};p.getSnapping=function(){return this.options.snapOptions.snapping};p.getSnapTolerance=function(){return this.options.snapOptions.tolerance};p.getSnapToPoint=function(a){return this.options.snapOptions.snapPoint};p.getSnapToEdge=function(a){return this.options.snapOptions.snapEdge};p.getSnapToVertex=function(a){return this.options.snapOptions.snapVertex};p.setSnapping=function(a){void 0!==a&&"boolean"==typeof a&&(this.options.snapOptions.snapping=
a)};p.setSnapTolerance=function(a){void 0!==a&&"number"==typeof a&&(this.options.snapOptions.tolerance=a)};p.setSnapToPoint=function(a){void 0!==a&&"boolean"==typeof a&&(this.options.snapOptions.snapPoint=a)};p.setSnapToEdge=function(a){void 0!==a&&"boolean"==typeof a&&(this.options.snapOptions.snapEdge=a)};p.setSnapToVertex=function(a){void 0!==a&&"boolean"==typeof a&&(this.options.snapOptions.snapVertex=a)};p.setSnapOptions=function(a){a&&(void 0!==a.snapping&&this.setSnapping(a.snapping),void 0!==
a.tolerance&&this.setSnapTolerance(a.tolerance),void 0!==a.snapPoint&&this.setSnapToPoint(a.snapPoint),void 0!==a.snapEdge&&this.setSnapToEdge(a.snapEdge),void 0!==a.snapVertex&&this.setSnapToVertex(a.snapVertex))};p.getSnapOptions=function(){return this.options.snapOptions};p.setMarkerOptions=function(a){a&&(void 0!==a.clickable&&(this.options.markerOptions.clickable=a.clickable),void 0!==a.title&&(this.options.markerOptions.title=a.title),void 0!==a.zIndex&&(this.options.markerOptions.zIndex=a.zIndex),
void 0!==a.opacity&&(this.options.markerOptions.opacity=a.opacity),void 0!==a.cursor&&(this.options.markerOptions.cursor=a.cursor),void 0!==a.flat&&(this.options.markerOptions.flat=a.flat),void 0!==a.icon&&(this.options.markerOptions.icon=a.icon),void 0!==a.shadow&&(this.options.markerOptions.shadow=a.shadow))};p.setLabelOptions=function(a){a&&(void 0!==a.fontSize&&(this.options.labelOptions.fontSize=a.fontSize),void 0!==a.fontColor&&(this.options.labelOptions.fontColor=a.fontColor),void 0!==a.font&&
(this.options.labelOptions.font=a.font),void 0!==a.fontWeight&&(this.options.labelOptions.fontWeight=a.fontWeight),void 0!==a.opacity&&(this.options.labelOptions.opacity=a.opacity),void 0!==a.label&&(this.options.labelOptions.label=a.label))};p.setLineOptions=function(a){a&&(void 0!==a.clickable&&(this.options.polylineOptions.clickable=a.clickable),void 0!==a.opacity&&(this.options.polylineOptions.opacity=a.opacity),void 0!==a.zIndex&&(this.options.polylineOptions.zIndex=a.zIndex),void 0!==a.strokeWeight&&
(this.options.polylineOptions.strokeWeight=a.strokeWeight),void 0!==a.strokeDasharray&&(this.options.polylineOptions.strokeDasharray=a.strokeDasharray),void 0!==a.strokeColor&&(this.options.polylineOptions.strokeColor=a.strokeColor),void 0!==a.strokeOpacity&&(this.options.polylineOptions.strokeOpacity=a.strokeOpacity),void 0!==a.strokeLinecap&&(this.options.polylineOptions.strokeLinecap=a.strokeLinecap),void 0!==a.strokeLinejoin&&(this.options.polylineOptions.strokeLinejoin=a.strokeLinejoin))};p.setPolygonOptions=
function(a){a&&(void 0!==a.clickable&&(this.options.polygonOptions.clickable=a.clickable),void 0!==a.opacity&&(this.options.polygonOptions.opacity=a.opacity),void 0!==a.zIndex&&(this.options.polygonOptions.zIndex=a.zIndex),void 0!==a.fillColor&&(this.options.polygonOptions.fillColor=a.fillColor),void 0!==a.fillOpacity&&(this.options.polygonOptions.fillOpacity=a.fillOpacity),void 0!==a.strokeWeight&&(this.options.polygonOptions.strokeWeight=a.strokeWeight),void 0!==a.strokeDasharray&&(this.options.polygonOptions.strokeDasharray=
a.strokeDasharray),void 0!==a.strokeColor&&(this.options.polygonOptions.strokeColor=a.strokeColor),void 0!==a.strokeOpacity&&(this.options.polygonOptions.strokeOpacity=a.strokeOpacity),void 0!==a.strokeLinecap&&(this.options.polygonOptions.strokeLinecap=a.strokeLinecap),void 0!==a.strokeLinejoin&&(this.options.polygonOptions.strokeLinejoin=a.strokeLinejoin))};p.setCircleOptions=function(a){a&&(void 0!==a.clickable&&(this.options.circleOptions.clickable=a.clickable),void 0!==a.zIndex&&(this.options.circleOptions.zIndex=
a.zIndex),void 0!==a.opacity&&(this.options.circleOptions.opacity=a.opacity),void 0!==a.fillColor&&(this.options.circleOptions.fillColor=a.fillColor),void 0!==a.fillOpacity&&(this.options.circleOptions.fillOpacity=a.fillOpacity),void 0!==a.strokeWeight&&(this.options.circleOptions.strokeWeight=a.strokeWeight),void 0!==a.strokeDasharray&&(this.options.circleOptions.strokeDasharray=a.strokeDasharray),void 0!==a.strokeColor&&(this.options.circleOptions.strokeColor=a.strokeColor),void 0!==a.strokeOpacity&&
(this.options.circleOptions.strokeOpacity=a.strokeOpacity))};p.setEnvOptions=function(a){a&&this.setEnvelopeOptions(a)};p.setEnvelopeOptions=function(a){a&&(void 0!==a.clickable&&(this.options.envelopeOptions.clickable=a.clickable),void 0!==a.opacity&&(this.options.envelopeOptions.opacity=a.opacity),void 0!==a.fillColor&&(this.options.envelopeOptions.fillColor=a.fillColor),void 0!==a.fillOpacity&&(this.options.envelopeOptions.fillOpacity=a.fillOpacity),void 0!==a.strokeWeight&&(this.options.envelopeOptions.strokeWeight=
a.strokeWeight),void 0!==a.zIndex&&(this.options.envelopeOptions.zIndex=a.zIndex),void 0!==a.strokeDasharray&&(this.options.envelopeOptions.strokeDasharray=a.strokeDasharray),void 0!==a.strokeColor&&(this.options.envelopeOptions.strokeColor=a.strokeColor),void 0!==a.strokeOpacity&&(this.options.envelopeOptions.strokeOpacity=a.strokeOpacity))};p.setModifyDrawingOptions=function(a){a&&(a.lineOptions&&(void 0!==a.lineOptions.clickable&&(this.options.modifyDrawingOptions.lineOptions.clickable=a.lineOptions.clickable),
void 0!==a.lineOptions.zIndex&&(this.options.modifyDrawingOptions.lineOptions.zIndex=a.lineOptions.zIndex),void 0!==a.lineOptions.opacity&&(this.options.modifyDrawingOptions.lineOptions.opacity=a.lineOptions.opacity),void 0!==a.lineOptions.strokeDasharray&&(this.options.modifyDrawingOptions.lineOptions.strokeDasharray=a.lineOptions.strokeDasharray),void 0!==a.lineOptions.strokeWeight&&(this.options.modifyDrawingOptions.lineOptions.strokeWeight=a.lineOptions.strokeWeight),void 0!==a.lineOptions.strokeColor&&
(this.options.modifyDrawingOptions.lineOptions.strokeColor=a.lineOptions.strokeColor),void 0!==a.lineOptions.strokeOpacity&&(this.options.modifyDrawingOptions.lineOptions.strokeOpacity=a.lineOptions.strokeOpacity)),a.circleOptions&&(void 0!==a.circleOptions.clickable&&(this.options.modifyDrawingOptions.circleOptions.clickable=a.circleOptions.clickable),void 0!==a.circleOptions.zIndex&&(this.options.modifyDrawingOptions.circleOptions.zIndex=a.circleOptions.zIndex),void 0!==a.circleOptions.opacity&&
(this.options.modifyDrawingOptions.circleOptions.opacity=a.circleOptions.opacity),void 0!==a.circleOptions.fillColor&&(this.options.modifyDrawingOptions.circleOptions.fillColor=a.circleOptions.fillColor),void 0!==a.circleOptions.fillOpacity&&(this.options.modifyDrawingOptions.circleOptions.fillOpacity=a.circleOptions.fillOpacity),void 0!==a.circleOptions.strokeDasharray&&(this.options.modifyDrawingOptions.circleOptions.strokeDasharray=a.circleOptions.strokeDasharray),void 0!==a.circleOptions.strokeWeight&&
(this.options.modifyDrawingOptions.circleOptions.strokeWeight=a.circleOptions.strokeWeight),void 0!==a.circleOptions.strokeColor&&(this.options.modifyDrawingOptions.circleOptions.strokeColor=a.circleOptions.strokeColor),void 0!==a.circleOptions.strokeOpacity&&(this.options.modifyDrawingOptions.circleOptions.strokeOpacity=a.circleOptions.strokeOpacity)))};p.setModifyIndicateOptions=function(a){a&&(void 0!==a.node&&(this.options.modifyIndicateOptions.node=a.node),void 0!==a.move&&(this.options.modifyIndicateOptions.move=
a.move),void 0!==a.pseudo&&(this.options.modifyIndicateOptions.pseudo=a.pseudo),void 0!==a.circleCenter&&(this.options.modifyIndicateOptions.circleCenter=a.circleCenter))};p.setDrawingControlOptions=function(a){a&&this.drawingControl&&this.drawingControl.setOptions(a)};p.setModifyControlOptions=function(a){a&&this.modifyControl&&this.modifyControl.setOptions(a)};p.setOptions=function(a){a&&(!0==a.drawingControl?this.drawingControl.setVisible(!0):!1==a.drawingControl&&this.drawingControl.setVisible(!1),
a.drawingControlOptions&&this.drawingControl.setOptions(a.drawingControlOptions),!0==a.modifyControl?this.modifyControl.setVisible(!0):!1==a.modifyControl&&this.modifyControl.setVisible(!1),a.modifyControlOptions&&this.modifyontrol.setOptions(a.modifyControlOptions),this.setCircleOptions(this.options.circleOptions),this.setEnvelopeOptions(this.options.envelopeOptions),this.setMarkerOptions(this.options.markerOptions),this.setLabelOptions(this.options.labelOptions),this.setLineOptions(this.options.polylineOptions),
this.setPolygonOptions(this.options.polygonOptions),this.setModifyDrawingOptions(this.options.modifyDrawingOptions),this.setModifyIndicateOptions(this.options.modifyIndicateOptions),this.setSnapOptions(this.options.snapOptions),a.circleOptions&&this.setCircleOptions(a.circleOptions),a.envelopeOptions&&this.setEnvelopeOptions(a.envelopeOptions),a.markerOptions&&this.setMarkerOptions(a.markerOptions),a.labelOptions&&this.setLabelOptions(a.labelOptions),a.polylineOptions&&this.setLineOptions(a.polylineOptions),
a.polygonOptions&&this.setPolygonOptions(a.polygonOptions),a.modifyDrawingOptions&&this.setModifyDrawingOptions(a.modifyDrawingOptions),a.modifyIndicateOptions&&this.setModifyIndicateOptions(a.modifyIndicateOptions),a.snapOptions&&this.setSnapOptions(a.snapOptions),this.options.circleOptions.editable=!1,this.options.envelopeOptions.editable=!1,this.options.markerOptions.editable=!1,this.options.labelOptions.editable=!1,this.options.polylineOptions.editable=!1,this.options.polygonOptions.editable=
!1,this.options.circleOptions.draggable=!1,this.options.envelopeOptions.draggable=!1,this.options.markerOptions.draggable=!1,this.options.labelOptions.draggable=!1,this.options.polylineOptions.draggable=!1,this.options.polygonOptions.draggable=!1)};p.getGeoJson=function(a){var b="\r\n";void 0!==a&&(b=a);a="";var d=this.getAllGraphics();if(void 0!==d){a=a+("{"+b)+('"type": "FeatureCollection",'+b);this.map.getCoordSys()==TGOS.TGCoordSys.EPSG3826?a+='"crs": {"type": "name", "properties": {"name": "urn:ogc:def:crs:EPSG::3826"}},'+
b:this.map.getCoordSys()==TGOS.TGCoordSys.EPSG3825&&(a+='"crs": {"type": "name", "properties": {"name": "urn:ogc:def:crs:EPSG::3825"}},'+b);a+='"features": ['+b;for(var e=0;e<d.length;e++){var f=d[e],g=f.geoJson,f=f.geoJsonProperties;a+="{"+b;a+='"type": "Feature",'+b;a+='"properties": '+JSON.stringify(f)+","+b;a+='"geometry": {'+b;a+='"type": "'+g.type+'",'+b;a+='"coordinates": [';if("Polygon"!=g.type)if("Point"==g.type)a+=g.coordinates[0]+","+g.coordinates[1];else for(f=0;f<g.coordinates.length;f++)"Point"!=
g.type&&(a+="["),a+=g.coordinates[f][0]+","+g.coordinates[f][1],"Point"!=g.type&&(a+="]"),f<g.coordinates.length-1&&(a+=",");else{a+="[";for(f=0;f<g.coordinates[0].length;f++)"Point"!=g.type&&(a+="["),a+=g.coordinates[0][f][0]+","+g.coordinates[0][f][1],"Point"!=g.type&&(a+="]"),f<g.coordinates[0].length-1&&(a+=",");a+="]"}a+="]";a+="}";a+="}";e<d.length-1&&(a+=","+b)}a+="]"+b;a+="}"}return a};p.setGeoJsonProperties=function(a,b){void 0!==a&&(a.geoJsonProperties=b)};TGOS.RegisterEvent(e,"marker_complete label_complete envelope_complete circle_complete linestring_complete polygon_complete overlay_complete modify_complete drawmode_changed drawmode_changed drawmodeChanged graphic_moved keydown".split(" "));
return e}();(function(){TGOS.MapIdInfo=TGOS.MapIdInfo||{};TGOS.TGMapServiceId=TGOS.TGMapServiceId||{};TGOS.TGMapId=TGOS.TGMapId||{};TGOS.CacheExtend3857=TGOS.CacheExtend3857||{};TGOS.ThemeLayerID={REGION:"M05",REGION_119:"M06",EOC:"M11",FIREDEPARTMENT:"M12",POLICEDEPARTMENT:"M13",NASC:"M14",SOCIALSERVICE:"M15",SHELTERS:"M18",NASC_LANDING:"M19",INDUSTRY:"M21",SCHOOL:"M22",DEBRISFLOW_P:"M08"};TGOS.ThemeLayerID.MEDICAL="M17";TGOS.ThemeTileID={LANDUSE:"T04"};TGOS.TGMapTypeId={TGOSMAP:"TGOSMAP",NLSCMAP:"NLSCMAP",
F2IMAGE:"F2IMAGE",ROADMAP:"ROADMAP",HILLSHADE:"HILLSHADE",SEGISMAP:"SEGISMAP",HILLSHADEMIX:"HILLSHADEMIX",IMAGENLSC:"IMAGENLSC",TGOSMAP_NP:"TGOSMAP_NP"};TGOS.TGMapTypeIdCode={TGOSMAP:"B01",NLSCMAP:"B02",F2IMAGE:"B04",ROADMAP:"B05",HILLSHADE:"B06",SEGISMAP:"B08",HILLSHADEMIX:"B07",IMAGENLSC:"B09",TGOSMAP_NP:"B10"};TGOS.TGMapTypeId_zh_TW={TGOSMAP:"TGOSMAP",NLSCMAP:"\u901a\u7528\u7248\u96fb\u5b50\u5730\u5716",F2IMAGE:"\u798f\u885b\u4e8c\u865f\u885b\u661f\u5f71\u50cf",ROADMAP:"\u798f\u885b\u6df7\u5408\u5730\u5716",
HILLSHADE:"\u5730\u5f62\u6688\u6e32\u5716",SEGISMAP:"\u7d71\u8a08\u5340\u5730\u5716",HILLSHADEMIX:"\u5730\u5f62\u6688\u6e32\u6df7\u5408\u5730\u5716",IMAGENLSC:"\u822a\u7167\u5716",TGOSMAP_NP:"TGOSMAP_NP"};TGOS.MapTypeDocumentName={TGOSMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_TGOSMAP3826.aspx",NLSCMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_NLSCMAP3826.aspx",F2IMAGE:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_F2IMAGE3826.aspx",ROADMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_ROADMAP3826.aspx",
HILLSHADE:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_HILLSHADE3826.aspx",SEGISMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_SEGISMAP3826.aspx",HILLSHADEMIX:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_HILLSHADEMIX3826.aspx",TGOSMAP_NP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_TGOSMAP_NP3826.aspx"};TGOS.MapTypeDocumentNameTWD97_119={NLSCMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_NLSCMAP3825.aspx",SEGISMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_SEGISMAP3825.aspx",
TGOSMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_TGOSMAP3825.aspx"};TGOS.MapTypeDocumentNameGoogle={TGOSMAP:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_TGOSMAPWORLD3857.aspx",NLSCMAP:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_NLSCMAP3857.aspx",F2IMAGE:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_F2IMAGE3857.aspx",ROADMAP:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_ROADMAP3857.aspx",HILLSHADE:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_HILLSHADE3857.aspx",SEGISMAP:getWebProtocal()+
getAPIPath()+"Agent/Google/Agent_SEGISMAP3857.aspx",HILLSHADEMIX:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_HILLSHADEMIX3857.aspx",IMAGENLSC:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_IMAGENLSC3857.aspx",TGOSMAP_NP:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_TGOSMAPWORLDNP3857.aspx"};TGOS.MapTypeIndexViewId_zh_TW={TGOSMAP:"TGOSMAP\u7d22\u5f15",NLSCMAP:"\u901a\u7528\u7248\u96fb\u5b50\u5730\u5716\u7d22\u5f15",F2IMAGE:"\u798f\u885b\u4e8c\u865f\u885b\u661f\u5f71\u50cf\u7d22\u5f15",
ROADMAP:"\u798f\u885b\u6df7\u5408\u5730\u5716\u7d22\u5f15",HILLSHADE:"\u5730\u5f62\u6688\u6e32\u5716\u7d22\u5f15",SEGISMAP:"\u7d71\u8a08\u5340\u5730\u5716\u7d22\u5f15",HILLSHADEMIX:"\u5730\u5f62\u6688\u6e32\u6df7\u5408\u5730\u5716\u7d22\u5f15",IMAGENLSC:"\u822a\u7167\u5716\u7d22\u5f15",TGOSMAP_NP:"TGOSMAP_NP\u7d22\u5f15"};TGOS.MapTypeIndexViewDocumentName={TGOSMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_TGOSMAP3826_IV.aspx",NLSCMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_NLSCMAP3826_IV.aspx",
F2IMAGE:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_F2IMAGE3826_IV.aspx",ROADMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_ROADMAP3826_IV.aspx",HILLSHADE:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_HILLSHADE3826_IV.aspx",SEGISMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_SEGISMAP3826_IV.aspx",HILLSHADEMIX:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_HILLSHADEMIX3826_IV.aspx",TGOSMAP_NP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_TGOSMAP_NP3826_IV.aspx"};TGOS.MapTypeIndexViewDocumentNameTWD97_119=
{TGOSMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_TGOSMAP3825_IV.aspx",NLSCMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_NLSCMAP3825_IV.aspx",SEGISMAP:getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_SEGISMAP3825_IV.aspx"};TGOS.MapTypeIndexViewDocumentNameGoogle={TGOSMAP:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_TGOSMAPWORLD3857_IV.aspx",NLSCMAP:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_NLSCMAP3857_IV.aspx",F2IMAGE:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_F2IMAGE3857_IV.aspx",
ROADMAP:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_ROADMAP3857_IV.aspx",HILLSHADE:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_HILLSHADE3857_IV.aspx",SEGISMAP:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_SEGISMAP3857_IV.aspx",HILLSHADEMIX:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_HILLSHADEMIX3857_IV.aspx",IMAGENLSC:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_IMAGENLSC3857_IV.aspx",TGOSMAP_NP:getWebProtocal()+getAPIPath()+"Agent/Google/Agent_TGOSMAPWORLDNP3857_IV.aspx"};
TGOS.MapTypeBackgroundColor={TGOSMAP:"#a5bfdd",NLSCMAP:"#a5bfdd",F2IMAGE:"#13437c",ROADMAP:"#13437c",HILLSHADE:"rgb(151,219,242)",SEGISMAP:"#a5bfdd",HILLSHADEMIX:"rgb(151,219,242)",IMAGENLSC:"#183c4a",TGOSMAP_NP:"#a5bfdd"};TGOS.MapTypeMaxZoomLevel={EPSG3825:{TGOSMAP:13,SEGISMAP:12,NLSCMAP:13},EPSG3826:{TGOSMAP:13,SEGISMAP:12,NLSCMAP:13,F2IMAGE:11,HILLSHADE:8,ROADMAP:11,HILLSHADEMIX:8,TGOSMAP_NP:13},EPSG3857:{TGOSMAP:19,SEGISMAP:18,NLSCMAP:19,F2IMAGE:17,HILLSHADE:13,ROADMAP:17,HILLSHADEMIX:13,IMAGENLSC:19,
TGOSMAP_NP:19}};var b=TGOS.TGMapServiceId;b.LANDUSE="LANDUSE";b.REGION="REGION";b.REGION_119="REGION_119";b.EOC="EOC";b.FIREDEPARTMENT="FIREDEPARTMENT";b.POLICEDEPARTMENT="POLICEDEPARTMENT";b.NASC="NASC";b.SOCIALSERVICE="SOCIALSERVICE";b.SHELTERS="SHELTERS";b.NASC_LANDING="NASC_LANDING";b.INDUSTRY="INDUSTRY";b.SCHOOL="SCHOOL";b.DEBRISFLOW_P="DEBRISFLOW_P";b.MEDICAL="MEDICAL";b=TGOS.TGMapId;b.LANDUSE="LANDUSE";b.COUNTY="COUNTY";b.TOWN="TOWN";b.VILLAGE="VILLAGE";b.EOC="EOC";b.FIREDEPARTMENT="FIREDEPARTMENT";
b.POLICEDEPARTMENT="POLICEDEPARTMENT";b.NASC="NASC";b.SOCIALSERVICE="SOCIALSERVICE";b.SHELTERS="SHELTERS";b.NASC_LANDING="NASC_LANDING";b.INDUSTRY="INDUSTRY";b.INDUSTRY_A="INDUSTRY_A";b.INDUSTRY_B="INDUSTRY_B";b.INDUSTRY_C="INDUSTRY_C";b.INDUSTRY_D="INDUSTRY_D";b.INDUSTRY_E="INDUSTRY_E";b.INDUSTRY_F="INDUSTRY_F";b.INDUSTRY_G="INDUSTRY_G";b.INDUSTRY_H="INDUSTRY_H";b.INDUSTRY_I="INDUSTRY_I";b.INDUSTRY_J="INDUSTRY_J";b.INDUSTRY_K="INDUSTRY_K";b.INDUSTRY_L="INDUSTRY_L";b.INDUSTRY_M="INDUSTRY_M";b.INDUSTRY_N=
"INDUSTRY_N";b.INDUSTRY_O="INDUSTRY_O";b.INDUSTRY_P="INDUSTRY_P";b.INDUSTRY_Q="INDUSTRY_Q";b.INDUSTRY_R="INDUSTRY_R";b.INDUSTRY_S="INDUSTRY_S";b.MEDICAL="MEDICAL";b.SCHOOL="SCHOOL";b.SCHOOL_A="SCHOOL_A";b.SCHOOL_B="SCHOOL_B";b.SCHOOL_C="SCHOOL_C";b.SCHOOL_D="SCHOOL_D";b.SCHOOL_E="SCHOOL_E";b.SCHOOL_F="SCHOOL_F";b.SCHOOL_G="SCHOOL_G";b.SCHOOL_H="SCHOOL_H";b.SCHOOL_I="SCHOOL_I";b.SCHOOL_J="SCHOOL_J";b.SCHOOL_K="SCHOOL_K";b.SCHOOL_L="SCHOOL_L";b.SCHOOL_M="SCHOOL_M";b.SCHOOL_N="SCHOOL_N";b.DEBRISFLOW_P=
"DEBRISFLOW_P";TGOS.MapIdInfo.DEBRISFLOW_P={resource:"DEBRISFLOW_P.cfg",layers:{DEBRISFLOW_P:{name:"dbo.DEBRISFLOW_P",oname:"dbo.DEBRISFLOW_P_201208A",identify:{DEBRISNO:"DEBRISNO",COUNTY01:"COUNTY01",TOWN01:"TOWN01",VILL01:"VILL01",NAME:"NAME",MARK:"MARK",ROADNAME:"ROADNAME",DW_NUMBER:"DW_NUMBER",POTENTIAL:"POTENTIAL"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/18_DEBRISFLOW_P.png",symbolName:"\u571f\u77f3\u6d41\u6f5b\u52e2\u6eaa\u6d41\u5716"}]}}};TGOS.MapIdInfo.LANDUSE=
{tileoverlay:{path:getWebProtocal()+getAPIPath()+"/TGOS_WMTS/TWD97/SimpleWMTS_LANDUSE3826.aspx",layer:"Map",matrixSet:"TGOS97_LANDUSE.cfg"},resource:"LANDUSE.cfg",layers:{LANDUSE:{name:"dbo.LANDUSE",oname:"dbo.LANDUSE_201207A",identify:{LCODE_C1:"LCODE_C1",LCODE_C2:"LCODE_C2",LCODE_C3:"LCODE_C3"}}}};TGOS.MapIdInfo.REGION={path:getWebProtocal()+getServicePath()+"REGION/Agent.aspx",resource:"REGION.cfg",layers:{COUNTY:{name:"dbo.COUNTY",oname:"dbo.COUNTY_201211C",identify:{PRO_ID:"PRO_ID",COUNTY_ID:"COUNTY_ID",
COUNTY:"COUNTY"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/16_REGION_A.png",symbolName:"\u7e23\u5e02"}]},TOWN:{name:"dbo.TOWN",oname:"dbo.TOWN_201211C",identify:{PRO_ID:"PRO_ID",COUNTY_ID:"COUNTY_ID",TOWN_ID:"TOWN_ID",COUNTY:"COUNTY",TOWN:"TOWN"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/16_REGION_B.png",symbolName:"\u9109\u93ae\u5e02\u5340"}]},VILLAGE:{name:"dbo.VILLAGE",oname:"dbo.VILLAGE_201211C",identify:{UID:"UID",PRO_ID:"PRO_ID",COUNTY_ID:"COUNTY_ID",
TOWN_ID:"TOWN_ID",VILLAGE_ID:"VILLAGE_ID",COUNTY:"COUNTY",TOWN:"TOWN",VILLAGE:"VILLAGE"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/16_REGION_C.png",symbolName:"\u6751\u91cc"}]}}};TGOS.MapIdInfo.REGION_119={path:getWebProtocal()+getServicePath()+"REGION/Agent.aspx",resource:"REGION_119.cfg",layers:{COUNTY:{name:"dbo.COUNTY",oname:"dbo.COUNTY_201211C",identify:{PRO_ID:"PRO_ID",COUNTY_ID:"COUNTY_ID",COUNTY:"COUNTY"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/16_REGION_A.png",
symbolName:"\u7e23\u5e02"}]},TOWN:{name:"dbo.TOWN",oname:"dbo.TOWN_201211C",identify:{PRO_ID:"PRO_ID",COUNTY_ID:"COUNTY_ID",TOWN_ID:"TOWN_ID",COUNTY:"COUNTY",TOWN:"TOWN"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/16_REGION_B.png",symbolName:"\u9109\u93ae\u5e02\u5340"}]},VILLAGE:{name:"dbo.VILLAGE",oname:"dbo.VILLAGE_201211C",identify:{UID:"UID",PRO_ID:"PRO_ID",COUNTY_ID:"COUNTY_ID",TOWN_ID:"TOWN_ID",VILLAGE_ID:"VILLAGE_ID",COUNTY:"COUNTY",TOWN:"TOWN",VILLAGE:"VILLAGE"},
legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/16_REGION_C.png",symbolName:"\u6751\u91cc"}]}}};TGOS.MapIdInfo.EOC={path:getWebProtocal()+getServicePath()+"EOC/Agent.aspx",resource:"EOC.cfg",layers:{EOC:{name:"dbo.EOC",oname:"dbo.EOC_201205A",identify:{NAME:"NAME",ADDRESS:"ADDRESS",CONTACT:"CONTACT",NOTE:"NOTE"},buffer:{NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",CONTACT:"CONTACT",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",
E:"E",N:"N"},query:{NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",CONTACT:"CONTACT",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/21_EOC.png",symbolName:"\u4e2d\u592e\u8207\u5730\u65b9\u7dca\u6025\u61c9\u8b8a\u4e2d\u5fc3"}]}}};TGOS.MapIdInfo.FIREDEPARTMENT={resource:"FIREDEPARTMENT.cfg",layers:{FIREDEPARTMENT:{name:"dbo.FIREDEPARTMENT",oname:"dbo.FIREDEPARTMENT_201206A",
identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",CONTACT:"CONTACT"},buffer:{TYPE:"TYPE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",CONTACT:"CONTACT",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",CONTACT:"CONTACT",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/22_FIREDEPARTMENT.png",
symbolName:"\u5168\u570b\u6d88\u9632\u6a5f\u95dc"}]}}};TGOS.MapIdInfo.POLICEDEPARTMENT={resource:"POLICEDEPARTMENT.cfg",layers:{POLICEDEPARTMENT:{name:"dbo.POLICEDEPARTMENT",oname:"dbo.POLICEDEPARTMENT_201208A",identify:{NAME:"NAME",CONTACT:"CONTACT",ADDRESS:"ADDRESS"},buffer:{NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",CONTACT:"CONTACT",ADDRESS:"ADDRESS",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",CONTACT:"CONTACT",
ADDRESS:"ADDRESS",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/23_POLICEDEPARTMENT.png",symbolName:"\u5168\u570b\u8b66\u5bdf\u6a5f\u95dc"}]}}};TGOS.MapIdInfo.NASC={resource:"NASC.cfg",layers:{NASC:{name:"dbo.NASC",oname:"dbo.NASC_201204A",identify:{NAME1:"NAME1",NAME2:"NAME2",ADDRESS:"ADDRESS"},buffer:{NAME2:"NAME2",NAME1:"NAME1",AREA:"AREA",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",X_97121:"X_97121",
Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{NAME2:"NAME2",NAME1:"NAME1",AREA:"AREA",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/24_NASC.png",symbolName:"\u7a7a\u4e2d\u52e4\u52d9\u7e3d\u968a"}]}}};TGOS.MapIdInfo.SOCIALSERVICE={resource:"SOCIALSERVICE.cfg",layers:{SOCIALSERVICE:{name:"dbo.SOCIALSERVICE",oname:"dbo.SOCIALSERVICE_201206A",
identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",CHARGE:"CHARGE",CONTACT:"CONTACT",FILINGDATE:"FILINGDATE",URL:"URL",REMARK:"REMARK"},buffer:{TYPE:"TYPE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",CHARGE:"CHARGE",CONTACT:"CONTACT",FILINGDATE:"FILINGDATE",URL:"URL",REMARK:"REMARK",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",CHARGE:"CHARGE",CONTACT:"CONTACT",FILINGDATE:"FILINGDATE",
URL:"URL",REMARK:"REMARK",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/25_AGED.png",symbolName:"\u8001\u4eba\u798f\u5229\u6a5f\u69cb"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/25_DISABLED.png",symbolName:"\u8eab\u969c\u6a5f\u69cb"}]}}};TGOS.MapIdInfo.SHELTERS={resource:"SHELTERS.cfg",layers:{SHELTERS:{oname:"dbo.SHELTERS_201204A",name:"dbo.SHELTERS",identify:{ID:"ID",NAME:"NAME",
COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",FLOODING:"FLOODING",EARTHQUAKE:"EARTHQUAKE",DEBRISFLOW:"DEBRISFLOW",TSUNAMI:"TSUNAMI",INTERIOR:"INTERIOR",OUTDOOR:"OUTDOOR",WEAKPEOPLE:"WEAKPEOPLE",NUMBERS:"NUMBERS",NUCLEAR:"NUCLEAR"},buffer:{ID:"ID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",FLOODING:"FLOODING",EARTHQUAKE:"EARTHQUAKE",DEBRISFLOW:"DEBRISFLOW",TSUNAMI:"TSUNAMI",INTERIOR:"INTERIOR",OUTDOOR:"OUTDOOR",WEAKPEOPLE:"WEAKPEOPLE",NUMBERS:"NUMBERS",X_97121:"X_97121",Y_97121:"Y_97121",
X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N",NUCLEAR:"NUCLEAR"},query:{ID:"ID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",FLOODING:"FLOODING",EARTHQUAKE:"EARTHQUAKE",DEBRISFLOW:"DEBRISFLOW",TSUNAMI:"TSUNAMI",INTERIOR:"INTERIOR",OUTDOOR:"OUTDOOR",WEAKPEOPLE:"WEAKPEOPLE",NUMBERS:"NUMBERS",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N",NUCLEAR:"NUCLEAR"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/28_SHELTERS.png",symbolName:"\u907f\u96e3\u6536\u5bb9\u8655\u6240"}]}}};
TGOS.MapIdInfo.NASC_LANDING={resource:"NASC_LANDING.cfg",layers:{NASC_LANDING:{name:"dbo.NASC_LANDING",oname:"dbo.NASC_LANDING_201206A",identify:{NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN"},buffer:{NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/29_NASC_LANDING.png",
symbolName:"\u76f4\u5347\u6a5f\u7dca\u6025\u6551\u96e3\u81e8\u6642\u8d77\u964d\u5834"}]}}};TGOS.MapIdInfo.INDUSTRY={resource:"INDUSTRY.cfg",layers:{INDUSTRY:{name:"dbo.INDUSTRY",oname:"dbo.INDUSTRY_201204A",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",
NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY.png",symbolName:"\u5de5\u5546\u4f01\u696d"}]},INDUSTRY_A:{name:"dbo.INDUSTRY_A",oname:"dbo.INDUSTRY_A",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",
TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_A.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u8fb2\u3001\u6797\u3001\u6f01\u3001\u7267\u696d"}]},
INDUSTRY_B:{name:"dbo.INDUSTRY_B",oname:"dbo.INDUSTRY_B",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",
E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_B.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u7926\u696d\u53ca\u571f\u77f3\u63a1\u53d6\u696d"}]},INDUSTRY_C:{name:"dbo.INDUSTRY_C",oname:"dbo.INDUSTRY_C",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",
Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_C.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u88fd\u9020\u696d"}]},INDUSTRY_D:{name:"dbo.INDUSTRY_D",oname:"dbo.INDUSTRY_D",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",
COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_D.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u96fb\u529b\u53ca\u71c3\u6c23\u4f9b\u61c9\u696d"}]},
INDUSTRY_E:{name:"dbo.INDUSTRY_E",oname:"dbo.INDUSTRY_E",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",
E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_E.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u7528\u6c34\u4f9b\u61c9\u53ca\u6c61\u67d3\u6574\u6cbb\u696d"}]},INDUSTRY_F:{name:"dbo.INDUSTRY_F",oname:"dbo.INDUSTRY_F",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",
X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_F.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u71df\u9020\u696d"}]},INDUSTRY_G:{name:"dbo.INDUSTRY_G",oname:"dbo.INDUSTRY_G",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",
ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_G.png",
symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u6279\u767c\u53ca\u96f6\u552e\u696d"}]},INDUSTRY_H:{name:"dbo.INDUSTRY_H",oname:"dbo.INDUSTRY_H",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",
COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_H.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u904b\u8f38\u53ca\u5009\u5132\u696d"}]},INDUSTRY_I:{name:"dbo.INDUSTRY_I",oname:"dbo.INDUSTRY_I",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",
COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_I.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u4f4f\u5bbf\u53ca\u9910\u98f2\u696d"}]},INDUSTRY_J:{name:"dbo.INDUSTRY_J",oname:"dbo.INDUSTRY_J",
identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+
getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_J.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u8cc7\u8a0a\u53ca\u901a\u8a0a\u50b3\u64ad\u696d"}]},INDUSTRY_K:{name:"dbo.INDUSTRY_K",oname:"dbo.INDUSTRY_K",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",
NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_K.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u91d1\u878d\u53ca\u4fdd\u96aa\u696d"}]},INDUSTRY_L:{name:"dbo.INDUSTRY_L",oname:"dbo.INDUSTRY_L",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",
NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_L.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u4e0d\u52d5\u7522\u696d"}]},
INDUSTRY_M:{name:"dbo.INDUSTRY_M",oname:"dbo.INDUSTRY_M",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",
E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_M.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u5c08\u696d\u3001\u79d1\u5b78\u53ca\u6280\u8853\u670d\u52d9\u696d"}]},INDUSTRY_N:{name:"dbo.INDUSTRY_N",oname:"dbo.INDUSTRY_N",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",
X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_N.png",smybolName:"\u5de5\u5546\u4f01\u696d\u2500\u652f\u63f4\u670d\u52d9\u696d"}]},INDUSTRY_O:{name:"dbo.INDUSTRY_O",oname:"dbo.INDUSTRY_O",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",
TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_O.png",
symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u516c\u5171\u884c\u653f\u53ca\u570b\u9632\uff1b\u5f37\u5236\u6027\u793e\u6703\u5b89\u5168"}]},INDUSTRY_P:{name:"dbo.INDUSTRY_P",oname:"dbo.INDUSTRY_P",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",
COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_P.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u6559\u80b2\u670d\u52d9\u696d"}]},INDUSTRY_Q:{name:"dbo.INDUSTRY_Q",oname:"dbo.INDUSTRY_Q",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",
COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_Q.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u91ab\u7642\u4fdd\u5065\u53ca\u793e\u6703\u5de5\u4f5c\u670d\u52d9\u696d"}]},
INDUSTRY_R:{name:"dbo.INDUSTRY_R",oname:"dbo.INDUSTRY_R",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",
E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_R.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u85dd\u8853\u3001\u5a1b\u6a02\u53ca\u4f11\u9592\u670d\u52d9\u696d"}]},INDUSTRY_S:{name:"dbo.INDUSTRY_S",oname:"dbo.INDUSTRY_S",identify:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI"},buffer:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",
X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{RID:"RID",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",COMMERCEKI:"COMMERCEKI",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/31_INDUSTRY_S.png",symbolName:"\u5de5\u5546\u4f01\u696d\u2500\u5176\u4ed6\u670d\u52d9\u696d"}]}}};TGOS.MapIdInfo.MEDICAL={resource:"MEDICAL.cfg",layers:{MEDICAL:{name:"dbo.MEDICAL",oname:"dbo.MEDICAL_201304A",
identify:{NAME:"NAME",ADDRESS:"ADDRESS",CHARGE:"CHARGE",CONTACT:"CONTACT"},buffer:{NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",CHARGE:"CHARGE",CONTACT:"CONTACT",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",CHARGE:"CHARGE",CONTACT:"CONTACT",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/27_MEDICAL.png",
symbolName:"\u91ab\u7642\u9662\u6240"}]}}};TGOS.MapIdInfo.SCHOOL={resource:"SCHOOL.cfg",layers:{SCHOOL:{name:"dbo.SCHOOL",oname:"dbo.SCHOOL_201207A",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",
CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL.png",symbolName:"\u5404\u7d1a\u5b78\u6821"}]},SCHOOL_A:{name:"dbo.SCHOOL_A",oname:"dbo.SCHOOL_A",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",
CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+
getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_A.png",symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u516c\u7acb\u5e7c\u7a1a\u5712"}]},SCHOOL_B:{name:"dbo.SCHOOL_B",oname:"dbo.SCHOOL_B",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",
E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_B.png",symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u570b\u6c11\u5c0f\u5b78"}]},SCHOOL_C:{name:"dbo.SCHOOL_C",oname:"dbo.SCHOOL_C",identify:{TYPE:"TYPE",NAME:"NAME",
ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",
X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_C.png",symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u9644\u8a2d\u570b\u6c11\u5c0f\u5b78"}]},SCHOOL_D:{name:"dbo.SCHOOL_D",oname:"dbo.SCHOOL_D",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",
NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_D.png",symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u570b\u6c11\u4e2d\u5b78"}]},
SCHOOL_E:{name:"dbo.SCHOOL_E",oname:"dbo.SCHOOL_E",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",
CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_E.png",symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u9644\u8a2d\u570b\u6c11\u4e2d\u5b78"}]},SCHOOL_F:{name:"dbo.SCHOOL_F",oname:"dbo.SCHOOL_F",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",
TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_F.png",
symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u9ad8\u7d1a\u4e2d\u5b78"}]},SCHOOL_G:{name:"dbo.SCHOOL_G",oname:"dbo.SCHOOL_G",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",
TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_G.png",symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u9ad8\u7d1a\u8077\u696d\u5b78\u6821"}]},SCHOOL_H:{name:"dbo.SCHOOL_H",oname:"dbo.SCHOOL_H",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",
CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+
getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_H.png",symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u5927\u5c08\u9662\u6821"}]},SCHOOL_I:{name:"dbo.SCHOOL_I",oname:"dbo.SCHOOL_I",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",
N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_I.png",symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u5b97\u6559\u7814\u4fee\u5b78\u9662"}]},SCHOOL_J:{name:"dbo.SCHOOL_J",oname:"dbo.SCHOOL_J",identify:{TYPE:"TYPE",
NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",
X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_J.png",symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u8ecd\u8b66\u5927\u5c08\u9662\u6821"}]},SCHOOL_K:{name:"dbo.SCHOOL_K",oname:"dbo.SCHOOL_K",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",
NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_K.png",symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u7279\u6b8a\u6559\u80b2\u5b78\u6821"}]},
SCHOOL_L:{name:"dbo.SCHOOL_L",oname:"dbo.SCHOOL_L",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",
CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_L.png",symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u570b\u4e2d\u5c0f\u88dc\u6821"}]},SCHOOL_M:{name:"dbo.SCHOOL_M",oname:"dbo.SCHOOL_M",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",
TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_M.png",
symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u9ad8\u4e2d\u8077\u9032\u4fee\u5b78\u6821"}]},SCHOOL_N:{name:"dbo.SCHOOL_N",oname:"dbo.SCHOOL_N",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",TEL:"TEL",WEBSITE:"WEBSITE"},buffer:{TYPE:"TYPE",CODE:"CODE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},query:{TYPE:"TYPE",CODE:"CODE",
NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",TEL:"TEL",AREA:"AREA",WEBSITE:"WEBSITE",CLASS:"CLASS",AWAY:"AWAY",NOTE:"NOTE",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/32_SCHOOL_N.png",symbolName:"\u5404\u7d1a\u5b78\u6821\u2500\u7a7a\u5927\u53ca\u5927\u5c08\u6821\u9662\u9644\u8a2d\u9032\u4fee\u5b78\u6821"}]}}}})();TGOS.PROXY_LOCAL="http://localhost:15086/tgproxy.ashx";TGOS.PROXY_SERVICE=getWebProtocal()+getAPIPath()+"proxyservice/proxy.aspx";TGOS.PROXY_SERVICE2=getWebProtocal()+getAPIPath()+"proxyservice/tgproxy.ashx";TGOS.LOCATOR_SERVICE=getWebProtocal()+getServicePath()+"addresslocator/locate.aspx";TGOS.STATISTICS_SERVICE=getWebProtocal()+getAPIPath()+"TGDistrict/statistics.aspx";TGOS.STATISTICS_SERVICE2=getWebProtocal()+getAPIPath()+"TGDistrict/statistics2.aspx";
TGOS.ADDRESSLOCATE_SERVICE=getWebProtocal()+getServicePath()+"TGAddress/TGAddress.aspx";TGOS.QUERY_SERVICE=getWebProtocal()+getServicePath()+"TGQuery/TGQuery.ashx";TGOS.TGKML_ATTR_SERVICE=getWebProtocal()+getAPIPath()+"SGSPWS/TGKMLService.ashx/TGQueryService";TGOS.TGKML_BUFFER_SERVICE=getWebProtocal()+getAPIPath()+"SGSPWS/TGKMLService.ashx/TGBufferService";
TGOS.TGBufferStatus={ERROR:"ERROR",INVALID_REQUEST:"INVALID_REQUEST",OK:"OK",OVER_QUERY_LIMIT:"OVER_QUERY_LIMIT",REQUEST_DENIED:"REQUEST_DENIED",UNKNOWN_ERROR:"UNKNOWN_ERROR",ZERO_RESULTS:"ZERO_RESULTS"};TGOS.TGQueryStatus={ERROR:"ERROR",INVALID_REQUEST:"INVALID_REQUEST",OK:"OK",OVER_QUERY_LIMIT:"OVER_QUERY_LIMIT",REQUEST_DENIED:"REQUEST_DENIED",UNKNOWN_ERROR:"UNKNOWN_ERROR",ZERO_RESULTS:"ZERO_RESULTS"};
TGOS.TGIdentifyStatus={ERROR:"ERROR",INVALID_REQUEST:"INVALID_REQUEST",OK:"OK",OVER_QUERY_LIMIT:"OVER_QUERY_LIMIT",REQUEST_DENIED:"REQUEST_DENIED",UNKNOWN_ERROR:"UNKNOWN_ERROR",ZERO_RESULTS:"ZERO_RESULTS"};TGOS.TGLocatorStatus={ERROR:"ERROR",INVALID_REQUEST:"INVALID_REQUEST",OK:"OK",OVER_QUERY_LIMIT:"OVER_QUERY_LIMIT",REQUEST_DENIED:"REQUEST_DENIED",UNKNOWN_ERROR:"UNKNOWN_ERROR",ZERO_RESULTS:"ZERO_RESULTS",TOO_MANY_RESULTS:"TOO_MANY_RESULTS"};
TGOS.TGMeasureStatus={ERROR:"ERROR",INVALID_REQUEST:"INVALID_REQUEST",OK:"OK",OVER_QUERY_LIMIT:"OVER_QUERY_LIMIT",REQUEST_DENIED:"REQUEST_DENIED",UNKNOWN_ERROR:"UNKNOWN_ERROR",INVALID_Coordinate:"INVALID_Coordinate"};TGOS.TGLocatorLocation={APPROXIMATE:"APPROXIMATE",GEOMETRIC_CENTER:"GEOMETRIC_CENTER",RANGE_INTERPOLATED:"GEOMETRIC_CENTER",ROOFTOP:"ROOFTOP"};TGOS.TGUnitSystem={IMPERIAL:"IMPERIAL",METRIC:"METRIC"};TGOS.TGStatMapId={COUNTYMAP:"COUNTYMAP",TOWNMAP:"TOWNMAP",VILLAGEMAP:"VILLAGEMAP"};
TGOS.TGStatServiceStatus={ERROR:"ERROR",INVALID_REQUEST:"INVALID_REQUEST",OK:"OK",OVER_QUERY_LIMIT:"OVER_QUERY_LIMIT",REQUEST_DENIED:"REQUEST_DENIED",UNKNOWN_ERROR:"UNKNOWN_ERROR",ZERO_RESULTS:"ZERO_RESULTS"};TGOS.KindInfo=TGOS.KindInfo||{};
TGOS.KindInfo={POI991:"POI991",POI992:"POI992",POI993:"POI993",POI994:"POI994",POI995:"POI995",POI996:"POI996",POI999:"POI999",government:"government",kindergarten:"kindergarten",culture:"culture",library:"library",museum:"museum",artmuseum:"artmuseum",funeral:"funeral",piration:"piration",hospital:"hospital",sanitation:"sanitation",preschool:"preschool",nursinghome:"nursinghome",nationalpark:"nationalpark",theater:"theater",park:"park",playground:"playground",zoo:"zoo",sports:"sports",market:"market",
mall:"mall",conveniencestore:"conveniencestore",post:"post",financial:"financial",hotel:"hotel",TRA:"TRA",highwaybus:"highwaybus",MRT:"MRT",HSR:"HSR",gasstation:"gasstation",parking:"parking",restingstop:"restingstop",airport:"airport",port:"port",districtoffice:"districtoffice",household:"household",land:"land",policedepartment:"policedepartment",firedepartment:"firedepartment",elementary:"elementary",juniorhigh:"juniorhigh",seniorhigh:"seniorhigh",college:"college",school:"school",peasant:"peasant",
buffer:{MARKNAME1:"MARKNAME1",ADDRESS:"ADDRESS",TEL:"TEL",COUNTYNAME:"COUNTYNAME",TOWNNAME:"TOWNNAME",FLOODING:"FLOODING",X_97121:"X_97121",Y_97121:"Y_97121",X_97119:"X_97119",Y_97119:"Y_97119",E:"E",N:"N"}};TGOS.APPID="oDPRlyfRCxJU0WQzbGoT3czIVKKrgazXufYoMUqrDunDU2wyZUyqxw%3d%3d";
TGOS.Log=function(b,d,a){b=getWebProtocal()+getAPIPath()+"rec/count.aspx?AppID="+TGOS.APPID+"&APIID="+d+"&DataID="+a;d=document.createElement("script");d.onload=function(){this.parentNode.removeChild(this)};d.onerror=function(){this.parentNode.removeChild(this)};d.type="text/javascript";document.body.appendChild(d);d.src=b};TGOS.ajaxCount__=0;
(function(){var b=function(b,a,f){b+=0<=b.indexOf("?")?"&":"?";return b+(a+"="+f)};TGOS.getJSON=function(d,a,f,e){var g={src:d},h=util.getInternetExplorerVersion(),k="sn"+TGOS.ajaxCount__;TGOS.getJSON[k]=function(){a.apply(g,arguments);delete TGOS.getJSON[k]};f&&(d=b(f,"serv",encodeURIComponent(d)));d=b(d,"keystr",encodeURIComponent(TGOS.tgHash));d=b(d,"jsonp",encodeURIComponent("TGOS.getJSON['"+k+"']"));f=document.getElementsByTagName("head");if(0!=f.length){var l=document.createElement("script");
l.type="text/javascript";0<=h&&8>=h?l.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(this.parentNode.removeChild(l),l=void 0)}:l.onload=function(){this.parentNode.removeChild(l);l=void 0};l.onerror=function(){e&&e.call(this);this.parentNode.removeChild(l);l=void 0};TGOS.ajaxCount__++;l.src=d;f[0].appendChild(l)}}})();
TGOS.loadJsonData=function(b,d,a,f,e){var g=document.createElement("script");g.type="text/javascript";document.body.appendChild(g);d=0<=d.indexOf("?")?d+"&keystr="+encodeURIComponent(TGOS.tgHash):d+"?keystr="+encodeURIComponent(TGOS.tgHash);d+="&rn="+Math.floor(1E5*Math.random()+1);g.onreadystatechange=function(){"loaded"==this.readyState&&a.call(this,dataObj)};g.onload=function(){a.call(this,dataObj);g.parentNode.removeChild(g);for(var b in g)delete g[b]};g.onerror=function(){f&&f.call(this)};""==
b?g.src=d:(e&&(g.src=b+"?serv="+encodeURIComponent(d)+"&skip=true&hash="+TGOS.tgHash),g.src=b+"?serv="+encodeURIComponent(d))};TGOS.DistrictID={U01COS01_201212A:"S01",U01COS02_201212A:"S02",U01COS03_201212A:"S03",U01COS04_201212A:"S04",U01COS05_201212A:"S05",U01TOS01_201212A:"S06",U01TOS02_201212A:"S07",U01TOS03_201212A:"S08",U01TOS04_201212A:"S09",U01TOS05_201212A:"S10",U01VIS01_201212A:"S11",U01VIS02_201212A:"S12",U01VIS03_201212A:"S13",U01VIS04_201212A:"S14",U01VIS05_201212A:"S15"};
TGOS.TGDistrictStat=function(){this.stat=function(b,d,a,f){var e={getImageUrl:"",district:[]},g="";switch(b){case TGOS.TGStatMapId.COUNTYMAP:g="county";break;case TGOS.TGStatMapId.TOWNMAP:g="town";break;case TGOS.TGStatMapId.VILLAGEMAP:g="village"}var h="string"==typeof a.layer?a.layer:"",k="string"==typeof a.code?a.code:"",l="ei";switch("string"==typeof a.classifyMethod?a.classifyMethod:""){case "EqualInterval":l="ei";break;case "Quantile":l="qt";break;case "StanDevi":l="sd"}var p="number"==typeof a.classes?
a.classes.toString():"",m="green";switch(a.graduatedColor.toLowerCase()){case "red":m="red";break;case "yellow":m="yellow";break;case "green":m="green";break;case "blue":m="blue"}var n="number"==typeof a.height?a.height.toString():"",u="number"==typeof a.width?a.width.toString():"";TGOS.getJSON(TGOS.STATISTICS_SERVICE2+"?width="+u+"&height="+n+"&district="+g+"&color="+m+"&layer="+h+"&code="+k+"&method="+l+"&classnum="+p,function(a){if(a&&a.error)f.call(this,null,"REQUEST_DENIED");else{e.district=
a.district;e.legend=a.legend;var b=parseFloat(a.envelope.left),d=parseFloat(a.envelope.top),C=parseFloat(a.envelope.right);a=parseFloat(a.envelope.bottom);e.envelope=new TGOS.TGEnvelope(b,d,C,a);b=TGOS.STATISTICS_SERVICE+"?width="+u+"&height="+n+"&district="+g+"&color="+m+"&layer="+h+"&code="+k+"&method="+l+"&classnum="+p;b=0<=b.indexOf("?")?b+"&keystr="+encodeURIComponent(TGOS.tgHash):b+"?keystr="+encodeURIComponent(TGOS.tgHash);e.imageUrl=b;f.call(this,e,"OK");h in TGOS.DistrictID&&TGOS.Log("web",
"A05",TGOS.DistrictID[h])}})}};
TGOS.TGLocateService=function(){function b(a,b,d){var f=[];new TGOS.TGTransformation;var l="",p="";switch(d){case "84":p="EPSG:4326";break;case "97_119":p="EPSG:3825";break;default:p="EPSG:3826"}TGOS.getJSON(TGOS.ADDRESSLOCATE_SERVICE+"?oAddress="+a.address+"&oSRS="+p+"&oResultDataType=jsonp&pnum="+parseInt(a.pageNumber),function(a){if(a&&a.Info&&a.Info.length)if(0>=parseInt(a.Info[0].OutTotal))l=TGOS.TGLocatorStatus.ZERO_RESULTS,b.call(this,null,l);else{l=TGOS.TGLocatorStatus.OK;30<parseInt(a.Info[0].OutTotal)&&
(l=TGOS.TGLocatorStatus.TOO_MANY_RESULTS);for(var e=0;e<a.AddressList.length;e++){var p={addressComponents:[],formattedAddress:"",geometry:{bounds:"",location:"",locatorLocation:"",geometry:""},types:[]},s=parseFloat(a.AddressList[e].X),q=parseFloat(a.AddressList[e].Y);p.addressComponents={county:a.AddressList[e].COUNTY,town:a.AddressList[e].TOWN,village:a.AddressList[e].VILLAGE,neighborhood:a.AddressList[e].NEIGHBORHOOD,road:a.AddressList[e].ROAD,section:a.AddressList[e].SECTION,lane:a.AddressList[e].LANE,
alley:a.AddressList[e].ALLEY,sub_alley:a.AddressList[e].SUB_ALLEY,number:a.AddressList[e].NUMBER};p.formattedAddress=a.AddressList[e].FULL_ADDR;p.geometry.location=new TGOS.TGPoint(s,q);"84"==d?(q=TGOS.WGS84ToGoo(p.geometry.location.x,p.geometry.location.y),s=TGOS.GooToWGS84(q.x-500,q.y+500),q=TGOS.GooToWGS84(q.x+500,q.y-500),p.geometry.viewport=new TGOS.TGEnvelope(s.x,s.y,q.x,q.y)):p.geometry.viewport=new TGOS.TGEnvelope(s-500,q+500,s+500,q-500);f.push(p)}b.call(this,f,l);TGOS.Log("web","A12","")}else l=
TGOS.TGLocatorStatus.ERROR,b.call(this,null,l)})}function d(a,b,d){var f=[],l=new TGOS.TGTransformation,p={addressComponents:[],formattedAddress:"",geometry:{bounds:"",location:"",locatorLocation:"",geometry:"",viewPort:""},types:[]},m=a.town?a.town:"",n=a.county?a.county:"",n=n.replace("\u6843\u5712\u7e23","\u6843\u5712\u5e02");srs="84"==d?"EPSG4326":"97_119"==d?"EPSG3825":"EPSG3826";m=TGOS.LOCATOR_SERVICE+"?op=poi&keyword="+a.poi+"&pnum="+parseInt(a.pageNumber)+"&county="+n+"&town="+m+"&srs="+srs;
a.center&&a.center instanceof TGOS.TGPoint&&(m+="&center="+a.center.x+","+a.center.y);TGOS.getJSON(m,function(a){if(a&&a.error)b.call(this,f,"REQUEST_DENIED",0,0);else if(!a||!a.Table||0>=a.Table.length)b.call(this,f,TGOS.TGLocatorStatus.ZERO_RESULTS,0,0);else{for(var e=0;e<a.Table.length;e++){p={addressComponents:[],formattedAddress:"",geometry:{bounds:"",location:"",locatorLocation:"",geometry:"",viewPort:""},types:[]};var m=parseFloat(a.Table[e].X_97121),n=parseFloat(a.Table[e].Y_97121);if("84"==
d){var C,B;l.twd97towgs84(m,n);p.geometry.location=new TGOS.TGPoint(l.transResult.x,l.transResult.y);l.twd97towgs84(m-1E3,n+1E3);C=l.transResult.x;B=l.transResult.y;l.twd97towgs84(m+1E3,n-1E3);n=l.transResult.x;m=l.transResult.y;p.geometry.viewport=new TGOS.TGEnvelope(C,B,n,m)}else"97_119"==d?(l.twd97towgs84(m,n),l.wgs84totwd97_119(l.transResult.x,l.transResult.y),p.geometry.location=new TGOS.TGPoint(l.transResult.x,l.transResult.y),l.twd97towgs84(m-1E3,n+1E3),l.wgs84totwd97_119(l.transResult.x,l.transResult.y),
C=l.transResult.x,B=l.transResult.y,l.twd97towgs84(m+1E3,n-1E3),l.wgs84totwd97_119(l.transResult.x,l.transResult.y),n=l.transResult.x,m=l.transResult.y,p.geometry.viewport=new TGOS.TGEnvelope(C,B,n,m)):(p.geometry.viewport=new TGOS.TGEnvelope(m-1E3,n+1E3,m+1E3,n-1E3),p.geometry.location=new TGOS.TGPoint(m,n));p.poiName=a.Table[e].LANDMARKNA;p.county=a.Table[e].COUNTYNAME;p.town=a.Table[e].TOWNNAME;f.push(p)}b.call(this,f,1<a.pages?TGOS.TGLocatorStatus.TOO_MANY_RESULTS:TGOS.TGLocatorStatus.OK,a.items,
a.pages);TGOS.Log("web","A13","")}})}function a(a,b,d){var f=[],l=new TGOS.TGTransformation,p=a.town?a.town:"",m=a.county?a.county:"",m=m.replace("\u6843\u5712\u7e23","\u6843\u5712\u5e02"),n;n="84"==d?"EPSG4326":"97_119"==d?"EPSG3825":"EPSG3826";p=TGOS.LOCATOR_SERVICE+"?op=rd&road="+a.roadLocation+"&pnum="+parseInt(a.pageNumber)+"&county="+m+"&town="+p+"&srs="+n;a.center&&a.center instanceof TGOS.TGPoint&&(p+="&center="+a.center.x+","+a.center.y);TGOS.getJSON(p,function(a){if(a&&a.error)b.call(this,
f,"REQUEST_DENIED",0,0);else if(a&&a.results){for(r=0;r<a.results.length;r++){var e={addressComponents:[],formattedAddress:"",geometry:{bounds:"",location:"",locatorLocation:"",geometry:"",viewPort:""},types:[]},m=parseFloat(a.results[r].min_x),p=parseFloat(a.results[r].min_y),n=parseFloat(a.results[r].max_x),B=parseFloat(a.results[r].max_y),H=parseFloat(a.results[r].point_x),A=parseFloat(a.results[r].point_y);"84"==d?(l.twd97towgs84(H,A),e.geometry.location=new TGOS.TGPoint(l.transResult.x,l.transResult.y),
l.twd97towgs84(m,B),m=l.transResult.x,B=l.transResult.y,l.twd97towgs84(n,p),n=l.transResult.x,p=l.transResult.y):"97_119"==d?(l.twd97towgs84(H,A),l.wgs84totwd97_119(l.transResult.x,l.transResult.y),e.geometry.location=new TGOS.TGPoint(l.transResult.x,l.transResult.y),l.twd97towgs84(m,B),l.wgs84totwd97_119(l.transResult.x,l.transResult.y),m=l.transResult.x,B=l.transResult.y,l.twd97towgs84(n,p),l.wgs84totwd97_119(l.transResult.x,l.transResult.y),n=l.transResult.x,p=l.transResult.y):e.geometry.location=
new TGOS.TGPoint(H,A);p=new TGOS.TGEnvelope(m,B,n,p);e.geometry.viewport=p;e.county=a.results[r].countyname;e.town=a.results[r].townname;e.formattedAddress=a.results[r].roadname;f.push(e)}b.call(this,f,1<a.pages?TGOS.TGLocatorStatus.TOO_MANY_RESULTS:TGOS.TGLocatorStatus.OK,a.items,a.pages);TGOS.Log("web","A14","")}else b.call(this,f,TGOS.TGLocatorStatus.ZERO_RESULTS,0,0)})}function f(a,b,d){var f=[];new TGOS.TGTransformation;var l={addressComponents:[],formattedAddress:"",geometry:{bounds:"",location:"",
locatorLocation:"",geometry:"",viewport:""},types:[]};a=encodeURIComponent(a.district.replace("\u6843\u5712\u7e23","\u6843\u5712\u5e02"));TGOS.getJSON(TGOS.LOCATOR_SERVICE+"?op=dist&district="+a,function(a){if(a&&a.error)b.call(this,null,"REQUEST_DENIED");else if(a&&"OK"==a.status){var e=parseFloat(a.Information.x),n=parseFloat(a.Information.y),u=new TGOS.TGEnvelope(a.Information.minX,a.Information.maxY,a.Information.maxX,a.Information.minY);a=util.parsePolyWkt(a.Information.geometry);if("84"==d){var s=
TGOS.TWD97toWGS84(u.left,u.top),u=TGOS.TWD97toWGS84(u.right,u.bottom),e=TGOS.TWD97toWGS84(e,n);l.geometry.location=new TGOS.TGPoint(e.x,e.y);l.geometry.viewport=new TGOS.TGEnvelope(s.x,s.y,u.x,u.y);e=TGOS.Geometry.Transform(a,TGOS.TWD97toWGS84);l.geometry.geometry=e}else"97_119"==d?(s=TGOS.TWD97toTWD97_119(u.left,u.top),u=TGOS.TWD97toTWD97_119(u.right,u.bottom),e=TGOS.TWD97toTWD97_119(e,n),l.geometry.location=new TGOS.TGPoint(e.x,e.y),l.geometry.viewport=new TGOS.TGEnvelope(s.x,s.y,u.x,u.y),e=TGOS.Geometry.Transform(a,
TGOS.TWD97toTWD97_119),l.geometry.geometry=e):(l.geometry.location=new TGOS.TGPoint(e,n),l.geometry.viewport=u,l.geometry.geometry=a);l.geometry&&l.geometry.geometry&&l.geometry.geometry.getBounds&&(l.geometry.bounds=l.geometry.geometry.getBounds());f.push(l);b.call(this,f,TGOS.TGLocatorStatus.OK);TGOS.Log("web","A15","")}else b.call(this,null,TGOS.TGLocatorStatus.ZERO_RESULTS)})}this.locateWGS84=function(e,g){"undefined"!=typeof e.address?b(e,g,"84"):"undefined"!=typeof e.poi?d(e,g,"84"):"undefined"!=
typeof e.roadLocation?a(e,g,"84"):"undefined"!=typeof e.district?f(e,g,"84"):g.call(this,null,TGOS.TGLocatorStatus.INVALID_REQUEST)};this.locateTWD97=function(e,g){"undefined"!=typeof e.address?b(e,g,"97"):"undefined"!=typeof e.poi?d(e,g,"97"):"undefined"!=typeof e.roadLocation?a(e,g,"97"):"undefined"!=typeof e.district?f(e,g,"97"):g.call(this,null,TGOS.TGLocatorStatus.INVALID_REQUEST)};this.locateTWD97_119=function(e,g){"undefined"!=typeof e.address?b(e,g,"97_119"):"undefined"!=typeof e.poi?d(e,
g,"97_119"):"undefined"!=typeof e.roadLocation?a(e,g,"97_119"):"undefined"!=typeof e.district?f(e,g,"97_119"):g.call(this,null,TGOS.TGLocatorStatus.INVALID_REQUEST)};this.setCenter=function(a,b){a.setCenter(b)};this.fitBounds=function(a,b){a.fitBounds(b)}};
TGOS.TGMeasureService=function(){this.twd97LineMeasure=function(b,d){var a,f;b instanceof TGOS.TGLineString?(a=b.getLength(),f="OK"):(a=null,f="INVALID_REQUEST");d.call(this,a,f);TGOS.Log("web","A07","")};this.twd97PolygonMeasure=function(b,d){var a,f;b instanceof TGOS.TGPolygon?(a=b.getArea(),f="OK"):(a=null,f="INVALID_REQUEST");d.call(this,a,f);TGOS.Log("web","A07","")};this.twd97_119LineMeasure=function(b,d){var a,f;b instanceof TGOS.TGLineString?(a=b.getLength(),f="OK"):(a=null,f="INVALID_REQUEST");
d.call(this,a,f);TGOS.Log("web","A07","")};this.twd97_119PolygonMeasure=function(b,d){var a,f;b instanceof TGOS.TGPolygon?(a=b.getArea(),f="OK"):(a=null,f="INVALID_REQUEST");d.call(this,a,f);TGOS.Log("web","A07","")};this.wgs84LineMeasure=function(b,d){var a,f;a=new TGOS.TGTransformation;var e=[],g,h;if(b instanceof TGOS.TGLineString){f=b.getPath();for(var k=0;k<f.length;k++)a.wgs84totwd97(f[k].x,f[k].y),g=a.transResult.x,h=a.transResult.y,g=new TGOS.TGPoint(g,h),e.push(g);a=new TGOS.TGLineString(e);
a=a.getLength();f="OK"}else a=null,f="INVALID_REQUEST";d.call(this,a,f);TGOS.Log("web","A07","")};this.wgs84PolygonMeasure=function(b,d){var a,f;a=new TGOS.TGTransformation;var e=[],g,h;if(b instanceof TGOS.TGPolygon){f=b.getExteriorRing().getPath().getPath();for(var k=0;k<f.length;k++)a.wgs84totwd97(f[k].x,f[k].y),g=a.transResult.x,h=a.transResult.y,g=new TGOS.TGPoint(g,h),e.push(g);a=new TGOS.TGLineString(e);a=new TGOS.TGLinearRing(a);a=new TGOS.TGPolygon([a]);a=a.getArea();f="OK"}else a=null,f=
"INVALID_REQUEST";d.call(this,a,f);TGOS.Log("web","A07","")}};
TGOS.TGTileOverlay=function(){var b=[],d,a="auto",f=null;this.getLayerById=function(a){for(var d=0;d<b.length;d++)if(b[d].id==a)return b[d];return null};this.setZIndex=function(d){a=d;for(d=0;d<b.length;d++)b[d].setZIndex(a)};this.getZIndex=function(){return a};this.setTileOpacity=function(a,b){if(null!=this.getLayerById(b)){if(null==this.getLayerById(b))throw"Layer Not Found";this.getLayerById(b).setOpacity(a)}};this.removeTileOverlay=function(a){if(null!=this.getLayerById(a)){d.removeLayer(this.getLayerById(a));
for(var f=0;f<b.length;f++)b[f].id==a&&b.splice(f,1)}};this.getThemeTile=function(a,g,h,k){var l=this.getLayerById(a),p;if(l){p=l.getTiles(g.left,g.top,g.right,g.bottom,g.scaleLevel,0);h=[];for(var l=[],m=0;m<p.length;m++)h.push(new TGOS.TGPoint(p[m].leftTop[0],p[m].leftTop[1])),l.push(p[m].url);k&&k.call(this,{leftTopAnchor:h,imageUrl:l})}else{d=g.map;null!=g.zIndex&&this.setZIndex(g.zIndex);var l=getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_"+a+".aspx",n=new MapCachedLayer(a,l,!1,this,"97",
function(){p=n.getTiles(g.left,g.top,g.right,g.bottom,g.scaleLevel,0);for(var a=[],b=[],e=0;e<p.length;e++){if(d.getCoordSys()==TGOS.TGCoordSys.EPSG3857){var f=TGOS.TWD97ToWGS84(p[e].leftTop[0],p[e].leftTop[1]);a.push(new TGOS.TGPoint(f.x,f.y))}else a.push(new TGOS.TGPoint(p[e].leftTop[0],p[e].leftTop[1]));b.push(p[e].url)}k&&k.call(this,{leftTopAnchor:a,imageUrl:b})});n.id=a;g.map.addLayer(n,!0);n.setZIndex(this.getZIndex());n.setOpacity(h);b.push(n);f=l=n;g.overlay||n.putVisible(!1)}a in TGOS.ThemeTileID&&
TGOS.Log("web","A03",TGOS.ThemeTileID[a])};this.getNode=function(){return f.gethLayers()}};TGOS.TGThemeTileRequest=function(){this.bottom=this.top=this.right=this.left=null;this.map=this.overlay=!0;this.setScaleLevel=null};TGOS.TGThemeTileResult=function(){this.LeftTopAnchor=this.ImageUrl=null};
TGOS.TGThemeLayer=function(){this.getThemePic=function(b,d,a,f){a=TGOS.QUERY_SERVICE+"?op=image&res="+TGOS.MapIdInfo[b].resource+"&layer="+TGOS.MapIdInfo[b].layers[d].name+"&Left="+a.left+"&Top="+a.top+"&Right="+a.right+"&Bottom="+a.bottom+"&Width="+parseFloat(a.width)+"&Height="+parseFloat(a.height)+"&keystr="+encodeURIComponent(TGOS.tgHash);f.call(this,a,"OK",TGOS.MapIdInfo[b].layers[d].legends);b in TGOS.ThemeLayerID&&TGOS.Log("web","A04",TGOS.ThemeLayerID[b])}};
TGOS.TGThemePicRequest=function(){this.bottom=this.top=this.right=this.left=null;this.height=this.width=256;this.setRange=function(b,d,a,f){this.left=b;this.right=d;this.top=a;this.bottom=f};this.setImageSize=function(b,d){this.height=b;this.width=d}};
TGOS.TGFeatureIdentify=function(){function b(b){return b.replace(/^[\s]*/gi,"").replace(/[\s]*$/gi,"")}this.identify=function(d,a,f,e,g){function h(a,b){var d=new TGOS.TGTransformation,e=[],f=a.indexOf("("),g=a.indexOf(")");f++;a=a.substring(f,g);f=a.split(",");for(g=0;g<f.length;g++){var h=f[g].split(" ");if(isNaN(h[0])||isNaN(h[1]))return!1;b?(d.twd97towgs84(parseFloat(h[0]),parseFloat(h[1])),e.push(new TGOS.TGPoint(d.transResult.x,d.transResult.y))):e.push(new TGOS.TGPoint(parseFloat(h[0]),parseFloat(h[1])))}return new TGOS.TGLineString(e)}
function k(a,b){var d=a.indexOf("("),e=a.indexOf(")");d++;a=a.substring(d,e);d=a.split(" ");return isNaN(d[0])||isNaN(d[1])?!1:b?(e=new TGOS.TGTransformation,e.twd97towgs84(parseFloat(d[0]),parseFloat(d[1])),new TGOS.TGPoint(e.transResult.x,e.transResult.y)):new TGOS.TGPoint(parseFloat(d[0]),parseFloat(d[1]))}function l(a,b,d){var e=a.indexOf("(");e++;for(var f=[];-1!=e;){var g=a.indexOf("))",e),e=a.substring(e,g+2);"MULTIPOINT"==b?f.push(k(e,d)):"MULTILINESTRING"==b?f.push(h(e,d)):"MULTIPOLYGON"==
b&&f.push(util.parsePolyWkt(e,d));e=a.indexOf("(",g-1)}return f}function p(f){var m="";if(f){f=f.Feature;var p=null,q=[],p=null,n;for(n in TGOS.MapIdInfo[d].layers[a].identify)m=m+n+",";w.fieldName=m;if("undefined"==typeof f.length){q=[];p=f.Values;for(n in TGOS.MapIdInfo[d].layers[a].identify){var s=p[TGOS.MapIdInfo[d].layers[a].identify[n]];q.push(s)}p=f.Geometry;s=p.indexOf("(");s=b(p.substr(0,s).toUpperCase());w.featureType=s;var u="EPSG3857"==e;if("POINT"==s)var C=[k(p,u)];else"LINESTRING"==
s?C=[h(p,u)]:"POLYGON"==s?C=[util.parsePolyWkt(p)]:-1!=s.indexOf("MULTI")&&(C=new l(p,s,u));w.fieldAttr.push(q);w.geometry=C}else for(m=0;m<f.length;m++){q=[];p=f[m].Values;for(n in TGOS.MapIdInfo[d].layers[a].identify)s=p[TGOS.MapIdInfo[d].layers[a].identify[n]],q.push(s);p=f[m].Geometry;s=p.indexOf("(");s=b(p.substr(0,s).toUpperCase());w.featureType=s;u="EPSG3857"==e;"POINT"==s?C=[k(p,u)]:"LINESTRING"==s?C=[h(p,u)]:"POLYGON"==s?C=[util.parsePolyWkt(p,u)]:-1!=s.indexOf("MULTI")&&(C=new l(p,s,u));
w.fieldAttr.push(q);w.geometry=C}g.call(this,w,"OK");TGOS.Log("web","A08",TGOS.ThemeLayerID[d])}else g.call(this,null,"ZERO_RESULTS")}function m(){var a=TGOS.QUERY_SERVICE+"?op=fid_s",a=a+"&layer=dbo.LANDUSE_201207A_1"+("&res="+TGOS.MapIdInfo[d].resource),a=a+("&geom=POLYGON(("+C+"))");TGOS.getJSON(a,function(a){a?p(a):(a=TGOS.QUERY_SERVICE+"?op=fid_s",a=a+"&layer=dbo.LANDUSE_201207A_2"+("&res="+TGOS.MapIdInfo[d].resource),a+="&geom=POLYGON(("+C+"))",TGOS.getJSON(a,function(a){p(a)}))})}if(f instanceof
TGOS.TGPoint){var n=new TGOS.TGPoint(0,0),u=new TGOS.TGPoint(0,0),s=new TGOS.TGPoint(0,0),q=new TGOS.TGPoint(0,0),w={fieldAttr:[],geometry:[]};n.x=f.x;n.y=f.y+30;u.x=f.x+30;u.y=f.y;s.x=f.x;s.y=f.y-30;q.x=f.x-30;q.y=f.y;var C=n.x+" "+n.y+","+u.x+" "+u.y+","+s.x+" "+s.y+","+q.x+" "+q.y+","+n.x+" "+n.y;"LANDUSE"==d?m():(n=TGOS.QUERY_SERVICE+"?op=fid",n+="&layer="+TGOS.MapIdInfo[d].layers[a].name,n+="&res="+TGOS.MapIdInfo[d].resource,n+="&cx="+f.x,n+="&cy="+f.y,TGOS.getJSON(n,function(f){var m="";if(f&&
f.error)g.call(this,null,"REQUEST_DENIED");else if(f&&f.Feature){f=f.Feature;var p=null,q=[],p=null,n;for(n in TGOS.MapIdInfo[d].layers[a].identify)m=m+n+",";w.fieldName=m;if("undefined"==typeof f.length){q=[];p=f.Values;for(n in TGOS.MapIdInfo[d].layers[a].identify){var s=p[TGOS.MapIdInfo[d].layers[a].identify[n]];q.push(s)}p=f.Geometry;s=p.indexOf("(");s=b(p.substr(0,s).toUpperCase());w.featureType=s;var u="EPSG3857"==e;if("POINT"==s)var C=[k(p,u)];else"LINESTRING"==s?C=[h(p,u)]:"POLYGON"==s?C=
[util.parsePolyWkt(p)]:-1!=s.indexOf("MULTI")&&(C=new l(p,s,u));w.fieldAttr.push(q);w.geometry=C}else for(m=0;m<f.length;m++){q=[];p=f[m].Values;for(n in TGOS.MapIdInfo[d].layers[a].identify)s=p[TGOS.MapIdInfo[d].layers[a].identify[n]],q.push(s);p=f[m].Geometry;s=p.indexOf("(");s=b(p.substr(0,s).toUpperCase());w.featureType=s;u="EPSG3857"==e;"POINT"==s?C=[k(p,u)]:"LINESTRING"==s?C=[h(p,u)]:"POLYGON"==s?C=[util.parsePolyWkt(p,u)]:-1!=s.indexOf("MULTI")&&(C=new l(p,s,u));w.fieldAttr.push(q);w.geometry=
C}g.call(this,w,"OK");TGOS.Log("web","A08",TGOS.ThemeLayerID[d])}else g.call(this,null,"ZERO_RESULTS")}))}else g.call(this,null,"INVALID_REQUEST")}};TGOS.parsePointWKT=function(b){var d=b.indexOf("("),a=b.indexOf(")");d++;b=b.substring(d,a);b=b.split(" ");return isNaN(b[0])||isNaN(b[1])?!1:new TGOS.TGPoint(parseFloat(b[0]),parseFloat(b[1]))};
TGOS.TGAttriQuery=function(){this.identify=function(b,d,a,f,e){var g="",h={},k=a.county,l=a.town,p=a.keyword;""!=l&&""==k?(g=g+"[TOWN]='"+l+"'",p&&(g=g+" AND [NAME] LIKE N'%"+p+"%'")):""==l&&""!=k?(g=g+"[COUNTY]='"+k.replace("\u53f0","\u81fa")+"'",p&&(g=g+" AND [NAME] LIKE N'%"+p+"%'")):""!=l&&""!=k?(k&&(g=g+"[TOWN]='"+l+"' AND [COUNTY]='"+k.replace("\u53f0","\u81fa")+"'"),p&&(g=g+" AND [NAME] LIKE N'%"+p+"%'")):p&&(g=g+" [NAME] LIKE N'%"+p+"%'");a=isNaN(a.pageNumber)||1>a.pageNumber?1:parseInt(a.pageNumber);
k=TGOS.QUERY_SERVICE+"?op=att&res="+TGOS.MapIdInfo[b].resource;k+="&layer="+TGOS.MapIdInfo[b].layers[d].name;k+="&EXPR="+encodeURIComponent(g);h.fieldAttr=[];h.position=[];TGOS.getJSON(k+("&page="+a),function(a){var g="";if(a&&a.error)e.call(this,null,"REQUEST_DENIED",0,0);else if(a){var k=a.Feature,l=null,p=[],w=null,C=a.items;a=a.pages;for(var B in TGOS.MapIdInfo[b].layers[d].query)g=g+B+",";h.fieldName=g;for(var g=k.length,H=0;H<g;H++){p=[];l=k[H].Values;w=k[H].Geometry;for(B in TGOS.MapIdInfo[b].layers[d].query)p.push(l[TGOS.MapIdInfo[b].layers[d].query[B]]);
switch(f){case "EPSG3857":var l=TGOS.parsePointWKT(w),l=TGOS.TWD97toWGS84(l.x,l.y),A=new TGOS.TGPoint(l.x,l.y);break;case "EPSG3826":A=TGOS.parsePointWKT(w);break;case "EPSG3825":l=TGOS.parsePointWKT(w),l=TGOS.TWD97toTWD97_119(l.x,l.y),A=new TGOS.TGPoint(l.x,l.y)}h.fieldAttr.push(p);h.position.push(A)}e.call(this,h,"OK",C,a);TGOS.Log("web","A09",TGOS.ThemeLayerID[b])}else e.call(this,null,"ZERO_RESULTS",0,0)})}};
TGOS.TGPointBuffer=function(){this.identify=function(b,d,a,f,e){if(a.position instanceof TGOS.TGPoint&&"number"==typeof a.distance){new TGOS.TGPoint(0,0);new TGOS.TGPoint(0,0);new TGOS.TGPoint(0,0);new TGOS.TGPoint(0,0);var g={fieldAttr:[],position:[]},h=null;switch(f){case "EPSG3857":h=TGOS.WGS84toTWD97(a.position.x,a.position.y);break;case "EPSG3826":h=new TGOS.TGPoint(a.position.x,a.position.y);break;case "EPSG3825":h=TGOS.WGS84toTWD97_119(a.position.x,a.position.y)}var k=TGOS.QUERY_SERVICE+"?op=pb",
k=k+("&layer="+TGOS.MapIdInfo[b].layers[d].name),k=k+("&res="+TGOS.MapIdInfo[b].resource),k=k+("&cx="+h.x),k=k+("&cy="+h.y),k=k+("&range="+a.distance);TGOS.getJSON(k,function(a){var h="";if(a&&a.error)e.call(this,null,"REQUEST_DENIED");else if(a){a=a.Feature;var k=null,n=null,u=[],s;for(s in TGOS.MapIdInfo[b].layers[d].buffer)h=h+s+",";g.fieldName=h;if("undefined"==typeof a.length){u=[];k=a.Values;n=a.Geometry;switch(f){case "EPSG3857":var q=TGOS.parsePointWKT(n),q=TGOS.TWD97toWGS84(q.x,q.y),q=new TGOS.TGPoint(q.x,
q.y);break;case "EPSG3826":q=TGOS.parsePointWKT(n);break;case "EPSG3825":q=TGOS.parsePointWKT(n),q=TGOS.TWD97toTWD97_119(q.x,q.y),q=new TGOS.TGPoint(q.x,q.y)}for(s in TGOS.MapIdInfo[b].layers[d].buffer){var w=k[TGOS.MapIdInfo[b].layers[d].buffer[s]];u.push(w)}g.position.push(q);g.fieldAttr.push(u)}else for(h=0;h<a.length;h++){u=[];k=a[h].Values;n=a[h].Geometry;for(s in TGOS.MapIdInfo[b].layers[d].buffer)w=k[TGOS.MapIdInfo[b].layers[d].buffer[s]],u.push(w);switch(f){case "EPSG3857":q=TGOS.parsePointWKT(n);
q=TGOS.TWD97toWGS84(q.x,q.y);q=new TGOS.TGPoint(q.x,q.y);break;case "EPSG3826":q=TGOS.parsePointWKT(n);break;case "EPSG3825":q=TGOS.parsePointWKT(n),q=TGOS.TWD97toTWD97_119(q.x,q.y),q=new TGOS.TGPoint(q.x,q.y)}g.position.push(q);g.fieldAttr.push(u)}e.call(this,g,"OK");TGOS.Log("web","A10",TGOS.ThemeLayerID[b])}else e.call(this,null,"ZERO_RESULTS")})}else e.call(this,null,"INVALID_REQUEST")}};
TGOS.TGKmlQuery=function(){this.identify=function(b,d,a,f){if(!(b in TGOS.TGMapServiceId))throw"Invalid TGMapServiceId";if(!(d in TGOS.TGMapId))throw"Invalid mapID";var e=TGOS.TGKML_ATTR_SERVICE,e=util.appendQStr(e,"TGMapServiceId",b),e=util.appendQStr(e,"TGMapId",d);"string"==typeof a.county&&(e=util.appendQStr(e,"County",a.county));"string"==typeof a.town&&(e=util.appendQStr(e,"Town",a.town));"string"==typeof a.keyword&&(e=util.appendQStr(e,"Keyword",a.keyword));f&&f.call(this,[{kmlUrl:e}],"OK")}};
TGOS.TGKmlBuffer=function(b){this.identify=function(b,a,f,e){if(!(b in TGOS.TGMapServiceId))throw"Invalid TGMapServiceId";if(!(a in TGOS.TGMapId))throw"Invalid mapID";var g=TGOS.TGKML_BUFFER_SERVICE,g=util.appendQStr(g,"TGMapServiceId",b);switch(f.coordSys){case "3826":break;case "4326":break;default:throw"Invalid CoordSys";}g=util.appendQStr(g,"EPSG",f.coordSys);g=util.appendQStr(g,"TGMapId",a);if(!util.isFloat(f.pointX))throw"Invalid pointX";g=util.appendQStr(g,"PointX",f.pointX);if(!util.isFloat(f.pointY))throw"Invalid pointY";
g=util.appendQStr(g,"PointY",f.pointY);if(!util.isFloat(f.distance))throw"Invalid distance";g=util.appendQStr(g,"Distance",f.distance);e&&e.call(this,[{kmlUrl:g}],"OK")}};
TGOS.TGPoiBuffer=function(){this.identify=function(b,d,a,f){if(d.position instanceof TGOS.TGPoint&&"number"==typeof d.distance){new TGOS.TGPoint(0,0);new TGOS.TGPoint(0,0);new TGOS.TGPoint(0,0);new TGOS.TGPoint(0,0);var e={fieldAttr:[],position:[]},g=null;switch(a){case "EPSG3857":g=TGOS.WGS84toTWD97(d.position.x,d.position.y);break;case "EPSG3826":g=new TGOS.TGPoint(d.position.x,d.position.y);break;case "EPSG3825":g=TGOS.WGS84toTWD97_119(d.position.x,d.position.y)}var h=TGOS.QUERY_SERVICE+"?op=poib",
h=h+("&kind="+b)+("&cx="+g.x),h=h+("&cy="+g.y),h=h+("&range="+d.distance);TGOS.getJSON(h,function(b){var d="";if(b&&b.error)f.call(this,null,"REQUEST_DENIED");else if(b){b=b.Feature;var g=null,h=null,n=[],u;for(u in TGOS.KindInfo.buffer)d=d+u+",";e.fieldName=d;if("undefined"==typeof b.length){n=[];g=b.Values;h=b.Geometry;switch(a){case "EPSG3857":var s=TGOS.parsePointWKT(h),s=TGOS.TWD97toWGS84(s.x,s.y),s=new TGOS.TGPoint(s.x,s.y);break;case "EPSG3826":s=TGOS.parsePointWKT(h);break;case "EPSG3825":s=
TGOS.parsePointWKT(h),s=TGOS.TWD97toTWD97_119(s.x,s.y),s=new TGOS.TGPoint(s.x,s.y)}for(u in TGOS.KindInfo.buffer){var q=g[TGOS.KindInfo.buffer[u]];n.push(q)}e.position.push(s);e.fieldAttr.push(n)}else for(d=0;d<b.length;d++){n=[];g=b[d].Values;h=b[d].Geometry;for(u in TGOS.KindInfo.buffer)q=g[TGOS.KindInfo.buffer[u]],n.push(q);switch(a){case "EPSG3857":s=TGOS.parsePointWKT(h);s=TGOS.TWD97toWGS84(s.x,s.y);s=new TGOS.TGPoint(s.x,s.y);break;case "EPSG3826":s=TGOS.parsePointWKT(h);break;case "EPSG3825":s=
TGOS.parsePointWKT(h),s=TGOS.TWD97toTWD97_119(s.x,s.y),s=new TGOS.TGPoint(s.x,s.y)}e.position.push(s);e.fieldAttr.push(n)}f.call(this,e,"OK")}else f.call(this,null,"ZERO_RESULTS")})}else f.call(this,null,"INVALID_REQUEST")}};
TGOS.TGPoiLayer=function(){var b="";this.getPoiLayer=function(d,a,f,e){var g={fieldAttr:[],position:[]};b=a.map;var h="",k=!0;if(null!=b&&void 0!==b)switch(h=b.getLevel(),f){case "EPSG3857":k=14<=h?!0:!1;break;case "EPSG3826":k=9<=h?!0:!1;break;case "EPSG3825":k=9<=h?!0:!1}h=TGOS.QUERY_SERVICE+"?op=poilayer";h=h+("&kind="+d)+("&Left="+a.left);h+="&Top="+a.top;h+="&Right="+a.right;h+="&Bottom="+a.bottom;k&&TGOS.getJSON(h,function(a){var b="";if(a&&a.error)e.call(this,null,"REQUEST_DENIED");else if(a){a=
a.Feature;var d=null,h=null,k=[],s;for(s in TGOS.KindInfo.buffer)b=b+s+",";g.fieldName=b;if("undefined"==typeof a.length){k=[];d=a.Values;h=a.Geometry;switch(f){case "EPSG3857":var q=TGOS.parsePointWKT(h),q=TGOS.TWD97toWGS84(q.x,q.y),q=new TGOS.TGPoint(q.x,q.y);break;case "EPSG3826":q=TGOS.parsePointWKT(h);break;case "EPSG3825":q=TGOS.parsePointWKT(h),q=TGOS.TWD97toTWD97_119(q.x,q.y),q=new TGOS.TGPoint(q.x,q.y)}for(s in TGOS.KindInfo.buffer){var w=d[TGOS.KindInfo.buffer[s]];k.push(w)}g.position.push(q);
g.fieldAttr.push(k)}else for(b=0;b<a.length;b++){k=[];d=a[b].Values;h=a[b].Geometry;for(s in TGOS.KindInfo.buffer)w=d[TGOS.KindInfo.buffer[s]],k.push(w);switch(f){case "EPSG3857":q=TGOS.parsePointWKT(h);q=TGOS.TWD97toWGS84(q.x,q.y);q=new TGOS.TGPoint(q.x,q.y);break;case "EPSG3826":q=TGOS.parsePointWKT(h);break;case "EPSG3825":q=TGOS.parsePointWKT(h),q=TGOS.TWD97toTWD97_119(q.x,q.y),q=new TGOS.TGPoint(q.x,q.y)}g.position.push(q);g.fieldAttr.push(k)}e.call(this,g,"OK")}else e.call(this,null,"ZERO_RESULTS")})}};
TGOS.TGPoiNear=function(){this.identify=function(b,d,a,f){if(d.position instanceof TGOS.TGPoint){var e={fieldAttr:[],position:[]},g=TGOS.QUERY_SERVICE+"?op=poinear",g=g+("&kind="+b),h;switch(a){case "EPSG3857":h=new TGOS.WGS84toTWD97(d.position.x,d.position.y);break;case "EPSG3826":h=new TGOS.TGPoint(d.position.x,d.position.y);break;case "EPSG3825":h=new TGOS.TWD97_119toTWD97(d.position.x,d.position.y)}g+="&cx="+h.x;g+="&cy="+h.y;TGOS.getJSON(g,function(b){var d="";if(b&&b.error)f.call(this,null,
"REQUEST_DENIED");else if(b){b=b.Feature;var g=null,h=null,n=[],u;for(u in TGOS.KindInfo.buffer)d=d+u+",";e.fieldName=d;if("undefined"==typeof b.length){n=[];g=b.Values;h=b.Geometry;switch(a){case "EPSG3857":var s=TGOS.parsePointWKT(h),s=TGOS.TWD97toWGS84(s.x,s.y),s=new TGOS.TGPoint(s.x,s.y);break;case "EPSG3826":s=TGOS.parsePointWKT(h);break;case "EPSG3825":s=TGOS.parsePointWKT(h),s=TGOS.TWD97toTWD97_119(s.x,s.y),s=new TGOS.TGPoint(s.x,s.y)}for(u in TGOS.KindInfo.buffer){var q=g[TGOS.KindInfo.buffer[u]];
n.push(q)}e.position.push(s);e.fieldAttr.push(n)}else for(d=0;d<b.length;d++){n=[];g=b[d].Values;h=b[d].Geometry;for(u in TGOS.KindInfo.buffer)q=g[TGOS.KindInfo.buffer[u]],n.push(q);switch(a){case "EPSG3857":s=TGOS.parsePointWKT(h);s=TGOS.TWD97toWGS84(s.x,s.y);s=new TGOS.TGPoint(s.x,s.y);break;case "EPSG3826":s=TGOS.parsePointWKT(h);break;case "EPSG3825":s=TGOS.parsePointWKT(h),s=TGOS.TWD97toTWD97_119(s.x,s.y),s=new TGOS.TGPoint(s.x,s.y)}e.position.push(s);e.fieldAttr.push(n)}f.call(this,e,"OK")}else f.call(this,
null,"ZERO_RESULTS")})}else f.call(this,null,"INVALID_REQUEST")}};var util=util||{info:"utility class"};util.isInt=function(b){return!isNaN(parseInt(b))};util.isUInt=function(b){return!isNaN(parseInt(b))||0<=parseInt(b)};util.isFloat=function(b){return!isNaN(parseFloat(b))};util.appendQStr=function(b,d,a){b||(b="");return b=-1<b.indexOf("?")?b.concat("&"+d+"="+a):b.concat("?"+d+"="+a)};
util.parsePolyWkt=function(b){var d=/^\s*\(?(.*?)\)?\s*$/,a=/\s+/,f=/\s*,\s*/,e=/\)\s*,\s*\(/,g=function(b){var d=[];b=b.split(f);for(var e=0;e<b.length;e++){var g=b[e].split(a),h=parseFloat(g[0]),g=parseFloat(g[1]);isNaN(h)||isNaN(g)||(h=new TGOS.TGPoint(h,g),d.push(h))}return d},h=[];if(0<=b.indexOf("MULTIPOLYGON"))for(b=b.replace("MULTIPOLYGON","").replace(d,"$1").replace(d,"$1"),b=b.split(e),e=0;e<b.length;e++){var k=b[e].replace(d,"$1"),k=g(k),k=new TGOS.TGLineString(k),k=new TGOS.TGLinearRing(k);
h.push(k)}else for(d=b.split(e),b=0;b<d.length;b++)k=g(d[b]),k=new TGOS.TGLineString(k),k=new TGOS.TGLinearRing(k),h.push(k);return new TGOS.TGPolygon(h)};util.decompress=function(b,d){d=Math.pow(10,-d);for(var a=b.length,f=0,e=0,g=0,h=[];f<a;){var k,l=0,p=0;do k=b.charCodeAt(f++)-63,p|=(k&31)<<l,l+=5;while(32<=k);e+=p&1?~(p>>1):p>>1;p=l=0;do k=b.charCodeAt(f++)-63,p|=(k&31)<<l,l+=5;while(32<=k);g+=p&1?~(p>>1):p>>1;h.push(e*d);h.push(g*d)}return h};TGOS.TGAddressStatus={ERROR:"ERROR",INVALID_REQUEST:"INVALID_REQUEST",OK:"OK",ZERO_RESULTS:"ZERO_RESULTS"};
TGOS.TGAddress=function(){return function(){this.nearestAddress=function(b,d,a){if(!(b instanceof TGOS.TGPoint))throw"Must be a Point @nearestAddress";var f="EPSG:3826";switch(d){case TGOS.TGCoordSys.EPSG3857:f="EPSG:4326";break;case TGOS.TGCoordSys.EPSG3826:f="EPSG:3826";break;case TGOS.TGCoordSys.EPSG3825:f="EPSG:3825"}TGOS.getJSON(TGOS.ADDRESSLOCATE_SERVICE+"?op=PointQueryNearAddr&oAPPId="+TGOS.APPID+"&oAPIKey="+TGOS.APIKey+"&oSRS="+f+"&oResultDataType=jsonp&oPX="+b.x+"&oPY="+b.y,function(b){b=
b.AddressList;0>=b.length?a.call(this,null,TGOS.TGAddressStatus.ZERO_RESULTS):(b=b[0],b={formattedAddress:b.FULL_ADDR,addressComponents:{county:b.COUNTY,town:b.TOWN,village:b.VILLAGE,neighborhood:b.NEIGHBORHOOD,road:b.ROAD,section:b.SECTION,lane:b.LANE,alley:b.ALLEY,sub_alley:b.SUB_ALLEY,tong:b.TONG,number:b.NUMBER},geometry:{bounds:new TGOS.TGEnvelope(b.X,b.Y,b.X,b.Y),location:new TGOS.TGPoint(b.X,b.Y)}},a.call(this,b,TGOS.TGAddressStatus.OK),TGOS.Log("web","A18",""))},null,null)}}}();TGOS.TGMileageType={HIGHWAY:"HIGHWAY",EXPRESSWAY:"EXPRESSWAY",PROVINCEWAY:"PROVINCEWAY",TRA:"TRA",HSR:"HSR"};TGOS.TGDirectionType={N:"N",E:"E",S:"S",W:"W"};TGOS.TGLocatorType={STREET_ADDRESS:"address",INTERPOLATED:"address",ROUTE:"road",COORD:"coord",POI:"poi",INTERSECTION:"roadcross"};
TGOS.COUNTYCODES={"09007":"\u9023\u6c5f\u7e23","09020":"\u91d1\u9580\u7e23",10002:"\u5b9c\u862d\u7e23",10004:"\u65b0\u7af9\u7e23",10005:"\u82d7\u6817\u7e23",10007:"\u5f70\u5316\u7e23",10008:"\u5357\u6295\u7e23",10009:"\u96f2\u6797\u7e23",10010:"\u5609\u7fa9\u7e23",10013:"\u5c4f\u6771\u7e23",10014:"\u81fa\u6771\u7e23",10015:"\u82b1\u84ee\u7e23",10016:"\u6f8e\u6e56\u7e23",10017:"\u57fa\u9686\u5e02",10018:"\u65b0\u7af9\u5e02",10020:"\u5609\u7fa9\u5e02",63E3:"\u81fa\u5317\u5e02",64E3:"\u9ad8\u96c4\u5e02",
65E3:"\u65b0\u5317\u5e02",66E3:"\u81fa\u4e2d\u5e02",67E3:"\u81fa\u5357\u5e02",68E3:"\u6843\u5712\u5e02"};
TGOS.TGLocate=function(){var b=function(a){if(!a)return"";for(var b in TGOS.COUNTYCODES)if(a.replace("\u53f0","\u81fa")==TGOS.COUNTYCODES[b])return b},d=TGOS.LOCATOR_SERVICE,a=getWebProtocal()+getServicePath()+"TGLocator/TGLocator.ashx",f=function(){};f.prototype.buildDescription=function(a,b,d,f){var l="",p="",m="";switch(a){case TGOS.TGMileageType.HIGHWAY:l="\u570b\u9053";break;case TGOS.TGMileageType.EXPRESSWAY:l="\u5feb\u901f\u9053\u8def";break;case TGOS.TGMileageType.PROVINCEWAY:l="\u7701\u9053";
break;case TGOS.TGMileageType.TRA:l="\u53f0\u9435";break;case TGOS.TGMileageType.HSR:l="\u9ad8\u9435"}m=a==TGOS.TGMileageType.HSR?m+l:m+(l+f);if(a==TGOS.TGMileageType.HIGHWAY){switch(b){case TGOS.TGDirectionType.E:p="\u6771\u5411";break;case TGOS.TGDirectionType.W:p="\u897f\u5411";break;case TGOS.TGDirectionType.S:p="\u5357\u5411";break;case TGOS.TGDirectionType.N:p="\u5317\u5411"}m+=","+p}return m+(","+d+"\u516c\u91cc")};f.prototype.calcViewport=function(a,b,d){switch(d){case TGOS.TGCoordSys.EPSG3857:b=
TGOS.WGS84ToGoo(a,b);a=TGOS.GooToWGS84(b.x-500,b.y+500);b=TGOS.GooToWGS84(b.x+500,b.y-500);a=new TGOS.TGEnvelope(a.x,a.y,b.x,b.y);break;default:a=new TGOS.TGEnvelope(a-500,b+500,a+500,b-500)}return a};f.prototype.buildGeometry=function(a,b){var d=new TGOS.TGPoint,f;switch(b){case TGOS.TGCoordSys.EPSG3826:d.x=a.TWD97X||a["97X"];d.y=a.TWD97Y||a["97Y"];break;case TGOS.TGCoordSys.EPSG3857:d.x=a.Lng;d.y=a.Lat;break;case TGOS.TGCoordSys.EPSG3825:x97=a.TWD97X||a["97X"],y97=a.TWD97Y||a["97Y"],f=TGOS.TWD97toTWD97_119(x97,
y97),d.x=f.x,d.y=f.y}f=this.calcViewport(d.x,d.y,b);return{location:d,bounds:new TGOS.TGEnvelope(d.x,d.y,d.x,d.y),viewport:f}};f.prototype.complexLocate=function(b,d,f){var k=this,l=b.requestText,p=b.town,m=b.county,n=b.geometryInfo,u=b.pageNumber;b=b.center;var s;switch(d){case TGOS.TGCoordSys.EPSG3826:s="EPSG:3826";break;case TGOS.TGCoordSys.EPSG3857:s="EPSG:4326"}l=a+"?format=jsonp&input="+l+"&srs="+s;m&&(l+="&county="+m);p&&(l+="&town="+p);l+=n?"&ignoreGeometry=false":"&ignoreGeometry=true";"number"==
typeof u&&(l+="&pnum="+u);b instanceof TGOS.TGPoint&&!isNaN(b.x)&&!isNaN(b.y)&&(l+="&center="+b.x+","+b.y);TGOS.getJSON(l,function(a){var b=a.status,e=a.results,l=a.featureCount,m=a.pages,p=[];if("OK"==b||"TOO_MANY_RESULTS"==b)for(var n=0;n<e.length;n++){a=e[n];var s={county:a.county,town:a.town,type:a.type,name:a.name};"address"==a.type&&(s.addressComponents={county:a.COUNTY,town:a.TOWN,village:a.VILLAGE,neighborhood:a.NEIGHBORHOOD,road:a.ROAD,section:a.SECTION,lane:a.LANE,alley:a.ALLEY,sub_alley:a.SUB_ALLEY,
number:a.NUMBER});"roadcross"==a.type&&(s.firstRoad=a.NAME1,s.secondRoad=a.NAME2);a.geometry&&(s.geometry={location:new TGOS.TGPoint(a.geometry.x,a.geometry.y),locatorLocation:null,viewport:k.calcViewport(a.geometry.x,a.geometry.y,d),bounds:null});p.push(s)}f&&f.call(k,p,b,l,m);TGOS.Log("web","A17","")})};f.prototype.intersection=function(a,b,d){this.roadCross.call(this,{firstRoad:a.roadName,secondRoad:"",county:a.county,town:a.town,pageNumber:a.pageNumber,geometryInfo:a.geometryInfo,center:a.center},
b,d)};f.prototype.roadCross=function(d,f,h){var k=this,l=d.firstRoad,p=b(d.firstCounty),m=d.county,n=d.firstTown,u=d.secondRoad,s=b(d.secondCounty),q=d.secondTown,w="number"==typeof d.pageNumber?d.pageNumber:1,C=d.center;d=d.geometryInfo;switch(f){case TGOS.TGCoordSys.EPSG3826:mCoordSys="EPSG:3826";break;case TGOS.TGCoordSys.EPSG3857:mCoordSys="EPSG:4326"}l=a+"?types=roadcross&input="+l+" "+u+"&srs="+mCoordSys+"&format=jsonp";"number"==typeof w&&(l+="&pnum="+w);"string"==typeof m&&(l+="&county="+
m);"string"==typeof p&&(l+="&county1="+p);"string"==typeof n&&(l+="&firstTown="+n);"string"==typeof s&&(l+="&county2="+s);"string"==typeof q&&(l+="&secondTown="+q);C instanceof TGOS.TGPoint&&!isNaN(C.x)&&!isNaN(C.y)&&(l+="&center="+C.x+","+C.y);TGOS.getJSON(l+(d?"&ignoreGeometry=false":"&ignoreGeometry=true"),function(a){var b=a.status,d=a.results,e=a.featureCount,l=a.pages,m=[];if("OK"==b||"TOO_MANY_RESULTS"==b)for(var p=0;p<d.length;p++){a=d[p];var n={county:a.county,town:a.town,type:a.type,name:a.name};
"roadcross"==a.type&&(n.firstRoad=a.NAME1,n.secondRoad=a.NAME2);a.geometry&&(n.geometry={location:new TGOS.TGPoint(a.geometry.x,a.geometry.y),locatorLocation:null,viewport:k.calcViewport(a.geometry.x,a.geometry.y,f),bounds:null});m.push(n)}h&&h.call(k,m,b,e,l);TGOS.Log("web","A17","")})};f.prototype.mileage=function(a,b,f){var k=this,l=a.mileageType,p=a.roadCode,m=a.directionType,n=a.mileageNum;a=d+"?op=mileage&mt="+l.toLowerCase()+"&dt="+m+"&rc="+p+"&mn="+n;TGOS.getJSON(a,function(a){var d="";a&&
a.Table?0>=a.Table.length?(d=TGOS.TGLocatorStatus.ZERO_RESULTS,f.call(k,null,null,d)):(d=k.buildDescription(l,m,n,a.Table[0].Number),a=k.buildGeometry(a.Table[0],b),f&&f.call(k,d,a,"OK"),TGOS.Log("web","A17","")):(d=TGOS.TGLocatorStatus.ERROR,f.call(k,null,null,d))})};return f}();(function(){var b=["Document","Folder","Placemark"];TGOS.TGKmlLayerOption=function(){this.suppressInfoWindows=this.preserveViewport=this.map=null;this.markerFitImageSize=!1};TGOS.TGKmlLayerMetaData=function(){this.snippet=this.name=this.description=this.author=null};TGOS.KmlMouseEvent=function(){this.pixelOffset=this.point=this.feature=null};TGOS.KmlFeatureData=function(){this.snippet=this.name=this.description=this.author=null};TGOS.KmlAuthor=function(){this.uri=this.name=this.email=null};TGOS.TGKmlLayerStatus=
{DOCUMENT_NOT_FOUND:"DOCUMENT_NOT_FOUND",DOCUMENT_TOO_LARGE:"DOCUMENT_TOO_LARGE",FETCH_ERROR:"FETCH_ERROR",INVALID_DOCUMENT:"INVALID_DOCUMENT",INVALID_REQUEST:"INVALID_REQUEST",LIMITS_EXCEEDED:"LIMITS_EXCEEDED",OK:"OK",TIMED_OUT:"TIMED_OUT",UNKNOWN:"UNKNOWN"};TGOS.TGKmlLayer=function(d,a,f){var e=this,g=a.map,h=!1,k,l="auto",p=!0;a&&(void 0!==a.zIndex&&"number"==typeof a.zIndex&&(l=a.zIndex),void 0!==a.visible&&"boolean"==typeof a.visible&&(p=a.visible),void 0!==a.independentContainer&&"boolean"==
typeof a.independentContainer&&(h=a.independentContainer,!0==h&&(k=g.addIndependentContainer("KML",this))));var m=g.getCoordSys(),n={author:{email:"",name:"",uri:""},description:"",name:"",snippet:""},u,s=new TGOS.TGInfoWindow("",null,{pixelOffset:new TGOS.TGSize(0,0)}),q=null,w=a.markerFitImageSize;this.overlays=[];this.points=[];this.polygons=[];this.polylines=[];this.groundoverlays=[];this.icons=[];this.getDefaultViewport=function(){if(!q){for(var a=Infinity,b=-Infinity,d=-Infinity,e=Infinity,
f=0;f<this.overlays.length;f++)var g=this.overlays[f].getBounds(),a=Math.min(a,g.left),e=Math.min(e,g.bottom),b=Math.max(b,g.right),d=Math.max(d,g.top);for(f=0;f<this.polylines.length;f++)g=this.polylines[f].getPath().getEnvelope(),a=Math.min(a,g.left),e=Math.min(e,g.bottom),b=Math.max(b,g.right),d=Math.max(d,g.top);for(f=0;f<this.groundoverlays.length;f++)g=this.groundoverlays[f].getBounds(),a=Math.min(a,g.left),e=Math.min(e,g.bottom),b=Math.max(b,g.right),d=Math.max(d,g.top);for(f=0;f<this.polygons.length;f++)g=
this.polygons[f].getBounds(),a=Math.min(a,g.left),e=Math.min(e,g.bottom),b=Math.max(b,g.right),d=Math.max(d,g.top);for(g=0;g<this.points.length;g++)f=this.points[g].getPosition(),a=Math.min(a,f.x),e=Math.min(e,f.y),b=Math.max(b,f.x),d=Math.max(d,f.y);if(!(isFinite(a)&&isFinite(d)&&isFinite(b)&&isFinite(e)))return null;q=new TGOS.TGEnvelope(a,d,b,e)}return q};this.getMetadata=function(){return n};this.getStatus=function(){return u};this.removeMap=function(){g=null};this.parseCoordinates=function(a,
b){var d=a;d&&(d=d.trim());var e=[];if(d){for(var f=d.split(/\s*[,]\s*/),d=[[]],g=d[0],h=0;h<f.length;h++)if(f[h].match(/\s+/)){var k=f[h].split(/\s+/);g.push(parseFloat(k[0]));d.push(g);g=[parseFloat(k[1])];d.push(g)}else g.push(parseFloat(f[h]));g=f=NaN;for(h=0;h<d.length;h++){switch(b){case "EPSG3826":var l=TGOS.WGS84toTWD97(d[h][0],d[h][1]);break;case "EPSG3825":l=TGOS.WGS84toTWD97_119(d[h][0],d[h][1]);break;case "EPSG3857":l={x:d[h][0],y:d[h][1]}}l.x&&l.y&&(l.x!=f||l.y!=g)&&(e.push(new TGOS.TGPoint(l.x,
l.y)),f=l.x,g=l.y)}}return e};this.setZIndex=function(a){l=a;for(a=0;a<this.polygons.length;a++)this.polygons[a].setZIndex(l,!1);for(a=0;a<this.polylines.length;a++)this.polylines[a].setZIndex(l,!1);for(a=0;a<this.groundoverlays.length;a++)this.groundoverlays[a].setZIndex(l,!1);for(var b=0;b<this.points.length;b++)this.points[a].setZIndex(l,!1)};this.getZIndex=function(){return l};this.createPoint=function(a){switch(m){case "EPSG3826":var b=this.parseCoordinates(a.coordinates,"EPSG3826");break;case "EPSG3825":b=
this.parseCoordinates(a.coordinates,"EPSG3825");break;case "EPSG3857":b=this.parseCoordinates(a.coordinates,"EPSG3857")}if(!(1>b.length))return b[0]};this.parseRing=function(a,b){switch(b){case "EPSG3826":var d=this.parseCoordinates(a.coordinates,"EPSG3826");break;case "EPSG3825":d=this.parseCoordinates(a.coordinates,"EPSG3825");break;case "EPSG3857":d=this.parseCoordinates(a.coordinates,"EPSG3857")}d=new TGOS.TGLineString(d);return new TGOS.TGLinearRing(d)};this.createPolygon=function(a){var b=[],
d=this.parseRing(a.outerBoundaryIs.LinearRing,m);b.push(d);var e=a.innerBoundaryIs;if(e)if(e.length)for(var f=0;f<e.length;f++)if(e[f].LinearRing.length)for(a=0;a<e[f].LinearRing.length;a++)d=this.parseRing(e[f].LinearRing[a],m),b.push(d);else d=this.parseRing(e[f].LinearRing,m),b.push(d);else if(e.LinearRing)if(e=e.LinearRing,e.length)for(a=0;a<e.length;a++)d=this.parseRing(e[a],m),b.push(d);else d=this.parseRing(e,m),b.push(d);else d=this.parseRing(e.LinearRing,m),b.push(d);return new TGOS.TGPolygon(b)};
this.createPolyLine=function(a){switch(m){case "EPSG3826":var b=this.parseCoordinates(a.coordinates,"EPSG3826");break;case "EPSG3825":b=this.parseCoordinates(a.coordinates,"EPSG3825");break;case "EPSG3857":b=this.parseCoordinates(a.coordinates,"EPSG3857")}return new TGOS.TGLineString(b)};this.handleGroundOverlay=function(b){function d(b){var f=new TGOS.TGImage(b.Icon.href);switch(m){case "EPSG3826":var h=TGOS.WGS84toTWD97(parseFloat(b.LatLonBox.west),parseFloat(b.LatLonBox.north));b=TGOS.WGS84toTWD97(parseFloat(b.LatLonBox.east),
parseFloat(b.LatLonBox.south));var k=h.x,h=h.y,l=b.x,t=b.y;break;case "EPSG3825":h=TGOS.WGS84toTWD97_119(parseFloat(b.LatLonBox.west),parseFloat(b.LatLonBox.north));b=TGOS.WGS84toTWD97_119(parseFloat(b.LatLonBox.east),parseFloat(b.LatLonBox.south));k=h.x;h=h.y;l=b.x;t=b.y;break;case "EPSG3857":k=parseFloat(b.LatLonBox.west),h=parseFloat(b.LatLonBox.north),l=parseFloat(b.LatLonBox.east),t=parseFloat(b.LatLonBox.south)}k=new TGOS.TGEnvelope(k,h,l,t);f=new TGOS.TGGroundOverlay(g,f,k,1);TGOS.TGEvent.addListener(f,
"click",B);TGOS.TGEvent.addListener(f,"mousedown",H);TGOS.TGEvent.addListener(f,"mouseup",A);TGOS.TGEvent.addListener(f,"mousemove",I);TGOS.TGEvent.addListener(f,"mouseout",D);TGOS.TGEvent.addListener(f,"dblclick",J);TGOS.TGEvent.addListener(f,"rightclick",K);a.suppressInfoWindows||TGOS.TGEvent.addListener(f,"click",C);e.groundoverlays.push(f)}if(b.length)for(var f=0;f<b.length;f++)d(b[f]);else d(b)};this.handleNetworkLink=function(a){var b="";if(a.length)for(var d=0;d<a.length;d++){if(a[d].hasOwnProperty("Url"))b=
a[d].Url.href;else if(a[d].hasOwnProperty("Link"))b=a[d].Link.href;else continue;if(-1==b.indexOf(".kmz")){var f=TGOS.PROXY_SERVICE2;DEBUG_MODE&&(f=TGOS.PROXY_LOCAL);TGOS.getJSON(b,function(a){a.error||e.parseKML(a.kml)},f)}}else{if(a.hasOwnProperty("Url"))b=a.Url.href;else if(a.hasOwnProperty("Link"))b=a.Link.href;else return;-1==b.indexOf(".kmz")&&TGOS.getJSON(b,function(a){a.error||e.parseKML(a.kml)},TGOS.PROXY_SERVICE2)}};this.handleDescription=function(a){};this.handleAuthor=function(a){a.hasOwnProperty("atom:name")&&
(n.author.name=a["atom:name"]);a.hasOwnProperty("atom:link")&&(n.author.uri=a["atom:link"]["@href"])};this.handleMultiGeometry=function(a){var b=[],d;for(d in a)switch(d){case "Point":if(a.Point.length)for(var e=0;e<a.Point.length;e++){var f=this.createPoint(a.Point[e]);f&&b.push(f)}else this.createPoint(a.Point),(f=this.createPoint(a.Point))&&b.push(f);break;case "Polygon":if(a.Polygon.length)for(e=0;e<a.Polygon.length;e++)(f=this.createPolygon(a.Polygon[e]))&&b.push(f);else(f=this.createPolygon(a.Polygon))&&
b.push(f);break;case "LineString":if(a.LineString.length)for(e=0;e<a.LineString.length;e++)(f=this.createPolyLine(a.LineString[e]))&&b.push(f);else(f=this.createPolyLine(a.LineString))&&b.push(f);break;case "MultiGeometry":if(a.MultiGeometry.length)for(e=0;e<a.MultiGeometry.length;e++)(f=this.handleMultiGeometry(a.MultiGeometry[e]))&&(b=b.concat(f));else(f=this.handleMultiGeometry(a.MultiGeometry))&&(b=b.concat(f))}return b};this.parseGeometry=function(a){var b=[];a.hasOwnProperty("Point")?(a=this.createPoint(a.Point))&&
b.push(a):a.hasOwnProperty("Polygon")?(a=this.createPolygon(a.Polygon))&&b.push(a):a.hasOwnProperty("LineString")?(a=this.createPolyLine(a.LineString))&&b.push(a):a.hasOwnProperty("MultiGeometry")&&(a=this.handleMultiGeometry(a.MultiGeometry,a))&&(b=b.concat(a));return b};this.createRandomColor=function(){return{r:parseInt(255*Math.random()),g:parseInt(255*Math.random()),b:parseInt(255*Math.random())}};this.parseKmlColor=function(a,b,d){b=parseInt(a.substring(0,2),16);var e=parseInt(a.substring(2,
4),16),f=parseInt(a.substring(4,6),16),g=parseInt(a.substring(6,8),16);"random"==d&&("ffffffff"==a?(a=this.createRandomColor(),e=a.b,g=a.r,f=a.g):(e*=Math.random(),f*=Math.random(),g*=Math.random()));return{a:parseFloat(b/255),b:parseInt(e),g:parseInt(f),r:parseInt(g)}};this.matchStyleMap=function(a,b,d,e){if(d&&b&&a){var f="normal";e&&(f=e);d=d.replace("#","");e=null;if(a instanceof Array)for(var g=0;g<a.length;g++){if(a[g]["@id"]==d){var h=a[g].Pair;if(h)for(var k=0;k<h.length;k++)if(h[k].key==
f){e=h[k].styleUrl;break}if(null!=e)break}}else if(a["@id"]==d&&(h=a.Pair))for(k=0;k<h.length;k++)if(h[k].key==f){e=h[k].styleUrl;break}return this.matchSharedStyle(b,e)}};this.matchSharedStyle=function(a,b){if(b&&a)if(b=b.replace("#",""),a instanceof Array)for(var d=0;d<a.length;d++){if(a[d]["@id"]==b)return a[d]}else if(a["@id"]==b)return a};this.createStyle=function(a,b){var d={match:!1,fillColor:{a:null,r:null,g:null,b:null,o:null},lineWidth:null,lineColor:{a:null,r:null,g:null,b:null},iconLink:null,
iconScale:1,iconHotSpot:{x:null,y:null,xunits:null,yunits:null}};if(a){d.match=!0;if(a.PolyStyle){if(a.PolyStyle.color){var e=this.parseKmlColor(a.PolyStyle.color,b,a.PolyStyle.colorMode);d.fillColor=e}"0"==a.PolyStyle.fill&&(d.fillColor.a=0);d.fillColor.o="0"==a.PolyStyle.outline?0:1}a.LineStyle&&(a.LineStyle.color&&(e=this.parseKmlColor(a.LineStyle.color,b,a.LineStyle.colorMode),d.lineColor=e),"string"==typeof a.LineStyle.width&&(d.lineWidth=parseFloat(a.LineStyle.width)));a.IconStyle&&(a.IconStyle.Icon&&
a.IconStyle.Icon.href&&(d.iconLink=a.IconStyle.Icon.href),a.IconStyle.scale&&(d.iconScale=parseFloat(a.IconStyle.scale)),a.IconStyle.hotSpot&&(d.iconHotSpot.x=parseFloat(a.IconStyle.hotSpot["@x"]),d.iconHotSpot.y=parseFloat(a.IconStyle.hotSpot["@y"]),d.iconHotSpot.xunits=a.IconStyle.hotSpot["@xunits"],d.iconHotSpot.yunits=a.IconStyle.hotSpot["@yunits"]))}return d};this.colorToHex=function(a){if("number"==typeof a.r||"number"==typeof a.g||"number"==typeof a.b){var b=a.r.toString(16);16>a.r&&(b="0"+
b);var d=a.g.toString(16);16>a.g&&(d="0"+d);var e=a.b.toString(16);16>a.b&&(e="0"+e);return"#"+b+d+e}};this.handlePlacemark=function(b,d){var e=[];if(b.length)for(var f=0;f<b.length;f++){var h=this.parseGeometry(b[f]);h&&(e=e.concat(h))}else(h=this.parseGeometry(b))&&(e=e.concat(h));(f=b.inStyle?b.inStyle:this.matchSharedStyle(b.sharedStyle,b.styleUrl))||(f=this.matchStyleMap(d,b.sharedStyle,b.styleUrl));for(h=0;h<e.length;h++){var m=this.createStyle(f,h/e.length);if(e[h]instanceof TGOS.TGPolygon){var n=
new TGOS.TGFill(g,e[h],{advancedLayer:k,fillColor:this.colorToHex(m.fillColor),fillOpacity:m.fillColor.a,fillOutline:m.fillColor.o,strokeWeight:m.lineWidth,strokeColor:this.colorToHex(m.lineColor),strokeOpacity:m.lineColor.a,visible:p,zIndex:l});this.polygons.push(n)}else e[h]instanceof TGOS.TGLineString?(n=new TGOS.TGLine(g,e[h],{advancedLayer:k,strokeWeight:m.lineWidth,strokeColor:this.colorToHex(m.lineColor),strokeOpacity:m.lineColor.a,visible:p,zIndex:l}),this.polylines.push(n)):e[h]instanceof
TGOS.TGPoint&&(null!=m.iconLink?(n=new TGOS.TGImage(m.iconLink),n.setOptions({scale:m.iconScale,hotSpot:m.iconHotSpot}),n=new TGOS.TGMarker(g,e[h],b.name,n,{advancedLayer:k,visible:p,zIndex:l,flat:!0,fitImageSize:w?w:!1})):n=new TGOS.TGMarker(g,e[h],b.name,null,{advancedLayer:k,visible:p,zIndex:l}),this.points.push(n));n.targetPlacemark=b;TGOS.TGEvent.addListener(n,"mouseover",G);TGOS.TGEvent.addListener(n,"mouseout",D);TGOS.TGEvent.addListener(n,"click",B);TGOS.TGEvent.addListener(n,"mousedown",
H);TGOS.TGEvent.addListener(n,"mousemove",I);TGOS.TGEvent.addListener(n,"mouseup",A);TGOS.TGEvent.addListener(n,"dblclick",J);TGOS.TGEvent.addListener(n,"rightclick",K);a.suppressInfoWindows||TGOS.TGEvent.addListener(n,"click",C)}};this.getStyleColorById=function(a,b){if(styles)if(styles.length)for(var d=0;d<styles.length;d++){if(b.slice(1,b.length)==styles[d].id){var e=styles[d].colorMode;if("random"==e)return null;if("line"==a&&styles[d].LineStyle)return e=styles[d].LineStyle.colorMode,"random"==
e?null:{a:styles[d].LineStyle.color.slice(0,2),b:styles[d].LineStyle.color.slice(2,4),g:styles[d].LineStyle.color.slice(4,6),r:styles[d].LineStyle.color.slice(6,8)};if("poly"==a&&styles[d].PolyStyle)return e=styles[d].PolyStyle.colorMode,"random"==e?null:{a:styles[d].PolyStyle.color.slice(0,2),b:styles[d].PolyStyle.color.slice(2,4),g:styles[d].PolyStyle.color.slice(4,6),r:styles[d].PolyStyle.color.slice(6,8)}}}else{if("line"==a&&styles.LineStyle)return e=styles.LineStyle.colorMode,"random"==e?null:
{a:styles.LineStyle.color.slice(0,2),b:styles.LineStyle.color.slice(2,4),g:styles.LineStyle.color.slice(4,6),r:styles.LineStyle.color.slice(6,8)};if("poly"==a&&styles.PolyStyle)return e=styles.PolyStyle.colorMode,"random"==e?null:{a:styles.PolyStyle.color.slice(0,2),b:styles.PolyStyle.color.slice(2,4),g:styles.PolyStyle.color.slice(4,6),r:styles.PolyStyle.color.slice(6,8)}}};this.getVisible=function(){return p};this.setVisible=function(a){p=a;for(a=0;a<this.polygons.length;a++)this.polygons[a].setVisible(p);
for(a=0;a<this.polylines.length;a++)this.polylines[a].setVisible(p);for(a=0;a<this.groundoverlays.length;a++)this.groundoverlays[a].setVisible(p);for(a=0;a<this.points.length;a++)this.points[a].setVisible(p)};this.parseFeature=function(a,b){var d=a.Style?a.Style:null,e=a.StyleMap?a.StyleMap:null,f;for(f in a){var g=a[f];switch(f){case "Document":g.inStyle=d?d:null;this.Schema=g.Schema;if(g instanceof Array)for(var h=0;h<g.length;h++){var k=g[h];k.inStyle=k.Style?k.Style:null;this.parseFeature(k,g.Style)}else this.parseFeature(g,
g.Style);break;case "Folder":g.inStyle=d?d:null;if(g instanceof Array)for(h=0;h<g.length;h++)k=g[h],k.inStyle=k.Style?k.Style:null,this.parseFeature(k,b);else this.parseFeature(g,b);break;case "Placemark":g.inStyle=d?d:null;g.sharedStyle=b;if(g instanceof Array)for(h=0;h<g.length;h++)k=g[h],k.inStyle=k.Style?k.Style:null,k.sharedStyle=b,this.handlePlacemark(k,e);else g.inStyle=g.Style?g.Style:null,g.sharedStyle=b,this.handlePlacemark(g,e);break;case "GroundOverlay":this.handleGroundOverlay(g);break;
case "NetworkLink":this.handleNetworkLink(g)}}};this.parseKML=function(a){if(a)for(var d in a)if(0<=b.indexOf(d)){this.parseFeature(a[d],a[d].Style);break}};this.removeKml=function(){if(0<this.points.length)for(var a=0;a<this.points.length;a++)this.points[a].setMap(null);if(0<this.polygons.length)for(a=0;a<this.polygons.length;a++)this.polygons[a].setMap(null);if(0<this.polylines.length)for(a=0;a<this.polylines.length;a++)this.polylines[a].setMap(null);if(0<this.groundoverlays.length)for(a=0;a<this.groundoverlays.length;a++)this.groundoverlays[a].setMap(null);
this.points=[];this.polygons=[];this.polylines=[];this.groundoverlays=[];s&&s.close();this.removeAdvancedLayer();this.removeMap()};var C=function(a){if(a.target.targetPlacemark){var b="",d=a.target.targetPlacemark.name;a.target.targetPlacemark.hasOwnProperty("description")&&(b=a.target.targetPlacemark.description.hasOwnProperty("#cdata-section")?a.target.targetPlacemark.description["#cdata-section"]:a.target.targetPlacemark.description);var f="";d&&(f=f+d+"</br>");0<b.length&&(f+=b);var h=a.target.targetPlacemark.ExtendedData;
if(h){var k;if(h.Data){k=h.Data.length?h.Data:[h.Data];f+="<br><table style='border: 1px solid black;'>";for(b=0;b<k.length;b++)var l=k[b],d=l["@name"],m=l.displayName,l=l.value,f=f+"<tr>",f=f+"<td style='border: 1px solid black;'>",f=f+(m||d),f=f+"</td>",f=f+"<td style='border: 1px solid black;'>",f=f+l,f=f+"</td>",f=f+"</tr>";f+="</table>"}if(h.SchemaData)for(h=h.SchemaData.length?h.SchemaData:[h.SchemaData],k=0;k<h.length;k++){m=null;h[k].SimpleData&&(m=h[k].SimpleData.length?h[k].SimpleData:[h[k].SimpleData]);
var p="";if(e.Schema)for(d=e.Schema.length?e.Schema:[e.Schema],b=0;b<d.length;b++)if(l=d[b],l["@id"]==h[k]["@schemaUrl"].replace("#","")){p=l["@name"];break}if(m){f+="<br><table style='border: 1px solid black;'>";for(b=0;b<m.length;b++)l=m[b],d=l["@name"],l=l["#text"],f+="<tr>",f+="<td style='border: 1px solid black;'>",f+=p+":"+d,f+="</td>",f+="<td style='border: 1px solid black;' >",f+=void 0===l?"":l,f+="</td>",f+="</tr>";f+="</table>"}}}0<f.length&&(s.setContent(f),s.setPosition(a.point),s.open(g))}},
B=function(a){TGOS.TGEvent.trigger_(e,"click",{featureData:{author:n.author,description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})},H=function(a){TGOS.TGEvent.trigger_(e,"mousedown",{featureData:{author:n.author,description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})},A=function(a){TGOS.TGEvent.trigger_(e,"mouseup",{featureData:{author:n.author,description:a.target.description,name:a.target.name,
snippet:a.target.snippet},point:a.point,pixelOffset:0})},I=function(a){TGOS.TGEvent.trigger_(e,"mousemove",{featureData:{author:n.author,description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})},G=function(a){TGOS.TGEvent.trigger_(e,"mouseover",{featureData:{author:n.author,description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})},D=function(a){TGOS.TGEvent.trigger_(e,"mouseout",{featureData:{author:n.author,
description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})},J=function(a){TGOS.TGEvent.trigger_(e,"dblclick",{featureData:{author:n.author,description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})},K=function(a){TGOS.TGEvent.trigger_(e,"rightclick",{featureData:{author:n.author,description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})};u="loading";if(!d)throw"Invalid kml url";
TGOS.getJSON(d,function(b){function d(a,b){for(var e=b.length,f=Object.keys(a),g=0;g<f.length;g++){var h=f[g];if(h.length>e&&h.substr(0,e)==b){var k=a[h];void 0!==k&&d(k,b);delete a[h];h=h.replace(b,"");a[h]=k}}}if(!b||b.error)u=TGOS.TGKmlLayerStatus.FETCH_ERROR,"function"==typeof f&&f.call(this,u);else{var h=b.kml;void 0==h&&(h=b["kml:kml"],void 0!==h&&d(h,"kml:"));h.Document?(h.Document.hasOwnProperty("description")&&null!=h.Document.description&&(h.Document.description.hasOwnProperty("#cdata-section")?
n.description=h.Document.description["#cdata-section"]:n.description=h.Document.description),h.Document.hasOwnProperty("name")&&null!=h.Document.name&&(h.Document.name.hasOwnProperty("#cdata-section")?n.name=h.Document.name["#cdata-section"]:n.name=h.Document.name),h.Document.hasOwnProperty("Snippet")&&null!=h.Document.Snippet&&(h.Document.Snippet.hasOwnProperty("#cdata-section")?n.snippet=h.Document.Snippet["#cdata-section"]:n.snippet=h.Document.Snippet),h.Document.hasOwnProperty("atom:author")&&
e.handleAuthor(h.Document["atom:author"]),e.Schema=h.Document.Schema):(h.hasOwnProperty("description")&&null!=h.description&&(h.description.hasOwnProperty("#cdata-section")?n.description=h.description["#cdata-section"]:n.description=h.description),h.hasOwnProperty("name")&&null!=h.name&&(h.name.hasOwnProperty("#cdata-section")?n.name=h.name["#cdata-section"]:n.name=h.name),h.hasOwnProperty("Snippet")&&null!=h.Snippet&&(h.Snippet.hasOwnProperty("#cdata-section")?n.snippet=h.Snippet["#cdata-section"]:
n.snippet=h.Snippet),h.hasOwnProperty("atom:author")&&e.handleAuthor(h["atom:author"]));e.parseKML(b.kml);u=TGOS.TGKmlLayerStatus.OK;a&&!0==a.preserveViewport&&(b=e.getDefaultViewport())&&g.fitBounds(b);"function"==typeof f&&f.call(e,e,u)}},TGOS.PROXY_SERVICE2,function(){"function"==typeof f&&f.call(this,TGOS.TGKmlLayerStatus.FETCH_ERROR)});this.removeAdvancedLayer=function(){null!=k&&(g.removeIndependentContainer(k),g.removeAdvancedLayer(this),k=null,h=!1)};this.moveToTop=function(){null!=k&&g.moveIndependentContainerToTop(k)};
this.getNode=function(){if(g)return!0==h&&null!=k?[k.div.main,k.div.shadow]:g.getPanes().graphicLayer}};TGOS.RegisterEvent(TGOS.TGKmlLayer,"click mousemove mouseout mouseover dblclick rightclick".split(" "))})();TGOS.TGWmtsLayer=function(){var b=function(b){this.fitBound=b.fitBound;this.matrixSet=b.matrixSet;this.matrixId=b.matrixId;this.row=b.row;this.col=b.col;this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom;this.scaledWidth=b.scaledWidth;this.scaledHeight=b.scaledHeight;this.toString=function(){return"{"+this.matrixId+","+this.row+","+this.col+"}"}};b.prototype.equals=function(b){return this.matrixId==b.matrixId&&this.row==b.row&&this.col==b.col};return function(d,a,f,e,g){this.layers=
[];this.tileMatrixSets=[];var h=null;a&&(h=a.getPanes().overlayviewLayer);var k=null,l=!1,p=name,m=!0,n=1,u,s=null,q=null,w=null,C=null,B=null,H=null;void 0!==e&&null!==e&&(null!=e.container&&(h=e.container),null!=e.fitDiv&&(fitDiv=e.fitDiv),s="number"==typeof e.left?e.left:null,q="number"==typeof e.top?e.top:null,w="number"==typeof e.right?e.right:null,C="number"==typeof e.bottom?e.bottom:null,n="number"==typeof e.opacity?Math.max(0,Math.min(1,e.opacity)):1,m=!1==e.wmtsVisible?!1:!0);var A=[],l=
!1,I=this,G=2.8E-4,D=256;void 0!==f&&(G="number"==typeof f.dpi?25.4/f.dpi/1E3:2.8E-4,D="number"==typeof f.tileWidth?f.tileWidth:256);var J="number"==typeof e.zIndex?e.zIndex:"auto",H=null,K=function(a){var b=document.createElement("div");b.className="TGOS_WMTS";b.style.position="absolute";b.style.left="0px";b.style.top="0px";b.style.width="100%";b.style.height="100%";b.style.zIndex=J;b.style.display=m?"":"none";a.appendChild(b);return b}(h);document.createElement("img");this.moveToTop=function(){h&&
(h.removeChild(K),h.appendChild(K))};this.moveLayerTo=function(a){if(h&&K){var b=h.childNodes.length,d=null;a&&(0>a?d=h.firstChild:a>=b||(d=h.childNodes[a]));h.removeChild(K);d?h.insertBefore(K,d):h.appendChild(K)}};this.getNode=function(){return K};this.getLayerId=function(){return p};this.getMatrixSetId=function(){return H["ows:Identifier"]};this.getTileOpacity=function(){return n};this.setTileOpacity=function(a){"number"==typeof a&&(n=a,K&&(K.style.opacity=n,K.style.filter="alpha(opacity="+100*
n+")"))};this.getSource=function(){return d};this.setZIndex=function(a){J=a;K&&(K.style.zIndex=J)};this.getZIndex=function(){return J};this.RemoveSelf=function(){h.removeChild(K)};var F=function(){var a=this,b=0;a.style.opacity=b;var d=n/7,e=setInterval(function(){b>=n?(a.style.filter="alpha(opacity="+100*n+")",a.style.opacity=n,clearInterval(e)):(a.style.opacity=b,a.style.filter="alpha(opacity="+100*b+")",b+=d)},33);a.style.filter="alpha(opacity=0)";a.style.display="block"},t=function(a,d,e,f){if(!a)return null;
var g;if(a.TileMatrix.length||a.TileMatrix["ows:Identifier"]!=d)for(var h=0;h<a.TileMatrix.length;h++){if(a.TileMatrix[h]["ows:Identifier"]==d){g=a.TileMatrix[h];break}}else g=a.TileMatrix;if(!g)return null;var h=parseFloat(g.MatrixWidth),k=parseFloat(g.MatrixHeight);mIdx=0==h?1:h-1;mIdy=0==k?1:k-1;var l=e.left,m=e.top,t=e.right,v=e.bottom;e=[];var k=g.TopLeftCorner,h=parseFloat(k.split(" ")[0]),k=parseFloat(k.split(" ")[1]),p=parseFloat(g.ScaleDenominator)*D*G,n;n=l<=h?0:Math.floor((l-h)/p);var t=
n+Math.ceil(Math.abs(l-t)/p)+1,l=m>=k?0:Math.floor((k-m)/p),v=l+Math.ceil(Math.abs(v-m)/p)+1,q,m=1;f&&(m=parseFloat(g.ScaleDenominator)*G/(0.0254*f/96));var t=t-n,s=v-l;f=[];var z=Infinity,u=-Infinity;q=Infinity;for(var w=-Infinity,E=0,A=0,C=[0,-1],v=Math.pow(Math.max(t,s),2);0<v;v--){-t/2<E&&E<=t/2&&-s/2<A&&A<=s/2&&(f.push({x:E,y:A}),E<z&&(z=E),E>u&&(u=E),A<q&&(q=A),A>w&&(w=A));if(E===A||0>E&&E===-A||0<E&&E===1-A)C=[-C[1],C[0]];E+=C[0];A+=C[1]}if(0<f.length)for(n-=z,l-=q,t=0;t<f.length;t++)q=f[t].x+
n,v=f[t].y+l,v=new b({left:h+q*p,top:k-v*p,scaledWidth:m*parseFloat(g.TileWidth),scaledHeight:m*parseFloat(g.TileHeight),matrixId:d,matrixSet:a["ows:Identifier"],col:q,row:v}),e.push(v);return e},v=function(a,b){for(var d=0,e=Infinity,f=a.ToMapDistX(D),g=0;g<b.TileMatrix.length;g++){var h=parseFloat(b.TileMatrix[g].ScaleDenominator)*D*G,h=Math.abs(h-f);h<e&&(e=h,d=g)}return 0.1<e/f?null:b.TileMatrix[d]["ows:Identifier"]};this.getTiles=function(b){var d=b.handler,e=new TGOS.TGEnvelope(b.rl,b.rt,b.rr,
b.rb),e=z(e),g=v(k,H),e=t(H,g,e);if(!e)return null;for(var g=[],h=[],l=0;l<e.length;l++)a.getCoordSys()==TGOS.TGCoordSys.EPSG3857?(b=TGOS.GooToWGS84(e[l].left,e[l].top),g.push(new TGOS.TGPoint(b.x,b.y))):g.push(new TGOS.TGPoint(e[l].left,e[l].top)),b=E(u,"1.0.0",f,e[l].matrixSet,e[l].matrixId,e[l].row,e[l].col),h.push(b);d&&d.call(this,{leftTopAnchor:g,imageUrl:h})};this.Initialize=function(a){k=a;u=d=0<d.indexOf("?")?d.slice(0,d.indexOf("?")):d;a=TGOS.PROXY_SERVICE2;DEBUG_MODE&&(a=TGOS.PROXY_LOCAL);
TGOS.getJSON(d+"?SERVICE=WMTS&REQUEST=GetCapabilities&VERSION=1.0.0",function(a){B=a.Capabilities;if(!B)throw"Service Error";a=B;var b=a["ows:OperationsMetadata"];if(void 0!==b){var d,e=b["ows:Operation"];if(void 0!==e&&e instanceof Array)for(b=0;b<e.length;b++){var h=e[b];if(void 0!==h){var k=h["@name"];if(void 0!==k&&"GetTile"==k&&(h=h["ows:DCP"],void 0!==h&&(d=h["ows:HTTP"]["ows:Get"],void 0!==d)))break}}if(void 0!==d&&d instanceof Array)for(b=0;b<d.length;b++)if(e=d[b],void 0!==e&&(xlnk=e["@xlink:href"],
void 0!==xlnk&&(e=e["ows:Constraint"]["ows:AllowedValues"]["ows:Value"],void 0!==e&&"KVP"==e))){u=0<xlnk.indexOf("?")?xlnk.slice(0,xlnk.indexOf("?")):xlnk;break}}I.layers=[];I.tileMatrixSets=[];d=null;if(b=a.Contents.Layer){if(b.length){for(var m=0;m<b.length;m++)e=b[m],I.layers.push({layer:e["ows:Identifier"],tilematrixset:""}),(e=e["ows:Identifier"])&&e==f.layer&&(d=b[m]);null==d&&(d=b[0])}else I.layers.push({layer:b["ows:Identifier"],tilematrixset:""}),d=b;if(null!=d){b=d.Format;if(b instanceof
Array){for(var t;0<b.length;m++)if(b[0]==f.format){t=f.format;break}void 0==t&&(f.format=b[0])}else f.format=b;(m=d.Style)&&(t=m["@isDefault"])&&"true"==t&&(f.style=null!=m["ows:Identifier"]?m["ows:Identifier"]:"");f.layer=d["ows:Identifier"];if(m=d.ResourceURL)t=m["@resourceType"],d=m["@template"],m["@format"]&&t&&d&&"tile"==t&&(u=d)}}a=a.Contents.TileMatrixSet;var v,p;if(void 0!==a)if(a["ows:SupportedCRS"]&&(v=URI(a["ows:SupportedCRS"]).segment()),a.WellKnownScaleSet&&(p=URI(a.WellKnownScaleSet).segment()),
void 0!==a.length){for(m=0;m<a.length;m++)I.tileMatrixSets.push(a[m]["ows:Identifier"]),(e=a[m]["ows:Identifier"])&&e==f.matrixSet&&(H=a[m]);null==H&&(H=a[0])}else I.tileMatrixSets.push(a["ows:Identifier"]),H=a;if(H)for(f.matrixSet=H["ows:Identifier"],v&&(f.crs=v),p&&(f.scaleSet=p),m=0;m<H.TileMatrix.length;m++)v=H.TileMatrix[m],a=v.TopLeftCorner,p=parseFloat(a.split(" ")[0]),a=parseFloat(a.split(" ")[1]),t=parseFloat(v.ScaleDenominator),e=parseFloat(v.MatrixWidth),d=parseFloat(v.MatrixHeight),h=
parseFloat(v.TileWidth),b=parseFloat(v.TileHeight),e=p+t*e*h*G,t=a-t*d*b*G,p&&a&&e&&t&&(v.left=p,v.top=a,v.right=e,v.bottom=t);l=!0;I.RebuildElement();I.UpdateElement();g&&g.call(this)},a)};this.UpdateElement=function(){if(l&&m&&H){this.RebuildElement();for(var a=0;a<A.length;a++){var b;b=k.FromMapPoint(A[a].left,A[a].top);A[a].img.style.left=b.x+"px";A[a].img.style.top=b.y+"px";A[a].img.style.width=A[a].scaledWidth+"px";A[a].img.style.height=A[a].scaledHeight+"px"}}};this.putVisible=function(a){m=
a;K.style.display=a?"":"none"};this.getWmtsVisible=function(){return m};this.setWmtsVisible=function(a){this.putVisible(a)};this.removeWmtsLayer=function(){void 0!==a&&a.removeLayer(this)};var z=function(a){null!==s&&a.left<s&&(a.left=s);null!==q&&a.top>q&&(a.top=q);null!==w&&a.right>w&&(a.right=w);null!==C&&a.bottom<C&&(a.bottom=C);return a},E=function(a,b,d,e,f,g,h){return 0<=a.indexOf("{")&&0<=a.indexOf("}")?(a=a.replace("{Style}",void 0!==d.style?d.style:"default"),a=a.replace("{TileMatrixSet}",
e),a=a.replace("{TileMatrix}",f),a=a.replace("{TileRow}",g),a=a.replace("{TileCol}",h)):a+"?SERVICE=WMTS&REQUEST=GetTile&VERSION="+b+"&Layer="+d.layer+"&Style="+(void 0!==d.style?d.style:"default")+"&Format="+d.format+"&TileMatrixSet="+e+"&TileMatrix="+f+"&TileRow="+g+"&TileCol="+h},L;this.RebuildElement=function(){if(l&&m&&H){var b=k.ToMapPoint(0,0),d=k.ToMapPoint(k.getClientWidth(),k.getClientHeight()),e=a.getZoom();if(L!=e&&0<A.length){for(var g=0;g<A.length;g++)K.removeChild(A[g].img);A=[]}L=
e;e=v(k,H);if(null!=e){b=new TGOS.TGEnvelope(b.x,b.y,d.x,d.y);b=z(b);d=96/0.0254/k.getScale();e=t(H,e,b,d);if(!e)return null;b=[];for(g=0;g<e.length;g++){for(var d=e[g],h=!1,p=0;p<A.length;p++)if(A[p].equals(d)){h=!0;break}h||b.push(d)}for(e=0;e<b.length;e++)d=b[e],h=E(u,"1.0.0",f,d.matrixSet,d.matrixId,d.row,d.col),g=K,p=document.createElement("img"),p.style.display="none",p.onload=F,p.style.position="absolute",p.galleryImg=!1,p.hideFocus=!0,p.style.MozUserSelect="none",p.border="0px",p.src=h,p.style.opacity=
n,p.style.filter="alpha(opacity="+100*n+")",g.appendChild(p),d.img=p,A.push(d)}}};void 0!==a&&a.addLayer(this,!0)}}();TGOS.TGWfsLayer=function(){function b(a,b){var d=a.split("?");if(1==d.length)return null;for(var d=d[1].split("&"),e=0;e<d.length;e++){var f=d[e].split("=");if(f[0].toUpperCase()==b.toUpperCase())return f[1]}}var d=function(a,b){this.mapCoordSys=a;this.dataCoordSys=b},a=function(a){a=a.split(".");for(var b=[],d=0;d<a.length;d++)b.push(a[d]);return b},f=function(a,b,d){var e=a;"EPSG3826"==d?"EPSG3825"==b?e=TGOS.TWD97toTWD97_119(a.x,a.y):"EPSG3857"==b&&(e=TGOS.TWD97toWGS84(a.x,a.y)):"EPSG3825"==d?"EPSG3826"==
b?e=TGOS.TWD97_119toTWD97(a.x,a.y):"EPSG3857"==b&&(e=TGOS.TWD97_119toWGS84(a.x,a.y)):"EPSG4326"==d&&("EPSG3826"==b?e=TGOS.WGS84toTWD97(a.x,a.y):"EPSG3825"==b&&(e=TGOS.WGS84toTWD97_119(a.x,a.y)));return e},e=function(a,b,d,e){var g=2;e&&(g=parseFloat(e));e=this.dataCoordSys;if(void 0!==d)switch(d){case "EPSG:4326":e="EPSG4326";break;case "EPSG:3826":e="EPSG3826";break;case "EPSG:3825":e="EPSG3825";break;case "EPSG:3857":e="EPSG3857"}if("1"!=b[0]||"0"!=b[1])if(a=a["#text"]||a,d=0<=a.indexOf(","),a=
a.replace(/[\s]*$/gi,"").replace(/^[\s]*/gi,"").split(/[\s]+/),b=[],d)for(d=0;d<a.length;d++){var g=a[d].split(","),h=new TGOS.TGPoint(parseFloat(g[0]),parseFloat(g[1])),h=f(h,this.mapCoordSys,e);b.push(h)}else for(d=0;d<a.length;d+=g)h=new TGOS.TGPoint(parseFloat(a[d]),parseFloat(a[d+1])),h=f(h,this.mapCoordSys,e),b.push(h);else if(a=a["#text"]||a,d=0<=a.indexOf(","),a=a.replace(/[\s]*$/gi,"").replace(/^[\s]*/gi,"").split(/[\s]+/),b=[],d)for(d=0;d<a.length;d++)g=a[d].split(","),h=new TGOS.TGPoint(parseFloat(g[0]),
parseFloat(g[1])),h=f(h,this.mapCoordSys,e),b.push(h);else for(d=0;d<a.length;d+=g)h=new TGOS.TGPoint(parseFloat(a[d]),parseFloat(a[d+1])),h=f(h,this.mapCoordSys,e),b.push(h);return b},g=function(a,b,d){var e=[],f;for(f in a){var g=a[f];if(g&&"object"===typeof g)for(var h in g)switch(h){case b+":MultiPolygon":for(var s=l(g[h],b,d),u=0;u<s.length;u++)e.push(s[u]);break;case b+":MultiSurface":s=l(g[h],b,d);for(u=0;u<s.length;u++)e.push(s[u]);break;case b+":Polygon":u=k(g,b,d);e.push(u);break;case b+
":MultiLineString":s=m(g[h],b,d);for(u=0;u<s.length;u++)e.push(s[u]);break;case b+":MultiCurve":s=m(g[h],b,d);for(u=0;u<s.length;u++)e.push(s[u]);break;case b+":LineString":u=p(g,b,d);e.push(u);break;case b+":MultiPoint":var u=b,s=d,J=g[h][u+":pointMember"],K=[];if(void 0!==J.length)for(var F=0;F<J.length;F++){var t=n(J[F],u,s);K.push(t)}else t=n(J,u,s),K.push(t);s=K;for(u=0;u<s.length;u++)e.push(s[u]);break;case b+":Point":u=n(g[b+":Point"],b,d),e.push(u)}}return e},h=function(a,b,d,f){a=a[b+":coordinates"]||
a[b+":posList"];f=a["@srsName"];d=e(a,d,f,a["@srsDimension"]);d=new TGOS.TGLineString(d);return new TGOS.TGLinearRing(d)},k=function(a,b,d){var e=[],f=a[b+":Polygon"];a=f["@srsName"];var g=h((f[b+":outerBoundaryIs"]||f[b+":exterior"])[b+":LinearRing"],b,d,a);e.push(g);if(f=f[b+":innerBoundaryIs"]||f[b+":interior"])if(f instanceof Array)for(g=0;g<f.length;g++){var k=f[g][b+":LinearRing"],k=h(k,b,d,a);e.push(k)}else k=f[b+":LinearRing"],k=h(k,b,d,a),e.push(k);return new TGOS.TGPolygon(e)},l=function(a,
b,d){a=a[b+":polygonMember"]||a[b+":surfaceMember"];var e=[];if(void 0!==a.length)for(var f=0;f<a.length;f++){var g=k(a[f],b,d);e.push(g)}else g=k(a,b,d),e.push(g);return e},p=function(a,b,d){var f=a[b+":LineString"];a=f["@srsName"];var g=f["@srsDimension"];b=f[b+":coordinates"]||f[b+":posList"];a||(a=b["@srsName"]);g||(g=b["@srsDimension"]);d=e(b,d,a,g);return new TGOS.TGLineString(d)},m=function(a,b,d){a=a[b+":lineStringMember"]||a[b+":curveMember"];var e=[];if(void 0!==a.length)for(var f=0;f<a.length;f++){var g=
p(a[f],b,d);e.push(g)}else g=p(a,b,d),e.push(g);return e},n=function(a,b,d){var f=a["@srsName"],g=a["@srsDimension"];a=a[b+":coordinates"]||a[b+":pos"];f||(f=a["@srsName"]);g||(g=a["@srsDimension"]);return e(a,d,f,g)[0]},u=function(a,b,d){this.zIndex="auto";this.defaultViewport=null;this.preserveViewport=!0;this.serviceInfo={VERSION:"1.0.0",REQUEST:"GetFeature",SERVICE:"WFS",SRSNAME:"EPSG:4326"};var e=TGOS.RES_PATH+"shadow2.png";this.markerOptions={title:"",clickable:!1,cursor:"",zIndex:"auto",flat:!1,
icon:new TGOS.TGImage(TGOS.RES_PATH+"marker2.png",new TGOS.TGSize(31,30),new TGOS.TGPoint(0,0),new TGOS.TGPoint(11,30)),shadow:new TGOS.TGImage(e,new TGOS.TGSize(31,30),new TGOS.TGPoint(0,0),new TGOS.TGPoint(9,25))};this.polylineOptions={clickable:!1,strokeWeight:2,zIndex:"auto",strokeColor:"#ff5555",strokeOpacity:1};this.polygonOptions={clickable:!1,opacity:1,fillColor:"#eeaaaa",fillOpacity:0.5,strokeWeight:2,zIndex:"auto",strokeColor:"#ff5555",strokeOpacity:1};this.callback=d;this.gs=[];b&&(void 0!==
b.map&&this.setMap(b.map),void 0!==b.preserveViewport&&this.setPreserveViewport(b.preserveViewport),void 0!==b.zIndex&&this.setZIndex(b.zIndex),void 0!==b.wfsVisible&&this.setWfsVisible(b.wfsVisible),void 0!==b.independentContainer&&this.setIndependentContainer(b.independentContainer),b.markerOptions&&this.setMarkerOptions(b.markerOptions),b.polylineOptions&&this.setLineOptions(b.polylineOptions),b.polygonOptions&&this.setPolygonOptions(b.polygonOptions),void 0!==b.zIndex&&this.setZIndex(b.zIndex),
void 0!==b.version&&(d=b.version,this.serviceInfo.version=d),void 0!==b.srsName&&(d=b.srsName,this.serviceInfo.srsname=d),void 0!==b.typeName&&(d=b.typeName,this.serviceInfo.typename=d));this.setUrl(a);this.update(this.callback)},s=u.prototype;s.update=function(e){if(this.url&&this.map){var f=null,h=null;void 0!==this.serviceInfo.typename?(f=this.serviceInfo.typename,h=this.serviceInfo.version):(f=b(this.url,"typeName"),h=b(this.url,"version"));if(!h)throw"Invalid WFS version";if(!f)throw"Invalid Type Name";
var k=a(h);if(3!=k.length)throw"Invalid WFS version";f.split(":");var l="",m="",p=this,h=null;if(void 0!==this.serviceInfo.typename){var h="",n;for(n in this.serviceInfo)0<h.length&&(h+="&"),h=h+n+"="+this.serviceInfo[n];h=this.url.split("?")[0]+"?"+h}else h=this.url;TGOS.getJSON(h,function(a){if(!a||a.error)e.call(this,a.error);else{var b,h;for(h in a)0<=h.indexOf("FeatureCollection")&&(b=a[h]);if(b){for(var n in b)if(0<=n.indexOf("@xmlns:")){if("http://www.opengis.net/gml"==b[n]||"http://www.opengis.net/gml/3.2"==
b[n])l=n.replace("@xmlns:","");if("http://www.opengis.net/wfs"==b[n]||"http://www.opengis.net/wfs/2.0"==b[n])m=n.replace("@xmlns:","")}a=p.map.getCoordSys();var t;h=b[l+":boundedBy"];void 0!==h&&(h=h[l+":Box"],void 0!==h&&void 0!==h["@srsName"]&&(t=h["@srsName"]));void 0!==t&&(t=t.replace(":",""));d(a,t);t=b[l+":featureMember"]||b[l+":featureMembers"]||b[l+":member"]||b[m+":member"];b=[];if(t){if(t.length)for(a=a=0;a<t.length;a++)for(h=g(t[a][f],l,k),n=0;n<h.length;n++)b.push(h[n]);else if(a=0,a=
t[f],a.length)for(a=0;a<t[f].length;a++)for(h=g(t[f][a],l,k),n=0;n<h.length;n++)b.push(h[n]);else for(h=g(a,l,k),n=0;n<h.length;n++)b.push(h[n]);t=function(a,b){var d=a;d||(d={});for(var e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);return d};a=null;!0==p.getIndependentContainer()&&(h=p.getAdvancedContainer(),null!=h&&(a={advancedLayer:h}));for(h=0;h<b.length;h++)b[h]instanceof TGOS.TGPolygon?(a=t(a,p.polygonOptions),n=new TGOS.TGFill(p.map,b[h],a),n.setOpacity(0.5),p.gs.push(n)):b[h]instanceof TGOS.TGLineString?
(a=t(a,p.polylineOptions),n=new TGOS.TGLine(p.map,b[h],a),n.setStrokeWeight(2),p.gs.push(n)):b[h]instanceof TGOS.TGPoint&&(a=t(a,p.markerOptions),n=new TGOS.TGMarker(p.map,b[h],null,null,a),p.gs.push(n));p.setZIndex(p.zIndex);p.setWfsVisible(p.visible);p.map&&!0==p.preserveViewport&&p.getDefaultViewport()&&p.map.fitBounds(p.getDefaultViewport());e&&e.call(p)}}}},TGOS.PROXY_SERVICE2)}};s.setUrl=function(a,b){this.url=a};s.setPreserveViewport=function(a){this.preserveViewport=a};s.setZIndex=function(a){this.zIndex=
a;for(a=0;a<this.gs.length;a++)this.gs[a].setZIndex(this.zIndex)};s.setMap=function(a){this.map=a};s.getDefaultViewport=function(){if(!this.defaultViewport){for(var a=Infinity,b=-Infinity,d=-Infinity,e=Infinity,f=0;f<this.gs.length;f++){var g=this.gs[f].getBounds();g&&(a=Math.min(a,g.left),e=Math.min(e,g.bottom),b=Math.max(b,g.right),d=Math.max(d,g.top))}isFinite(a)&&isFinite(d)&&isFinite(b)&&isFinite(e)?this.defaultViewport=new TGOS.TGEnvelope(a,d,b,e):this.defaultViewport=null}return this.defaultViewport};
s.getUrl=function(){return this.url};s.removeAdvancedLayer=function(){null!=this.advancedLayer&&(this.map.removeIndependentContainer(this.advancedLayer),this.map.removeAdvancedLayer(this),this.advancedLayer=null)};s.moveToTop=function(){null!=this.advancedLayer&&this.map.moveIndependentContainerToTop(this.advancedLayer)};s.removeWfs=function(){this.removeAdvancedLayer();for(var a=0;a<this.gs.length;a++)this.gs[a].setMap(null),this.gs[a]=null;this.gs=[];this.map=null};s.getZIndex=function(){return this.zIndex};
s.getWfsVisible=function(){return this.visible};s.setWfsVisible=function(a){this.visible=a;for(a=0;a<this.gs.length;a++)this.gs[a].setVisible(this.visible)};s.setMarkerOptions=function(a){a&&(void 0!==a.clickable&&(this.markerOptions.clickable=a.clickable),void 0!==a.title&&(this.markerOptions.title=a.title),void 0!==a.zIndex&&(this.markerOptions.zIndex=a.zIndex),void 0!==a.opacity&&(this.markerOptions.opacity=a.opacity),void 0!==a.cursor&&(this.markerOptions.cursor=a.cursor),void 0!==a.flat&&(this.markerOptions.flat=
a.flat),void 0!==a.icon&&(this.markerOptions.icon=a.icon),void 0!==a.shadow&&(this.markerOptions.shadow=a.shadow))};s.setLineOptions=function(a){a&&(void 0!==a.clickable&&(this.polylineOptions.clickable=a.clickable),void 0!==a.opacity&&(this.polylineOptions.opacity=a.opacity),void 0!==a.zIndex&&(this.polylineOptions.zIndex=a.zIndex),void 0!==a.strokeWeight&&(this.polylineOptions.strokeWeight=a.strokeWeight),void 0!==a.strokeDasharray&&(this.polylineOptions.strokeDasharray=a.strokeDasharray),void 0!==
a.strokeColor&&(this.polylineOptions.strokeColor=a.strokeColor),void 0!==a.strokeOpacity&&(this.polylineOptions.strokeOpacity=a.strokeOpacity))};s.setPolygonOptions=function(a){a&&(void 0!==a.clickable&&(this.polygonOptions.clickable=a.clickable),void 0!==a.opacity&&(this.polygonOptions.opacity=a.opacity),void 0!==a.zIndex&&(this.polygonOptions.zIndex=a.zIndex),void 0!==a.fillColor&&(this.polygonOptions.fillColor=a.fillColor),void 0!==a.fillOpacity&&(this.polygonOptions.fillOpacity=a.fillOpacity),
void 0!==a.strokeWeight&&(this.polygonOptions.strokeWeight=a.strokeWeight),void 0!==a.strokeDasharray&&(this.polygonOptions.strokeDasharray=a.strokeDasharray),void 0!==a.strokeColor&&(this.polygonOptions.strokeColor=a.strokeColor),void 0!==a.strokeOpacity&&(this.polygonOptions.strokeOpacity=a.strokeOpacity))};s.getIndependentContainer=function(){return this.independentContainer};s.setIndependentContainer=function(a){this.independentContainer=a;!0==this.independentContainer&&void 0===this.advancedLayer&&
(this.advancedLayer=this.map.addIndependentContainer("WFS",this))};s.getAdvancedContainer=function(){return!0==this.independentContainer?(void 0===this.advancedLayer&&(this.advancedLayer=this.map.addIndependentContainer("WFS",this)),this.advancedLayer):null};s.getNode=function(){if(this.map){if(!0==this.independentContainer){var a=this.getAdvancedContainer();return null!=a?[a.div.main,a.div.shadow]:this.map.getPanes().graphicLayer}return this.map.getPanes().graphicLayer}};return u}();TGOS.CDC_SERVICE=getWebProtocal()+getAPIPath()+"CDCDistrict/StatisticsCombined.aspx";
TGOS.TGCounty={KEELUNG:{code:"11"},TAIPEI:{code:"01"},XINBEI:{code:"31"},TAOYUAN:{code:"32"},HSINCHUCOUNTY:{code:"33"},HSINCHUCITY:{code:"12"},MIAOLI:{code:"35"},TAICHUNG:{code:"03"},CHANGHUA:{code:"37"},NANTOU:{code:"38"},YUNLIN:{code:"39"},CHIAYICOUNTY:{code:"40"},CHIAYICITY:{code:"22"},TAINAN:{code:"05"},KAOHSIUNG:{code:"07"},PINGTUNG:{code:"43"},YILAN:{code:"34"},HUALIEN:{code:"45"},TAITUNG:{code:"46"},PENGHU:{code:"44"},KINMEN:{code:"90"},LIENCHIANG:{code:"91"}};
TGOS.TGCDCStatMapId={COUNTYMAP:"COUNTYMAP",TOWNMAP:"TOWNMAP"};TGOS.TGCDCStatServiceStatus={ERROR:"ERROR",INVALID_REQUEST:"INVALID_REQUEST",OK:"OK",OVER_QUERY_LIMIT:"OVER_QUERY_LIMIT",REQUEST_DENIED:"REQUEST_DENIED",UNKNOWN_ERROR:"UNKNOWN_ERROR",ZERO_RESULTS:"ZERO_RESULTS"};
TGOS.TGCDCDistrictStat=function(){var b=function(a,b){var d,g,h;if(!b)return null;switch(a){case "year":d=b.slice(0,4);if(isNaN(parseInt(d)))throw"Invalid Date";break;case "month":d=b.slice(0,4);g=b.slice(4,6);if(isNaN(parseInt(d))||isNaN(parseInt(g)))throw"Invalid Date";break;case "week":d=b.slice(0,4);h=b.slice(4,6);if(isNaN(parseInt(d))||isNaN(parseInt(h)))throw"Invalid Date";break;default:return null}return{year:d,month:g,week:h}},d={EPSG3857:"EPSG3857",EPSG3826:"EPSG3826"};this.stat=function(a,
f,e,g){if(e){if(!e)throw"Missing Request";if(!(f in d))throw"Invalid Coordinate System";var h=e.width;a=e.height;var k=e.diseaseCode,l=e.graduatedColor,p=e.ageGroup,m=e.statType,n=e.date1,u=e.date2,s=e.gender,q=e.classifyMethod,w=e.dateType,C=e.countyName,B=e.classes,H=e.originInfection,A=e.layer,I=e.county,G=e.autoSize;switch(w){case "year":break;case "month":break;case "week":break;default:throw"Invalid dateType";}e=b(w,n);u=b(w,u);if(!e||!u)throw"date1 and date2 are required";switch(H){case "0":H=
"0";break;case "1":H="1";break;default:H="all"}switch(s){case "male":s="m";break;case "female":s="f";break;case "all":s="all";break;default:s="all"}switch(p){case "0to14":p="1";break;case "15to49":p="2";break;case "50upper":p="3";break;default:p="a"}switch(m){case "confirmed":m="deter";break;case "reported":m="report";break;default:m="deter"}switch(q){case "EqualInterval":q="ei";break;case "Quantile":q="qt";break;case "StanDevi":q="sd";break;case "TBClassfy":q="2005TB";u=e;break;default:q="ei"}switch(l.toLowerCase()){case "red":l=
"red";break;case "yellow":l="yellow";break;case "green'":l="green";break;case "blue":l="blue";break;default:l="green"}switch(C){case !0:C="true";break;case !1:C="false";break;default:C="false"}k="?disease="+k;G||(k=k+"&width="+h+"&height="+a);k=k+"&layer="+A;k=k+"&classm="+q;k=k+"&color="+l;k=k+"&gender="+s;k=k+"&classes="+B;k=k+"&ag="+p;k=k+"&dateType="+w;k=k+"&sy="+e.year;k=k+"&ey="+u.year;k=k+"&label="+C;k=k+"&oi="+H;k=k+"&stattype="+m;I&&I.code&&(k=k+"&targetDist="+I.code);switch(w){case "week":k=
k+"&sw="+e.week;k=k+"&ew="+u.week;break;case "month":k=k+"&sm="+e.month,k=k+"&em="+u.month}a=TGOS.CDC_SERVICE+k+"&t=data";var D=TGOS.CDC_SERVICE+k+"&t=img&keystr="+encodeURIComponent(TGOS.tgHash),J={};TGOS.getJSON(a,function(a){if(a)if(a.error)switch(a.error){case "ZERO_RESULT":g.call(this,J,"ZERO_RESULT");break;default:g.call(this,J,"INVALID_REQUEST")}else{J.district=a.district;J.legend=a.legend;if("EPSG3826"==f)var b=parseFloat(a.bounds.left),d=parseFloat(a.bounds.top),e=parseFloat(a.bounds.right),
k=parseFloat(a.bounds.bottom);else"EPSG3857"==f&&(d=TGOS.TWD97toWGS84(a.bounds.left,a.bounds.top),a=TGOS.TWD97toWGS84(a.bounds.right,a.bounds.bottom),b=d.x,d=d.y,e=a.x,k=a.y);J.envelope=new TGOS.TGEnvelope(b,d,e,k);b=(d-k)/(e-b);G&&(D=D+"&width="+h,D=D+"&height="+Math.round(h*b));J.imageUrl=D;g.call(this,J,"OK")}else g.call(this,J,"INVALID_REQUEST")})}else g.call(this,null)}};TGOS.TGMarkerCluster=function(){var b="",d=TGOS.RES_PATH+"clusters/cluster-10-99.png",a=TGOS.RES_PATH+"clusters/cluster-100-999.png",f=TGOS.RES_PATH+"clusters/cluster-999up.png",e=new TGOS.TGImage(TGOS.RES_PATH+"clusters/cluster-2-9.png",new TGOS.TGSize(36,36),null,new TGOS.TGPoint(18,18)),d=new TGOS.TGImage(d,new TGOS.TGSize(48,48),null,new TGOS.TGPoint(24,24)),a=new TGOS.TGImage(a,new TGOS.TGSize(64,64),null,new TGOS.TGPoint(32,32)),f=new TGOS.TGImage(f,new TGOS.TGSize(72,72),null,new TGOS.TGPoint(36,
36)),g=function(a,b,d){a={center:{x:a.x,y:a.y},markers:b,symbols:[]};d&&(a.centerLonLat={x:d.x,y:d.y});return a},h=function(a){if(!a)return null;for(var b=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=0;g<a.length;g++)var h=a[g].getPosition(),b=Math.min(b,h.x),d=Math.min(d,h.y),e=Math.max(e,h.x),f=Math.max(f,h.y);a=new TGOS.TGEnvelope;a.left=b;a.top=f;a.right=e;a.bottom=d;return a},k=function(a,d,e){var f=this;this.map=a?a:null;b=this.map.getTransformation().getMapMaxLevel();this.clusters=[];this.markers=
[];if(d&&d.length)for(var g=0;g<d.length;g++)this.markers.push(d[g]);this.takeapart=this.clickable=!0;this.clickHandler=function(){if(f.clickable){var a;a=this.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857?TGOS.GooToWGS84(this.cluster.center.x,this.cluster.center.y):this.cluster.center;TGOS.TGEvent.trigger_(f,"clusterclick",{specifiedCluster:this.cluster.markers,clusterEnvelope:h(this.cluster.markers),clusterCenter:a})}};TGOS.TGEvent.addListener(a,"idle",function(){f.redrawViewport()});TGOS.TGEvent.addListener(a,
"zoom_changed",function(){var a=f.map.getZoom();if(f.takeapart){if(a>f.maxZoom||a==b){f.clearClusters();for(a=0;a<f.markers.length;a++)f.markers[a].setMap(f.map);return}}else if(a>f.maxZoom){f.clearClusters();for(a=0;a<f.markers.length;a++)f.markers[a].setMap(f.map);return}for(a=0;a<f.markers.length;a++)f.markers[a].setMap(null);f.clearClusters()});e&&("number"==typeof e.bounds&&(this.bounds=e.bounds),"number"==typeof e.maxZoom&&(this.maxZoom=e.maxZoom),e.scaleClass&&"number"==typeof e.scaleClass.length&&
(this.scaleClass=e.scaleClass),e.style&&"number"==typeof e.style.length&&(this.styles=e.style),e.updateCenter&&(this.updateCenter=e.updateCenter),"boolean"==typeof e.takeapart&&(this.takeapart=e.takeapart))},l=k.prototype;l.clusters=null;l.cursor="default";l.visible=!0;l.zIndex=0;l.bounds=30;l.map=null;l.markers=null;l.scaleClass=[9,99,999];l.classifyMarker=function(a){var b=Infinity,d=null,e=this.map.getMapBase(),f=a.getPosition(),h=this.map.getCoordSys();h==TGOS.TGCoordSys.EPSG3857&&(f=a.gPos);
var k=e.FromMapPoint(f.x,f.y),l=2*this.bounds;if(0==this.clusters.length){var B=a.getPosition();if(h==TGOS.TGCoordSys.EPSG3857)var H=B,B=a.gPos;f=g({x:B.x,y:B.y},[a],H);this.clusters.push(f)}else{for(var A=0;A<this.clusters.length;A++){var I=this.clusters[A].center,B=e.FromMapPoint(I.x,I.y),I=k.x-B.x,B=k.y-B.y,I=Math.sqrt(I*I+B*B);I<=b&&(b=I,d=A)}b<=l?(b=this.clusters[d],this.updateCenter&&(b.center.x=(b.center.x*b.markers.length+f.x)/(b.markers.length+1),b.center.y=(b.center.y*b.markers.length+f.y)/
(b.markers.length+1)),b.markers.push(a),f=b):(B=a.getPosition(),h==TGOS.TGCoordSys.EPSG3857&&(H=B,B=a.gPos),f=g({x:B.x,y:B.y},[a],H),this.clusters.push(f))}a.isClustered=!0;return a.parentCluster=f};l.styles=[{icon:e,label:new TGOS.TGPoint(0,0),labelColor:"#f0f0f0",labelSize:12},{icon:d,label:new TGOS.TGPoint(0,0),labelColor:"#f0f0f0",labelSize:14},{icon:a,label:new TGOS.TGPoint(0,0),labelColor:"#f0f0f0",labelSize:16},{icon:f,label:new TGOS.TGPoint(0,0),labelColor:"#f0f0f0",labelSize:18}];l.setMarkers=
function(a,b){this.markers=a;for(var d=0;d<this.markers.length;d++)this.classifyMarker(this.markers[d])};l.getClickable=function(){return this.clickable};l.setClickable=function(a){this.clickable=a};l.addMarkers=function(a,b){for(var d=0;d<a.length;d++)this.markers.push(a[d]);b&&this.redrawAll()};l.addMarker=function(a,b){this.markers.push(a);b&&this.redrawAll()};l.redrawAll=function(){var a=this.map.getZoom();if(this.takeapart){if(a>this.maxZoom||a==b){this.clearClusters();for(a=0;a<this.markers.length;a++)this.markers[a].setMap(this.map);
return}}else if(a>this.maxZoom){this.clearClusters();for(a=0;a<this.markers.length;a++)this.markers[a].setMap(this.map);return}for(a=0;a<this.markers.length;a++)this.markers[a].setMap(null);this.clearClusters();this.redrawViewport()};l.clearAll=function(){this.clearClusters();this.markers=[]};l.clearClusters=function(){for(var a=0;a<this.clusters.length;a++){for(var b=this.clusters[a],d=0;d<b.symbols.length;d++)b.symbols[d].setMap(null);b.symbols=[];for(d=0;d<b.markers.length;d++)b.markers[d].isClustered=
!1}this.clusters=[]};l.getClustersCounts=function(){return this.clusters?this.clusters.length:0};l.getExtendedBounds=function(){var a=this.map.getRawBound(),b=this.bounds,d=a.left,e=a.top,f=a.right,a=a.bottom,g=this.map.getMapBase().FromMapDistX(b),b=this.map.getMapBase().FromMapDistY(b);return new TGOS.TGEnvelope(d-g,e+b,f+g,a-b)};l.redrawViewport=function(){if(this.map){var a=this.map.getZoom();if(this.takeapart){if(a>this.maxZoom||a==b){this.clearClusters();return}}else if(a>this.maxZoom){this.clearClusters();
return}for(var a=this.getExtendedBounds(),d=0;d<this.markers.length;d++){var e=this.markers[d],f=e.getPosition();this.map.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&(e.gPos||(e.gPos=TGOS.WGS84ToGoo(f.x,f.y)),f=e.gPos);this.takeapart?!e.isClustered&&a.contains(f)&&this.classifyMarker(this.markers[d]):e.isClustered||this.classifyMarker(this.markers[d])}for(a=0;a<this.clusters.length;a++)0>=this.clusters[a].symbols.length&&this.addClusterMarker(this.clusters[a])}};l.addClusterMarker=function(a){var b;
b=a.centerLonLat?a.centerLonLat:a.center;var d=new TGOS.TGPoint(b.x,b.y);b=a.markers.length;var e=new TGOS.TGMarker(null,d);e.setFlat(!0);e.setClickable(!0);e.setVisible(this.visible);e.setZIndex(this.zIndex);e.setMap(this.map);a.symbols.push(e);if(1<b){var f=new TGOS.TGLabel({map:this.map,position:d,fontColor:"#ff0000",fontSize:this.bounds,fontWeight:"bold",opacity:1,zIndex:this.zIndex+1,label:b.toString()});f.setZIndex(this.zIndex+1);f.setVisible(this.visible);a.symbols.push(f)}a:{var d=this.scaleClass,
g=this.styles;if(1==a.markers.length)a.symbols[0].setIcon(a.markers[0].getIcon());else{for(var h=0;h<d.length;h++)if(a.markers.length<=d[h]){d=h>g.length-1?g[g.length-1]:g[h];a.symbols[0].setIcon(d.icon);a.symbols[0].setTitle(a.markers.length);a.symbols[1].setFontColor(d.labelColor?d.labelColor:"#f0f0f0");a.symbols[1].setFontSize(d.labelSize?d.labelSize:12);d.labelAnchor&&a.symbols[1].setOffset(d.labelAnchor);break a}d=g[g.length-1];a.symbols[0].setIcon(d.icon);a.symbols[0].setTitle(a.markers.length);
a.symbols[1].setFontColor(d.labelColor?d.labelColor:"#f0f0f0");a.symbols[1].setFontSize(d.labelSize?d.labelSize:12);d.labelAnchor&&a.symbols[1].setOffset(d.labelAnchor)}}1==b&&(TGOS.TGEvent.copyEvent(a.markers[0],e),e.setTitle(a.markers[0].getTitle()),e.annotation=a.markers[0].annotation);f&&(f.cluster=a,TGOS.TGEvent.addListener(f,"click",this.clickHandler));e&&(e.cluster=a,TGOS.TGEvent.addListener(e,"click",this.clickHandler))};l.getScaleClass=function(){return this.scaleClass};l.setScaleClass=function(a){this.scaleClass=
a};l.setClusterStyle=function(a){this.styles=a};l.getClusterStyle=function(){return this.styles};l.removeMarker=function(a,b){for(var d=0;d<this.markers.length;d++)if(this.markers[d]==a){this.markers.splice(d,1);break}b&&this.redrawAll()};l.removeMarkers=function(a,b){for(var d=0;d<a.length;d++)for(var e=0;e<this.markers.length;e++)if(this.markers[e]==a[d]){this.markers.splice(e,1);break}b&&this.redrawAll()};l.setVisible=function(a,b){this.visible=a;b&&this.redrawAll()};l.getVisible=function(){return this.visible};
l.setSearchBounds=function(a){this.bounds=a};l.getSearchBounds=function(){return this.bounds};l.getCursor=function(){return this.cursor};l.setCursor=function(a,b){this.cursor=a;b&&this.redrawAll()};l.setZIndex=function(a,b){this.zIndex=a;b&&this.redrawAll()};l.getZIndex=function(){return this.zIndex};l.maxZoom=Infinity;l.getMaxZoom=function(){return this.maxZoom};l.setMaxZoom=function(a){this.maxZoom=a};l.getClusterBounds=function(){return h(this.markers)};TGOS.RegisterEvent(k,["clusterclick"]);return k}();TGOS.TGData=function(){var b="Point MultiPoint LineString MultiLineString Polygon MultiPolygon GeometryCollection".split(" "),d=function(a,b,d){var e=a[0];a=a[1];b=b==d?{x:e,y:a}:TGOS[b+"to"+d](e,a);return new TGOS.TGPoint(b.x,b.y)},a=function(b,e,f){switch(b.type){case "Point":return d(b.coordinates,e,f);case "MultiPoint":for(var g=[],m=0;m<b.coordinates.length;m++)g.push(d(b.coordinates[m],e,f));return new TGOS.TGMultiPoint(g);case "LineString":g=[];for(m=0;m<b.coordinates.length;m++)g.push(d(b.coordinates[m],
e,f));return new TGOS.TGLineString(g);case "MultiLineString":for(var n=[],u=0;u<b.coordinates.length;u++){g=[];for(m=0;m<b.coordinates[u].length;m++)g.push(d(b.coordinates[u][m],e,f));g=new TGOS.TGLineString(g);n.push(g)}return new TGOS.TGMultiLineString(n);case "Polygon":for(var s=[],u=0;u<b.coordinates.length;u++){g=[];if(0==u)for(m=0;m<b.coordinates[u].length;m++)g.push(d(b.coordinates[u][m],e,f));else for(m=b.coordinates[u].length-1;0<=m;m--)g.push(d(b.coordinates[u][m],e,f));g=new TGOS.TGLineString(g);
g=new TGOS.TGLinearRing(g);s.push(g)}return new TGOS.TGPolygon(s);case "MultiPolygon":for(var q=[],n=0;n<b.coordinates.length;n++){s=[];for(u=0;u<b.coordinates[n].length;u++){g=[];for(m=0;m<b.coordinates[n][u].length;m++)g.push(d(b.coordinates[n][u][m],e,f));g=new TGOS.TGLineString(g);g=new TGOS.TGLinearRing(g);s.push(g)}u=new TGOS.TGPolygon(s);q.push(u)}return new TGOS.TGMultiPolygon(q);case "GeometryCollection":e=[];for(n=0;n<b.geometries.length;n++)f=a(b.geometries[n]),e.push(f);return new TGOS.TGGeometryCollection(e);
default:throw"Unable to import GeoJSON";}},f=function(b,d,e,f){e=a(b.geometry,e,f);f=b.properties;b=b.id;d&&d.idPropertyName&&f&&(b=f[d.idPropertyName]);return new TGOS.TGGraphic({geometry:e,properties:f,id:b})},e=function(a){this.graphics=[];a.map&&(this.map=a.map);a.style&&(this.style=a.style)};e.prototype=new TGOS.MVCObject;var g=e.prototype;g.graphics=null;g.map=null;g.style=null;g.add=function(a){if(a instanceof TGOS.TGGraphic)return this.graphics.push(a),this.bindTo("style",a,"style"),a.draw(this.map),
this.bindEvents(a),TGOS.TGEvent.trigger_(this,"addgraphic",a),a};g.bindEvents=function(a){var b=this;TGOS.TGEvent.addListener(a,"setproperty",function(a){b.redraw(a.graphic);TGOS.TGEvent.trigger_(b,"setproperty",a)});TGOS.TGEvent.addListener(a,"setgeometry",function(a){b.redraw(a.graphic);TGOS.TGEvent.trigger_(b,"setgeometry",a)});TGOS.TGEvent.addListener(a,"removeproperty",function(a){b.redraw(a.graphic);TGOS.TGEvent.trigger_(b,"removeproperty",a)});TGOS.TGEvent.addListener(a,"mousedown",function(d){d.graphic=
a;TGOS.TGEvent.trigger_(b,"mousedown",d)});TGOS.TGEvent.addListener(a,"mouseup",function(d){d.graphic=a;TGOS.TGEvent.trigger_(b,"mouseup",d)});TGOS.TGEvent.addListener(a,"mousemove",function(d){d.graphic=a;TGOS.TGEvent.trigger_(b,"mousemove",d)});TGOS.TGEvent.addListener(a,"mouseover",function(d){d.graphic=a;TGOS.TGEvent.trigger_(b,"mouseover",d)});TGOS.TGEvent.addListener(a,"dblclick",function(d){d.graphic=a;TGOS.TGEvent.trigger_(b,"dblclick",d)});TGOS.TGEvent.addListener(a,"click",function(d){d.graphic=
a;TGOS.TGEvent.trigger_(b,"click",d)});TGOS.TGEvent.addListener(a,"rightclick",function(d){d.graphic=a;TGOS.TGEvent.trigger_(b,"rightclick",d)});TGOS.TGEvent.addListener(a,"mouseout",function(d){d.graphic=a;TGOS.TGEvent.trigger_(b,"mouseout",d)})};g.removeAllGraphics=function(){this.forEach(function(a){this.remove(a)})};g.remove=function(a){if(a&&this.contains(a)){a.clear();var b=this.graphics.indexOf(a);this.graphics.splice(b,1);TGOS.TGEvent.trigger_(this,"removegraphic",a)}};g.forEach=function(a,
b){for(var d=this.graphics.slice(0),e=0;e<d.length;e++)a.call(b,d[e])};g.contains=function(a){if(!(a instanceof TGOS.TGGraphic))return!1;for(var b=0;b<this.graphics.length;b++)if(this.graphics[b]==a)return!0;return!1};g.getGraphicById=function(a){for(var b=0;b<this.graphics.length;b++)if(this.graphics[b].id===a)return this.graphics[b]};g.getMap=function(){return this.map};g.setMap=function(a){this.clearAll();(this.map=a)&&this.redrawAll()};g.clearAll=function(){this.forEach(function(a){a.clear()})};
g.getStyle=function(){return this.style};g.setStyle=function(a){this.set("style",a);this.redrawAll()};g.redrawAll=function(){var a=this;this.forEach(function(b){b.redraw(a.map)})};g.redraw=function(a){that=this;this.contains(a)&&a.redraw(that.map)};g.overrideStyle=function(a,b){a instanceof TGOS.TGGraphic&&(a.ownStyle=b,a.redraw())};g.revertStyle=function(a){a instanceof TGOS.TGGraphic&&(a.ownStyle=null,a.redraw())};g.loadGeoJson=function(a,b,d){var e,f=this;e=window.XMLHttpRequest?new XMLHttpRequest:
new ActiveXObject("Microsoft.XMLHTTP");e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var a=JSON.parse(e.responseText),a=f.addGeoJson(a);d.call(void 0,a)}};if(-1!=a.indexOf("http")||-1!=a.indexOf("https"))a=TGOS.PROXY_SERVICE2+"?serv="+encodeURIComponent(a),a+="&keystr="+encodeURIComponent(TGOS.tgHash),a+="&mode=json";e.open("GET",a,!0);e.send()};g.addGeoJson=function(d,e){if(null!=d)d instanceof Object||(d=JSON.parse(d));else throw"Unable to import GeoJSON";if(!d)throw"Unable to import GeoJSON";
var g="WGS84";if(d.crs&&"name"==d.crs.type&&d.crs.properties){var p=d.crs.properties.name;"urn:ogc:def:crs:EPSG::3826"==p?g="TWD97":"urn:ogc:def:crs:EPSG::3825"==p&&(g="TWD97_119")}var m=null;switch(this.map.getCoordSys()){case TGOS.TGCoordSys.EPSG3857:m="WGS84";break;case TGOS.TGCoordSys.EPSG3826:m="TWD97";break;case TGOS.TGCoordSys.EPSG3825:m="TWD97_119";break;default:throw"Invalid Map CRS";}if(0<=b.indexOf(d.type))return p=a(d,g,m),p=new TGOS.TGGraphic({geometry:p}),this.add(p),[p];if("Feature"==
d.type)return p=f(d,e,g,m),this.add(p),[p];if("FeatureCollection"==d.type){for(var p=d,n=m,m=[],u=0;u<p.features.length;u++)m.push(f(p.features[u],e,g,n));for(p=0;p<m.length;p++)this.add(m[p]);return m}throw"Unable to import GeoJSON";};TGOS.RegisterEvent(e,"addgraphic removegraphic removeproperty setgeometry setproperty click dblclick mousedown mouseup mouseout mouseover mousemove rightclick".split(" "));return e}();TGOS.TGGeometry.TGSpherical=function(){var b={EARTH_RADIUS:6378137,computeSignedArea:function(b,a){for(var f="number"==typeof a?a:6378137,e=0,g=b.length,h=b[g-1].x,k=b[g-1].y,l=0;l<g;l++)var p=b[l].x,m=b[l].y,e=e+TGOS.math.toRadian(p-h)*(2+Math.sin(TGOS.math.toRadian(k))+Math.sin(TGOS.math.toRadian(m))),h=p,k=m;return e*f*f/2},computeArea:function(d,a){return Math.abs(b.computeSignedArea(d),a)},computeDistanceBetween:function(b,a,f){f="number"==typeof f?f:6378137;var e=TGOS.math.toRadian(b.y),g=TGOS.math.toRadian(a.y);
b=TGOS.math.toRadian(a.x-b.x);return f*Math.acos(Math.sin(e)*Math.sin(g)+Math.cos(e)*Math.cos(g)*Math.cos(b))},computeHeading:function(b,a){var f=TGOS.math.toRadian(b.y),e=TGOS.math.toRadian(a.y),g=TGOS.math.toRadian(a.x-b.x),h=Math.sin(g)*Math.cos(e),f=Math.cos(f)*Math.sin(e)-Math.sin(f)*Math.cos(e)*Math.cos(g);return TGOS.math.toDegree(Math.atan2(h,f))},computeLength:function(d,a){for(var f=0,e=0;e<d.length-1;e++)f+=b.computeDistanceBetween(d[e],d[e+1],a);return f},computeOffset:function(b,a,f,
e){var g="number"==typeof e?e:6378137;f=TGOS.math.toRadian(f);e=TGOS.math.toRadian(b.y);b=TGOS.math.toRadian(b.x);g=a/g;a=Math.asin(Math.sin(e)*Math.cos(g)+Math.cos(e)*Math.sin(g)*Math.cos(f));f=b+Math.atan2(Math.sin(f)*Math.sin(g)*Math.cos(e),Math.cos(g)-Math.sin(e)*Math.sin(a));return new TGOS.TGPoint(TGOS.math.toDegree(f),TGOS.math.toDegree(a))},interpolate:function(b,a,f){var e=TGOS.math.toRadian(b.y);b=TGOS.math.toRadian(b.x);var g=TGOS.math.toRadian(a.y),h=TGOS.math.toRadian(a.x),k=Math.cos(e),
e=Math.sin(e),l=Math.cos(g),g=Math.sin(g),p=Math.cos(h-b),m=e*g+k*l*p;if(1<=m)return a.slice();m=f*Math.acos(m);a=Math.cos(m);f=Math.sin(m);h=Math.sin(h-b)*l;l=Math.atan2(h,k*g-e*l*p);h=Math.asin(e*a+k*f*Math.cos(l));b+=Math.atan2(Math.sin(l)*f*k,a-e*Math.sin(h));return new TGOS.TGPoint(TGOS.math.toDegree(b),TGOS.math.toDegree(h))}};return b}();(function(){TGOS.TGOverlayView=function(){};var b=TGOS.TGOverlayView.prototype;b.setMap=function(b){null==b?(this.map.removeLayer(this),this.map=null):b instanceof TGOS.TGOnlineMap&&(this.map=b,this.map.addLayer(this))};b.getMap=function(){return this.map};b.getPanes=function(){return this.map?this.map.getPanes():null};b.getProjection=function(){if(!this.map)return null;var b=this.map,a=b.getMapBase(),f=b.getCoordSys();return{fromDivToMap:function(b){if(f==TGOS.TGCoordSys.EPSG3857)return b=a.ToMapPoint(b.x,
b.y),b=TGOS.WGS84ToGoo(b.x,b.y),new TGOS.TGPoint(b.x,b.y);b=a.ToMapPoint(b.x,b.y);return new TGOS.TGPoint(b.x,b.y)},fromMapToDiv:function(b){if(f==TGOS.TGCoordSys.EPSG3857)return b=TGOS.WGS84ToGoo(b.x,b.y),b=a.FromMapPoint(b.x,b.y),new TGOS.TGPoint(b.x,b.y);b=a.FromMapPoint(b.x,b.y);return new TGOS.TGPoint(b.x,b.y)}}};b.Initialize=function(){this.onAdd()};b.UpdateElement=function(){this.onDraw()};b.RebuildElement=function(){this.onDraw()};b.RemoveSelf=function(){this.onRemove()}})();(function(){var b=function(a,b,d,h){this.max="number"==typeof a?a:1;this.min="number"==typeof b?b:0;this.radius=d;h&&(this.stops=h);a=document.createElement("canvas");a.width=1;a.height=d;a=a.getContext("2d");b=a.createLinearGradient(0,0,0,d);for(var k=h=1/this.stops.length,l=0;l<this.stops.length;l++)b.addColorStop(k,this.stops[l]),k+=h;a.fillStyle=b;a.fillRect(0,0,1,d);this.data=a.getImageData(0,0,1,d).data},d=b.prototype;d.stops="rgba(0,0,255,0) #00f #0ff #0f0 #ff0 #f00".split(" ");d.getColor=
function(a){a=(a-this.min)/(this.max-this.min);1<a&&(a=1);a=4*Math.round((this.radius-1)*a);return[this.data[a],this.data[a+1],this.data[a+2],this.data[a+3]]};var a=function(a,b,d){for(var h=[],k=2*a,l=0;l<k;l++){for(var p=[],m=0;m<k;m++){var n=a-1-l,u=a-1-m,n=Math.sqrt(n*n+u*u),u=0,s=n/a,s=0.5>s?2*s*s:-1+(4-2*s)*s;n<a&&(u=b*(1-s));p.push(u)}h.push(p)}this.cmap=h;this.radius=a;this.intensity=b;d&&(this.maxIntensity=d.maxIntensity)};a.prototype.process=function(a,b,d){var h=a.length,k=a[0].length;
b-=this.radius;var l=b+2*this.radius;d-=this.radius;for(var p=d+2*this.radius,l=0>l?0:l>=h?h:l,m=0>d?0:d>k?k:d,k=0>p?0:p>=k?k:p,p=-Infinity,n=Infinity,h=0>b?0:b>h?h:b;h<l;h++)for(var u=m;u<k;u++)a[h][u]+=this.cmap[h-b][u-d],"number"==typeof this.maxIntensity&&a[h][u]>this.maxIntensity&&(a[h][u]=maxIntensity),p=Math.max(p,a[h][u]),n=Math.min(n,a[h][u]);return{max:p,min:n}};TGOS.TGHeatmapLayer=function(a){this.data=[];this.div=document.createElement("div");this.div.style.width="100%";this.div.style.height=
"100%";this.div.style.position="absolute";this.cv=document.createElement("canvas");this.cv.style.position="absolute";this.div.appendChild(this.cv);this.ctx=this.cv.getContext("2d");this.cacheImage=new Image;a&&this.setOptions(a)};TGOS.TGHeatmapLayer.prototype=new TGOS.TGOverlayView;d=TGOS.TGHeatmapLayer.prototype;d.getData=function(){return this.data};d.createKernels=function(){this.kernels=[];for(var b=0;b<this.data.length;b++){var d="number"==typeof this.data[b].weight?this.data[b].weight:1,g=1;
this.dissipating&&(g=this.map.getZoom(),g=Math.pow(2,g));d=new a((this.radius?this.radius:10)*g,d);this.kernels.push(d)}};d.setData=function(a){this.data=a;this.createKernels();this.draw_()};d.createHeatmap=function(a,b){for(var d=[],h=0;h<a;h++){for(var k=[],l=0;l<b;l++)k.push(null);d.push(k)}return d};d.onAdd=function(){this.getPanes().overlayviewLayer.appendChild(this.div);this.width=this.div.clientWidth;this.height=this.div.clientHeight;this.cv.width=this.width;this.cv.height=this.height;var a=
this;this.chl&&TGOS.TGEvent.removeListener(this.chl);this.il&&TGOS.TGEvent.removeListener(this.il);this.rl&&TGOS.TGEvent.removeListener(this.rl);this.chl=TGOS.TGEvent.addListener(this.map,"center_changed",function(){a.translate()});this.il=TGOS.TGEvent.addListener(this.map,"idle",function(){a.draw_()});this.rl=TGOS.TGEvent.addListener(this.map,"resize",function(){a.width=a.div.clientWidth;a.height=a.div.clientHeight;a.cv.width=a.div.clientWidth;a.cv.height=a.div.clientHeight;a.draw_()});a.draw_()};
d.translate=function(){if(this.center_){var a=this.getProjection(),b=this.map.getCenter(),d=a.fromMapToDiv(this.center_),b=a.fromMapToDiv(b),a=b.x-d.x,d=b.y-d.y;this.ctx.clearRect(0,0,this.width,this.height);this.ctx.drawImage(this.cacheImage,-a,-d)}};d.draw_=function(){this.heatmap=this.createHeatmap(this.width,this.height);var a=-Infinity,d=0,g=this.getProjection();this.kernels&&!this.dissipating||this.createKernels();for(var h=0;h<this.data.length;h++)var k=g.fromMapToDiv(this.data[h]),k=this.kernels[h].process(this.heatmap,
Math.round(k.x),Math.round(k.y)),a=Math.max(k.max,a),d=Math.min(k.min,d);"number"==typeof this.maxIntensity&&(a=this.maxIntensity);a=new b(a,d,256,this.gradient?this.gradient:this.stops);this.ctx.clearRect(0,0,this.width,this.height);d=this.ctx.createImageData(this.width,this.height);for(g=0;g<this.heatmap.length;g++)for(h=0;h<this.heatmap[g].length;h++)if(k=this.heatmap[g][h],null!=k){var k=a.getColor(k),l=d,p=k[1],m=k[2],n=k[3],u=4*(g+h*l.width);l.data[u]=k[0];l.data[u+1]=p;l.data[u+2]=m;l.data[u+
3]=n}this.ctx.putImageData(d,0,0);this.cacheImage.src=this.cv.toDataURL();this.center_=this.map.getCenter()};d.onDraw=function(){};d.onRemove=function(){this.div.parentNode.removeChild(this.div)};d.setOptions=function(a){a&&(a.data&&(this.data=a.data),void 0!==a.dissipating&&(this.dissipating=a.dissipating),void 0!==a.gradient&&(this.gradient=a.gradient),void 0!==a.maxIntensity&&(this.maxIntensity=a.maxIntensity),void 0!==a.opacity&&(this.opacity=a.opacity),this.div.style.opacity=this.opacity?this.opacity:
0.6,void 0!==a.radius&&(this.radius=a.radius),this.kernels=null,this.setMap(a.map||this.map))}})();(function(){TGOS.TGLayerSwipe=function(b){if(b)if(b.map&&(this.map=b.map),b.layers&&(this.layers=b.layers instanceof Array?b.layers:[b.layers]),"string"==typeof b.type&&(this.type=b.type),this.swipeSize="number"==typeof b.size?b.size:"string"==typeof b.size?parseFloat(b.size):300,this.borderStyle="string"==typeof b.borderStyle?b.borderStyle:"solid",this.borderWidth="number"==typeof b.borderWidth?b.borderWidth:"string"==typeof b.borderWidth?parseFloat(b.borderWidth):1,this.borderRadius="string"==typeof b.borderRadius?
b.borderRadius:"50%",this.borderColor="string"==typeof b.borderColor?b.borderColor:"#eaeaea",this.left="number"==typeof b.left?b.left:"horizontal"==this.type?b.map.getDiv().offsetWidth:(b.map.getDiv().offsetWidth+1)/2,this.top="number"==typeof b.top?b.top:"horizontal"==this.type?(b.map.getDiv().offsetHeight+1)/2:b.map.getDiv().offsetHeight,this.map&&this.layers)this.onAdd();else throw"map and layers must be provided";};TGOS.TGLayerSwipe.prototype=new TGOS.TGOverlayView;var b=TGOS.TGLayerSwipe.prototype;
b.onAdd=function(){this.buildNode();this.updateClip_()};b.destroy=function(){var b=function(a,b){a&&(a.style.clip=null,"round"==b||"circle"==b)&&(a.style.webkitClipPath=null,a.style.mozClipPath=null,a.style.msClipPath=null,a.style.oClipPath=null,a.style.clipPath=null)};if(this.layers)for(var a=0;a<this.layers.length;){var f=this.layers[a];if(null!=f&&f.getNode&&(f=f.getNode()))if(f instanceof Array)for(var e=0;e<f.length;e++)b(f[e],this.type);else b(f,this.type);a++}for(;this.node.firstChild;)this.node.removeChild(this.node.firstChild);
this.node.removeAttribute("style");this.node.innerHTML="";this.getPanes().controlLayer.removeChild(this.node);this.bounds_changed_&&TGOS.TGEvent.removeListener(this.bounds_changed_);this.bounds_changed_=null;this.zoom_changed_&&TGOS.TGEvent.removeListener(this.zoom_changed_);this.zoom_changed_=null;this.tilesloaded_&&TGOS.TGEvent.removeListener(this.tilesloaded_);this.tilesloaded_=null;this.drag_&&TGOS.TGEvent.removeListener(this.drag_);this.drag_=null;this.wms_loaded_&&TGOS.TGEvent.removeListener(this.wms_loaded_);
this.wmts_loaded_=null;this.wms_loaded_=null};b.buildNode=function(){var b=this,a=document.createElement("div"),f=document.createElement("div");this.node=document.createElement("div");this.node.appendChild(a);this.node.appendChild(f);this.getPanes().controlLayer.appendChild(this.node);for(var e=0;e<this.layers.length;e++){var g=this.layers[e];g instanceof TGOS.WMSLayer||g instanceof TGOS.TGWmsLayer?this.wms_loaded_=TGOS.TGEvent.addListener(g,"image_loaded",function(){b.wmsRefreshed(b)}):g instanceof
TGOS.WMTSLayer&&(this.wmts_loaded_=TGOS.TGEvent.addListener(g,"image_loaded",function(){b.wmtsRefreshed(b)}))}if("horizontal"==this.type||"vertical"==this.type){"horizontal"==this.type?(f.setAttribute("class","handle horizontal-handle"),a.setAttribute("class","bar horizontal-bar"),this.node.style.left="0px",this.node.style.top="4px",this.node.style.width="100%",this.node.style.position="absolute",a.style.top=-(a.clientHeight/2)+"px",a.style.position="absolute",a.style.backgroundColor="#eaeaea",a.style.borderTop=
"1px solid #505050",a.style.borderBottom="1px solid #505050",a.style.height="4px",a.style.width="100%",f.style.left=this.left/2+"px",f.style.position="absolute",f.style.backgroundColor="#eaeaea",f.style.border="1px solid #505050",f.style.borderRadius="4px",f.style.width="36px",f.style.height="18px",f.style.cursor="row-resize",f.style.background="linear-gradient(to bottom,#eaeaea,#eaeaea,lightgray)",f.style.top="-9px"):(f.setAttribute("class","handle vertical-handle"),a.setAttribute("class","bar vertical-bar"),
this.node.style.left=this.left+"px",this.node.style.top="0px",this.node.style.height="100%",this.node.style.position="absolute",a.style.left=-(a.clientWidth/2)+"px",a.style.position="absolute",a.style.backgroundColor="#eaeaea",a.style.borderTop="1px solid #505050",a.style.borderBottom="1px solid #505050",a.style.width="4px",a.style.height="100%",f.style.top=this.top/2-f.clientHeight/2+"px",f.style.position="absolute",f.style.backgroundColor="#eaeaea",f.style.border="1px solid #505050",f.style.borderRadius=
"4px",f.style.width="18px",f.style.height="36px",f.style.cursor="col-resize",f.style.background="linear-gradient(to right,#eaeaea,#eaeaea,lightgray)",f.style.left="-9px");var a=function(a){AttachEvent(document.body,"mousemove",k);AttachEvent(document.body,"mouseup",h);a.preventDefault&&a.preventDefault();return!1},h=function(a){DetachEvent(document.body,"mousemove",k);DetachEvent(document.body,"mouseup",h);a.preventDefault&&a.preventDefault();return!1},k=function(a){if(b.node&&b.node.parentNode){var e=
b.node.parentNode.getBoundingClientRect();if("horizontal"==b.type){var f=a.clientY-e.top;f>e.height-3&&(f=e.height-3);b.top=f}else f=a.clientX-e.left,f>e.width-3&&(f=e.width-3),b.left=f;b.updateClip_();a.preventDefault&&a.preventDefault();return!1}};AttachEvent(f,"mousedown",a)}else if("circle"==this.type||"square"==this.type||"round"==this.type)this.node.style.width=this.swipeSize+"px",this.node.style.height=this.swipeSize+"px",this.node.style.position="absolute",this.top=this.top/2-this.swipeSize/
2,this.left-=this.swipeSize/2,this.node.style.left=this.left+"px",this.node.style.top=this.top+"px","square"==this.type?(this.node.style.borderStyle=this.borderStyle,this.node.style.borderWidth=this.borderWidth+"px",this.node.style.borderColor=this.borderColor):"circle"==this.type?(this.node.style.borderStyle=this.borderStyle,this.node.style.borderWidth=this.borderWidth+"px",this.node.style.borderRadius="50%",this.node.style.borderColor=this.borderColor,this.bounds_changed_=TGOS.TGEvent.addListener(this.map,
"bounds_changed",function(){b.mapChanged(b)}),this.zoom_changed_=TGOS.TGEvent.addListener(this.map,"zoom_changed",function(){b.mapChanged(b)}),this.tilesloaded_=TGOS.TGEvent.addListener(this.map,"tilesloaded",function(){b.mapChanged(b)}),this.drag_=TGOS.TGEvent.addListener(this.map,"drag",function(){b.mapChanged(b)})):"round"==this.type&&(this.node.style.borderStyle=this.borderStyle,this.node.style.borderWidth=this.borderWidth,this.node.style.borderRadius=this.borderRadius,this.node.style.borderColor=
this.borderColor,this.bounds_changed_=TGOS.TGEvent.addListener(this.map,"bounds_changed",function(){b.mapChanged(b)}),this.zoom_changed_=TGOS.TGEvent.addListener(this.map,"zoom_changed",function(){b.mapChanged(b)}),this.tilesloaded_=TGOS.TGEvent.addListener(this.map,"tilesloaded",function(){b.mapChanged(b)}),this.drag_=TGOS.TGEvent.addListener(this.map,"drag",function(){b.mapChanged(b)})),a=function(a){AttachEvent(document.body,"mousemove",k);AttachEvent(document.body,"mouseup",h);b.clientX=a.clientX;
b.clientY=a.clientY;a.preventDefault&&a.preventDefault();return!1},h=function(a){DetachEvent(document.body,"mousemove",k);DetachEvent(document.body,"mouseup",h);a.preventDefault&&a.preventDefault();return!1},k=function(a){if(b.node&&b.node.parentNode){var e=b.left+(a.clientX-b.clientX),f=b.top+(a.clientY-b.clientY),g=b.node.parentNode.getBoundingClientRect();f>g.height-10&&(f=g.height-10);f<-b.swipeSize+10&&(f=-b.swipeSize+10);e>g.width-10&&(e=g.width-10);e<-b.swipeSize+10&&(e=-b.swipeSize+10);b.node.style.top=
f+"px";b.top=f;b.clientY=a.clientY;b.node.style.left=e+"px";b.left=e;b.clientX=a.clientX;b.updateClip_();a.preventDefault&&a.preventDefault();return!1}},AttachEvent(this.node,"mousedown",a)};b.wmtsRefreshed=function(b){b.mapChanged(b)};b.wmsRefreshed=function(b){b.mapChanged(b)};b.mapChanged=function(b){function a(){clearTimeout(f);e=b.updateClip_(e);0<e&&(f=setTimeout(a,100))}var f,e=0;a()};b.updateClip_=function(b){var a=Infinity;if("horizontal"==this.type||"vertical"==this.type){var f="rect(0px,"+
this.left+"px,"+this.top+"px,0px)";b=function(a){a&&(a.style.clip=f)};for(var e=0;e<this.layers.length;){var g=this.layers[e];if(null!=g&&g.getNode){var h=g.getNode();if(h)if(h instanceof Array)for(var k=0;k<h.length;k++)b(h[k]);else b(h)}e++}"horizontal"==this.type?this.node.style.top=this.top+"px":this.node.style.left=this.left+"px";a=0}else if("square"==this.type){var l="rect("+this.top+"px,"+(this.left+this.swipeSize+this.borderWidth)+"px,"+(this.top+this.swipeSize+this.borderWidth)+"px,"+this.left+
"px)";b=function(a){a&&(a.style.clip=l)};for(e=0;e<this.layers.length;){g=this.layers[e];null!=g&&g.getNode&&(h=g.getNode());if(h)if(h instanceof Array)for(k=0;k<h.length;k++)b(h[k]);else b(h);e++}a=0}else if("circle"==this.type)for(var p=Math.ceil(this.swipeSize/2),e=Math.round(this.swipeSize/2),m=this.left+e+this.borderWidth,n=this.top+e+this.borderWidth,u="circle("+p+"px at 50% 50%)",s="circle("+p+"px at "+m+"px "+n+"px)",q=null,w=function(a,b,d){var e=Infinity;if(a){e="";if(b)if(b instanceof TGOS.WMTSLayer||
b instanceof TGOS.TGWmtsLayer)e="WMTSLayer";else if(b instanceof TGOS.WMSLayer||b instanceof TGOS.TGWmsLayer)e="WMSLayer";if("WMTSLayer"==e){for(var e=0,f=b=Infinity,g=0;g<a.childNodes.length;g++){var h=a.childNodes[g];if(h){var k=h.offsetLeft,l=h.offsetTop,w=k+h.offsetWidth,h=l+h.offsetHeight;0==k&&0==l&&0==w&&0==h&&(e+=1);k<b&&(b=k);l<f&&(f=l)}}e==d&&(e=0);q="circle("+p+"px at "+(m-b)+"px "+(n-f)+"px)"}else{if("WMSLayer"==e){if(h=a.childNodes[0])d=h.offsetLeft,e=h.offsetTop,q="circle("+p+"px at "+
(m-(0<=d?0:d))+"px "+(n-(0<=e?0:e))+"px)"}else q=a.childNodes[0].clientWidth&&a.childNodes[0].clientHeight?s:u;e=0}a.style.clip=q;a.style.webkitClipPath=q;a.style.mozClipPath=q;a.style.msClipPath=q;a.style.oClipPath=q;a.style.clipPath=q}return e},e=0;e<this.layers.length;){g=this.layers[e];null!=g&&g.getNode&&(h=g.getNode());if(h)if(h instanceof Array)for(k=a=0;k<h.length;k++)a+=w(h[k],g,b);else a=w(h,g,b);e++}else a=0;return a};b.setOptions=function(b){}})();(function(){var b=function(a){for(var b="",d=[],g=0;g<a.length;g++){var h=a[g];"t"!=h&&"r"!=h||d.push(g)}for(g=0;g<d.length;g++)h=a.slice(d[g]+1,d[g+1]),"t"==a[d[g]]?(h="translate("+h+") ",b+=h):"r"==a[d[g]]&&(h="rotate("+h+") ",b+=h);return b},d=function(a,b){return function(){return"xxxxxxxx-sxxx-gxxx-xxxx-xxxxxxxxxxxx".replace(a,b).toUpperCase()}}(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i;TGOS.gfxSurface=function(a){this.shapes=
[];this.sets=[];this.defs=document.createElementNS("http://www.w3.org/2000/svg","defs");a.appendChild(this.defs);this.getDefID_=function(){this.defs.childNodes.length};this.element=function(){return a};this.rect=function(b,d,g,h){var k=document.createElementNS("http://www.w3.org/2000/svg","rect");k.setAttribute("width",g);k.setAttribute("height",h);k.setAttribute("x",b);k.setAttribute("y",d);a.appendChild(k);k=new TGOS.gfxElement(k);this.shapes.push(k);k.surfacnode=this;return k};this.image=function(b,
d,g,h,k){var l=document.createElementNS("http://www.w3.org/2000/svg","image");l.setAttribute("width",h);l.setAttribute("height",k);l.setAttribute("x",d);l.setAttribute("y",g);l.setAttributeNS("http://www.w3.org/1999/xlink","href",b);a.appendChild(l);l=new TGOS.gfxElement(l,"image");this.shapes.push(l);l.surfacnode=this;l.type="image";return l};this.text=function(b,d,g){var h=document.createElementNS("http://www.w3.org/2000/svg","text");h.setAttribute("x",b);h.setAttribute("y",d);h.textContent=g;a.appendChild(h);
h=new TGOS.gfxElement(h);this.shapes.push(h);h.surfacnode=this;return h};this.circle=function(b,d,g){var h=document.createElementNS("http://www.w3.org/2000/svg","circle");h.setAttribute("cx",b);h.setAttribute("cy",d);h.setAttribute("r",g);a.appendChild(h);h=new TGOS.gfxElement(h);this.shapes.push(h);h.surfacnode=this;return h};this.path=function(b){var d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d",b);a.appendChild(d);d=new TGOS.gfxElement(d);this.shapes.push(d);
d.surfacnode=this;return d};this.clear=function(){};this.group=function(){var b=document.createElementNS("http://www.w3.org/2000/svg","g");b.style.display="block";a.appendChild(b);b=new TGOS.gfxElement(b,"group");this.shapes.push(b);b.surfacnode=this;return b}};TGOS.gfxElement=function(a,b){this.node=a;this.type=b;"group"==this.type&&(this.shapes=[])};TGOS.gfxElement.prototype.node=null;TGOS.gfxElement.prototype.surfacnode=null;TGOS.gfxElement.prototype.patternId=null;TGOS.gfxElement.prototype.type=
null;TGOS.gfxElement.prototype.getBBox=function(a){return a?this.node.getBBox():this.node.getBoundingClientRect()};TGOS.gfxElement.prototype.element=function(){return this.node};TGOS.gfxElement.prototype.hide=function(){return this.node.style.visibility="hidden"};TGOS.gfxElement.prototype.show=function(){return this.node.style.visibility="visible"};TGOS.gfxElement.prototype.attr=function(a){for(var b in a)switch(b){case "path":this.node.setAttribute("d",a[b]);break;case "fill":if("object"==typeof a[b]){if("pattern"==
a[b].type){var e=a[b].src;this.pattern&&this.pattern.parentNode.removeChild(this.pattern);var g=document.createElementNS("http://www.w3.org/2000/svg","pattern");this.pattern=g;if("100%"==a[b].width&&"100%"==a[b].height){g.setAttribute("patternContentUnits","objectBoundingBox");g.setAttribute("width",1);g.setAttribute("height",1);g.setAttribute("x",0);g.setAttribute("y",0);this.patternId=d();g.setAttribute("id",this.patternId);var h=document.createElementNS("http://www.w3.org/2000/svg","image");g.img=
h;var k=this.node,l=this.patternId,p=this.surfacnode;h.setAttribute("x","0");h.setAttribute("y","0");h.setAttribute("width","1");h.setAttribute("height","1");h.setAttribute("preserveAspectRatio","none");g.appendChild(h);p.defs.appendChild(g)}else g.setAttribute("patternUnits","userSpaceOnUse"),g.setAttribute("width",a[b].width),g.setAttribute("height",a[b].height),g.setAttribute("x",a[b].x?a[b].x:0),g.setAttribute("y",a[b].y?a[b].y:0),this.patternId=d(),g.setAttribute("id",this.patternId),h=document.createElementNS("http://www.w3.org/2000/svg",
"image"),g.appendChild(h),g.img=h,k=this.node,l=this.patternId,p=this.surfacnode,p.defs.appendChild(g),h.setAttribute("x","0"),h.setAttribute("y","0"),h.setAttribute("width",a[b].width),h.setAttribute("height",a[b].height);h.setAttributeNS("http://www.w3.org/1999/xlink","href",e);k.setAttribute("fill","url(#"+l+")")}}else this.node.setAttribute(b,a[b]);break;case "stroke-dasharray":e="";g=parseInt(this.node.getAttributeNS(null,"stroke-width"));for(h=0;h<a[b].length;h++)"_"===a[b][h]?e+=4*g+",":"."===
a[b][h]?e+=g+",":"~"===a[b][h]?e+=8*g+",":"-"===a[b][h]&&(e+=2*g+","),e+=g+",";","==e[e.length-1]&&(e=e.substring(0,e.length-1));this.node.setAttribute("stroke-dasharray",e);break;default:this.node.setAttribute(b,a[b])}};TGOS.gfxElement.prototype.setRotate=function(a,b,d){var g=this.node.getAttributeNS(null,"transform");rot=void 0===b&&void 0===d?" rotate("+a+")":" rotate("+a+" "+b+" "+d+")";g=g.replace(/rotate\(*.\)/,rot);this.node.setAttributeNS(null,"transform",g)};TGOS.gfxElement.prototype.setTranslate=
function(a,b){var d=this.node.getAttributeNS(null,"transform"),d=d.replace(/translate\(*.\)/,"translate("+a+" "+b+")");this.node.setAttributeNS(null,"transform",d)};TGOS.gfxElement.prototype.transform=function(a){this.node.setAttributeNS(null,"transform",b(a))};TGOS.gfxElement.prototype.translate=function(a,b){var d=this.node.getAttributeNS(null,"transform");this.node.setAttributeNS(null,"transform",d+(" translate("+a+" "+b+")"))};TGOS.gfxElement.prototype.rotate=function(a,b,d){var g=this.node.getAttributeNS(null,
"transform");this.node.setAttributeNS(null,"transform",void 0===b&&void 0===d?g+(" rotate("+a+")"):g+(" rotate("+a+" "+b+" "+d+")"))};TGOS.gfxElement.prototype.scale=function(a,b){var d=this.node.getAttributeNS(null,"transform");this.node.setAttributeNS(null,"transform",void 0===b?d+(" scale("+a+")"):d+(" scale("+a+" "+b+")"))};TGOS.gfxElement.prototype.remove=function(){this.pattern&&this.pattern.parentNode&&this.pattern.parentNode.removeChild(this.pattern);this.node&&this.node.parentNode&&this.node.parentNode.removeChild(this.node)};
TGOS.gfxElement.prototype.insertBefore=function(a){this.surfacnode.element().insertBefore(this.node,a.node)};TGOS.gfxElement.prototype.rect=function(a,b,d,g){var h=document.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("width",d);h.setAttribute("height",g);h.setAttribute("x",a);h.setAttribute("y",b);this.node.appendChild(h);h=new TGOS.gfxElement(h);this.shapes.push(h);h.surfacnode=this.surfacnode;return h};TGOS.gfxElement.prototype.image=function(a,b,d,g,h){var k=document.createElementNS("http://www.w3.org/2000/svg",
"image");k.setAttribute("width",g);k.setAttribute("height",h);k.setAttribute("x",b);k.setAttribute("y",d);k.setAttributeNS("http://www.w3.org/1999/xlink","href",a);this.node.appendChild(k);k=new TGOS.gfxElement(k,"image");this.shapes.push(k);k.surfacnode=this.surfacnode;return k};TGOS.gfxElement.prototype.text=function(a,b,d){var g=document.createElementNS("http://www.w3.org/2000/svg","text");g.setAttribute("x",a);g.setAttribute("y",b);g.textContent=d;this.node.appendChild(g);g=new TGOS.gfxElement(g);
this.shapes.push(g);g.surfacnode=this.surfacnode;return g};TGOS.gfxElement.prototype.circle=function(a,b,d){var g=document.createElementNS("http://www.w3.org/2000/svg","circle");g.setAttribute("cx",a);g.setAttribute("cy",b);g.setAttribute("r",d);this.node.appendChild(g);g=new TGOS.gfxElement(g);this.shapes.push(g);g.surfacnode=this.surfacnode;return g};TGOS.gfxElement.prototype.path=function(a){var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttributeNS(null,"d",a);this.node.appendChild(b);
b=new TGOS.gfxElement(b);this.shapes.push(b);b.surfacnode=this.surfacnode;return b};TGOS.gfxElement.prototype.clear=function(){};TGOS.gfxElement.prototype.group=function(){var a=document.createElementNS("http://www.w3.org/2000/svg","g");this.node.appendChild(a);a=new TGOS.gfxElement(a,"group");this.shapes.push(a);a.surfacnode=this.surfacnode;return a};TGOS.createSurface=function(a,b,d){if(!TGOS.features.svg)return null;var g=document.createElementNS("http://www.w3.org/2000/svg","svg");d="number"==
typeof d?d:"100%";g.setAttribute("width","number"==typeof b?b:"100%");g.setAttribute("height",d);g.setAttribute("overflow","hidden");g.style.position="absolute";a.appendChild(g);return new TGOS.gfxSurface(g)}})();TGOS.renderers=TGOS.renderers||function(){var b={Renderer:function(){this.getColor=function(b){if(this.colorInfo&&(b=b.attributes)){b=(parseFloat(b[this.colorInfo.field])-this.colorInfo.minValue)/(this.colorInfo.maxValue-this.colorInfo.minValue);var a=this.colorInfo.colors.length;if(2<=a){a=b/(1/(a-1));b=Math.floor(a);var a=a-b,f=this.colorInfo.colors[b];b=this.colorInfo.colors[b+1];return b?b=new TGOS.Color(f.r+(b.r-f.r)*a,f.g+(b.g-f.g)*a,f.b+(b.b-f.b)*a,f.a+(b.a-f.a)*a):(b=this.colorInfo.colors[this.colorInfo.colors.length-
1],b=new TGOS.Color(b.r,b.g,b.b,b.a))}}};this.getRotationAngle=function(b){if(this.rotationInfo&&(b=b.attributes)){b=parseFloat(b[this.rotationInfo.field]);var a,f=this.rotationInfo.type;"geographic"==f?a=360-b-90:"arithmetic"==f&&(a=b);return a}};this.getSize=function(b){if(this.propotionalSymbolInfo){var a=b.attributes;if(a){b=this.propotionalSymbolInfo.maxSize;var f=this.propotionalSymbolInfo.minSize,a=parseFloat(a[this.propotionalSymbolInfo.field]);return a>b?b:a<f?f:a}}};this.setColorInfo=function(b){b&&
(this.colorInfo=b);return this};this.setSizeInfo=function(b){b&&(this.sizeInfo=b);return this};this.setOpacityInfo=function(b){b&&(this.opacityInfo=b);return this};this.setProportionalSymbolInfo=function(b){b&&(this.propotionalSymbolInfo=b);return this};this.setRotationInfo=function(b){b&&(this.rotationInfo=b);return this}},ClassBreaksRenderer:function(b,a){this.getSymbol=function(a){for(var b=0;b<this.infos.length;b++)if(this.infos[b].maxValue>a.attributes[this.attributeField]&&this.infos[b].minValue<=
a.attributes[this.attributeField])return this.infos[b].symbol;return this.defaultSymbol};this.infos=[];if(!b)throw"Default Symbol must be provided";this.defaultSymbol=b;if("string"!=typeof a)throw"Attribute field must be provided";this.attributeField=a}};TGOS.extend(b.Renderer,b.ClassBreaksRenderer);b.ClassBreaksRenderer.prototype.addBreak=function(b){this.infos.push(b)};b.ClassBreaksRenderer.prototype.removeBreak=function(b){b=this.infos.indexOf(b);0<=b&&this.infos.splice(b,1)};return b}();TGOS.request=function(){var b={},d=0,a=function(a){var b=document.createElement("form");b.setAttribute("method",a.method?a.method:"POST");b.setAttribute("enctype","multipart/form-data");b.setAttribute("encoding","multipart/form-data");for(var d in a.data){var e=document.createElement("input");e.type="hidden";e.name=d;e.value=a.data[d];b.appendChild(e)}a=document.createElement("input");a.type="submit";b.appendChild(a);document.body.appendChild(b);return b};b.iframe=function(b,e){var f="sgIFrame"+d,
l=document.createElement("iframe");l.setAttribute("id",f);l.setAttribute("name",f);l.setAttribute("width","0");l.setAttribute("height","0");l.setAttribute("border","0");l.setAttribute("style","width: 0; height: 0; border: none;");var p=e.form?e.form:a(e);document.body.appendChild(l);var m=document.getElementById(f),n=function(){m.detachEvent?m.detachEvent("onload",n):m.removeEventListener("load",n,!1);m.contentDocument?content=m.contentDocument.body.innerHTML:m.contentWindow?content=m.contentWindow.document.body.innerHTML:
m.document&&(content=m.document.body.innerHTML);e.callback&&e.callback.call(this,JSON.parse(content));m.parentNode.removeChild(m)};m.addEventListener&&m.addEventListener("load",n,!0);m.attachEvent&&m.attachEvent("onload",n);p.setAttribute("target",f);p.setAttribute("action",b);p.submit();d++};var f=function(a,b,d){return 0<=a.indexOf("?")?a+"&"+b+"="+d:a+"?"+b+"="+d};b.getJSON=function(a,d,e,l){var p=DeviceTest();"number"!=typeof b.ajaxCount__&&(b.ajaxCount__=0);var m="sn"+b.ajaxCount__;TGOS.request.getJSON[m]=
function(){d.apply(this,arguments);delete TGOS.request.getJSON[m]};e&&(a=f(e,"serv",encodeURIComponent(a)));a=f(a,"jsonp",encodeURIComponent("TGOS.request.getJSON['"+m+"']"));e=document.getElementsByTagName("head");if(0!=e.length){var n=document.createElement("script");n.type="text/javascript";"MSIE"==p?n.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(this.parentNode.removeChild(n),n=void 0)}:n.onload=function(){this.parentNode.removeChild(n);
n=void 0};n.onerror=function(){l&&l.call(this);this.parentNode.removeChild(n);n=void 0};b.ajaxCount__++;n.src=a;e[0].appendChild(n)}};var e=function(a,b,d){4==a.readyState&&(200!=a.status&&304!=a.status?d&&d.call(this,a.status):b&&b.call(this,a))};b.ajax=function(a,b){var d;d=window.XMLHttpRequest?new XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):void 0;var f="get",p=!1,m=null,n=null,u=null,s=null,q=null;b&&("post"===b.method&&(f="post"),!1===b.async&&(p=!1),!1===b.async&&
(m=null),b.user&&(n=b.user),b.password&&(u=b.password),b.error&&(s=b.error),b.complete&&(q=b.complete));d.open(f,a,p,n,u);m&&d.setRequestHeader("Content-type","application/x-www-form-urlencoded");!0===p&&(d.onreadystatechange=function(a){e(d,q,s)});4!=d.readyState&&(d.send(m),!1===p&&e(d,q,s))};b.get=function(a,d){d.method="get";b.ajax.call(this,a,d)};b.post=function(a,d){d.method="post";b.ajax.call(this,a,d)};return b}();(function(){var b=/\${[\w:]*}/g,d;TGOS.GraphicsLayer=function(){this.graphics=this.surface=this.lastScale=this.svgContainer=this.surface_=this.map_=null;this.mouseEventEnabled=!0;this.infoTemplate=this.renderer=null;this.visible=!0;this.graphics=[];this.title=this.name="Graphics Layer";this.maxScale=this.minScale=0;this.getNode=function(){return this.node};this.templateReplace=function(a,d){var e=d.match(b);if(e)for(var g=0;g<e.length;g++){var h=e[g].replace("{","").replace("$","").replace("}","").split(":"),
k="";1>=h.length?k=a.attributes[h[0]]?a.attributes[h[0]]:"":window[h[1]]&&(k=window[h[1]].call(this,a.attributes[h[0]],h[0],a.attributes));d=d.replace(e[g],k)}return d};this.add=function(a){a&&(a.layer=this,a.draw(this.map_,new TGOS.TGPoint(a.attributes.longitude,a.attributes.latitude)),this.graphics.push(a),TGOS.TGEvent.trigger(a,"graphic-add"))};this.clear=function(){for(var a=0;a<this.graphics.length;a++){var b=this.graphics[a];if(!(b instanceof TGOS.Graphic))return;for(var d=0;d<b.shapes.length;d++)b.shapes[d].remove();
b.shapes=[]}this.graphics=[];TGOS.TGEvent.trigger(b,"graphic-clear")};this.setInfoTemplate=function(a){tempe&&(this.infoTemplate=a)};this.disableMouseEvents=function(){this.mouseEventEnabled=!1};this.enableMouseEvents=function(){this.mouseEventEnabled=!0};this.getMap=function(){return this.map_};this.isVisibleAtScale=function(a){var b=0===this.maxScale||a<this.maxScale;return(0===this.minScale||a>this.minScale)&&b};this.setMaxScale=function(a){"number"==typeof a&&(this.maxScale=a,this.map_&&(a=this.map_.getMapBase().getScale(),
this.isVisibleAtScale(a)||(this.node.style.visibility="hidden")))};this.setMinScale=function(a){"number"==typeof a&&(this.minScale=a,this.map_&&(a=this.map_.getMapBase().getScale(),this.isVisibleAtScale(a)||(this.node.style.visibility="hidden")))};this.setVisibility=function(a){"boolean"==typeof a&&(this.node&&(this.node.style.visibility=a?"visible":"hidden"),this.visible=a)};this.setRenderer=function(a){this.renderer=a;this.map_&&this.redraw()};this.redraw=function(){for(var a=0;a<this.graphics.length;a++)this.graphics[a].draw()};
this.remove=function(a){if(a instanceof TGOS.Graphic){for(var b=0;b<a.shapes.length;b++)a.shapes[b].remove();a.shapes=[];b=this.graphics.indexOf(a);-1<b&&this.graphics.splice(b,1);TGOS.TGEvent.trigger(a,"graphic-remove")}};this.UpdateElement=function(){if(this.map_.getMapBase().getScale()==this.lastScale){var a=this.map_.getMapBase().FromMapPoint(d.x,d.y);Math.round(a.x);Math.round(a.y);this.trans=a}};this.RebuildElement=function(){var a=this.map_.getMapBase().getScale(),b=a!=this.lastScale;this.isVisibleAtScale(a)||
this.setVisibility(!1);b&&(this.lt_=this.map_.getMapBase().ToMapPoint(0,0),this.trans=new TGOS.TGPoint(0,0),this.lastScale=this.map_.getMapBase().getScale(),this.visible&&this.redraw())};this.Initialize=function(a){this.map_=this.mapsa;this.map=a;this.map_.getMapBase();this.map_.getMapBase();this.lt_=this.map_.getMapBase().ToMapPoint(0,0);d=this.map_.getMapBase().ToMapPoint(0,0);this.trans=new TGOS.TGPoint(0,0);this.lastScale=this.map_.getMapBase().getScale();this.redraw()};this.RemoveSelf=function(){this.zoomStartEvt_&&
this.zoomStartEvt_.remove();this.zoomEndEvt_&&this.zoomEndEvt_.remove()};TGOS.RegisterEvent(TGOS.GraphicsLayer,"graphic-add graphic-remove graphic-clear drag-start drag drag-end click dblclick mousedown mouseup mouseout mouseover mousemove rightclick".split(" "))}})();(function(){TGOS.TGGraphicsLayer=function(b,d){this.advancedLayer=this.map=null;this.visible=!0;this.opacity=1;this.graphics=[];this.title=this.name=null;this.getNode=function(){if(this.map){if(this.advancedLayer){var a=this.advancedLayer;return null!=a?[a.div.main,a.div.shadow]:this.map.getPanes().graphicLayer}return this.map.getPanes().graphicLayer}};this.getAllGraphics=function(){return this.graphics};this.add=function(a,b){a&&(a instanceof TGOS.TGFill||a instanceof TGOS.TGLine||a instanceof TGOS.TGMarker||
a instanceof TGOS.TGLabel)&&(a.setAdvancedLayer(this.advancedLayer),a.setMap(this.map),a.setVisible(this.visible),a.redraw&&a.redraw(!0),this.graphics.push(a),null==b&&TGOS.TGEvent.trigger(this,"graphic_add"))};this.load=function(a){if(void 0!==a&&null!=a){if(a instanceof Array)for(var b=a.length,d=0;d<b;d++)this.add(a[d],!0);else this.add(a,!0);this.getMap().getMapBase().RefreshMap()}};this.removeAt=function(a){if(0<=a&&a<graphics.length){var b=graphics[a];null!=b&&(b.setMap&&b.setMap(null),this.graphics.splice(a,
1))}};this.remove=function(a){void 0!==a&&(a=this.graphics.indexOf(a),0<=a&&this.removeAt(a),TGOS.TGEvent.trigger(this,"graphic_remove"))};this.clear=function(){for(var a=this.graphics.length,b=0;b<a;b++){var d=this.graphics[b];d.setMap&&d.setMap(null)}this.graphics=[];TGOS.TGEvent.trigger(this,"graphic_clear")};this.getName=function(){return this.name};this.setName=function(a){this.name=a};this.getTitle=function(){return this.title};this.setTitle=function(a){this.title=a};this.getMap=function(){return this.map};
this.getOpacity=function(){return this.opacity};this.setOpacity=function(a){"number"==typeof a&&(this.opacity=a,0>this.opacity&&(this.opacity=0),1<this.opacity&&(this.opacity=1),this.advancedLayer&&(this.advancedLayer.div.main.style.opacity=this.opacity,this.advancedLayer.div.main.style.filter="alpha(opacity="+100*this.opacity+")",this.advancedLayer.div.shadow.style.opacity=this.opacity,this.advancedLayer.div.shadow.style.filter="alpha(opacity="+100*this.opacity+")"))};this.getVisible=function(){return this.visible};
this.setVisible=function(a){if("boolean"==typeof a&&(this.visible=a,this.graphics))for(var b=this.graphics.length,d=0;d<b;d++)this.graphics[d].setVisible(a)};this.setOptions=function(a){void 0!==a&&(void 0!==a.name&&this.setName(a.name),void 0!==a.title&&this.setTitle(a.title),void 0!==a.visible&&this.setVisible(a.visible),void 0!==a.opacity&&this.setOpacity(a.opacity));null==this.name&&(this.name="TGGraphic_Layer");null==this.title&&(this.title=this.name)};this.redraw=function(){for(var a=this.graphics.length,
b=0;b<a;b++)this.graphics[b].draw()};this.Initialize=function(a){this.map=a;this.redraw()};this.removeAdvancedLayer=function(){null!=this.advancedLayer&&(this.map.removeIndependentContainer(this.advancedLayer),this.advancedLayer=null)};this.removeLayer=function(){this.map&&(this.clear(),this.removeAdvancedLayer());this.map=null};this.RemoveSelf=function(){this.removeLayer()};TGOS.RegisterEvent(TGOS.TGGraphicsLayer,"add remove clear click dblclick mousedown mouseup mouseout mouseover mousemove rightclick".split(" "));
this.map=b;d&&this.setOptions(d);void 0!==this.map&&null!=this.map&&(this.advancedLayer=this.map.addIndependentContainer(this.name))}})();(function(){var b=function(a,b){for(var d=0,g=0,h=0,k=0,l;k<a.length;){if(";"==a[k]){l=1;k=0;break}else if(","==a[k]){l=2;k=0;break}k++}this.output=function(d,e,k){d=a.slice(d,e);1==l&&b.onRead&&b.onRead.call(null,{row:g,col:h,value:d,status:";"==k?"endValue":"endLine"});2==l&&b.onRead&&b.onRead.call(null,{row:g,col:h,value:d,status:","==k?"endValue":"endLine"})};this.readValue=function(){var b="q0",f,k;if(d>=a.length)return!1;f=d;if(1==l)for(;d<a.length;){var u=a[d];if("q0"==b)if(";"==u||"\n"==u){TGOS.isNumber(k)||
(k=d);this.output(f,k,u);";"==u?h++:"\n"==u&&(g++,h=0);d++;break}else'"'==u&&('"'==a[d+1]?(b="q2",d++,f+=2):(b="q1",f++));else"q1"==b?'"'==a.slice(d,d+1)&&(k=d,b="q0"):"q2"==b&&'""'==a.slice(d,d+2)&&(k=d,d+=1,b="q0");d++}if(2==l)for(;d<a.length;){u=a[d];if("q0"==b)if(","==u||"\n"==u){TGOS.isNumber(k)||(k=d);this.output(f,k,u);","==u?h++:"\n"==u&&(g++,h=0);d++;break}else'"'==u&&('"'==a[d+1]?(b="q2",d++,f+=2):(b="q1",f++));else"q1"==b?'"'==a.slice(d,d+1)&&(k=d,b="q0"):"q2"==b&&'""'==a.slice(d,d+2)&&
(k=d,d+=1,b="q0");d++}return!0}};TGOS.TGCSVLayer=function(a,b){this.url=a;this.latFields="lat latitude y ycenter latitude83 latdecdeg POINT-Y".split(" ");this.lonFields="lon lng long longitude x xcenter longitude83 longdecdeg POINT-X".split(" ");b&&(TGOS.isString(b.latitudeFieldName)&&this.latFields.unshift(b.latitudeFieldName),TGOS.isString(b.longitudeFieldName)&&this.lonFields.unshift(b.longitudeFieldName),-1!=b.outSR.indexOf("EPSG")&&(this.outSR=b.outSR),this.mapsa=b.map,this.init())};TGOS.TGCSVLayer.prototype=
new TGOS.GraphicsLayer;var d=TGOS.TGCSVLayer.prototype;d.loadCSV=function(){var a=this;encodeURIComponent(a.url);TGOS.request.get(this.url,{complete:TGOS.wrap(this,this.parseCSV),error:function(){if(TGOS.PROXY_SERVICE2){var b=TGOS.PROXY_SERVICE2+"?url="+encodeURIComponent(a.url);TGOS.request.get(b,{complete:TGOS.wrap(a,a.parseCSV)})}}})};d.parseCSV=function(a){var d=this,e=[],g=0,h=0,k={},l=0,p=0;for(a=new b(a.responseText,{onRead:function(a){0==a.row?(e.push(a.value),0<=d.lonFields.indexOf(a.value)?
g=a.col:0<=d.latFields.indexOf(a.value)&&(h=a.col)):"endLine"==a.status?(k[e[a.col]]=a.value,a=new TGOS.TGPoint(l,p),a=-1!=d.outSR.indexOf("3857")?TGOS.GooToWGS84(a.x,a.y):a,a=new TGOS.TGGraphic(a),a.attributes=k,d.add(a),k={}):(a.col==g&&(l=parseFloat(a.value)),a.col==h&&(p=parseFloat(a.value)),k[e[a.col]]=a.value)}});a.readValue(););};d.init=function(a){d.Initialize.apply(this,arguments);this.loadCSV()}})();(function(){TGOS.TGGauge=function(b,a){this.node=b;this.angle=0;this.outRadius=80;this.inRadius=60;a&&(a.layer&&(this.layer=a.layer),this.maxDataValue="number"==typeof a.maxDataValue?a.maxDataValue:100,this.dataField="string"==typeof a.dataField?a.dataField:"",this.dataFormat="string"==typeof a.dataFormat?a.dataFormat:"value",this.caption="string"==typeof a.caption?a.caption:"",this.title="string"==typeof a.title?a.title:"",this.dataLabelField="string"==typeof a.dataLabelField?a.dataLabelField:"",
this.unitLabel="string"==typeof a.unitLabel?a.unitLabel:"",this.color="string"==typeof a.color?a.color:"#88ff33",this.lowColor="string"==typeof a.lowColor?a.lowColor:"#88ff33",this.midColor="string"==typeof a.midColor?a.midColor:"#FFD700",this.highColor="string"==typeof a.highColor?a.highColor:"#FF2400");var f=document.createElement("div");f.style.width="100%";f.style.height="100%";this.captionSpan=document.createElement("span");this.captionSpan.setAttribute("class","caption");this.captionSpan.style.position=
"absolute";this.captionSpan.style.bottom="0px";this.valueSpan=document.createElement("span");this.valueSpan.style.position="absolute";this.valueSpan.setAttribute("class","value");this.titleSpan=document.createElement("span");this.titleSpan.setAttribute("class","title");this.titleSpan.style.position="absolute";this.titleSpan.style.top="0px";this.labelSpan=document.createElement("span");this.labelSpan.setAttribute("class","label");this.labelSpan.style.position="absolute";this.labelSpan.style.top="1em";
this.node&&(this.node.appendChild(f),this.node.appendChild(this.captionSpan),this.node.appendChild(this.valueSpan),this.node.appendChild(this.titleSpan),this.node.appendChild(this.labelSpan));this.cx=this.node.clientWidth/2;this.cy=3*(this.node.clientHeight/4);var e=null,e=TGOS.createSurface(f);e.path(this.createPathStr(0,this.outRadius,this.inRadius,this.cx,this.cy)).attr({fill:"#aaaaaa",stroke:"#555555","stroke-width":2});this.path=e.path("");this.path.attr({fill:this.color,"stroke-width":2});this.captionSpan.innerHTML=
this.caption;this.titleSpan.innerHTML=this.title;this.update();this.startup()};TGOS.TGGauge.prototype=new TGOS.TGOverlayView;var b=TGOS.TGGauge.prototype;b.update=function(){if(this.feature){var b=this,a=parseFloat(this.feature.attributes[this.dataField]),f=a;this.dataLabelField&&(this.labelSpan.innerHTML=this.feature.attributes[this.dataLabelField]);0>f&&(f=0);f>this.maxDataValue&&(f=this.maxDataValue);if(this.ColorArry){var e=this.CompareValue(a);this.color=e?e:"#88ff33"}else 0.33>=a/this.maxDataValue?
this.color=this.lowColor:0.66>=a/this.maxDataValue?this.color=this.midColor:1>=a/this.maxDataValue&&(this.color=this.highColor);var g=this.angle,h=180*(1-f/this.maxDataValue),k=h-g;this.animation&&this.animation.stop();this.valueSpan.style.left=this.cx-this.valueSpan.clientWidth/2+"px";this.valueSpan.style.top=this.cy+"px";this.valueSpan.innerHTML=a+" "+this.unitLabel;isNaN(f)?(a=b.createPathStr(180,b.outRadius,b.inRadius,b.cx,b.cy),b.path.attr({path:a}),this.angle=180):(this.animation=TGOS.fx.createAnimation({easing:TGOS.fx.easing.quadInOut,
type:window.requestAnimationFrame?"":"setTimeout",duration:150,onAnimation:function(a){b.angle=g+k*a;a=b.createPathStr(b.angle,b.outRadius,b.inRadius,b.cx,b.cy);b.path.attr({fill:b.color});b.path.attr({path:a})},onEnd:function(){var a=b.createPathStr(h,b.outRadius,b.inRadius,b.cx,b.cy);b.path.attr({path:a})}}),this.animation.play())}};b.setCaption=function(b){"string"==typeof b&&(this.caption=b,this.captionSpan&&(this.captionSpan.innerHTML=b))};b.setTitle=function(b){"string"==typeof b&&(this.title=
b,this.titleSpan&&(this.titleSpan.innerHTML=b))};b.setLabel=function(b){"string"==typeof b&&(this.label=b,this.labelSpan&&(this.labelSpan.innerHTML=b))};b.setValue=function(b){"number"==typeof b&&(this.value=b,this.valueSpan&&(this.valueSpan.innerHTML=b,this.valueSpan.style.left=this.cx-this.valueSpan.clientWidth/2+"px",this.valueSpan.style.top=this.cy))};b.setFeature=function(b){b instanceof TGOS.Graphic&&(this.feature=b,this.update())};b.startup=function(){for(var b=this,a=0;a<this.layer.graphics.length;a++)TGOS.TGEvent.addListener(this.layer.graphics[a].gs_[0],
"mouseover",function(a,e){return function(){b.feature=a;b.update()}}(this.layer.graphics[a],a))};b.destroy=function(){this.handler_&&TGOS.TGEvent.removeListener(this.handler_);this.handler_=null};b.createPathStr=function(b,a,f,e,g){b=b/180*Math.PI;x=e+a*Math.cos(b);y=g-a*Math.sin(b);x2=e+f*Math.cos(b);y2=g-f*Math.sin(b);return"M"+(e-a)+","+g+"A"+a+","+a+",0,0,1,"+x+","+y+"L"+x2+","+y2+"A"+f+","+f+",0,0,0,"+(e-f)+","+g+"z"};b.addBreak=function(b,a,f){var e={};e.MaxValue=a;e.MinValue=b;e.Color=f;this.ColorArry||
(this.ColorArry=[]);this.ColorArry.push(e)};b.CompareValue=function(b){if(this.ColorArry)for(var a=this.ColorArry.length,f,e=0;e<a;e++)if(f=this.ColorArry[e],b>=f.MinValue&&b<f.MaxValue)return f.Color}})();TGOS=TGOS||{};
(function(){var b=["Document","Folder","Placemark"];TGOS.TGKmlLayerOption=function(){this.suppressInfoWindows=this.preserveViewport=this.map=null;this.markerFitImageSize=!1};TGOS.TGKmlLayerMetaData=function(){this.snippet=this.name=this.description=this.author=null};TGOS.KmlMouseEvent=function(){this.pixelOffset=this.point=this.feature=null};TGOS.KmlFeatureData=function(){this.snippet=this.name=this.description=this.author=null};TGOS.KmlAuthor=function(){this.uri=this.name=this.email=null};TGOS.TGKmlLayerStatus=
{DOCUMENT_NOT_FOUND:"DOCUMENT_NOT_FOUND",DOCUMENT_TOO_LARGE:"DOCUMENT_TOO_LARGE",FETCH_ERROR:"FETCH_ERROR",INVALID_DOCUMENT:"INVALID_DOCUMENT",INVALID_REQUEST:"INVALID_REQUEST",LIMITS_EXCEEDED:"LIMITS_EXCEEDED",OK:"OK",TIMED_OUT:"TIMED_OUT",UNKNOWN:"UNKNOWN"};TGOS.KMLLayer=function(d,a,f,e,g,h){var k=this,l=f,p=!1,m,n="auto",u=!0;g&&(void 0!==g.zIndex&&"number"==typeof g.zIndex&&(n=g.zIndex),void 0!==g.visible&&"boolean"==typeof g.visible&&(u=g.visible),void 0!==g.independentContainer&&"boolean"==
typeof g.independentContainer&&(p=g.independentContainer,!0==p&&(m=l.addIndependentContainer("KML",this))));var s=l.getCoordSys(),q={author:{email:"",name:"",uri:""},description:"",name:"",snippet:""},w;e=new TGOS.TGInfoWindow("",null,{pixelOffset:new TGOS.TGSize(0,0)});var C=null,B=g.markerFitImageSize;this.overlays=[];this.points=[];this.polygons=[];this.polylines=[];this.groundoverlays=[];this.icons=[];this.getDefaultViewport=function(){if(!C){for(var a=Infinity,b=-Infinity,d=-Infinity,e=Infinity,
f=0;f<this.overlays.length;f++)var g=this.overlays[f].getBounds(),a=Math.min(a,g.left),e=Math.min(e,g.bottom),b=Math.max(b,g.right),d=Math.max(d,g.top);for(f=0;f<this.polylines.length;f++)g=this.polylines[f].getPath().getEnvelope(),a=Math.min(a,g.left),e=Math.min(e,g.bottom),b=Math.max(b,g.right),d=Math.max(d,g.top);for(f=0;f<this.groundoverlays.length;f++)g=this.groundoverlays[f].getBounds(),a=Math.min(a,g.left),e=Math.min(e,g.bottom),b=Math.max(b,g.right),d=Math.max(d,g.top);for(f=0;f<this.polygons.length;f++)g=
this.polygons[f].getBounds(),a=Math.min(a,g.left),e=Math.min(e,g.bottom),b=Math.max(b,g.right),d=Math.max(d,g.top);for(g=0;g<this.points.length;g++)f=this.points[g].getPosition(),a=Math.min(a,f.x),e=Math.min(e,f.y),b=Math.max(b,f.x),d=Math.max(d,f.y);if(!(isFinite(a)&&isFinite(d)&&isFinite(b)&&isFinite(e)))return null;C=new TGOS.TGEnvelope(a,d,b,e)}return C};this.getMetadata=function(){return q};this.getLayerId=function(){return d};this.getStatus=function(){return w};this.removeMap=function(){l=null};
this.parseCoordinates=function(a,b){var d=a;d&&(d=d.trim());var e=[];if(d){for(var f=d.split(/\s*[,]\s*/),d=[[]],g=d[0],h=0;h<f.length;h++)if(f[h].match(/\s+/)){var k=f[h].split(/\s+/);g.push(parseFloat(k[0]));d.push(g);g=[parseFloat(k[1])];d.push(g)}else g.push(parseFloat(f[h]));g=f=NaN;for(h=0;h<d.length;h++){switch(b){case "EPSG3826":var l=TGOS.WGS84toTWD97(d[h][0],d[h][1]);break;case "EPSG3825":l=TGOS.WGS84toTWD97_119(d[h][0],d[h][1]);break;case "EPSG3857":l={x:d[h][0],y:d[h][1]}}l.x&&l.y&&(l.x!=
f||l.y!=g)&&(e.push(new TGOS.TGPoint(l.x,l.y)),f=l.x,g=l.y)}}return e};this.setZIndex=function(a){n=a;for(a=0;a<this.polygons.length;a++)this.polygons[a].setZIndex(n,!1);for(a=0;a<this.polylines.length;a++)this.polylines[a].setZIndex(n,!1);for(a=0;a<this.groundoverlays.length;a++)this.groundoverlays[a].setZIndex(n,!1);for(var b=0;b<this.points.length;b++)this.points[a].setZIndex(n,!1)};this.getZIndex=function(){return n};this.createPoint=function(a){switch(s){case "EPSG3826":var b=this.parseCoordinates(a.coordinates,
"EPSG3826");break;case "EPSG3825":b=this.parseCoordinates(a.coordinates,"EPSG3825");break;case "EPSG3857":b=this.parseCoordinates(a.coordinates,"EPSG3857")}if(!(1>b.length))return b[0]};this.parseRing=function(a,b){switch(b){case "EPSG3826":var d=this.parseCoordinates(a.coordinates,"EPSG3826");break;case "EPSG3825":d=this.parseCoordinates(a.coordinates,"EPSG3825");break;case "EPSG3857":d=this.parseCoordinates(a.coordinates,"EPSG3857")}d=new TGOS.TGLineString(d);return new TGOS.TGLinearRing(d)};this.createPolygon=
function(a){var b=[],d=this.parseRing(a.outerBoundaryIs.LinearRing,s);b.push(d);var e=a.innerBoundaryIs;if(e)if(e.length)for(var f=0;f<e.length;f++)if(e[f].LinearRing.length)for(a=0;a<e[f].LinearRing.length;a++)d=this.parseRing(e[f].LinearRing[a],s),b.push(d);else d=this.parseRing(e[f].LinearRing,s),b.push(d);else if(e.LinearRing)if(e=e.LinearRing,e.length)for(a=0;a<e.length;a++)d=this.parseRing(e[a],s),b.push(d);else d=this.parseRing(e,s),b.push(d);else d=this.parseRing(e.LinearRing,s),b.push(d);
return new TGOS.TGPolygon(b)};this.createPolyLine=function(a){switch(s){case "EPSG3826":var b=this.parseCoordinates(a.coordinates,"EPSG3826");break;case "EPSG3825":b=this.parseCoordinates(a.coordinates,"EPSG3825");break;case "EPSG3857":b=this.parseCoordinates(a.coordinates,"EPSG3857")}return new TGOS.TGLineString(b)};this.handleGroundOverlay=function(a){function b(a){var d=new TGOS.TGImage(a.Icon.href);switch(s){case "EPSG3826":var e=TGOS.WGS84toTWD97(parseFloat(a.LatLonBox.west),parseFloat(a.LatLonBox.north));
a=TGOS.WGS84toTWD97(parseFloat(a.LatLonBox.east),parseFloat(a.LatLonBox.south));var f=e.x,e=e.y,h=a.x,m=a.y;break;case "EPSG3825":e=TGOS.WGS84toTWD97_119(parseFloat(a.LatLonBox.west),parseFloat(a.LatLonBox.north));a=TGOS.WGS84toTWD97_119(parseFloat(a.LatLonBox.east),parseFloat(a.LatLonBox.south));f=e.x;e=e.y;h=a.x;m=a.y;break;case "EPSG3857":f=parseFloat(a.LatLonBox.west),e=parseFloat(a.LatLonBox.north),h=parseFloat(a.LatLonBox.east),m=parseFloat(a.LatLonBox.south)}f=new TGOS.TGEnvelope(f,e,h,m);
d=new TGOS.TGGroundOverlay(l,d,f,1);TGOS.TGEvent.addListener(d,"click",A);TGOS.TGEvent.addListener(d,"mousedown",I);TGOS.TGEvent.addListener(d,"mouseup",G);TGOS.TGEvent.addListener(d,"mousemove",D);TGOS.TGEvent.addListener(d,"mouseout",K);TGOS.TGEvent.addListener(d,"dblclick",F);TGOS.TGEvent.addListener(d,"rightclick",t);g.suppressInfoWindows||TGOS.TGEvent.addListener(d,"click",H);k.groundoverlays.push(d)}if(a.length)for(var d=0;d<a.length;d++)b(a[d]);else b(a)};this.handleNetworkLink=function(a){var b=
"";if(a.length)for(var d=0;d<a.length;d++){if(a[d].hasOwnProperty("Url"))b=a[d].Url.href;else if(a[d].hasOwnProperty("Link"))b=a[d].Link.href;else continue;if(-1==b.indexOf(".kmz")){var e=TGOS.PROXY_SERVICE2;DEBUG_MODE&&(e=TGOS.PROXY_LOCAL);TGOS.getJSON(b,function(a){a.error||k.parseKML(a.kml)},e)}}else{if(a.hasOwnProperty("Url"))b=a.Url.href;else if(a.hasOwnProperty("Link"))b=a.Link.href;else return;-1==b.indexOf(".kmz")&&(e=TGOS.PROXY_SERVICE2,DEBUG_MODE&&(e=TGOS.PROXY_LOCAL),TGOS.getJSON(b,function(a){a.error||
k.parseKML(a.kml)},e))}};this.handleDescription=function(a){};this.handleAuthor=function(a){a.hasOwnProperty("atom:name")&&(q.author.name=a["atom:name"]);a.hasOwnProperty("atom:link")&&(q.author.uri=a["atom:link"]["@href"])};this.handleMultiGeometry=function(a){var b=[],d;for(d in a)switch(d){case "Point":if(a.Point.length)for(var e=0;e<a.Point.length;e++){var f=this.createPoint(a.Point[e]);f&&b.push(f)}else this.createPoint(a.Point),(f=this.createPoint(a.Point))&&b.push(f);break;case "Polygon":if(a.Polygon.length)for(e=
0;e<a.Polygon.length;e++)(f=this.createPolygon(a.Polygon[e]))&&b.push(f);else(f=this.createPolygon(a.Polygon))&&b.push(f);break;case "LineString":if(a.LineString.length)for(e=0;e<a.LineString.length;e++)(f=this.createPolyLine(a.LineString[e]))&&b.push(f);else(f=this.createPolyLine(a.LineString))&&b.push(f);break;case "MultiGeometry":if(a.MultiGeometry.length)for(e=0;e<a.MultiGeometry.length;e++)(f=this.handleMultiGeometry(a.MultiGeometry[e]))&&(b=b.concat(f));else(f=this.handleMultiGeometry(a.MultiGeometry))&&
(b=b.concat(f))}return b};this.parseGeometry=function(a){var b=[];a.hasOwnProperty("Point")?(a=this.createPoint(a.Point))&&b.push(a):a.hasOwnProperty("Polygon")?(a=this.createPolygon(a.Polygon))&&b.push(a):a.hasOwnProperty("LineString")?(a=this.createPolyLine(a.LineString))&&b.push(a):a.hasOwnProperty("MultiGeometry")&&(a=this.handleMultiGeometry(a.MultiGeometry,a))&&(b=b.concat(a));return b};this.createRandomColor=function(){return{r:parseInt(255*Math.random()),g:parseInt(255*Math.random()),b:parseInt(255*
Math.random())}};this.parseKmlColor=function(a,b,d){b=parseInt(a.substring(0,2),16);var e=parseInt(a.substring(2,4),16),f=parseInt(a.substring(4,6),16),g=parseInt(a.substring(6,8),16);"random"==d&&("ffffffff"==a?(a=this.createRandomColor(),e=a.b,g=a.r,f=a.g):(e*=Math.random(),f*=Math.random(),g*=Math.random()));return{a:parseFloat(b/255),b:parseInt(e),g:parseInt(f),r:parseInt(g)}};this.matchStyleMap=function(a,b,d,e){if(d&&b&&a){var f="normal";e&&(f=e);d=d.replace("#","");e=null;if(a instanceof Array)for(var g=
0;g<a.length;g++){if(a[g]["@id"]==d){var h=a[g].Pair;if(h)for(var k=0;k<h.length;k++)if(h[k].key==f){e=h[k].styleUrl;break}if(null!=e)break}}else if(a["@id"]==d&&(h=a.Pair))for(k=0;k<h.length;k++)if(h[k].key==f){e=h[k].styleUrl;break}return this.matchSharedStyle(b,e)}};this.matchSharedStyle=function(a,b){if(b&&a)if(b=b.replace("#",""),a instanceof Array)for(var d=0;d<a.length;d++){if(a[d]["@id"]==b)return a[d]}else if(a["@id"]==b)return a};this.createStyle=function(a,b){var d={match:!1,fillColor:{a:null,
r:null,g:null,b:null,o:null},lineWidth:null,lineColor:{a:null,r:null,g:null,b:null},iconLink:null,iconScale:1,iconHotSpot:{x:null,y:null,xunits:null,yunits:null}};if(a){d.match=!0;if(a.PolyStyle){if(a.PolyStyle.color){var e=this.parseKmlColor(a.PolyStyle.color,b,a.PolyStyle.colorMode);d.fillColor=e}"0"==a.PolyStyle.fill&&(d.fillColor.a=0);d.fillColor.o="0"==a.PolyStyle.outline?0:1}a.LineStyle&&(a.LineStyle.color&&(e=this.parseKmlColor(a.LineStyle.color,b,a.LineStyle.colorMode),d.lineColor=e),"string"==
typeof a.LineStyle.width&&(d.lineWidth=parseFloat(a.LineStyle.width)));a.IconStyle&&(a.IconStyle.Icon&&a.IconStyle.Icon.href&&(d.iconLink=a.IconStyle.Icon.href),a.IconStyle.scale&&(d.iconScale=parseFloat(a.IconStyle.scale)),a.IconStyle.hotSpot&&(d.iconHotSpot.x=parseFloat(a.IconStyle.hotSpot["@x"]),d.iconHotSpot.y=parseFloat(a.IconStyle.hotSpot["@y"]),d.iconHotSpot.xunits=a.IconStyle.hotSpot["@xunits"],d.iconHotSpot.yunits=a.IconStyle.hotSpot["@yunits"]))}return d};this.colorToHex=function(a){if("number"==
typeof a.r||"number"==typeof a.g||"number"==typeof a.b){var b=a.r.toString(16);16>a.r&&(b="0"+b);var d=a.g.toString(16);16>a.g&&(d="0"+d);var e=a.b.toString(16);16>a.b&&(e="0"+e);return"#"+b+d+e}};this.handlePlacemark=function(a,b){var d=[];if(a.length)for(var e=0;e<a.length;e++){var f=this.parseGeometry(a[e]);f&&(d=d.concat(f))}else(f=this.parseGeometry(a))&&(d=d.concat(f));(e=a.inStyle?a.inStyle:this.matchSharedStyle(a.sharedStyle,a.styleUrl))||(e=this.matchStyleMap(b,a.sharedStyle,a.styleUrl));
for(f=0;f<d.length;f++){var h=this.createStyle(e,f/d.length);if(d[f]instanceof TGOS.TGPolygon){var k=new TGOS.TGFill(l,d[f],{advancedLayer:m,fillColor:this.colorToHex(h.fillColor),fillOpacity:h.fillColor.a,fillOutline:h.fillColor.o,strokeWeight:h.lineWidth,strokeColor:this.colorToHex(h.lineColor),strokeOpacity:h.lineColor.a,visible:u,zIndex:n});this.polygons.push(k)}else d[f]instanceof TGOS.TGLineString?(k=new TGOS.TGLine(l,d[f],{advancedLayer:m,strokeWeight:h.lineWidth,strokeColor:this.colorToHex(h.lineColor),
strokeOpacity:h.lineColor.a,visible:u,zIndex:n}),this.polylines.push(k)):d[f]instanceof TGOS.TGPoint&&(null!=h.iconLink?(k=new TGOS.TGImage(h.iconLink),k.setOptions({scale:h.iconScale,hotSpot:h.iconHotSpot}),k=new TGOS.TGMarker(l,d[f],a.name,k,{advancedLayer:m,visible:u,zIndex:n,flat:!0,fitImageSize:B?B:!1})):k=new TGOS.TGMarker(l,d[f],a.name,null,{advancedLayer:m,visible:u,zIndex:n}),this.points.push(k));k.targetPlacemark=a;TGOS.TGEvent.addListener(k,"mouseover",J);TGOS.TGEvent.addListener(k,"mouseout",
K);TGOS.TGEvent.addListener(k,"click",A);TGOS.TGEvent.addListener(k,"mousedown",I);TGOS.TGEvent.addListener(k,"mousemove",D);TGOS.TGEvent.addListener(k,"mouseup",G);TGOS.TGEvent.addListener(k,"dblclick",F);TGOS.TGEvent.addListener(k,"rightclick",t);g.suppressInfoWindows||TGOS.TGEvent.addListener(k,"click",H)}};this.getStyleColorById=function(a,b){if(styles)if(styles.length)for(var d=0;d<styles.length;d++){if(b.slice(1,b.length)==styles[d].id){var e=styles[d].colorMode;if("random"==e)return null;if("line"==
a&&styles[d].LineStyle)return e=styles[d].LineStyle.colorMode,"random"==e?null:{a:styles[d].LineStyle.color.slice(0,2),b:styles[d].LineStyle.color.slice(2,4),g:styles[d].LineStyle.color.slice(4,6),r:styles[d].LineStyle.color.slice(6,8)};if("poly"==a&&styles[d].PolyStyle)return e=styles[d].PolyStyle.colorMode,"random"==e?null:{a:styles[d].PolyStyle.color.slice(0,2),b:styles[d].PolyStyle.color.slice(2,4),g:styles[d].PolyStyle.color.slice(4,6),r:styles[d].PolyStyle.color.slice(6,8)}}}else{if("line"==
a&&styles.LineStyle)return e=styles.LineStyle.colorMode,"random"==e?null:{a:styles.LineStyle.color.slice(0,2),b:styles.LineStyle.color.slice(2,4),g:styles.LineStyle.color.slice(4,6),r:styles.LineStyle.color.slice(6,8)};if("poly"==a&&styles.PolyStyle)return e=styles.PolyStyle.colorMode,"random"==e?null:{a:styles.PolyStyle.color.slice(0,2),b:styles.PolyStyle.color.slice(2,4),g:styles.PolyStyle.color.slice(4,6),r:styles.PolyStyle.color.slice(6,8)}}};this.getVisible=function(){return u};this.setVisible=
function(a){u=a;for(a=0;a<this.polygons.length;a++)this.polygons[a].setVisible(u);for(a=0;a<this.polylines.length;a++)this.polylines[a].setVisible(u);for(a=0;a<this.groundoverlays.length;a++)this.groundoverlays[a].setVisible(u);for(a=0;a<this.points.length;a++)this.points[a].setVisible(u)};this.parseFeature=function(a,b){var d=a.Style?a.Style:null,e=a.StyleMap?a.StyleMap:null,f;for(f in a){var g=a[f];switch(f){case "Document":g.inStyle=d?d:null;this.Schema=g.Schema;if(g instanceof Array)for(var h=
0;h<g.length;h++){var k=g[h];k.inStyle=k.Style?k.Style:null;this.parseFeature(k,g.Style)}else this.parseFeature(g,g.Style);break;case "Folder":g.inStyle=d?d:null;if(g instanceof Array)for(h=0;h<g.length;h++)k=g[h],k.inStyle=k.Style?k.Style:null,this.parseFeature(k,b);else this.parseFeature(g,b);break;case "Placemark":g.inStyle=d?d:null;g.sharedStyle=b;if(g instanceof Array)for(h=0;h<g.length;h++)k=g[h],k.inStyle=k.Style?k.Style:null,k.sharedStyle=b,this.handlePlacemark(k,e);else g.inStyle=g.Style?
g.Style:null,g.sharedStyle=b,this.handlePlacemark(g,e);break;case "GroundOverlay":this.handleGroundOverlay(g);break;case "NetworkLink":this.handleNetworkLink(g)}}};this.parseKML=function(a){if(a)for(var d in a)if(0<=b.indexOf(d)){this.parseFeature(a[d],a[d].Style);break}};this.removeLayer=function(){if(0<this.points.length)for(var a=0;a<this.points.length;a++)this.points[a].setMap(null);if(0<this.polygons.length)for(a=0;a<this.polygons.length;a++)this.polygons[a].setMap(null);if(0<this.polylines.length)for(a=
0;a<this.polylines.length;a++)this.polylines[a].setMap(null);if(0<this.groundoverlays.length)for(a=0;a<this.groundoverlays.length;a++)this.groundoverlays[a].setMap(null);this.points=[];this.polygons=[];this.polylines=[];this.groundoverlays=[];e&&e.close();this.removeAdvancedLayer();this.removeMap()};var H=function(a){if(a.target.targetPlacemark){var b="",d=a.target.targetPlacemark.name;a.target.targetPlacemark.hasOwnProperty("description")&&(b=a.target.targetPlacemark.description.hasOwnProperty("#cdata-section")?
a.target.targetPlacemark.description["#cdata-section"]:a.target.targetPlacemark.description);var f="";d&&(f=f+d+"</br>");0<b.length&&(f+=b);var g=a.target.targetPlacemark.ExtendedData;if(g){var h;if(g.Data){h=g.Data.length?g.Data:[g.Data];f+="<br><table style='border: 1px solid black;'>";for(b=0;b<h.length;b++)var m=h[b],d=m["@name"],t=m.displayName,m=m.value,f=f+"<tr>",f=f+"<td style='border: 1px solid black;'>",f=f+(t||d),f=f+"</td>",f=f+"<td style='border: 1px solid black;'>",f=f+m,f=f+"</td>",
f=f+"</tr>";f+="</table>"}if(g.SchemaData)for(g=g.SchemaData.length?g.SchemaData:[g.SchemaData],h=0;h<g.length;h++){t=null;g[h].SimpleData&&(t=g[h].SimpleData.length?g[h].SimpleData:[g[h].SimpleData]);var n="";if(k.Schema)for(d=k.Schema.length?k.Schema:[k.Schema],b=0;b<d.length;b++)if(m=d[b],m["@id"]==g[h]["@schemaUrl"].replace("#","")){n=m["@name"];break}if(t){f+="<br><table style='border: 1px solid black;'>";for(b=0;b<t.length;b++)m=t[b],d=m["@name"],m=m["#text"],f+="<tr>",f+="<td style='border: 1px solid black;'>",
f+=n+":"+d,f+="</td>",f+="<td style='border: 1px solid black;' >",f+=void 0===m?"":m,f+="</td>",f+="</tr>";f+="</table>"}}}0<f.length&&(e.setContent(f),e.setPosition(a.point),e.open(l))}},A=function(a){TGOS.TGEvent.trigger_(k,"click",{featureData:{author:q.author,description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})},I=function(a){TGOS.TGEvent.trigger_(k,"mousedown",{featureData:{author:q.author,description:a.target.description,name:a.target.name,
snippet:a.target.snippet},point:a.point,pixelOffset:0})},G=function(a){TGOS.TGEvent.trigger_(k,"mouseup",{featureData:{author:q.author,description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})},D=function(a){TGOS.TGEvent.trigger_(k,"mousemove",{featureData:{author:q.author,description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})},J=function(a){TGOS.TGEvent.trigger_(k,"mouseover",{featureData:{author:q.author,
description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})},K=function(a){TGOS.TGEvent.trigger_(k,"mouseout",{featureData:{author:q.author,description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})},F=function(a){TGOS.TGEvent.trigger_(k,"dblclick",{featureData:{author:q.author,description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})},t=function(a){TGOS.TGEvent.trigger_(k,
"rightclick",{featureData:{author:q.author,description:a.target.description,name:a.target.name,snippet:a.target.snippet},point:a.point,pixelOffset:0})};w="loading";if(!a)throw"Invalid kml url";f=TGOS.PROXY_SERVICE2;DEBUG_MODE&&(f=TGOS.PROXY_LOCAL);TGOS.getJSON(a,function(a){function b(a,d){for(var e=d.length,f=Object.keys(a),g=0;g<f.length;g++){var h=f[g];if(h.length>e&&h.substr(0,e)==d){var k=a[h];void 0!==k&&b(k,d);delete a[h];h=h.replace(d,"");a[h]=k}}}if(!a||a.error)w=TGOS.TGKmlLayerStatus.FETCH_ERROR,
"function"==typeof h&&h.call(this,w);else{var d=a.kml;void 0==d&&(d=a["kml:kml"],void 0!==d&&b(d,"kml:"));d.Document?(d.Document.hasOwnProperty("description")&&null!=d.Document.description&&(d.Document.description.hasOwnProperty("#cdata-section")?q.description=d.Document.description["#cdata-section"]:q.description=d.Document.description),d.Document.hasOwnProperty("name")&&null!=d.Document.name&&(d.Document.name.hasOwnProperty("#cdata-section")?q.name=d.Document.name["#cdata-section"]:q.name=d.Document.name),
d.Document.hasOwnProperty("Snippet")&&null!=d.Document.Snippet&&(d.Document.Snippet.hasOwnProperty("#cdata-section")?q.snippet=d.Document.Snippet["#cdata-section"]:q.snippet=d.Document.Snippet),d.Document.hasOwnProperty("atom:author")&&k.handleAuthor(d.Document["atom:author"]),k.Schema=d.Document.Schema):(d.hasOwnProperty("description")&&null!=d.description&&(d.description.hasOwnProperty("#cdata-section")?q.description=d.description["#cdata-section"]:q.description=d.description),d.hasOwnProperty("name")&&
null!=d.name&&(d.name.hasOwnProperty("#cdata-section")?q.name=d.name["#cdata-section"]:q.name=d.name),d.hasOwnProperty("Snippet")&&null!=d.Snippet&&(d.Snippet.hasOwnProperty("#cdata-section")?q.snippet=d.Snippet["#cdata-section"]:q.snippet=d.Snippet),d.hasOwnProperty("atom:author")&&k.handleAuthor(d["atom:author"]));k.parseKML(d);w=TGOS.TGKmlLayerStatus.OK;g&&!0==g.preserveViewport&&(a=k.getDefaultViewport())&&l.fitBounds(a);"function"==typeof h&&h.call(k,w)}},f,function(){"function"==typeof h&&h.call(this,
TGOS.TGKmlLayerStatus.FETCH_ERROR)});this.removeAdvancedLayer=function(){null!=m&&(l.removeIndependentContainer(m),l.removeAdvancedLayer(this),m=null,p=!1)};this.moveToTop=function(){null!=m&&l.moveIndependentContainerToTop(m)};this.getNode=function(){if(l)return!0==p&&null!=m?[m.div.main,m.div.shadow]:l.getPanes().graphicLayer}};TGOS.RegisterEvent(TGOS.KMLLayer,"click mousemove mouseout mouseover dblclick rightclick".split(" "))})();TGOS=TGOS||{};
(function(){var b=function(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom;this.src=b.src;this.width=b.width;this.height=b.height;this.layer=b.layer;this.cancel=this.loaded=!1;this.node=document.createElement("img");this.node.style.position="absolute";this.setSource=function(a){this.loaded=!1;this.node.src=a};var a=this;this.node.onload=function(){a.cancel?a.loaded=!1:(a.loaded=!0,b.onload&&b.onload.call(a))};this.src&&(this.node.src=this.src);"number"==typeof this.width&&(this.node.width=
this.width);"number"==typeof this.height&&(this.node.height=this.height);this.destroy=function(){this.node&&this.node.parentNode&&this.node.parentNode.removeChild(this.node)}};TGOS.WMSLayer=function(d,a,f,e,g,h){function k(){if(n){var a=m.getClientWidth(),b=m.getClientHeight(),d=m.ToMapPoint(0,0),e=m.ToMapPoint(a,b);l();var f=null,f=null!=B?B+"="+I:"1.3.0"==A?"CRS="+I:"SRS="+I;switch(n.getCoordSys()){case TGOS.TGCoordSys.EPSG3857:d=TGOS.GooToWGS84(d.x,d.y);e=TGOS.GooToWGS84(e.x,e.y);break;case TGOS.TGCoordSys.EPSG3826:0>
I.indexOf("3826")&&(0<=I.indexOf("3825")?(d=TGOS.TWD97toTWD97_119(d.x,d.y),e=TGOS.TWD97toTWD97_119(e.x,e.y)):0<=I.indexOf("4326")&&(d=TGOS.TWD97toWGS84(d.x,d.y),e=TGOS.TWD97toWGS84(e.x,e.y)));break;case TGOS.TGCoordSys.EPSG3825:0>I.indexOf("3825")&&(0<=I.indexOf("3826")?(d=TGOS.TWD97_119toTWD97(d.x,d.y),e=TGOS.TWD97_119toTWD97(e.x,e.y)):0<=I.indexOf("4326")&&(d=TGOS.TWD97_119toWGS84(d.x,d.y),e=TGOS.TWD97_119toWGS84(e.x,e.y)))}var g=d.x,h=e.y,k=e.x,t=d.y;"1.3.0"==A&&0>I.indexOf("CRS:84")&&0<=I.indexOf("EPSG:4326")&&
(g=e.y,h=d.x,k=d.y,t=e.x);a=p+"?BBOX="+(g+","+h+","+k+","+t)+"&WIDTH="+a+"&HEIGHT="+b;a+="&"+F.join("&");a+="&"+f;s&&(a=s+"?"+a);return a}}function l(){if(n){var a=m.getClientWidth(),b=m.getClientHeight(),d=m.ToMapPoint(0,0),e=m.ToMapPoint(a,b);return{left:d.x,top:d.y,right:e.x,bottom:e.y,width:a,height:b}}}var p,m,n=f,u=!0,s,q="auto",w,C=1,B=null,H=f.getPanes().overlayviewLayer;g&&(void 0!==g.opacity&&"number"==typeof g.opacity&&(C=g.opacity),void 0!==g.visible&&"boolean"==typeof g.visible&&(u=g.visible),
void 0!==g.container&&(H=g.container),void 0!==g.proxy&&(s=0<g.proxy.indexOf("?")?g.proxy.slice(0,g.proxy.indexOf("?")):g.proxy));var A="1.3.0",I="EPSG:4326";g=f="";h="image/png";var G="0xFFFFFF",D="TRUE";if(e){void 0!==e.version&&(A=e.version);var J,K;void 0!==e.srs&&(J=e.srs);void 0!==e.crs&&(K=e.crs);void 0!==J&&void 0!==K?I="1.3.0"==A?J:K:(void 0!==J&&(I=J),void 0!==K&&(I=K));void 0!==e.cstag&&(B=e.cstag);void 0!==e.layers&&(f=e.layers);void 0!==e.styles&&(g=e.styles);void 0!==e.format&&(h=e.format);
void 0!==e.bgcolor&&(G=e.bgcolor);void 0!==e.transparent&&(D=e.transparent)}var F=[];F.push("SERVICE=WMS");F.push("REQUEST=GetMap");F.push("VERSION="+A);F.push("LAYERS="+f);F.push("STYLES="+g);F.push("FORMAT="+h);F.push("BGCOLOR="+G);F.push("TRANSPARENT="+D);e=a;if(-1<e.indexOf("?")&&(J=e.indexOf("?"),a=e.substring(0,J),J=e.substr(J+1,e.length-J),e=a,0<J.length))for(e=J.split("&"),J=0;J<e.length;J++)K=e[J],0<K.length&&(!(0<=K.toUpperCase().indexOf("BBOX"))||0<=K.toUpperCase().indexOf("BBOXSR"))&&
(0<=K.toUpperCase().indexOf("WIDTH")||0<=K.toUpperCase().indexOf("HEIGHT")||0<=K.toUpperCase().indexOf("VERSION")||F.push(K));var t;this.moveToTop=function(){H&&(H.removeChild(t),H.appendChild(t))};this.moveLayerTo=function(a){if(H&&layerContainer&&(a=parseInt(a),!isNaN(a))){var b=H.childNodes.length;if(1<b){var d=null;0>=a?d=H.firstChild:a>=b||(d=H.childNodes[a]);H.removeChild(layerContainer);d?H.insertBefore(layerContainer,d):H.appendChild(layerContainer)}}};this.RemoveSelf=function(){H&&t&&H.removeChild(t)};
this.getLayerId=function(){return d};this.getNode=function(){return t};this.getDefaultViewport=function(){};this.getUrl=function(){return p};this.removeLayer=function(){n.removeLayer(this)};this.getZIndex=function(){return q};this.setZIndex=function(a){q=a;t&&(t.style.zIndex=q)};this.getVisible=function(){return u};this.setVisible=function(a){u=a;t&&(t.style.display=u?"block":"none")};this.putVisible=function(a){this.setVisible(a)};this.setProxy=function(a){a&&(s=0<a.indexOf("?")?a.slice(0,a.indexOf("?")):
a)};this.getProxy=function(){return s};var v=function(a){if(a){var b=m.FromMapPoint(a.left,a.top);a.node.style.left=b.x+"px";a.node.style.top=b.y+"px"}};this.setOpacity=function(a){if(t){var b=parseInt(100*a);t.style.filter="alpha(opacity="+b+")";t.style.opacity=a}C=a};this.getOpacity=function(){return C};var z,E;this.UpdateElement=function(){var a=m.getScale(),b=w/a;E&&(E.node.width/=b,E.node.height/=b);v(z);v(E);w=a};this.RebuildElement=function(){var a=this;this.temp&&!this.temp.loaded&&(this.temp.cancel=
!0);var d=l();this.temp=new b({left:d.left,right:d.right,top:d.top,bottom:d.bottom,width:d.width,height:d.height,src:k(),onload:function(){z=E;t.appendChild(a.temp.node);E=a.temp;z&&z.destroy();a.temp=null;TGOS.TGEvent.trigger(a,"image_loaded")}})};t=document.createElement("div");t.style.position="absolute";t.style.left="0px";t.style.top="0px";t.style.width="100%";t.style.height="100%";t.className="TGOS_WMS";t.style.opacity=C;parseInt(100*C);m=n.getMapBase();p=0<a.indexOf("?")?a.slice(0,a.indexOf("?")):
a;H.appendChild(t);n.addLayer(this,!0)};TGOS.RegisterEvent(TGOS.WMSLayer,["image_loaded"])})();TGOS.WMSLayer.enumCoordinate={WGS84:0,TWD97:1,GOOGLE:2,TWD97_119:3};TGOS=TGOS||{};
TGOS.WFSLayer=function(){var b=function(a,b){this.mapCoordSys=a;this.dataCoordSys=b},d=function(a){a=a.split(".");for(var b=[],d=0;d<a.length;d++)b.push(a[d]);return b},a=function(a,b,d){var e=a;"EPSG3826"==d?"EPSG3825"==b?e=TGOS.TWD97toTWD97_119(a.x,a.y):"EPSG3857"==b&&(e=TGOS.TWD97toWGS84(a.x,a.y)):"EPSG3825"==d?"EPSG3826"==b?e=TGOS.TWD97_119toTWD97(a.x,a.y):"EPSG3857"==b&&(e=TGOS.TWD97_119toWGS84(a.x,a.y)):"EPSG4326"==d&&("EPSG3826"==b?e=TGOS.WGS84toTWD97(a.x,a.y):"EPSG3825"==b&&(e=TGOS.WGS84toTWD97_119(a.x,
a.y)));return e},f=function(b,d,e,f){var g=2;f&&(g=parseFloat(f));f=this.dataCoordSys;if(void 0!==e)switch(e){case "EPSG:4326":f="EPSG4326";break;case "EPSG:3826":f="EPSG3826";break;case "EPSG:3825":f="EPSG3825";break;case "EPSG:3857":f="EPSG3857"}if("1"!=d[0]||"0"!=d[1])if(b=b["#text"]||b,e=0<=b.indexOf(","),b=b.replace(/[\s]*$/gi,"").replace(/^[\s]*/gi,"").split(/[\s]+/),d=[],e)for(e=0;e<b.length;e++){var g=b[e].split(","),h=new TGOS.TGPoint(parseFloat(g[0]),parseFloat(g[1])),h=a(h,this.mapCoordSys,
f);d.push(h)}else for(e=0;e<b.length;e+=g)h=new TGOS.TGPoint(parseFloat(b[e]),parseFloat(b[e+1])),h=a(h,this.mapCoordSys,f),d.push(h);else if(b=b["#text"]||b,e=0<=b.indexOf(","),b=b.replace(/[\s]*$/gi,"").replace(/^[\s]*/gi,"").split(/[\s]+/),d=[],e)for(e=0;e<b.length;e++)g=b[e].split(","),h=new TGOS.TGPoint(parseFloat(g[0]),parseFloat(g[1])),h=a(h,this.mapCoordSys,f),d.push(h);else for(e=0;e<b.length;e+=g)h=new TGOS.TGPoint(parseFloat(b[e]),parseFloat(b[e+1])),h=a(h,this.mapCoordSys,f),d.push(h);
return d},e=function(a,b,d){var e=[],f;for(f in a){var g=a[f];if(g&&"object"===typeof g)for(var n in g)switch(n){case b+":MultiPolygon":for(var u=k(g[n],b,d),G=0;G<u.length;G++)e.push(u[G]);break;case b+":MultiSurface":u=k(g[n],b,d);for(G=0;G<u.length;G++)e.push(u[G]);break;case b+":Polygon":G=h(g,b,d);e.push(G);break;case b+":MultiLineString":u=p(g[n],b,d);for(G=0;G<u.length;G++)e.push(u[G]);break;case b+":MultiCurve":u=p(g[n],b,d);for(G=0;G<u.length;G++)e.push(u[G]);break;case b+":LineString":G=
l(g,b,d);e.push(G);break;case b+":MultiPoint":var G=b,u=d,D=g[n][G+":pointMember"],J=[];if(void 0!==D.length)for(var K=0;K<D.length;K++){var F=m(D[K],G,u);J.push(F)}else F=m(D,G,u),J.push(F);u=J;for(G=0;G<u.length;G++)e.push(u[G]);break;case b+":Point":G=m(g[b+":Point"],b,d),e.push(G)}}return e},g=function(a,b,d,e){a=a[b+":coordinates"]||a[b+":posList"];e=a["@srsName"];d=f(a,d,e,a["@srsDimension"]);d=new TGOS.TGLineString(d);return new TGOS.TGLinearRing(d)},h=function(a,b,d){var e=[],f=a[b+":Polygon"];
a=f["@srsName"];var h=g((f[b+":outerBoundaryIs"]||f[b+":exterior"])[b+":LinearRing"],b,d,a);e.push(h);if(f=f[b+":innerBoundaryIs"]||f[b+":interior"])if(f instanceof Array)for(h=0;h<f.length;h++){var k=f[h][b+":LinearRing"],k=g(k,b,d,a);e.push(k)}else k=f[b+":LinearRing"],k=g(k,b,d,a),e.push(k);return new TGOS.TGPolygon(e)},k=function(a,b,d){a=a[b+":polygonMember"]||a[b+":surfaceMember"];var e=[];if(void 0!==a.length)for(var f=0;f<a.length;f++){var g=h(a[f],b,d);e.push(g)}else g=h(a,b,d),e.push(g);
return e},l=function(a,b,d){var e=a[b+":LineString"];a=e["@srsName"];var g=e["@srsDimension"];b=e[b+":coordinates"]||e[b+":posList"];a||(a=b["@srsName"]);g||(g=b["@srsDimension"]);d=f(b,d,a,g);return new TGOS.TGLineString(d)},p=function(a,b,d){a=a[b+":lineStringMember"]||a[b+":curveMember"];var e=[];if(void 0!==a.length)for(var f=0;f<a.length;f++){var g=l(a[f],b,d);e.push(g)}else g=l(a,b,d),e.push(g);return e},m=function(a,b,d){var e=a["@srsName"],g=a["@srsDimension"];a=a[b+":coordinates"]||a[b+":pos"];
e||(e=a["@srsName"]);g||(g=a["@srsDimension"]);return f(a,d,e,g)[0]},n=function(a,b,d,e,f,g){this.zIndex="auto";this.defaultViewport=null;this.preserveViewport=!0;this.serviceInfo={VERSION:"1.0.0",REQUEST:"GetFeature",SERVICE:"WFS",SRSNAME:"EPSG:4326"};var h=TGOS.RES_PATH+"shadow2.png";this.markerOptions={title:"",clickable:!1,cursor:"",zIndex:"auto",flat:!1,icon:new TGOS.TGImage(TGOS.RES_PATH+"marker2.png",new TGOS.TGSize(31,30),new TGOS.TGPoint(0,0),new TGOS.TGPoint(11,30)),shadow:new TGOS.TGImage(h,
new TGOS.TGSize(31,30),new TGOS.TGPoint(0,0),new TGOS.TGPoint(9,25))};this.polylineOptions={clickable:!1,strokeWeight:2,zIndex:"auto",strokeColor:"#ff5555",strokeOpacity:1};this.polygonOptions={clickable:!1,opacity:1,fillColor:"#eeaaaa",fillOpacity:0.5,strokeWeight:2,zIndex:"auto",strokeColor:"#ff5555",strokeOpacity:1};this.callback=g;this.gs=[];void 0!==d&&this.setMap(d);this.setName(a);if(e)for(var k in e)d=e[k],this.serviceInfo[k.toUpperCase()]=d;if(-1<b.indexOf("?")&&(k=b.indexOf("?"),k=b.substr(k+
1,b.length-k),0<k.length))for(e=k.split("&"),a=0;a<e.length;a++)k=e[a],0<k.length&&(d=k.split("="),2==d.length&&(k=d[0].toUpperCase(),d=d[1],this.serviceInfo[k]=d));f&&(f.preserveViewport&&this.setPreserveViewport(f.preserveViewport),f.independentContainer&&this.setIndependentContainer(f.independentContainer),f.visible&&this.setVisible(f.visible),f.markerOptions&&this.setMarkerOptions(f.markerOptions),f.polylineOptions&&this.setLineOptions(f.polylineOptions),f.polygonOptions&&this.setPolygonOptions(f.polygonOptions),
void 0!==f.zIndex&&this.setZIndex(f.zIndex));this.setUrl(b);this.update(this.callback)},u=n.prototype;u.update=function(a){if(this.url&&this.map){var f=this.serviceInfo.TYPENAME,g=this.serviceInfo.VERSION;if(!g)throw"Invalid WFS version";if(!f)throw"Invalid Type Name";var h=d(g);if(3!=h.length)throw"Invalid WFS version";f.split(":");var k="",l="",m=this,g="",n;for(n in this.serviceInfo)0<g.length&&(g+="&"),g=g+n+"="+this.serviceInfo[n];n=this.url+"?"+g;g=TGOS.PROXY_SERVICE2;DEBUG_MODE&&(g=TGOS.PROXY_LOCAL);
TGOS.getJSON(n,function(d){if(!d||d.error)a.call(this,d.error);else{var g,n;for(n in d)0<=n.indexOf("FeatureCollection")&&(g=d[n]);if(g){for(var p in g)if(0<=p.indexOf("@xmlns:")){if("http://www.opengis.net/gml"==g[p]||"http://www.opengis.net/gml/3.2"==g[p])k=p.replace("@xmlns:","");if("http://www.opengis.net/wfs"==g[p]||"http://www.opengis.net/wfs/2.0"==g[p])l=p.replace("@xmlns:","")}d=m.map.getCoordSys();var u;n=g[k+":boundedBy"];void 0!==n&&(n=n[k+":Box"],void 0!==n&&void 0!==n["@srsName"]&&(u=
n["@srsName"]));void 0!==u&&(u=u.replace(":",""));b(d,u);u=g[k+":featureMember"]||g[k+":featureMembers"]||g[k+":member"]||g[l+":member"];g=[];if(u){if(u.length)for(d=d=0;d<u.length;d++)for(n=e(u[d][f],k,h),p=0;p<n.length;p++)g.push(n[p]);else if(d=0,d=u[f],d.length)for(d=0;d<u[f].length;d++)for(n=e(u[f][d],k,h),p=0;p<n.length;p++)g.push(n[p]);else for(n=e(d,k,h),p=0;p<n.length;p++)g.push(n[p]);u=function(a,b){var d=a;d||(d={});for(var e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);return d};d=null;!0==m.getIndependentContainer()&&
(n=m.getAdvancedContainer(),null!=n&&(d={advancedLayer:n}));for(n=0;n<g.length;n++)g[n]instanceof TGOS.TGPolygon?(d=u(d,m.polygonOptions),p=new TGOS.TGFill(m.map,g[n],d),p.setOpacity(0.5),m.gs.push(p)):g[n]instanceof TGOS.TGLineString?(d=u(d,m.polylineOptions),p=new TGOS.TGLine(m.map,g[n],d),p.setStrokeWeight(2),m.gs.push(p)):g[n]instanceof TGOS.TGPoint&&(d=u(d,m.markerOptions),p=new TGOS.TGMarker(m.map,g[n],null,null,d),m.gs.push(p));m.setZIndex(m.zIndex);m.setVisible(m.visible);m.map&&!0==m.preserveViewport&&
m.getDefaultViewport()&&m.map.fitBounds(m.getDefaultViewport());a&&a.call(m)}}}},g)}};u.setUrl=function(a,b){this.url=0<a.indexOf("?")?a.slice(0,a.indexOf("?")):a};u.setPreserveViewport=function(a){this.preserveViewport=a};u.setZIndex=function(a){this.zIndex=a;for(a=0;a<this.gs.length;a++)this.gs[a].setZIndex(this.zIndex)};u.setName=function(a){this.name=a};u.setMap=function(a){this.map=a};u.getDefaultViewport=function(){if(!this.defaultViewport){for(var a=Infinity,b=-Infinity,d=-Infinity,e=Infinity,
f=0;f<this.gs.length;f++){var g=this.gs[f].getBounds();g&&(a=Math.min(a,g.left),e=Math.min(e,g.bottom),b=Math.max(b,g.right),d=Math.max(d,g.top))}isFinite(a)&&isFinite(d)&&isFinite(b)&&isFinite(e)?this.defaultViewport=new TGOS.TGEnvelope(a,d,b,e):this.defaultViewport=null}return this.defaultViewport};u.getUrl=function(){return this.url};u.removeAdvancedLayer=function(){null!=this.advancedLayer&&(this.map.removeIndependentContainer(this.advancedLayer),this.map.removeAdvancedLayer(this),this.advancedLayer=
null)};u.moveToTop=function(){null!=this.advancedLayer&&this.map.moveIndependentContainerToTop(this.advancedLayer)};u.removeLayer=function(){this.removeAdvancedLayer();for(var a=0;a<this.gs.length;a++)this.gs[a].setMap(null),this.gs[a]=null;this.gs=[];this.map=null};u.getVisible=function(){return this.visible};u.getLayerId=function(){return this.name};u.setVisible=function(a){this.visible=a;for(a=0;a<this.gs.length;a++)this.gs[a].setVisible(this.visible)};u.setMarkerOptions=function(a){a&&(void 0!==
a.clickable&&(this.markerOptions.clickable=a.clickable),void 0!==a.title&&(this.markerOptions.title=a.title),void 0!==a.zIndex&&(this.markerOptions.zIndex=a.zIndex),void 0!==a.opacity&&(this.markerOptions.opacity=a.opacity),void 0!==a.cursor&&(this.markerOptions.cursor=a.cursor),void 0!==a.flat&&(this.markerOptions.flat=a.flat),void 0!==a.icon&&(this.markerOptions.icon=a.icon),void 0!==a.shadow&&(this.markerOptions.shadow=a.shadow))};u.setLineOptions=function(a){a&&(void 0!==a.clickable&&(this.polylineOptions.clickable=
a.clickable),void 0!==a.opacity&&(this.polylineOptions.opacity=a.opacity),void 0!==a.zIndex&&(this.polylineOptions.zIndex=a.zIndex),void 0!==a.strokeWeight&&(this.polylineOptions.strokeWeight=a.strokeWeight),void 0!==a.strokeDasharray&&(this.polylineOptions.strokeDasharray=a.strokeDasharray),void 0!==a.strokeColor&&(this.polylineOptions.strokeColor=a.strokeColor),void 0!==a.strokeOpacity&&(this.polylineOptions.strokeOpacity=a.strokeOpacity))};u.setPolygonOptions=function(a){a&&(void 0!==a.clickable&&
(this.polygonOptions.clickable=a.clickable),void 0!==a.opacity&&(this.polygonOptions.opacity=a.opacity),void 0!==a.zIndex&&(this.polygonOptions.zIndex=a.zIndex),void 0!==a.fillColor&&(this.polygonOptions.fillColor=a.fillColor),void 0!==a.fillOpacity&&(this.polygonOptions.fillOpacity=a.fillOpacity),void 0!==a.strokeWeight&&(this.polygonOptions.strokeWeight=a.strokeWeight),void 0!==a.strokeDasharray&&(this.polygonOptions.strokeDasharray=a.strokeDasharray),void 0!==a.strokeColor&&(this.polygonOptions.strokeColor=
a.strokeColor),void 0!==a.strokeOpacity&&(this.polygonOptions.strokeOpacity=a.strokeOpacity))};u.getIndependentContainer=function(){return this.independentContainer};u.setIndependentContainer=function(a){this.independentContainer=a;!0==this.independentContainer&&void 0===this.advancedLayer&&(this.advancedLayer=this.map.addIndependentContainer("WFS",this))};u.getAdvancedContainer=function(){return!0==this.independentContainer?(void 0===this.advancedLayer&&(this.advancedLayer=this.map.addIndependentContainer("WFS",
this)),this.advancedLayer):null};u.getNode=function(){if(this.map){if(!0==this.independentContainer){var a=this.getAdvancedContainer();return null!=a?[a.div.main,a.div.shadow]:this.map.getPanes().graphicLayer}return this.map.getPanes().graphicLayer}};return n}();TGOS=TGOS||{};
TGOS.WMTSLayer=function(){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(b,a){if(null==this)throw new TypeError('"this" is null or not defined');var f=Object(this),e=f.length>>>0;if("function"!==typeof b)throw new TypeError("predicate must be a function");for(var g=0;g<e;){var h=f[g];if(b.call(a,h,g,f))return h;g++}}});Math.hypot||(Math.hypot=function(b,a){return Math.sqrt(b*b+a*a)});Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(b,
a,f){if(null==this)throw new TypeError("this is null or not defined");var e=Object(this),g=e.length>>>0;a>>=0;a=0>a?Math.max(g+a,0):Math.min(a,g);f=void 0===f?g:f>>0;for(g=0>f?Math.max(g+f,0):Math.min(f,g);a<g;)e[a]=b,a++;return e}});var b=function(b){this.fitBound=b.fitBound;this.matrixSet=b.matrixSet;this.matrixId=b.matrixId;this.row=b.row;this.col=b.col;this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom;this.scaledWidth=b.scaledWidth;this.scaledHeight=b.scaledHeight;this.toString=
function(){return"{"+this.matrixId+","+this.row+","+this.col+"}"}};b.prototype.equals=function(b){return this.matrixId==b.matrixId&&this.row==b.row&&this.col==b.col};return function(d,a,f,e,g,h){function k(a,b){return a?a instanceof Array?a:[a]:b}function l(a){return!this||0>=this.length?null:this.find(a)||this[0]}function p(){return!this||0>=this.length?null:this[this.push(this.shift())-1]}function m(a){if(!t)return null;var b=k(t.TileMatrix,null);if(!b||0>=b.length)return null;var d=a.ToMapDistX(1)/
(0.0254/e.dpi);return(a=b.map(function(a){return{m:a,d:Math.abs(Math.log(parseFloat(a.ScaleDenominator)/d))}}).reduce(function(a,b){return a&&a.d<b.d?a:b},null))?a.m:null}function n(a,b){if(b&&b.length)return Object.keys(a).reduce(function(b,d){return b.replace("{"+d+"}",a[d])},p.call(b)||"");var d=p.call(k(v,null)),d=d+((0<d.indexOf("?")?"&":"?")+Object.keys(a).map(function(b){return b+"="+a[b]}).join("&"));"boolean"==typeof K&&K&&TGOS.APIKEY&&TGOS.APPID?d+="&APPID="+TGOS.APPID+"&APIKEY="+TGOS.APIKEY:
"string"==typeof K&&(d+="&"+K);return d}function u(a,b,d){return n({SERVICE:"WMTS",REQUEST:"GetTile",VERSION:"1.0.0",Layer:e.layer,Format:e.format,Style:e.style,TileMatrixSet:e.matrixSet,TileMatrix:a,TileRow:b,TileCol:d},z)}function s(a,d){if(!a)return null;var f=parseFloat(a.TileWidth),g=parseFloat(a.TileHeight),h=parseFloat(a.ScaleDenominator)*f*(0.0254/e.dpi),k=parseFloat(a.ScaleDenominator)*g*(0.0254/e.dpi),f=a.TopLeftCorner.split(" ").map(parseFloat),l=f[0],m=f[1],f=Math.max(d.left,I||d.left),
g=Math.min(d.right,D||d.right),t=Math.min(d.top,G||d.top),n=Math.max(d.bottom,J||d.bottom),p=a["ows:Identifier"],f=function(a,b,d,e){var f=(d+a-1)/2,g=(e+b-1)/2;a=Math.floor(a);b=Math.floor(b);var h=Math.ceil(d)-a;d=Math.ceil(e)-b;return Array(h*d).fill(0).map(function(d,e){return{x:e%h+a,y:Math.floor(e/h)+b}}).map(function(a){return{xy:a,d:Math.abs(a.x-f)+Math.abs(a.y-g)}}).sort(function(a,b){return a.d-b.d}).map(function(a){return a.xy})}((f-l)/h,(m-t)/k,(g-l)/h,(m-n)/k);return 0<f.length?f.map(function(a){return new b({matrixId:p,
col:a.x,row:a.y,left:l+a.x*h,top:m-a.y*k,right:l+(a.x+1)*h,bottom:m-(a.y+1)*k})}):null}function q(a,b){(function N(){a()?b():setTimeout(N,200)})()}var w=null;f&&f.getPanes&&(w=f.getPanes().overlayviewLayer);var C=null,B=!1,H=!0,A=1,I=null,G=null,D=null,J=null,K=!0,F=null,t=null,v=a,z=null,E=[];void 0!==g&&null!==g&&(null!=g.container&&(w=g.container),null!=g.appendKey&&(K=g.appendKey),null!=g.fitDiv&&(fitDiv=g.fitDiv),I="number"==typeof g.left?g.left:null,G="number"==typeof g.top?g.top:null,D="number"==
typeof g.right?g.right:null,J="number"==typeof g.bottom?g.bottom:null,A="number"==typeof g.opacity?Math.max(0,Math.min(1,g.opacity)):1,H="boolean"==typeof g.visible?g.visible:!0);e||(e={});e.dpi="number"==typeof e.dpi?e.dpi:0.0254/2.8E-4;e.style="string"==typeof e.style?e.style:"default";e.format="string"==typeof e.format?e.format:"image/png";var L=document.createElement("div");L.className="TGOS_WMTS";L.style.position="absolute";L.style.left="0px";L.style.top="0px";L.style.width="100%";L.style.height=
"100%";L.style.display=H?"":"none";L.style.opacity=A;L.style.filter="alpha(opacity="+100*A+")";w.appendChild(L);this.moveLayerTo=function(a){!w||!L||1>=w.childNodes.length||(a=parseInt(a),isNaN(a)||(0>a&&(a+=w.childNodes.length+1),w.insertBefore(L,a<w.childNodes.length?w.childNodes[Math.max(0,a)]:null)))};this.moveToTop=function(){this.moveLayerTo(-1)};this.RemoveSelf=function(){w.removeChild(L)};this.getNode=function(){return L};this.getLayerId=function(){return d};this.getMatrixSetId=function(){return e.matrixSet};
this.getSource=function(){return a};this.getVisible=function(){return H};this.putVisible=function(a){L.style.display=(H=a)?"":"none"};this.setVisible=function(a){this.putVisible(a)};this.getOpacity=function(){return A};this.setOpacity=function(a){A=Math.max(0,Math.min(1,parseFloat(a)));L&&(L.style.opacity=A,L.style.filter="alpha(opacity="+100*A+")")};this.removeLayer=function(){void 0!==f&&f.removeLayer(this)};this.Initialize=function(a){C=a;a=n({SERVICE:"WMTS",REQUEST:"GetCapabilities",VERSION:"1.0.0"});
TGOS.getJSON(a,function(a){F=a.Capabilities;if(!F)throw"Service Error";B=!0;F["ows:OperationsMetadata"]&&k(F["ows:OperationsMetadata"]["ows:Operation"],[]).some(function(a){return"GetTile"==a["@name"]&&a["ows:DCP"]&&a["ows:DCP"]["ows:HTTP"]?k(a["ows:DCP"]["ows:HTTP"]["ows:Get"],[]).some(function(a){return"KVP"!=a["ows:Constraint"]["ows:AllowedValues"]["ows:Value"]?!1:void 0!==(v=a["@xlink:href"])}):!1});if(F.Contents){if(a=l.call(k(F.Contents.Layer,null),function(a){return a&&a["ows:Identifier"]==
e.layer}))e.layer=a["ows:Identifier"],e.format=l.call(k(a.Format,null),function(a){return a==e.format}),a.Style&&"true"==a.Style["@isDefault"]&&(e.style=a.Style["ows:Identifier"]||""),z=k(a.ResourceURL,[]).filter(function(a){return"tile"==a["@resourceType"]}).map(function(a){return a["@template"]});t=l.call(k(F.Contents.TileMatrixSet,null),function(a){return a&&a["ows:Identifier"]==e.matrixSet});e.matrixSet=t?t["ows:Identifier"]:null}this.RebuildElement();this.UpdateElement();h&&h.call(this)}.bind(this),
DEBUG_MODE?TGOS.PROXY_LOCAL:TGOS.PROXY_SERVICE2)};this.getTiles=function(a){if(a.handler){var b=m(C),d=s(b,new TGOS.TGEnvelope(a.rl,a.rt,a.rr,a.rb));if(!d)return null;var e=b["ows:Identifier"],b=d.map(function(a){return u(e,a.row,a.col)}),d=d.map(function(a){return new TGOS.TGPoint(a.left,a.top)});f.getCoordSys()==TGOS.TGCoordSys.EPSG3857&&d.forEach(function(a){var b=TGOS.GooToWGS84(a.x,a.y);a.x=b.x;a.y=b.y});a.handler.call(this,{leftTopAnchor:d,imageUrl:b})}};this.UpdateElement=this.RebuildElement=
function(){function a(){this.ts.forEach(function(a){a.completed=!0;a.img.parentNode.removeChild(a.img)});var b=E.indexOf(this);0<=b&&E.splice(b,1)}if(B&&H){var b=C.ToMapPoint(0,0),d=C.ToMapPoint(C.getClientWidth(),C.getClientHeight()),f=m(C),g=s(f,new TGOS.TGEnvelope(b.x,b.y,d.x,d.y));if(g){var h=f["ows:Identifier"],k={sid:e.matrixSet,mid:h,ts:[]};if(b=E.pop())k.sid==b.sid&&k.mid==b.mid&&(k.ts=b.ts.filter(function(a){return g.some(function(b){return b.equals(a)})}),b.ts=b.ts.filter(function(a){return!k.ts.some(function(b){return b.equals(a)})}),
g=g.filter(function(a){return!k.ts.some(function(b){return b.equals(a)})})),0<b.ts.length&&(b.ts.forEach(function(a){a.img.onload=a.img.onerror=null;a.img.complete||(a.img.src="")}),E.push(b));0!=g.length?(g.forEach(function(a){a.completed=!1;a.img=document.createElement("img");a.img.style.opacity=0;a.img.style.position="absolute";a.img.style.MozUserSelect="none";a.img.style.transition="opacity 0.5s linear 0s";a.img.border="0px";a.img.galleryImg=!1;a.img.hideFocus=!0;a.img.onerror=function(){a.completed=
!0};a.img.onload=function(){a.completed=!0;this.style.opacity=1};a.img.src=u(h,a.row,a.col);L.appendChild(a.img)}),k.ts.push.apply(k.ts,g),b&&0<b.ts.length&&q(function(){return this.ts.every(function(a){return a.completed})}.bind(k),function(){setTimeout(a.bind(this),600)}.bind(b))):b&&0<b.ts.length&&a.call(b);E.push(k);E.forEach(function(a){a.ts.forEach(function(a){var b=C.FromMapPoint(a.left,a.top),d=C.FromMapPoint(a.right,a.bottom);a.img.style.left=Math.round(b.x)+"px";a.img.style.top=Math.round(b.y)+
"px";a.img.style.width=Math.round(d.x)-Math.round(b.x)+"px";a.img.style.height=Math.round(d.y)-Math.round(b.y)+"px"})})}}};if(void 0!==f&&f.addLayer){var P=!0;void 0!==g&&!1==g.addToMap&&(P=!1);P&&f.addLayer(this,!0)}this.getTitle=function(){return d}}}();TGOS=TGOS||{};
TGOS.TMSLayer=function(){function b(a,b,d,h,k,l,p,m,n,u){var s,q="\u4e0d\u63d0\u4f9b\u5716\u78da\u670d\u52d9",w=!1;s=b.ownerDocument.createElement("img");s.onerror=function(){s&&(q?(s.alt=q,s.style.display=""):(s.alt="",s.style.display="none"),s.onload=null,s.onerror=null);w=!0};s.onmousedown=function(){return!1};s.onload=function(){s&&(s.alt="",s.style.display="");this.loaded=!0;TGOS.TGEvent.trigger(u,"tilesloaded")};s.galleryImg=!1;s.hideFocus=!0;s.style.display="none";s.style.MozUserSelect="none";
s.style.border="0 none";s.style.position="absolute";s.src=a;b.appendChild(s);this.setErrorTile=function(a){q=a};this.IsComplete=function(){return s.loaded||"complete"==s.readyState||s.complete};this.getStatus=function(){return!w};this.getHObject=function(){return s};this.getScale=function(){return d};this.getLeft=function(){return l};this.getTop=function(){return p};this.getRight=function(){return m};this.getBottom=function(){return n};this.RemoveSelf=function(){s&&(s.onmousedown=null,b.removeChild(s));
s=null};this.ReloadStatus=function(a,b,d,e){d=a+d;a=Math.round(a);e=b+e;b=Math.round(b);s.style.left=a+"px";s.style.top=b+"px";s.style.width=Math.round(d-a)+"px";s.style.height=Math.round(e-b)+"px"};this.isEqual=function(a,b,e){return d==a&&h==b&&k==e};this.getIndexX=function(){return h};this.getIndexY=function(){return k}}var d=[{z:0,x:-2.00375083427892E7,y:2.00375083427892E7,sd:5.91658710909131E8},{z:1,x:-2.00375083427892E7,y:2.00375083427892E7,sd:2.95829355454566E8},{z:2,x:-2.00375083427892E7,
y:2.00375083427892E7,sd:1.47914677727283E8},{z:3,x:-2.00375083427892E7,y:2.00375083427892E7,sd:7.39573388636414E7},{z:4,x:-2.00375083427892E7,y:2.00375083427892E7,sd:3.69786694318207E7},{z:5,x:-2.00375083427892E7,y:2.00375083427892E7,sd:1.84893347159103E7},{z:6,x:-2.00375083427892E7,y:2.00375083427892E7,sd:9244667.35795517},{z:7,x:-2.00375083427892E7,y:2.00375083427892E7,sd:4622333.67897759},{z:8,x:-2.00375083427892E7,y:2.00375083427892E7,sd:2311166.83948879},{z:9,x:-2.00375083427892E7,y:2.00375083427892E7,
sd:1155583.4197444},{z:10,x:-2.00375083427892E7,y:2.00375083427892E7,sd:577791.709872198},{z:11,x:-2.00375083427892E7,y:2.00375083427892E7,sd:288895.854936099},{z:12,x:-2.00375083427892E7,y:2.00375083427892E7,sd:144447.92746805},{z:13,x:-2.00375083427892E7,y:2.00375083427892E7,sd:72223.9637340248},{z:14,x:-2.00375083427892E7,y:2.00375083427892E7,sd:36111.9818670124},{z:15,x:-2.00375083427892E7,y:2.00375083427892E7,sd:18055.9909335062},{z:16,x:-2.00375083427892E7,y:2.00375083427892E7,sd:9027.9954667531},
{z:17,x:-2.00375083427892E7,y:2.00375083427892E7,sd:4513.99773337655},{z:18,x:-2.00375083427892E7,y:2.00375083427892E7,sd:2256.99886668828},{z:19,x:-2.00375083427892E7,y:2.00375083427892E7,sd:1128.49943334414},{z:20,x:-2.00375083427892E7,y:2.00375083427892E7,sd:564.249716672069},{z:21,x:-2.00375083427892E7,y:2.00375083427892E7,sd:282.124858336034},{z:22,x:-2.00375083427892E7,y:2.00375083427892E7,sd:141.062429168017},{z:23,x:-2.00375083427892E7,y:2.00375083427892E7,sd:70.5312145840086},{z:24,x:-2.00375083427892E7,
y:2.00375083427892E7,sd:35.2656072920043}],a=[{z:0,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:5.91658710909131E8},{z:1,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:2.95829355454566E8},{z:2,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:1.47914677727283E8},{z:3,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:7.39573388636414E7},{z:4,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:3.69786694318207E7},{z:5,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:1.84893347159103E7},{z:6,x:-2.00375083427892E7,
y:-2.00375083427892E7,sd:9244667.35795517},{z:7,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:4622333.67897759},{z:8,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:2311166.83948879},{z:9,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:1155583.4197444},{z:10,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:577791.709872198},{z:11,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:288895.854936099},{z:12,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:144447.92746805},{z:13,x:-2.00375083427892E7,y:-2.00375083427892E7,
sd:72223.9637340248},{z:14,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:36111.9818670124},{z:15,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:18055.9909335062},{z:16,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:9027.9954667531},{z:17,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:4513.99773337655},{z:18,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:2256.99886668828},{z:19,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:1128.49943334414},{z:20,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:564.249716672069},
{z:21,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:282.124858336034},{z:22,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:141.062429168017},{z:23,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:70.5312145840086},{z:24,x:-2.00375083427892E7,y:-2.00375083427892E7,sd:35.2656072920043}];return function(f,e,g,h,k,l){var p="{x}",m="{y}",n="{z}",u=!1,s=null!=g.getPanes?g.getPanes():null,q=null!=s?s.overlayviewLayer:null,w=25.4/96/1E3,C=256,B=d.slice(0),s=B.length;h&&(void 0!==h.dpi&&"OGC"==h.dpi&&(w=2.8E-4),
void 0!==h.tileWidth&&"number"==typeof h.tileWidth&&(C=h.tileWidth),void 0!==h.xTemplate&&(p=h.xTemplate),void 0!==h.yTemplate&&(m=h.yTemplate),void 0!==h.zTemplate&&(n=h.zTemplate),void 0!==h.yNorthPositive&&"boolean"==typeof h.yNorthPositive&&(u=h.yNorthPositive)&&(B=a.slice(0),s=B.length),void 0!==h.levels&&(B=h.levels,s=B.length),void 0!==h.maxZoom&&(s=h.maxZoom));s<B.length&&B.splice(s+1);var H=1,A="auto",I=!0,G=null,D=null,J=null,K=null,F=null;k&&(void 0!==k.container&&(q=k.container),void 0!==
k.opacity&&"number"==typeof k.opacity&&(H=k.opacity),void 0!==k.zIndex&&"number"==typeof k.zIndex&&(A=k.zIndex),void 0!==k.visible&&"boolean"==typeof k.visible&&(I=k.visible),void 0!==k.left&&"number"==typeof k.left&&(G=k.left),void 0!==k.right&&"number"==typeof k.right&&(J=k.right),void 0!==k.top&&"number"==typeof k.top&&(D=k.top),void 0!==k.bottom&&"number"==typeof k.bottom&&(K=k.bottom),void 0!==k.errorTile&&(F=k.errorTile));var t=[],v=[],z,E=!1,L=this,P=document.createElement("div");P.style.position=
"absolute";P.style.left="0px";P.style.top="0px";P.style.width="100%";P.style.height="100%";P.style.zIndex=A;P.style.display=I?"":"none";P.style.opacity=H;P.style.filter="alpha(opacity="+100*H+")";q.appendChild(P);this.moveToTop=function(){q&&(q.removeChild(P),q.appendChild(P))};this.moveLayerTo=function(a){if(q&&P&&(a=parseInt(a),!isNaN(a))){var b=q.childNodes.length;if(1<b){var d=null;0>=a?d=q.firstChild:a>=b||(d=q.childNodes[a]);q.removeChild(P);d?q.insertBefore(P,d):q.appendChild(P)}}};this.getLayerId=
function(){return f};this.getOpacity=function(){return H};this.setOpacity=function(a){"number"==typeof a&&(H=a,P&&(P.style.opacity=H,P.style.filter="alpha(opacity="+100*H+")"))};this.getZIndex=function(){return A};this.setZIndex=function(a){A=a;P&&(P.style.zIndex=A)};this.getSourceUrl=function(){return e};this.getNode=function(){return P};this.RemoveSelf=function(){q&&P&&q.removeChild(P)};var U=function(a,d,f){if(!a)return null;for(var h,k=0;k<a.length;k++)if(a[k].z==d.z){h=a[k];break}if(!h)return null;
var k=function(a,b){var d=[],e=Infinity,f=-Infinity,g=Infinity,h=-Infinity,k=0,l=0,m=[0,-1];for(D=Math.pow(Math.max(a,b),2);0<D;D--){-a/2<k&&k<=a/2&&-b/2<l&&l<=b/2&&(d.push({x:k,y:l}),k<e&&(e=k),k>f&&(f=k),l<g&&(g=l),l>h&&(h=l));if(k===l||0>k&&k===-l||0<k&&k===1-l)m=[-m[1],m[0]];k+=m[0];l+=m[1]}return{l:e,r:f,t:h,b:g,xy:d}},l=f.left,v=f.top,s=f.right,q=f.bottom;f=h.x;a=h.y;h=h.sd*C*w;var z,D;if(u){if(z=l<=f?0:Math.floor((l-f)/h),s=z+Math.ceil(Math.abs(l-s)/h)+1,l=q<=a?0:Math.floor((q-a)/h),v=l+Math.ceil(Math.abs(q-
v)/h)+1,v=k(s-z,v-l),k=v.xy,0<k.length)for(z-=v.l,v=l-v.b,l=0;l<k.length;l++){q=k[l].x+z;D=k[l].y+v;for(var s=!1,A=0;A<t.length;A++)if(t[A].isEqual(d.z,q,D)){s=!0;break}s||(s=e.replace(p,q).replace(m,D).replace(n,d.z),q=new b(s,P,d.z,q,D,f+q*h,a+(D+1)*h,f+(q+1)*h,a+D*h,g),q.setErrorTile(F),t.push(q))}}else if(z=l<=f?0:Math.floor((l-f)/h),s=z+Math.ceil(Math.abs(l-s)/h)+1,l=v>=a?0:Math.floor((a-v)/h),v=l+Math.ceil(Math.abs(q-v)/h)+1,v=k(s-z,v-l),k=v.xy,0<k.length)for(z-=v.l,v=l-v.b,l=0;l<k.length;l++){q=
k[l].x+z;D=k[l].y+v;s=!1;for(A=0;A<t.length;A++)if(t[A].isEqual(d.z,q,D)){s=!0;break}s||(s=e.replace(p,q).replace(m,D).replace(n,d.z),q=new b(s,P,d.z,q,D,f+q*h,a-D*h,f+(q+1)*h,a-(D+1)*h,g),q.setErrorTile(F),t.push(q))}},Y=function(a,b){for(var d=0,e=Infinity,f=a.ToMapDistX(C),g=0;g<b.length;g++){var h=Math.abs(b[g].sd*C*w-f);h<e&&(e=h,d=g)}return b[d]};this.Initialize=function(a){z=a;E=!0;L.RebuildElement();L.UpdateElement();l&&l.call(this)};this.putVisible=function(a){I=a;P.style.display=a?"":"none"};
this.setVisible=function(a){this.putVisible(a)};this.removeLayer=function(){g.removeLayer(this)};this.getVisible=function(){return I};var M=function(a){null!==G&&a.left<G&&(a.left=G);null!==D&&a.top>D&&(a.top=D);null!==J&&a.right>J&&(a.right=J);null!==K&&a.bottom<K&&(a.bottom=K);return a};this.MoveTiles=function(){if(E&&I&&B)for(var a=[t,v],b=0;b<a.length;b++)for(var d=a[b],e=0;e<d.length;e++){var f=z.FromMapPoint(d[e].getLeft(),d[e].getTop()),g=z.FromMapPoint(d[e].getRight(),d[e].getBottom()),h=
g.x-f.x,g=g.y-f.y;0>h&&(f.x-=h=-h);0>g&&(f.y-=g=-g);d[e].ReloadStatus(f.x,f.y,h,g)}};this.UpdateElement=function(){this.RebuildElement()};this.RebuildElement=function(){if(E&&I&&B){var a=Y(z,B);if(null!=a){var b=z.ToMapPoint(0,0),d=z.ToMapPoint(z.getClientWidth(),z.getClientHeight()),b=new TGOS.TGEnvelope(b.x,b.y,d.x,d.y),b=M(b);U(B,a,b);DEBUG_MODE&&console.log("getBoundTiles = "+t.length);var d=[],e=t.length;for(i=0;i<e;i++){var f=t[i],g=f.getScale(),h=f.getLeft(),k=f.getRight(),l=f.getTop(),m=f.getBottom();
f.getIndexX();f.getIndexY();k<b.left||h>b.right||m>b.top||l<b.bottom?f.RemoveSelf():g==a.z?d.push(f):f.IsComplete()&&f.getStatus()?v.push(f):f.RemoveSelf()}t=d;DEBUG_MODE&&console.log("tiles = "+t.length);this.MoveTiles();var n=function(){for(var a=!0,b=0;b<t.length;b++)if(t[b].IsComplete())a=t[b].getStatus();else return setTimeout(n,100);if(a)for(;0<v.length;)v.pop().RemoveSelf()};setTimeout(n,100)}}};void 0!==g&&g.addLayer&&(h=!0,void 0!==k&&!1==k.addToMap&&(h=!1),h&&g.addLayer(this,!0))}}();TGOS=TGOS||{};
(function(){var b=/[, ]/;TGOS.TGVectorFeature=function(b){this.mset=b.mset;this.mid=b.mid;this.fid=b.fid;this.count=1;this.attr=b.attr;this.geom=b.geom;this.visible=!0;this.symbol};TGOS.TGVectorFeatures=function(b){this.map=b;this.independentContainer=!1;this.format=null;this.queryable=!0;this.mFeatures=[];this.graphicSelectedCallback=null;this.position=TGOS.TGControlPosition.LEFT_BOTTOM;this.div=document.createElement("div");this.div.style.background="red";util.disableSelect(this.div);var a=document.createTextNode(" ");
b=document.createElement("BUTTON");b.className="warning_text";b.style.color="blue";b.appendChild(a);a=document.createElement("table");a.insertRow(-1).insertCell(-1).appendChild(b);this.div.appendChild(a);this.div.style.display="none";this.textTooManyGraphics="\u5716\u5f62\u6578\u91cf\u592a\u591a, \u505c\u6b62\u7e6a\u5716.";this.textForceDrawWaiting="\u5f37\u5236\u91cd\u7e6a, \u8acb\u8010\u5fc3\u7a0d\u5019...";this.map.controls[this.position].push(this.div);this.setWarningText=function(a){var b=this.div.getElementsByClassName("warning_text");
0<b.length&&(b[0].data=a,b[0].innerText=a);this.showWarning(!0)};this.showWarning=function(a){this.div.style.display=a?"":"none"};this.closeWarning=function(){for(this.div.style.display="none";this.div.firstChild;)this.div.removeChild(this.div.firstChild);var a=this.map.controls[this.position].indexOf(this.div);0<=a&&this.map.controls[this.position].removeAt(a)};this.infoWindowOptions={maxWidth:1E3,pixelOffset:{x:0,y:0}};this.messageBox=null;this.infoAttrFields={};this.polygonSymbol=this.lineSymbol=
this.pointSymbol=null;this.limitFeatures=!0;this.maxFeaturesAllow=1E3;var f=this;b.onclick=function(){f.setWarningText(f.textForceDrawWaiting);setTimeout(function(){f.draw(!0)},100)};this.setClickCallback=function(a){this.graphicSelectedCallback=a};this.add=function(a){var b=!1,d=a.mset+"_"+a.mid,f=null;void 0!==this.mFeatures[d]?(f=this.mFeatures[d],d=f[a.fid],void 0!==d&&(b=!0,d.count+=1,d.visible=!0)):(this.mFeatures[d]={},f=this.mFeatures[d]);!1==b&&(f[a.fid]=new TGOS.TGVectorFeature(a))};this.getPointSymbol=
function(a){var b=null;null!=this.pointSymbol&&(a=a[this.pointSymbol.field],void 0!==a&&(b=this.pointSymbol.symbols[a]));return b};this.getLineSymbol=function(a){var b=null;null!=this.lineSymbol&&(a=a[this.lineSymbol.field],void 0!==a&&(b=this.lineSymbol.symbols[a]));return b};this.getPolygonSymbol=function(a){var b=null;null!=this.polygonSymbol&&(a=a[this.polygonSymbol.field],void 0!==a&&(b=this.polugonSymbol.symbols[a]));return b};this.getAdvancedContainer=function(){return!0==this.independentContainer?
(void 0===this.advancedLayer&&(this.advancedLayer=this.map.addIndependentContainer("VectorTileLayer")),this.advancedLayer):null};this.removeAdvancedLayer=function(){null!=this.advancedLayer&&(this.map.removeIndependentContainer(this.advancedLayer),this.advancedLayer=null)};this.removeAll=function(){!0==this.independentContainer&&this.removeAdvancedLayer();for(var a in this.mFeatures){var b=this.mFeatures[a];if(void 0!==b)for(var d in b){var f=b[d];void 0!==f&&(void 0!==f.symbol&&(f.symbol.setMap(null),
f.symbol=null),delete b[d])}delete this.mFeatures[a]}};this.draw=function(a){DEBUG_MODE&&console.log("Draw start...");var b=performance.now();this.showWarning(!1);var d={};if(!0==this.independentContainer){var k=this.getAdvancedContainer();null!=k&&(d.advancedLayer=k)}var l=this.map.getMapBase(),k=l.ToMapPoint(0,0),l=l.ToMapPoint(l.getClientWidth(),l.getClientHeight()),p=new TGOS.TGEnvelope(k.x,k.y,l.x,l.y),m=!1,l=k=0,n;for(n in this.mFeatures){var u=this.mFeatures[n];if(void 0!==u)for(var s in u){var q=
u[s];if(void 0!==q&&q.visible&&q.geom){var w=!0;void 0===a&&this.limitFeatures&&k>=this.maxFeaturesAllow&&(w=!1,m=!0,this.setWarningText(this.textTooManyGraphics));if(w){var w=!1,C=q.geom.Envelope;null!=C&&(C.left>p.right||C.right<p.left||C.bottom>p.top||C.top<p.bottom)&&(q.visible=!1,w=!0,void 0!==q.symbol&&q.symbol.getVisible()&&q.symbol.setVisible(!1));if(!w){q.visible=!0;if(void 0!==q.symbol)q.symbol.getVisible()||q.symbol.setVisible(!0);else{l++;var B=d,H=null,C=q.attr,w=q.geom;w instanceof TGOS.TGPolygon?
(H=new TGOS.TGFill(this.map,w,B),H.setOpacity(0.5)):w instanceof TGOS.TGLineString?(H=new TGOS.TGLine(this.map,w,B),H.setStrokeWeight(4)):w instanceof TGOS.TGPoint?(C=this.getPointSymbol(C),null!=C?(B.flat=!0,H=new TGOS.TGMarker(this.map,w,"",C,B)):H=new TGOS.TGMarker(this.map,w,"",null,B)):w instanceof TGOS.TGMultiPolygon?(H=new TGOS.TGFill(this.map,w,B),H.setOpacity(0.5)):w instanceof TGOS.TGMultiLineString?(H=new TGOS.TGLine(this.map,w,B),H.setStrokeWeight(4)):w instanceof TGOS.TGMultiPoint&&(C=
this.getPointSymbol(C),null!=C?(B.flat=!0,H=new TGOS.TGMarker(this.map,w,"",C,B)):H=new TGOS.TGMarker(this.map,w,"",null,B));w=H;q.symbol=w;null!=w&&(w.key=n,w.id=s,this.queryable&&TGOS.TGEvent.addListener(w,"click",f.showInfo))}k++}}}if(m)break}if(m)break}a=performance.now()-b;DEBUG_MODE&&console.log("Drawing = "+k+" (Create = "+l+"), Time = "+a)};this.remove=function(a,b,d){b=a+"_"+b;a=null;if(void 0!==this.mFeatures[b]){a=this.mFeatures[b];b=d.length;for(var f=0;f<b;f++){var l=d[f],p=a[l];void 0!==
p&&(p.count-=1,0>=p.count&&(void 0!==p.symbol&&null!=p.symbol&&(p.symbol.setMap(null),p.symbol=null),delete a[l]))}}};this.setVisible=function(a,b,d,f){b=a+"_"+b;a=null;if(void 0!==this.mFeatures[b]){a=this.mFeatures[b];b=d.length;for(var l=0;l<b;l++){var p=a[d[l]];void 0!==p&&p.visible!=f&&(p.visible=f)}}};this.showInfo=function(a){a.stopPropagation();var b=a.target;if(void 0!==b){var d=f.mFeatures[b.key];if(void 0!==d&&(d=d[b.id],void 0!==d)){var k="",l=[];if(0<f.infoAttrFields.length)for(var p=
f.infoAttrFields.length,m=0;m<p;m++){var n=f.infoAttrFields[m],u=null,s=null;"string"===typeof n||n instanceof String?s=u=n:n instanceof Object&&(u=n.name,s=n.alias);null!=u&&null!=s&&(u=d.attr[u],void 0!==u&&(0<k.length&&(k+="<br />"),k=k+s+": "+u,l.push({field:s,value:u})))}else for(n in d.attr)u=d.attr[n],void 0!==u&&(0<k.length&&(k+="<br />"),k=k+n+": "+u,l.push({field:n,value:u}));f.graphicSelectedCallback?f.graphicSelectedCallback.call(b,{graphic:b,point:a.point,info:k,attr:l}):(null==f.messageBox&&
(f.messageBox=new TGOS.TGInfoWindow(null,null,f.infoWindowOptions)),f.messageBox.setPosition(a.point),f.messageBox.setMessageText(k),f.messageBox.open(f.map))}}};this.hideInfo=function(){null!=f.messageBox&&(f.messageBox.setMessageText(""),f.messageBox.close())};this.setQueryable=function(a){this.queryable=a;for(var b in this.mFeatures){var d=this.mFeatures[b];if(void 0!==d)for(var k in d){var l=d[k];void 0!==l&&(l=l.symbol,void 0!==l&&(a?(TGOS.TGEvent.addListener(l,"click",f.showInfo),l.setCursor("pointer")):
(void 0!==l.click_&&TGOS.TGEvent.removeListener(l.click_[0]),l.setCursor("default"))))}}};this.getQueryable=function(){return this.queryable}};TGOS.TGVectorTile=function(d,a){this.req=this.url=this.map=null;this.loaded=this.loading=!1;this.matrixSet=d.matrixSet;this.matrixId=d.matrixId;this.bound=d.bound;this.row=d.row;this.col=d.col;this.format=d.format;this.visible=!0;this.fid=[];this.equals=function(a){return this.matrixSet==a.matrixSet&&this.matrixId==a.matrixId&&this.row==a.row&&this.col==a.col};
this.setVisible=function(b){this.visible=b;if(0<this.fid.length){var d=this.matrixSet,g=this.matrixId;a.getAllFeatures().setVisible(d,g,this.fid,b)}};this.getVisible=function(){return this.visible};this.clear=function(){if(0<this.fid.length){var b=this.matrixSet,d=this.matrixId;a.getAllFeatures().remove(b,d,this.fid)}};this.getJsonFeature=function(b,d){var g=function(a,b){var d=null;if(void 0!==a&&0<a.length){var d=[],e=a.length;if(b.intCoord)for(var f=b.scaleFactor,g=b.vt.bound,h=g.left,g=g.bottom,
k=0;k<e;k++)d.push({x:h+a[k][0]*f,y:g+a[k][1]*f});else if(f=a[0],f instanceof Array)for(k=0;k<e;k++)d.push({x:a[k][0],y:a[k][1]});else if(void 0!==f.x&&void 0!==f.y)for(k=0;k<e;k++)d.push(a[k])}return d},h=function(a,b){var d=null;if(void 0!==a&&0<a.length){var e=null,f=null;b.intCoord?(f=b.vt.bound,e=f.left+a[0]*b.scaleFactor,f=f.bottom+a[1]*b.scaleFactor):a instanceof Array?(e=a[0],f=a[1]):void 0!==a.x&&void 0!==a.y&&(e=a.x,f=a.y);null!=e&&null!=f&&(d=new TGOS.TGPoint(e,f))}return d},k=function(a,
b){var d=null,e=g(a,b);null!=e&&(d=new TGOS.TGLineString(e));return d},l=function(a,b){var d=null,e=g(a,b);if(null!=e){var f=e.length;if(2<f){var h=e[0],f=e[f-1];h.x==f.x&&h.y==f.y||e.push(h)}}null!=e&&(e=new TGOS.TGLineString(e),null!=e&&(d=new TGOS.TGLinearRing(e)));return d},p=function(a,b){var d=null;if(void 0!==a&&0<a.length){var e=[],f=l(a[0],b);null!=f&&e.push(f);f=a.length;if(1<f)for(var g=1;g<f;g++){var h=l(a[g],b);null!=h&&e.push(h)}0<e.length&&(d=new TGOS.TGPolygon(e))}return d},m=function(a,
b){var d=null,e=a.type;if(void 0!==e)if("GeometryCollection"==e){var f=a.geometries;if(0<f.length)for(var d=[],g=f.length,e=0;e<g;e++)d.push(m(f[e],b))}else if("MultiPolygon"==e){if(g=a.coordinates,0<g.length){for(var l=[],f=g.length,e=0;e<f;e++){var t=p(g[e],b);null!=t&&l.push(t)}0<l.length&&(d=new TGOS.TGMultiPolygon(l))}}else if("MultiLineString"==e){if(f=a.coordinates,0<f.length){d=[];g=f.length;for(e=0;e<g;e++)d.push(k(f[e],b));d=new TGOS.TGMultiLineString(d)}}else if("MultiPoint"==e){if(g=a.coordinates,
0<g.length){d=[];f=g.length;for(e=0;e<f;e++)l=h(g[e],b),null!=l&&d.push(l);d=new TGOS.TGMultiPoint(d)}}else"Polygon"==e?(e=a.coordinates,d=p(e,b)):"LineString"==e?(e=a.coordinates,d=k(e,b)):"Point"==e&&(e=a.coordinates,d=h(e,b));return d},n=function(a,b){var d=null;if(void 0!==a.type&&"Feature"==a.type){var e=a.FID,f=a.properties,g=a.geometry;void 0!==g&&(g=m(g,b),null!=g&&("EPSG3857"==u.coordSys&&(g=TGOS.Geometry.Transform(g,TGOS.GooToWGS84)),d={fid:e,attr:f,geom:g}))}return d},u=this;if(b&&(u.coordSys=
this.map.getCoordSys(),void 0!==b.type&&"FeatureCollection"==b.type)){var s=b.features,q=[];if(null!=s&&s instanceof Array)for(var w=s.length,C=0;C<w;C++){var B=s[C];null!=B&&(B=n(B,d),null!=B&&q.push(B))}if(0<q.length){for(var n=u.matrixSet,s=u.matrixId,w=a.getAllFeatures(),C=q.length,H=0;H<C;H++)B=q[H],B.mset=n,B.mid=s,w.add(B),u.fid.push(B.fid);w.draw()}q=[]}};this.getGmlFeature=function(d,e){var g=function(a,d){var e=null;if(null!=a&&0<a.length){var e=[],f=a[0].childNodes[0].nodeValue.split(b);
if(d.intCoord)for(var g=d.scaleFactor,h=d.vt.bound,k=h.left,h=h.bottom,l=0;l<f.length;l+=2){var m=k+parseInt(f[l])*g,n=h+parseInt(f[l+1])*g;e.push({x:m,y:n})}else for(l=0;l<f.length;l+=2)e.push({x:parseFloat(f[l]),y:parseFloat(f[l+1])})}return e},h=function(a,b){var d=null;if(void 0!==a){var e=g(a.getElementsByTagNameNS("http://www.opengis.net/gml","coordinates"),b);null!=e&&0<e.length&&(d=new TGOS.TGPoint(parseFloat(e[0].x),parseFloat(e[0].y)))}return d},k=function(a,b){var d=null;if(void 0!==a){var e=
g(a.getElementsByTagNameNS("http://www.opengis.net/gml","coordinates"),b);null!=e&&0<e.length&&(d=new TGOS.TGLineString(e))}return d},l=function(a,b){var d=null,e=g(a.getElementsByTagNameNS("http://www.opengis.net/gml","coordinates"),b);if(null!=e){var f=e.length;if(2<f){var h=e[0],f=e[f-1];h.x==f.x&&h.y==f.y||e.push(h)}}null!=a&&(e=k(a,b),null!=e&&(d=new TGOS.TGLinearRing(e)));return d},p=function(a,b){var d=null;if(void 0!==a){var e=[],f=a.getElementsByTagNameNS("http://www.opengis.net/gml","outerBoundaryIs");
if(null!=f&&0<f.length){var g=f[0].getElementsByTagNameNS("http://www.opengis.net/gml","LinearRing");null!=g&&0<g.length&&(g=l(g[0],b),null!=g&&e.push(g))}f=a.getElementsByTagNameNS("http://www.opengis.net/gml","innerBoundaryIs");if(null!=f&&0<f.length)for(var h=0;h<f.length;h++)g=f[h].getElementsByTagNameNS("http://www.opengis.net/gml","LinearRing"),null!=g&&0<g.length&&(g=l(g[0],b),null!=g&&e.push(g));0<e.length&&(d=new TGOS.TGPolygon(e))}return d},m=function(a,b){var d=null;if(void 0!==a){for(var e=
a.getAttribute("FID"),f=a.getElementsByTagNameNS("http://www.supergeo.com.tw/gml","Fields"),g={},l=f.length,m=0;m<l;m++)g[f[m].attributes[0].value]=f[m].textContent;f=a.getElementsByTagNameNS("http://www.supergeo.com.tw/gml","_SHAPE_");if(void 0!==f){var t=f[0],d=null,f=t.getElementsByTagNameNS("http://www.opengis.net/gml","MultiPoint"),l=t.getElementsByTagNameNS("http://www.opengis.net/gml","MultiLineString"),m=t.getElementsByTagNameNS("http://www.opengis.net/gml","MultiPolygon"),v=t.getElementsByTagNameNS("http://www.opengis.net/gml",
"Point"),q=t.getElementsByTagNameNS("http://www.opengis.net/gml","LineString"),t=t.getElementsByTagNameNS("http://www.opengis.net/gml","Polygon");if(0<m.length){if(f=m[0].getElementsByTagNameNS("http://www.opengis.net/gml","Polygon"),0<f.length){l=[];for(d=0;d<f.length;d++)l.push(p(f[d],b));d=new TGOS.TGMultiPolygon(l)}}else if(0<l.length){if(f=l[0].getElementsByTagNameNS("http://www.opengis.net/gml","LineString"),0<f.length){l=[];for(d=0;d<f.length;d++)l.push(k(f[d],b));d=new TGOS.TGMultiLineString(l)}}else if(0<
f.length){if(f=f[0].getElementsByTagNameNS("http://www.opengis.net/gml","Point"),0<f.length){l=[];for(d=0;d<f.length;d++)l.push(h(f[d],b));d=new TGOS.TGMultiPoint(l)}}else 0<t.length?d=p(t[0],b):0<q.length?d=k(q[0],b):0<v.length&&(d=h(v[0],b));"EPSG3857"==n.coordSys&&(d=TGOS.Geometry.Transform(d,TGOS.GooToWGS84));d={fid:e,attr:g,geom:d}}}return d},n=this;if(d&&d.documentElement&&(n.coordSys=this.map.getCoordSys(),void 0!==d.documentElement.getElementsByTagNameNS("http://www.opengis.net/gml","featureMember"))){var u=
d.documentElement.getElementsByTagNameNS("http://www.supergeo.com.tw/gml","Feature"),s=[],q=u.length;if(null!=u&&0<q)for(var w=0;w<q;w++){var C=u[w];null!=C&&(C=m(C,e),null!=C&&s.push(C))}if(0<s.length){for(var m=n.matrixSet,u=n.matrixId,q=a.getAllFeatures(),w=s.length,B=0;B<w;B++)C=s[B],C.mset=m,C.mid=u,q.add(C),n.fid.push(C.fid);q.draw()}s=[]}}};TGOS.TGVectorTileLayer=function(b,a,f,e,g,h){function k(){DEBUG_MODE&&console.log("cleanTiles");var a=z(B,F);if(null!=a){var b=F["ows:Identifier"],a=a["ows:Identifier"],
d;for(d in C){var e=C[d];if(e.matrixSet!=b||e.matrixId!=a)e.clear(),delete C[d]}w.draw()}}var l=f.getPanes().overlayviewLayer,p="boolean"==typeof g.independentContainer?g.independentContainer:!1,m,n="number"==typeof g.left?g.left:null,u="number"==typeof g.top?g.top:null,s="number"==typeof g.right?g.right:null,q="number"==typeof g.bottom?g.bottom:null,w=new TGOS.TGVectorFeatures(f),C={},B,H=!1,A=this;w.independentContainer=p;void 0!==e.attrFields&&(w.infoAttrFields=e.attrFields);void 0!==g.infoWindowOptions&&
(w.infoWindowOptions=g.infoWindowOptions);void 0!==g.limitFeatures&&(w.limitFeatures=g.limitFeatures);void 0!==g.queryable&&(w.queryable=g.queryable);void 0!==g.pointSymbol&&(w.pointSymbol=g.pointSymbol);void 0!==g.lineSymbol&&(w.lineSymbol=g.lineSymbol);void 0!==g.polygonSymbol&&(w.polygonSymbol=g.polygonSymbol);var I="number"==typeof e.dpi?25.4/e.dpi/1E3:2.8E-4,G="number"==typeof e.tileWidth?e.tileWidth:256,D="number"==typeof e.tileHeight?e.tileHeight:256;null!=g.container&&(l=g.container);var J=
"number"==typeof g.opacity?g.opacity:1;0>J&&(J=0);1<J&&(J=1);var K=!1==g.visible?!1:!0,F=null,t=document.createElement("div");t.style.position="absolute";t.style.left="0px";t.style.top="0px";t.style.width="100%";t.style.height="100%";t.style.zIndex="auto";t.style.display=K?"":"none";l.appendChild(t);var v;this.moveToTop=function(){l&&(l.removeChild(t),l.appendChild(t))};this.getLayerId=function(){return b};this.getLayerContainer=function(){return t};this.getMatrixSetId=function(){return F["ows:Identifier"]};
this.getOpacity=function(){return J};this.setOpacity=function(a){"number"==typeof a&&(J=a,t&&(t.style.opacity=J,t.style.filter="alpha(opacity="+100*J+")"))};this.getSource=function(){return a};this.RemoveSelf=function(){null!=w&&(w.closeWarning(),w.hideInfo(),w.removeAll());l.removeChild(t)};this.getBoundTiles=function(a,b,d,e){if(!a||!b)return null;var g=parseFloat(b.MatrixWidth),h=parseFloat(b.MatrixHeight);mIdx=0==g?1:g-1;mIdy=0==h?1:h-1;var k=d.left,l=d.top,m=d.right,t=d.bottom,g=[],h=b.left,
n=b.top,p=parseFloat(b.ScaleDenominator),v=parseFloat(b.TileWidth),v=p*v*I,p=p*D*I;d=k<=h?0:Math.floor((k-h)/v);for(var m=d+Math.ceil(Math.abs(k-m)/v)+1,k=l>=n?0:Math.floor((n-l)/v),l=k+Math.ceil(Math.abs(t-l)/v)+1,m=m-d,q=l-k,l=[],s=Infinity,u=-Infinity,z=Infinity,E=-Infinity,w=0,A=0,B=[0,-1],t=Math.pow(Math.max(m,q),2);0<t;t--){-m/2<w&&w<=m/2&&-q/2<A&&A<=q/2&&(l.push({x:w,y:A}),w<s&&(s=w),w>u&&(u=w),A<z&&(z=A),A>E&&(E=A));if(w===A||0>w&&w===-A||0<w&&w===1-A)B=[-B[1],B[0]];w+=B[0];A+=B[1]}if(0<l.length)for(m=
d-s,k-=z,z=0;z<l.length;z++)q=l[z].x+m,t=l[z].y+k,d={left:h+q*v,top:n-t*p,right:h+(q+1)*v,bottom:n-(t+1)*p},d=new TGOS.TGVectorTile({matrixId:b["ows:Identifier"],matrixSet:a,bound:d,col:q,row:t,format:e.format},this),d.map=f,g.push(d);return g};var z=function(a,b){for(var d=0,e=Infinity,f=a.ToMapDistX(G),g=0;g<b.TileMatrix.length;g++){var h=parseFloat(b.TileMatrix[g].ScaleDenominator)*G*I,h=Math.abs(h-f);h<e&&(e=h,d=g)}return 0.1<e/f&&parseFloat(b.TileMatrix[d].ScaleDenominator)*G*I<1.1*f?null:b.TileMatrix[d]};
this.Initialize=function(b){B=b;m=a=0<a.indexOf("?")?a.slice(0,a.indexOf("?")):a;TGOS.getJSON(a+"?SERVICE=WMTS&REQUEST=GetCapabilities&VERSION=1.0.0",function(a){v=a.Capabilities;if(!v)throw"Service Error";a=v;var b=a["ows:OperationsMetadata"];if(void 0!==b){var d,f=b["ows:Operation"];if(void 0!==f&&f instanceof Array)for(b=0;b<f.length;b++){var g=f[b];if(void 0!==g){var k=g["@name"];if(void 0!==k&&"GetTile"==k&&(g=g["ows:DCP"],void 0!==g&&(d=g["ows:HTTP"]["ows:Get"],void 0!==d)))break}}if(void 0!==
d&&d instanceof Array)for(b=0;b<d.length;b++)if(f=d[b],void 0!==f&&(xlnk=f["@xlink:href"],void 0!==xlnk&&(f=f["ows:Constraint"]["ows:AllowedValues"]["ows:Value"],void 0!==f&&"KVP"==f))){m=0<xlnk.indexOf("?")?xlnk.slice(0,xlnk.indexOf("?")):xlnk;break}}f=null;g=a.Contents.Layer;if(void 0!==g){if(void 0!==g.length){for(d=0;d<g.length;d++)if((b=g[d]["ows:Identifier"])&&b==e.layer){f=g[d];break}null==f&&(f=g[0])}else f=g;null!=f&&(e.format=f.Format,e.layer=f["ows:Identifier"])}a=a.Contents.TileMatrixSet;
if(void 0!==a)if(void 0!==a.length){for(d=0;d<a.length;d++)if((b=a[d]["ows:Identifier"])&&b==e.matrixSet){F=a[d];break}null==F&&(F=a[0])}else F=a;if(F)for(e.matrixSet=F["ows:Identifier"],d=0;d<F.TileMatrix.length;d++){a=F.TileMatrix[d];var f=a.TopLeftCorner,b=parseFloat(f.split(" ")[0]),f=parseFloat(f.split(" ")[1]),g=parseFloat(a.ScaleDenominator),l=parseFloat(a.MatrixWidth),k=parseFloat(a.MatrixHeight),t=parseFloat(a.TileWidth),n=parseFloat(a.TileHeight),l=b+g*l*t*I,g=f-g*k*n*I;b&&f&&l&&g&&(a.left=
b,a.top=f,a.right=l,a.bottom=g)}H=!0;A.RebuildElement();h&&h.call(this)},TGOS.PROXY_SERVICE2)};this.getAllFeatures=function(){return w};this.putVisible=function(a){K=a;t.style.display=a?"":"none"};this.getVisible=function(){return K};this.setVisible=function(a){this.putVisible(a)};this.removeLayer=function(){f.removeLayer(this)};var E=function(a){var b=a.url;if(void 0!=b&&null!=b&&!a.loaded&&!a.loading){a.loading=!0;var d;d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");
d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var b=d.responseText;a.loading=!1;a.loaded=!0;if(0<b.length){var e=a.map.getMapBase().getCellSizeX(),e={vt:a,scaleFactor:e,simTolenrance:e};DEBUG_MODE&&console.log("loaded with data.");var f=a.format.indexOf("xml");0<=a.format.indexOf("text")&&0>f&&(e.intCoord=!0);var g=a.format.indexOf("gml"),h=a.format.indexOf("json");0<=g||0<=f?(b=TGOS.parseXML(b),a.getGmlFeature(b,e)):0<=h&&(b=JSON.parse(b),a.getJsonFeature(b,e))}}};a.xhr=d;d.open("GET",
a.url,!0);d.send()}},L;this.finished=!1;this.UpdateElement=function(){if(H&&K&&F&&(this.getAllFeatures().showWarning(!1),this.finished)){var a=z(B,F);if(null!=a){var b=F["ows:Identifier"],d=a["ows:Identifier"],g=B.ToMapPoint(0,0),h=B.ToMapPoint(B.getClientWidth(),B.getClientHeight()),g=h=new TGOS.TGEnvelope(g.x,g.y,h.x,h.y);null!==n&&g.left<n&&(g.left=n);null!==u&&g.top>u&&(g.top=u);null!==s&&g.right>s&&(g.right=s);null!==q&&g.bottom<q&&(g.bottom=q);var h=g,l;for(l in C)if(g=C[l],g.matrixSet==b&&
g.matrixId==d){var t=g.bound;t.left>h.right||t.right<h.left||t.bottom>h.top||t.top<h.bottom?g.setVisible(!1):g.setVisible(!0)}else g.xhr.abort(),g.clear(),delete C[l];a=this.getBoundTiles(b,a,h,e);if(!a)return null;for(l=0;l<a.length;l++){var b=a[l],d=!1,p;for(p in C)if(g=C[p],g.equals(b)){d=!0;break}d||(d=m+"?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&Layer="+e.layer+"&Style="+(void 0!==e.style?e.style:"default")+"&Format="+e.format+"&TileMatrixSet="+b.matrixSet+"&TileMatrix="+b.matrixId+"&TileRow="+
b.row+"&TileCol="+b.col,g=new TGOS.TGVectorTile({matrixId:b.matrixId,matrixSet:b.matrixSet,bound:b.bound,col:b.col,row:b.row,format:b.format},this),g.map=f,g.url=d,C[b.matrixSet+"_"+b.matrixId+"_"+b.row+"_"+b.col]=g,E(g))}clearTimeout(L);L=setTimeout(k,250);this.finished=!1}}};this.RebuildElement=function(){this.finished=!0;this.UpdateElement()};this.hideInfo=function(){w.hideInfo()};this.setClickCallback=function(a){w.setClickCallback(a)};this.setQueryable=function(a){w.setQueryable(a)};this.getQueryable=
function(){return w.getQueryable()};this.getIndependentContainer=function(){return p};this.setIndependentContainer=function(a){p=a;w.independentContainer=p};this.getAdvancedContainer=function(){return w.getAdvancedContainer()};this.getNode=function(){if(f){if(!0==p){var a=w.getAdvancedContainer();return null!=a?[a.div.main,a.div.shadow]:[f.getPanes().graphicLayer,f.getPanes().shadowLayer]}return[f.getPanes().graphicLayer,f.getPanes().shadowLayer]}};f.addLayer(this,!0)};TGOS.RegisterEvent(TGOS.TGVectorTileLayer,
"click mousemove mouseout mouseover dblclick rightclick".split(" "))})();TGOS=TGOS||{};
(function(){var b=/[, ]/;TGOS.TGVectorPoiFeature=function(b){this.mset=b.mset;this.mid=b.mid;this.fid=b.fid;this.count=1;this.attr=b.attr;this.geom=b.geom;this.visible=!0;this.symbol};TGOS.TGVectorPoiFeatures=function(b){this.map=b;this.independentContainer=!1;this.format=null;this.queryable=!0;this.mFeatures=[];this.graphicSelectedCallback=null;this.infoWindowOptions={maxWidth:1E3,pixelOffset:{x:0,y:0}};this.messageBox=null;this.infoAttrFields={};this.polygonSymbol=this.lineSymbol=this.pointSymbol=
null;var a=this;this.setClickCallback=function(a){this.graphicSelectedCallback=a};this.add=function(a){var b=!1,d=a.mset+"_"+a.mid,h=null;void 0!==this.mFeatures[d]?(h=this.mFeatures[d],d=h[a.fid],void 0!==d&&(b=!0,d.count+=1,d.visible=!0,void 0!==d.symbol&&null!=d.symbol&&d.symbol.setVisible(!0))):(this.mFeatures[d]={},h=this.mFeatures[d]);!1==b&&(h[a.fid]=new TGOS.TGVectorFeature(a))};this.getPointSymbol=function(a){var b=null;if(null!=this.pointSymbol){var d=a[this.pointSymbol.field1];a=a[this.pointSymbol.field2];
void 0!==d&&(b=-1<a.indexOf("\u53f0\u5317\u6377\u904b")?this.pointSymbol.symbols[d][0]:-1<a.indexOf("\u9ad8\u96c4\u6377\u904b")?this.pointSymbol.symbols[d][1]:-1<a.indexOf("\u5168\u5bb6\u4fbf\u5229\u5546\u5e97")?this.pointSymbol.symbols[d][0]:-1<a.indexOf("7-ELEVEn")?this.pointSymbol.symbols[d][1]:-1<a.indexOf("\u840a\u723e\u5bcc\u4fbf\u5229\u5546\u5e97")?this.pointSymbol.symbols[d][2]:-1<a.indexOf("OK\u4fbf\u5229\u5546\u5e97")?this.pointSymbol.symbols[d][3]:this.pointSymbol.symbols[d])}return b};
this.getLineSymbol=function(a){var b=null;null!=this.lineSymbol&&(a=a[this.lineSymbol.field],void 0!==a&&(b=this.lineSymbol.symbols[a]));return b};this.getPolygonSymbol=function(a){var b=null;null!=this.polygonSymbol&&(a=a[this.polygonSymbol.field],void 0!==a&&(b=this.polugonSymbol.symbols[a]));return b};this.getAdvancedContainer=function(){return!0==this.independentContainer?(void 0===this.advancedLayer&&(this.advancedLayer=this.map.addIndependentContainer("VectorTileLayer")),this.advancedLayer):
null};this.removeAdvancedLayer=function(){null!=this.advancedLayer&&(this.map.removeIndependentContainer(this.advancedLayer),this.advancedLayer=null)};this.removeAll=function(){!0==this.independentContainer&&this.removeAdvancedLayer();for(var a in this.mFeatures){var b=this.mFeatures[a];if(void 0!==b)for(var d in b){var h=b[d];void 0!==h&&(h.visible&&void 0!==h.symbol&&h.symbol.setMap(null),delete b[d])}delete this.mFeatures[a]}};this.draw=function(){var b=null;if(!0==this.independentContainer){var d=
this.getAdvancedContainer();null!=d&&(b={cursor:"pointer",advancedLayer:d})}var g=d=0,h;for(h in this.mFeatures){var k=this.mFeatures[h];if(void 0!==k)for(var l in k){var p=k[l];if(void 0!==p&&p.visible){if(void 0===p.symbol){g++;var m=null,n=p.attr,u=p.geom;if(u instanceof TGOS.TGPolygon)m=new TGOS.TGFill(this.map,u,b),m.setOpacity(0.5);else if(u instanceof TGOS.TGLineString)m=new TGOS.TGLine(this.map,u,b),m.setStrokeWeight(4);else if(u instanceof TGOS.TGPoint){m=b;new TGOS.TGPoint(u.x,u.y-0.005);
var s=this.getPointSymbol(n);null!=s?(null!=b?(m.flat=!0,this.queryable&&(m.cursor="pointer")):m=this.queryable?{flat:!0,cursor:"pointer"}:{flat:!0},m=new TGOS.TGMarker(this.map,u,n.MARKNAME1,s,m)):m=new TGOS.TGMarker(this.map,u,n.MARKNAME1,null,m)}else u instanceof TGOS.TGMultiPolygon?(m=new TGOS.TGFill(this.map,u,b),m.setOpacity(0.5)):u instanceof TGOS.TGMultiLineString?(m=new TGOS.TGLine(this.map,u,b),m.setStrokeWeight(4)):u instanceof TGOS.TGMultiPoint&&(m=b,s=this.getPointSymbol(n),null!=s?(null!=
b?m.flat=!0:m={flat:!0},m=new TGOS.TGMarker(this.map,u,"",s,m)):m=new TGOS.TGMarker(this.map,u,"",null,m));p.symbol=m;null!=m&&null!=n&&(m.key=h,m.id=l,this.queryable&&TGOS.TGEvent.addListener(m,"click",a.showInfo))}d++}}}};this.remove=function(a,b,d){b=a+"_"+b;a=null;if(void 0!==this.mFeatures[b]){a=this.mFeatures[b];b=d.length;for(var h=0;h<b;h++){var k=d[h],l=a[k];void 0!==l&&(l.count-=1,0>=l.count&&(void 0!==l.symbol&&null!=l.symbol&&(l.symbol.setMap(null),l.symbol=null),delete a[k]))}}};this.setVisible=
function(a,b,d,h){b=a+"_"+b;a=null;if(void 0!==this.mFeatures[b]){a=this.mFeatures[b];b=d.length;for(var k=0;k<b;k++){var l=a[d[k]];void 0!==l&&(l.visible=h,void 0!==l.symbol&&null!=l.symbol&&l.symbol.setVisible(h))}}};this.showInfo=function(b){var d=b.target;if(void 0!==d){var g=a.mFeatures[d.key];if(void 0!==g&&(g=g[d.id],void 0!==g)){var h="",k=[];if(0<a.infoAttrFields.length)for(var l=a.infoAttrFields.length,p=0;p<l;p++){var m=a.infoAttrFields[p],n=null,u=null;"string"===typeof m||m instanceof
String?u=n=m:m instanceof Object&&(n=m.name,u=m.alias);null!=n&&null!=u&&(n=g.attr[n],void 0!==n&&(0<h.length&&(h+="<br />"),h=h+u+": "+n,k.push({field:u,value:n})))}else for(m in g.attr)n=g.attr[m],void 0!==n&&(0<h.length&&(h+="<br />"),h=h+m+": "+n,k.push({field:m,value:n}));a.graphicSelectedCallback?a.graphicSelectedCallback.call(d,{graphic:d,point:b.point,info:h,attr:k}):(null==a.messageBox&&(a.messageBox=new TGOS.TGInfoWindow(null,null,a.infoWindowOptions)),h='<font style="font-size:10pt;line-height:20px;">'+
h+"</font>",a.messageBox.setPosition(b.point),a.messageBox.setMessageText(h),a.messageBox.open(a.map))}}};this.hideInfo=function(){null!=a.messageBox&&(a.messageBox.setMessageText(""),a.messageBox.close())};this.setQueryable=function(b){this.queryable=b;for(var d in this.mFeatures){var g=this.mFeatures[d];if(void 0!==g)for(var h in g){var k=g[h];void 0!==k&&(k=k.symbol,void 0!==k&&(b?(TGOS.TGEvent.addListener(k,"click",a.showInfo),k.setCursor("pointer")):(void 0!==k.click_&&TGOS.TGEvent.removeListener(k.click_[0]),
k.setCursor("default"))))}}};this.getQueryable=function(){return this.queryable}};TGOS.TGVectorTilePoi=function(d,a){this.req=this.url=this.map=null;this.loaded=this.loading=!1;this.matrixSet=d.matrixSet;this.matrixId=d.matrixId;this.bound=d.bound;this.row=d.row;this.col=d.col;this.format=d.format;this.visible=!0;this.fid=[];this.equals=function(a){return this.matrixSet==a.matrixSet&&this.matrixId==a.matrixId&&this.row==a.row&&this.col==a.col};this.setVisible=function(b){this.visible=b;if(0<this.fid.length){var d=
this.matrixSet,g=this.matrixId;a.getAllFeatures().setVisible(d,g,this.fid,b)}};this.getVisible=function(){return this.visible};this.clear=function(){if(0<this.fid.length){var b=this.matrixSet,d=this.matrixId;a.getAllFeatures().remove(b,d,this.fid)}};this.simplifyLineString=function(a,b){var d=a;if(void 0!==a){var h=a;if(!(1>=h.length)){for(var d=void 0!==b?b*b:1,k=h[0],l=[k],p,m=1,n=h.length;m<n;m++){p=h[m];var u=p.x-k.x,s=p.y-k.y;u*u+s*s>d&&(l.push(p),k=p)}k!==p&&l.push(p);p=l;var h=p.length,k=new ("undefined"!==
typeof Uint8Array?Uint8Array:Array)(h),l=0,m=h-1,n=[],u=[],q,w,C;for(k[l]=k[m]=1;m;){q=0;for(s=l+1;s<m;s++){w=p[s];var B=p[l],H=p[m],A=B.x,B=B.y,I=H.x-A,G=H.y-B;if(0!==I||0!==G){var D=((w.x-A)*I+(w.y-B)*G)/(I*I+G*G);1<D?(A=H.x,B=H.y):0<D&&(A+=I*D,B+=G*D)}I=w.x-A;G=w.y-B;w=I*I+G*G;w>q&&(C=s,q=w)}q>d&&(k[C]=1,n.push(l,C,C,m));m=n.pop();l=n.pop()}for(s=0;s<h;s++)k[s]&&u.push(p[s]);h=u}d=h}return d};this.getJsonFeature=function(b,d){var g=function(a,b){var d=null;if(void 0!==a&&0<a.length){var d=[],e=
a.length,f=a[0];if(f instanceof Array)for(f=0;f<e;f++)d.push({x:a[f][0],y:a[f][1]});else if(void 0!==f.x&&void 0!==f.y)for(f=0;f<e;f++)d.push(a[f]);void 0!==b&&b.vt&&b.simTolenrance&&(d=b.vt.simplifyLineString(d,b.simTolenrance))}return d},h=function(a,b){var d=null,e=g(a,b);null!=e&&(d=new TGOS.TGLineString(e));return d},k=function(a,b){var d=null,e=g(a,b);if(null!=e){var f=e.length;if(2<f){var h=e[0],f=e[f-1];h.x==f.x&&h.y==f.y||e.push(h)}}null!=e&&(e=new TGOS.TGLineString(e),null!=e&&(d=new TGOS.TGLinearRing(e)));
return d},l=function(a,b){var d=null;if(void 0!==a&&0<a.length){var e=[],f=k(a[0],b);null!=f&&e.push(f);f=a.length;if(1<f)for(var g=1;g<f;g++){var h=k(a[g],b);null!=h&&e.push(h)}0<e.length&&(d=new TGOS.TGPolygon(e))}return d},p=function(a,b){var d=null,e=a.type;if(void 0!==e)if("GeometryCollection"==e){var f=a.geometries;if(0<f.length)for(var d=[],g=f.length,e=0;e<g;e++)d.push(p(f[e],b))}else if("MultiPolygon"==e){if(g=a.coordinates,0<g.length){for(var k=[],f=g.length,e=0;e<f;e++){var m=l(g[e],b);
null!=m&&k.push(m)}0<k.length&&(d=new TGOS.TGMultiPolygon(k))}}else if("MultiLineString"==e){if(f=a.coordinates,0<f.length){d=[];g=f.length;for(e=0;e<g;e++)d.push(h(f[e],b));d=new TGOS.TGMultiLineString(d)}}else if("MultiPoint"==e){if(g=a.coordinates,0<g.length){d=[];e=g[0];if(e instanceof Array)for(f=g.length,e=0;e<f;e++)d.push(new TGOS.TGPoint(g[e][0],g[e][1]));else if(void 0!==e.x&&void 0!==e.y)for(f=g.length,e=0;e<f;e++)d.push(new TGOS.TGPoint(g[e].x,g[e].y));d=new TGOS.TGMultiPoint(d)}}else"Polygon"==
e?(e=a.coordinates,d=l(e,b)):"LineString"==e?(e=a.coordinates,d=h(e,b)):"Point"==e&&(e=a.coordinates,e instanceof Array?d=new TGOS.TGPoint(e[0],e[1]):void 0!==e.x&&void 0!==e.y&&(d=new TGOS.TGPoint(e.x,e.y)));return d},m=function(a,b){var d=null;if(void 0!==a.type&&"Feature"==a.type){var e=a.FID,f=a.properties,g=a.geometry;void 0!==g&&(g=p(g,b),null!=g&&("EPSG3857"==n.coordSys&&(g=TGOS.Geometry.Transform(g,TGOS.GooToWGS84)),d={fid:e,attr:f,geom:g}))}return d},n=this;if(b&&(n.coordSys=this.map.getCoordSys(),
void 0!==b.type&&"FeatureCollection"==b.type)){var u=b.features,s=[];if(null!=u&&u instanceof Array)for(var q=u.length,w=0;w<q;w++){var C=u[w];null!=C&&(C=m(C,d),null!=C&&s.push(C))}if(0<s.length){for(var m=n.matrixSet,u=n.matrixId,q=a.getAllFeatures(),w=s.length,B=0;B<w;B++)C=s[B],C.mset=m,C.mid=u,q.add(C),n.fid.push(C.fid);q.draw()}s=[]}};this.getGmlFeature=function(d,e){var g=function(a,d){var e=null;if(null!=a&&0<a.length){for(var e=[],f=a[0].childNodes[0].nodeValue.split(b),g=0;g<f.length;g+=
2)e.push({x:parseFloat(f[g]),y:parseFloat(f[g+1])});void 0!==d&&d.vt&&d.simTolenrance&&2<e.length&&(e=d.vt.simplifyLineString(e,d.simTolenrance))}return e},h=function(a){var b=null;void 0!==a&&(a=g(a.getElementsByTagNameNS("http://www.opengis.net/gml","coordinates")),null!=a&&0<a.length&&(b=new TGOS.TGPoint(parseFloat(a[0].x),parseFloat(a[0].y))));return b},k=function(a,b){var d=null;if(void 0!==a){var e=g(a.getElementsByTagNameNS("http://www.opengis.net/gml","coordinates"),b);null!=e&&0<e.length&&
(d=new TGOS.TGLineString(e))}return d},l=function(a,b){var d=null,e=g(a.getElementsByTagNameNS("http://www.opengis.net/gml","coordinates"),void 0);if(null!=e){var f=e.length;if(2<f){var h=e[0],f=e[f-1];h.x==f.x&&h.y==f.y||e.push(h)}}null!=a&&(e=k(a,b),null!=e&&(d=new TGOS.TGLinearRing(e)));return d},p=function(a,b){var d=null;if(void 0!==a){var e=[],f=a.getElementsByTagNameNS("http://www.opengis.net/gml","outerBoundaryIs");if(null!=f&&0<f.length){var g=f[0].getElementsByTagNameNS("http://www.opengis.net/gml",
"LinearRing");null!=g&&0<g.length&&(g=l(g[0],b),null!=g&&e.push(g))}f=a.getElementsByTagNameNS("http://www.opengis.net/gml","innerBoundaryIs");if(null!=f&&0<f.length)for(var h=0;h<f.length;h++)g=f[h].getElementsByTagNameNS("http://www.opengis.net/gml","LinearRing"),null!=g&&0<g.length&&(g=l(g[0],b),null!=g&&e.push(g));0<e.length&&(d=new TGOS.TGPolygon(e))}return d},m=function(a,b){var d=null;if(void 0!==a){for(var e=a.getAttribute("FID"),f=a.getElementsByTagNameNS("http://www.supergeo.com.tw/gml",
"Fields"),g={},l=f.length,m=0;m<l;m++)g[f[m].attributes[0].value]=f[m].textContent;f=a.getElementsByTagNameNS("http://www.supergeo.com.tw/gml","_SHAPE_");if(void 0!==f){var t=f[0],d=null,f=t.getElementsByTagNameNS("http://www.opengis.net/gml","MultiPoint"),l=t.getElementsByTagNameNS("http://www.opengis.net/gml","MultiLineString"),m=t.getElementsByTagNameNS("http://www.opengis.net/gml","MultiPolygon"),v=t.getElementsByTagNameNS("http://www.opengis.net/gml","Point"),q=t.getElementsByTagNameNS("http://www.opengis.net/gml",
"LineString"),t=t.getElementsByTagNameNS("http://www.opengis.net/gml","Polygon");if(0<m.length){if(f=m[0].getElementsByTagNameNS("http://www.opengis.net/gml","Polygon"),0<f.length){l=[];for(d=0;d<f.length;d++)l.push(p(f[d],b));d=new TGOS.TGMultiPolygon(l)}}else if(0<l.length){if(f=l[0].getElementsByTagNameNS("http://www.opengis.net/gml","LineString"),0<f.length){l=[];for(d=0;d<f.length;d++)l.push(k(f[d],b));d=new TGOS.TGMultiLineString(l)}}else if(0<f.length){if(f=f[0].getElementsByTagNameNS("http://www.opengis.net/gml",
"Point"),0<f.length){l=[];for(d=0;d<f.length;d++)l.push(h(f[d]));d=new TGOS.TGMultiPoint(l)}}else 0<t.length?d=p(t[0],b):0<q.length?d=k(q[0],b):0<v.length&&(d=h(v[0]));"EPSG3857"==n.coordSys&&(d=TGOS.Geometry.Transform(d,TGOS.GooToWGS84));d={fid:e,attr:g,geom:d}}}return d},n=this;if(d&&d.documentElement&&(n.coordSys=this.map.getCoordSys(),void 0!==d.documentElement.getElementsByTagNameNS("http://www.opengis.net/gml","featureMember"))){var u=d.documentElement.getElementsByTagNameNS("http://www.supergeo.com.tw/gml",
"Feature"),s=[],q=u.length;if(null!=u&&0<q)for(var w=0;w<q;w++){var C=u[w];null!=C&&(C=m(C,e),null!=C&&s.push(C))}if(0<s.length){for(var m=n.matrixSet,u=n.matrixId,q=a.getAllFeatures(),w=s.length,B=0;B<w;B++)C=s[B],C.mset=m,C.mid=u,q.add(C),n.fid.push(C.fid);q.draw()}s=[]}}};TGOS.TGVectorTilePoiLayer=function(b,a,f,e,g){function h(){var a=Z(B,da);if(null!=a)for(var b=da["ows:Identifier"],a=a["ows:Identifier"],d=C.length-1;0<=d;d--){var e=C[d];if(e.matrixSet!=b||e.matrixId!=a)e.clear(),C.splice(d,
1)}}var k=a.getCoordSys(),l=a.getPanes().overlayviewLayer;e=void 0!==e?e:{};var p="boolean"==typeof e.independentContainer?e.independentContainer:!1,m,n="number"==typeof e.left?e.left:null,u="number"==typeof e.top?e.top:null,s="number"==typeof e.right?e.right:null,q="number"==typeof e.bottom?e.bottom:null,w=new TGOS.TGVectorPoiFeatures(a),C=[],B,H=!1,A=this,I=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/university.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),G=new TGOS.TGImage(TGOS.RES_PATH+
"point_icons/arts.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),D=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/gas.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),J=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/railway.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),K=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/resting.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),F=new TGOS.TGImage(TGOS.RES_PATH+
"point_icons/nursinghomes.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),t=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/temple.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),v=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/hotel.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),z=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/other.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),E=new TGOS.TGImage(TGOS.RES_PATH+
"point_icons/bus.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),L=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/gov.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),P=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/family.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),U=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/7-11.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),Y=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/hilife.png",
new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),M=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/OK.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),N=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/tpmetro.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),Q=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/khmetro.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),$=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/tymetro.png",
new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),T=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/thsrc.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),aa=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/p.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),O=new TGOS.TGSymbol;O.symbolStyle=TGOS.TGSymbolStyle.SQUARE;O.xPixel=6;O.yPixel=6;O.fillColor="#73B4FF";O.fillOpacity=0.8;O.strokeWeight=2;O.strokeOpacity=0.4;O.strokeColor="#BDD5FF";O.anchor.x=
3;O.anchor.y=3;O.rotation=0;var S=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/port.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),R=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/cemetery.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),ka=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/post.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),V=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/bank.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,
0),new TGOS.TGPoint(8,8)),ia=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/fa.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),na=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/school.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),la=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/airport.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,0),new TGOS.TGPoint(8,8)),W=new TGOS.TGImage(TGOS.RES_PATH+"point_icons/hospital.png",new TGOS.TGSize(16,16),new TGOS.TGPoint(0,
0),new TGOS.TGPoint(8,8)),I={field1:"MARKTYPE",field2:"MARKNAME1",symbols:{"99210H":I,"99210I":I,"99210J":I,99220:G,99221:G,99222:G,99223:G,99224:G,99225:G,99226:G,99411:G,99412:G,99413:G,99623:D,99611:J,99625:K,99310:F,99313:F,99314:F,93598:t,99712:t,99540:v,"99540A":v,"99540B":v,90330:z,93721:z,93725:z,93821:z,94200:z,94623:z,95124:z,95152:z,97421:z,99400:z,99410:z,99414:z,99416:z,99418:z,99419:z,99421:z,99422:z,99423:z,99424:z,99425:z,99426:z,99430:z,99431:z,99432:z,99441:z,99500:z,99510:z,99511:z,
99513:z,99523:z,99524:z,99810:z,99820:z,99840:z,99900:z,99904:z,99907:z,"99410A":z,"99410B":z,"99410C":z,"99410D":z,"99410E":z,"99410F":z,"99410G":z,"99410H":z,99612:E,99312:L,99514:[P,U,Y,M],"99613A":[N,Q,$],99613:O,99614:T,99624:aa,"99624A":aa,"99624B":aa,"99624C":aa,99640:S,99641:S,99642:S,99643:S,99521:ka,99300:R,99320:R,99330:R,99530:V,"99530A":ia,99215:na,"99210B":na,"99210D":na,"99210F":na,"99210K":na,"99210N":na,99630:la,99631:la,99311:W,99100:L,99111:L,99112:L,99113:L,99114:L,99115:L,99116:L,
99117:L,99118:L,99122:L,99123:L,99124:L,99125:L,99126:L,99130:L,99142:L,"99110A":L,"99110B":L,"99110C":L,"99110D":L,"99110E":L,"99110F":L,"99119A":L,"99119B":L,"99140C":L}};w.independentContainer=p;var D=G=null,ba="",ga="";"EPSG3826"==k?(G="X_97121",D="Y_97121",ba=getWebProtocal()+getAPIPath()+"TGOS_POI/TWD97/POI3826.aspx",ga="TGOS_POI.cfg"):"EPSG3825"==k?(G="X_97119",D="Y_97119",ba=getWebProtocal()+getAPIPath()+"TGOS_POI/TWD97/POI3825.aspx",ga="TGOS_POI_119.cfg"):"EPSG3857"==k&&(G="E",D="N",ba=getWebProtocal()+
getAPIPath()+"TGOS_POI/World/POI3857.aspx",ga="TGOS_POI_W.cfg");k=[{name:"MARKNAME1",alias:"\u5730\u6a19"},{name:"ADDRESS",alias:"\u5730\u5740"},{name:"TEL",alias:"\u96fb\u8a71"},{name:"COUNTYNAME",alias:"\u7e23\u5e02"},{name:"TOWNNAME",alias:"\u9109\u93ae"},{name:G,alias:"X"},{name:D,alias:"Y"}];w.infoAttrFields=void 0!==f.attrFields?f.attrFields:k;void 0!==e.infoWindowOptions&&(w.infoWindowOptions=e.infoWindowOptions);void 0!==e.queryable&&(w.queryable=e.queryable);if(void 0!==e.pointSymbol){for(key in e.pointSymbol.symbols)I.symbols[key]=
e.pointSymbol.symbols[key];w.pointSymbol=I;for(key in I.symbols)console.log(I.symbols[key])}else w.pointSymbol=I;if(void 0!==e.lineSymbol)for(key in e.lineSymbol.symbols);w.lineSymbol=null;if(void 0!==e.polygonSymbol)for(key in e.polygonSymbol.symbols);w.polygonSymbol=null;var ha="number"==typeof f.dpi?25.4/f.dpi/1E3:2.8E-4,Aa="string"==typeof f.style?f.style:"default",ya="string"==typeof f.format?f.format:"text/xml",xa="number"==typeof f.tileWidth?f.tileWidth:256,Da="number"==typeof f.tileHeight?
f.tileHeight:256,fa="string"==typeof f.layer?f.layer:"Map";null!=e.container&&(l=e.container);var oa="number"==typeof e.opacity?e.opacity:1;0>oa&&(oa=0);1<oa&&(oa=1);var ua=!1==e.visible?!1:!0,da=null,X=document.createElement("div");X.style.position="absolute";X.style.left="0px";X.style.top="0px";X.style.width="100%";X.style.height="100%";X.style.zIndex="auto";X.style.display=ua?"":"none";l.appendChild(X);var ja;this.moveToTop=function(){l&&(l.removeChild(X),l.appendChild(X))};this.getLayerId=function(){return b};
this.getMatrixSetId=function(){return da["ows:Identifier"]};this.getOpacity=function(){return oa};this.setOpacity=function(a){"number"==typeof a&&(oa=a,X&&(X.style.opacity=oa,X.style.filter="alpha(opacity="+100*oa+")"))};this.getSource=function(){return ba};this.RemoveSelf=function(){null!=w&&(w.hideInfo(),w.removeAll());l.removeChild(X)};this.getBoundTiles=function(b,d,e){if(!b||!d)return null;var f=parseFloat(d.MatrixWidth),g=parseFloat(d.MatrixHeight);mIdx=0==f?1:f-1;mIdy=0==g?1:g-1;var h=e.left,
k=e.top,l=e.right;e=e.bottom;var f=[],g=d.left,m=d.top,t=parseFloat(d.ScaleDenominator),n=parseFloat(d.TileWidth),n=t*n*ha,t=t*Da*ha,p;p=h<=g?0:Math.floor((h-g)/n);h=p+Math.ceil(Math.abs(h-l)/n)+1;l=k>=m?0:Math.floor((m-k)/n);for(k=l+Math.ceil(Math.abs(e-k)/n)+1;l<k;l++)for(var v=p;v<h;v++)e={left:g+v*n,top:m-l*t,right:g+(v+1)*n,bottom:m-(l+1)*t},e=new TGOS.TGVectorTilePoi({matrixId:d["ows:Identifier"],matrixSet:b,bound:e,col:v,row:l,format:ya},this),e.map=a,f.push(e);return f};var Z=function(a,b){for(var d=
0,e=Infinity,f=a.ToMapDistX(xa),g=0;g<b.TileMatrix.length;g++){var h=parseFloat(b.TileMatrix[g].ScaleDenominator)*xa*ha,h=Math.abs(h-f);h<e&&(e=h,d=g)}return 0.1<e/f&&parseFloat(b.TileMatrix[d].ScaleDenominator)*xa*ha<1.1*f?null:b.TileMatrix[d]};this.Initialize=function(a){B=a;m=ba=0<ba.indexOf("?")?ba.slice(0,ba.indexOf("?")):ba;TGOS.getJSON(ba+"?SERVICE=WMTS&REQUEST=GetCapabilities&VERSION=1.0.0&appid="+TGOS.APPID+"&apikey="+TGOS.APIKEY,function(a){ja=a.Capabilities;if(!ja)throw"Service Error";
a=ja;var b=a["ows:OperationsMetadata"];if(void 0!==b){var d,e=b["ows:Operation"];if(void 0!==e&&e instanceof Array)for(b=0;b<e.length;b++){var f=e[b];if(void 0!==f){var h=f["@name"];if(void 0!==h&&"GetTile"==h&&(f=f["ows:DCP"],void 0!==f&&(d=f["ows:HTTP"]["ows:Get"],void 0!==d)))break}}if(void 0!==d&&d instanceof Array)for(b=0;b<d.length;b++)if(e=d[b],void 0!==e&&(xlnk=e["@xlink:href"],void 0!==xlnk&&(e=e["ows:Constraint"]["ows:AllowedValues"]["ows:Value"],void 0!==e&&"KVP"==e))){m=0<xlnk.indexOf("?")?
xlnk.slice(0,xlnk.indexOf("?")):xlnk;break}}a=a.Contents.TileMatrixSet;if("undefined"!=typeof a.length)for(d=0;d<a.length;d++){if((b=a[d]["ows:Identifier"])&&b==ga){da=a[d];break}da=a[0]}else da=a;if(da)for(d=0;d<da.TileMatrix.length;d++){a=da.TileMatrix[d];var e=a.TopLeftCorner,b=parseFloat(e.split(" ")[0]),e=parseFloat(e.split(" ")[1]),f=parseFloat(a.ScaleDenominator),k=parseFloat(a.MatrixWidth),h=parseFloat(a.MatrixHeight),l=parseFloat(a.TileWidth),t=parseFloat(a.TileHeight),k=b+f*k*l*ha,f=e-f*
h*t*ha;b&&e&&k&&f&&(a.left=b,a.top=e,a.right=k,a.bottom=f)}H=!0;A.RebuildElement();g&&g.call(this)},TGOS.PROXY_SERVICE2)};this.getAllFeatures=function(){return w};this.putVisible=function(a){ua=a;X.style.display=a?"":"none"};this.getVisible=function(){return ua};this.setVisible=function(a){for(var b in w.mFeatures){var d=w.mFeatures[b];if(void 0!==d)for(var e in d){var f=d[e].symbol;void 0!==f&&f.setVisible(a)}}this.putVisible(a)};this.removeLayer=function(){a.removeLayer(this)};var Ba=function(a){var b=
a.url;if(void 0!=b&&null!=b&&!a.loaded&&!a.loading){a.loading=!0;var d;d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var b=d.responseText;a.loading=!1;a.loaded=!0;0<b.length&&"{}"!=b&&("application/json"==a.format?(b=JSON.parse(b),a.getJsonFeature(b)):a.getGmlFeature(TGOS.parseXML(b)))}};a.xhr=d;d.open("GET",a.url,!0);d.send()}},ma;this.UpdateElement=function(){if(H&&ua&&da){var b=Z(B,da);if(null!=
b){var d=da["ows:Identifier"],e=b["ows:Identifier"],f=B.ToMapPoint(0,0),g=B.ToMapPoint(B.getClientWidth(),B.getClientHeight()),k=new TGOS.TGEnvelope(f.x,f.y,g.x,g.y),f=k;null!==n&&f.left<n&&(f.left=n);null!==u&&f.top>u&&(f.top=u);null!==s&&f.right>s&&(f.right=s);null!==q&&f.bottom<q&&(f.bottom=q);k=f;for(f=0;f<C.length;f++)if(g=C[f],g.matrixSet==d&&g.matrixId==e){var l=g.bound;(l.left>k.right||l.right<k.left||l.bottom>k.top||l.top<k.bottom)&&g.setVisible(!1)}else g.setVisible(!1),g.xhr.abort();b=
this.getBoundTiles(d,b,k);if(!b)return null;for(f=0;f<b.length;f++){d=b[f];e=!1;for(k=0;k<C.length;k++)if(g=C[k],g.equals(d)){g.setVisible(!0);e=!0;break}e||(g=m+"?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&Layer="+fa+"&Style="+Aa+"&Format="+ya+"&TileMatrixSet="+d.matrixSet+"&TileMatrix="+d.matrixId+"&TileRow="+d.row+"&TileCol="+d.col+"&appid="+TGOS.APPID+"&apikey="+TGOS.APIKEY,d=new TGOS.TGVectorTilePoi({matrixId:d.matrixId,matrixSet:d.matrixSet,bound:d.bound,col:d.col,row:d.row,format:d.format},
this),d.map=a,d.url=g,C.push(d),Ba(d))}clearTimeout(ma);ma=setTimeout(h,250)}}};this.RebuildElement=function(){this.UpdateElement()};this.hideInfo=function(){w.hideInfo()};this.setClickCallback=function(a){w.setClickCallback(a)};this.setQueryable=function(a){w.setQueryable(a)};this.getQueryable=function(){return w.getQueryable()};this.getIndependentContainer=function(){return p};this.setIndependentContainer=function(a){p=a;w.independentContainer=p};this.getAdvancedContainer=function(){return w.getAdvancedContainer()};
this.getNode=function(){if(a){if(!0==p){var b=w.getAdvancedContainer();return null!=b?[b.div.main,b.div.shadow]:[a.getPanes().graphicLayer,a.getPanes().shadowLayer]}return[a.getPanes().graphicLayer,a.getPanes().shadowLayer]}};a.addLayer(this,!0)};TGOS.RegisterEvent(TGOS.TGVectorTilePoiLayer,"click mousemove mouseout mouseover dblclick rightclick".split(" "))})();(function(b,d){"object"===typeof module&&module.exports?module.exports=d(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains")):"function"===typeof define&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],d):b.URI=d(b.punycode,b.IPv6,b.SecondLevelDomains,b)})(this,function(b,d,a,f){function e(a,b){var d=1<=arguments.length,f=2<=arguments.length;if(!(this instanceof e))return d?f?new e(a,b):new e(a):new e;if(void 0===a){if(d)throw new TypeError("undefined is not a valid argument for URI");
a="undefined"!==typeof location?location.href+"":""}if(null===a&&d)throw new TypeError("null is not a valid argument for URI");this.href(a);return void 0!==b?this.absoluteTo(b):this}function g(a){return a.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function h(a){return void 0===a?"Undefined":String(Object.prototype.toString.call(a)).slice(8,-1)}function k(a){return"Array"===h(a)}function l(a,b){var d={},e,f;if("RegExp"===h(b))d=null;else if(k(b))for(e=0,f=b.length;e<f;e++)d[b[e]]=!0;else d[b]=!0;
e=0;for(f=a.length;e<f;e++)if(d&&void 0!==d[a[e]]||!d&&b.test(a[e]))a.splice(e,1),f--,e--;return a}function p(a,b){var d,e;if(k(b)){d=0;for(e=b.length;d<e;d++)if(!p(a,b[d]))return!1;return!0}var f=h(b);d=0;for(e=a.length;d<e;d++)if("RegExp"===f){if("string"===typeof a[d]&&a[d].match(b))return!0}else if(a[d]===b)return!0;return!1}function m(a,b){if(!k(a)||!k(b)||a.length!==b.length)return!1;a.sort();b.sort();for(var d=0,e=a.length;d<e;d++)if(a[d]!==b[d])return!1;return!0}function n(a){return a.replace(/^\/+|\/+$/g,
"")}function u(a){return escape(a)}function s(a){return encodeURIComponent(a).replace(/[!'()*]/g,u).replace(/\*/g,"%2A")}function q(a){return function(b,d){if(void 0===b)return this._parts[a]||"";this._parts[a]=b||null;this.build(!d);return this}}function w(a,b){return function(d,e){if(void 0===d)return this._parts[a]||"";null!==d&&(d+="",d.charAt(0)===b&&(d=d.substring(1)));this._parts[a]=d;this.build(!e);return this}}var C=f&&f.URI;e.version="1.18.8";var B=e.prototype,H=Object.prototype.hasOwnProperty;
e._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,duplicateQueryParameters:e.duplicateQueryParameters,escapeQuerySpace:e.escapeQuerySpace}};e.duplicateQueryParameters=!1;e.escapeQuerySpace=!0;e.protocol_expression=/^[a-z][a-z0-9.+-]*$/i;e.idn_expression=/[^a-z0-9\.-]/i;e.punycode_expression=/(xn--)/i;e.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;e.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;
e.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u2018\u2019]))/ig;e.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u201e\u2018\u2019]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g};e.defaultPorts={http:"80",https:"443",ftp:"21",
gopher:"70",ws:"80",wss:"443"};e.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/;e.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"};e.getDomAttribute=function(a){if(a&&a.nodeName){var b=a.nodeName.toLowerCase();return"input"===b&&"image"!==a.type?void 0:e.domAttributes[b]}};e.encode=s;e.decode=decodeURIComponent;e.iso8859=function(){e.encode=escape;
e.decode=unescape};e.unicode=function(){e.encode=s;e.decode=decodeURIComponent};e.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/ig,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/ig,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&",
"%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/ig,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}};e.encodeQuery=function(a,b){var d=e.encode(a+"");void 0===b&&(b=e.escapeQuerySpace);return b?d.replace(/%20/g,"+"):d};e.decodeQuery=function(a,b){a+="";void 0===
b&&(b=e.escapeQuerySpace);try{return e.decode(b?a.replace(/\+/g,"%20"):a)}catch(d){return a}};var A={encode:"encode",decode:"decode"},I,G=function(a,b){return function(d){try{return e[b](d+"").replace(e.characters[a][b].expression,function(d){return e.characters[a][b].map[d]})}catch(f){return d}}};for(I in A)e[I+"PathSegment"]=G("pathname",A[I]),e[I+"UrnPathSegment"]=G("urnpath",A[I]);A=function(a,b,d){return function(f){var g;g=d?function(a){return e[b](e[d](a))}:e[b];f=(f+"").split(a);for(var h=
0,k=f.length;h<k;h++)f[h]=g(f[h]);return f.join(a)}};e.decodePath=A("/","decodePathSegment");e.decodeUrnPath=A(":","decodeUrnPathSegment");e.recodePath=A("/","encodePathSegment","decode");e.recodeUrnPath=A(":","encodeUrnPathSegment","decode");e.encodeReserved=G("reserved","encode");e.parse=function(a,b){var d;b||(b={});d=a.indexOf("#");-1<d&&(b.fragment=a.substring(d+1)||null,a=a.substring(0,d));d=a.indexOf("?");-1<d&&(b.query=a.substring(d+1)||null,a=a.substring(0,d));"//"===a.substring(0,2)?(b.protocol=
null,a=a.substring(2),a=e.parseAuthority(a,b)):(d=a.indexOf(":"),-1<d&&(b.protocol=a.substring(0,d)||null,b.protocol&&!b.protocol.match(e.protocol_expression)?b.protocol=void 0:"//"===a.substring(d+1,d+3)?(a=a.substring(d+3),a=e.parseAuthority(a,b)):(a=a.substring(d+1),b.urn=!0)));b.path=a;return b};e.parseHost=function(a,b){a=a.replace(/\\/g,"/");var d=a.indexOf("/"),e;-1===d&&(d=a.length);if("["===a.charAt(0))e=a.indexOf("]"),b.hostname=a.substring(1,e)||null,b.port=a.substring(e+2,d)||null,"/"===
b.port&&(b.port=null);else{var f=a.indexOf(":");e=a.indexOf("/");f=a.indexOf(":",f+1);-1!==f&&(-1===e||f<e)?(b.hostname=a.substring(0,d)||null,b.port=null):(e=a.substring(0,d).split(":"),b.hostname=e[0]||null,b.port=e[1]||null)}b.hostname&&"/"!==a.substring(d).charAt(0)&&(d++,a="/"+a);return a.substring(d)||"/"};e.parseAuthority=function(a,b){a=e.parseUserinfo(a,b);return e.parseHost(a,b)};e.parseUserinfo=function(a,b){var d=a.indexOf("/"),f=a.lastIndexOf("@",-1<d?d:a.length-1);-1<f&&(-1===d||f<d)?
(d=a.substring(0,f).split(":"),b.username=d[0]?e.decode(d[0]):null,d.shift(),b.password=d[0]?e.decode(d.join(":")):null,a=a.substring(f+1)):(b.username=null,b.password=null);return a};e.parseQuery=function(a,b){if(!a)return{};a=a.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"");if(!a)return{};for(var d={},f=a.split("&"),g=f.length,h,k,l=0;l<g;l++)if(h=f[l].split("="),k=e.decodeQuery(h.shift(),b),h=h.length?e.decodeQuery(h.join("="),b):null,H.call(d,k)){if("string"===typeof d[k]||null===d[k])d[k]=[d[k]];
d[k].push(h)}else d[k]=h;return d};e.build=function(a){var b="";a.protocol&&(b+=a.protocol+":");a.urn||!b&&!a.hostname||(b+="//");b+=e.buildAuthority(a)||"";"string"===typeof a.path&&("/"!==a.path.charAt(0)&&"string"===typeof a.hostname&&(b+="/"),b+=a.path);"string"===typeof a.query&&a.query&&(b+="?"+a.query);"string"===typeof a.fragment&&a.fragment&&(b+="#"+a.fragment);return b};e.buildHost=function(a){var b="";if(a.hostname)b=e.ip6_expression.test(a.hostname)?b+("["+a.hostname+"]"):b+a.hostname;
else return"";a.port&&(b+=":"+a.port);return b};e.buildAuthority=function(a){return e.buildUserinfo(a)+e.buildHost(a)};e.buildUserinfo=function(a){var b="";a.username&&(b+=e.encode(a.username));a.password&&(b+=":"+e.encode(a.password));b&&(b+="@");return b};e.buildQuery=function(a,b,d){var f="",g,h,l,m;for(h in a)if(H.call(a,h)&&h)if(k(a[h]))for(g={},l=0,m=a[h].length;l<m;l++)void 0!==a[h][l]&&void 0===g[a[h][l]+""]&&(f+="&"+e.buildQueryParameter(h,a[h][l],d),!0!==b&&(g[a[h][l]+""]=!0));else void 0!==
a[h]&&(f+="&"+e.buildQueryParameter(h,a[h],d));return f.substring(1)};e.buildQueryParameter=function(a,b,d){return e.encodeQuery(a,d)+(null!==b?"="+e.encodeQuery(b,d):"")};e.addQuery=function(a,b,d){if("object"===typeof b)for(var f in b)H.call(b,f)&&e.addQuery(a,f,b[f]);else if("string"===typeof b)void 0===a[b]?a[b]=d:("string"===typeof a[b]&&(a[b]=[a[b]]),k(d)||(d=[d]),a[b]=(a[b]||[]).concat(d));else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");};e.removeQuery=
function(a,b,d){var f;if(k(b))for(d=0,f=b.length;d<f;d++)a[b[d]]=void 0;else if("RegExp"===h(b))for(f in a)b.test(f)&&(a[f]=void 0);else if("object"===typeof b)for(f in b)H.call(b,f)&&e.removeQuery(a,f,b[f]);else if("string"===typeof b)void 0!==d?"RegExp"===h(d)?!k(a[b])&&d.test(a[b])?a[b]=void 0:a[b]=l(a[b],d):a[b]!==String(d)||k(d)&&1!==d.length?k(a[b])&&(a[b]=l(a[b],d)):a[b]=void 0:a[b]=void 0;else throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");
};e.hasQuery=function(a,b,d,f){switch(h(b)){case "String":break;case "RegExp":for(var g in a)if(H.call(a,g)&&b.test(g)&&(void 0===d||e.hasQuery(a,g,d)))return!0;return!1;case "Object":for(var l in b)if(H.call(b,l)&&!e.hasQuery(a,l,b[l]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter");}switch(h(d)){case "Undefined":return b in a;case "Boolean":return a=Boolean(k(a[b])?a[b].length:a[b]),d===a;case "Function":return!!d(a[b],
b,a);case "Array":return k(a[b])?(f?p:m)(a[b],d):!1;case "RegExp":return k(a[b])?f?p(a[b],d):!1:Boolean(a[b]&&a[b].match(d));case "Number":d=String(d);case "String":return k(a[b])?f?p(a[b],d):!1:a[b]===d;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter");}};e.joinPaths=function(){for(var a=[],b=[],d=0,f=0;f<arguments.length;f++){var g=new e(arguments[f]);a.push(g);for(var g=g.segment(),h=0;h<g.length;h++)"string"===typeof g[h]&&
b.push(g[h]),g[h]&&d++}if(!b.length||!d)return new e("");b=(new e("")).segment(b);""!==a[0].path()&&"/"!==a[0].path().slice(0,1)||b.path("/"+b.path());return b.normalize()};e.commonPath=function(a,b){var d=Math.min(a.length,b.length),e;for(e=0;e<d;e++)if(a.charAt(e)!==b.charAt(e)){e--;break}if(1>e)return a.charAt(0)===b.charAt(0)&&"/"===a.charAt(0)?"/":"";if("/"!==a.charAt(e)||"/"!==b.charAt(e))e=a.substring(0,e).lastIndexOf("/");return a.substring(0,e+1)};e.withinString=function(a,b,d){d||(d={});
var f=d.start||e.findUri.start,g=d.end||e.findUri.end,h=d.trim||e.findUri.trim,k=d.parens||e.findUri.parens,l=/[a-z0-9-]=["']?$/i;for(f.lastIndex=0;;){var m=f.exec(a);if(!m)break;var n=m.index;if(d.ignoreHtml){var p=a.slice(Math.max(n-3,0),n);if(p&&l.test(p))continue}for(var q=n+a.slice(n).search(g),p=a.slice(n,q),q=-1;;){var s=k.exec(p);if(!s)break;q=Math.max(q,s.index+s[0].length)}p=-1<q?p.slice(0,q)+p.slice(q).replace(h,""):p.replace(h,"");p.length<=m[0].length||d.ignore&&d.ignore.test(p)||(q=
n+p.length,m=b(p,n,q,a),void 0===m?f.lastIndex=q:(m=String(m),a=a.slice(0,n)+m+a.slice(q),f.lastIndex=n+m.length))}f.lastIndex=0;return a};e.ensureValidHostname=function(a){if(a.match(e.invalid_hostname_characters)){if(!b)throw new TypeError('Hostname "'+a+'" contains characters other than [A-Z0-9.-] and Punycode.js is not available');if(b.toASCII(a).match(e.invalid_hostname_characters))throw new TypeError('Hostname "'+a+'" contains characters other than [A-Z0-9.-]');}};e.noConflict=function(a){if(a)return a=
{URI:this.noConflict()},f.URITemplate&&"function"===typeof f.URITemplate.noConflict&&(a.URITemplate=f.URITemplate.noConflict()),f.IPv6&&"function"===typeof f.IPv6.noConflict&&(a.IPv6=f.IPv6.noConflict()),f.SecondLevelDomains&&"function"===typeof f.SecondLevelDomains.noConflict&&(a.SecondLevelDomains=f.SecondLevelDomains.noConflict()),a;f.URI===this&&(f.URI=C);return this};B.build=function(a){if(!0===a)this._deferred_build=!0;else if(void 0===a||this._deferred_build)this._string=e.build(this._parts),
this._deferred_build=!1;return this};B.clone=function(){return new e(this)};B.valueOf=B.toString=function(){return this.build(!1)._string};B.protocol=q("protocol");B.username=q("username");B.password=q("password");B.hostname=q("hostname");B.port=q("port");B.query=w("query","?");B.fragment=w("fragment","#");B.search=function(a,b){var d=this.query(a,b);return"string"===typeof d&&d.length?"?"+d:d};B.hash=function(a,b){var d=this.fragment(a,b);return"string"===typeof d&&d.length?"#"+d:d};B.pathname=function(a,
b){if(void 0===a||!0===a){var d=this._parts.path||(this._parts.hostname?"/":"");return a?(this._parts.urn?e.decodeUrnPath:e.decodePath)(d):d}this._parts.path=this._parts.urn?a?e.recodeUrnPath(a):"":a?e.recodePath(a):"/";this.build(!b);return this};B.path=B.pathname;B.href=function(a,b){var d;if(void 0===a)return this.toString();this._string="";this._parts=e._parts();var f=a instanceof e,g="object"===typeof a&&(a.hostname||a.path||a.pathname);a.nodeName&&(g=e.getDomAttribute(a),a=a[g]||"",g=!1);!f&&
g&&void 0!==a.pathname&&(a=a.toString());if("string"===typeof a||a instanceof String)this._parts=e.parse(String(a),this._parts);else if(f||g)for(d in f=f?a._parts:a,f)H.call(this._parts,d)&&(this._parts[d]=f[d]);else throw new TypeError("invalid input");this.build(!b);return this};B.is=function(b){var d=!1,f=!1,g=!1,h=!1,k=!1,l=!1,m=!1,n=!this._parts.urn;this._parts.hostname&&(n=!1,f=e.ip4_expression.test(this._parts.hostname),g=e.ip6_expression.test(this._parts.hostname),d=f||g,k=(h=!d)&&a&&a.has(this._parts.hostname),
l=h&&e.idn_expression.test(this._parts.hostname),m=h&&e.punycode_expression.test(this._parts.hostname));switch(b.toLowerCase()){case "relative":return n;case "absolute":return!n;case "domain":case "name":return h;case "sld":return k;case "ip":return d;case "ip4":case "ipv4":case "inet4":return f;case "ip6":case "ipv6":case "inet6":return g;case "idn":return l;case "url":return!this._parts.urn;case "urn":return!!this._parts.urn;case "punycode":return m}return null};var D=B.protocol,J=B.port,K=B.hostname;
B.protocol=function(a,b){if(void 0!==a&&a&&(a=a.replace(/:(\/\/)?$/,""),!a.match(e.protocol_expression)))throw new TypeError('Protocol "'+a+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return D.call(this,a,b)};B.scheme=B.protocol;B.port=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0!==a&&(0===a&&(a=null),a&&(a+="",":"===a.charAt(0)&&(a=a.substring(1)),a.match(/[^0-9]/))))throw new TypeError('Port "'+a+'" contains characters other than [0-9]');
return J.call(this,a,b)};B.hostname=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0!==a){var d={};if("/"!==e.parseHost(a,d))throw new TypeError('Hostname "'+a+'" contains characters other than [A-Z0-9.-]');a=d.hostname}return K.call(this,a,b)};B.origin=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0===a){var d=this.protocol();return this.authority()?(d?d+"://":"")+this.authority():""}d=e(a);this.protocol(d.protocol()).authority(d.authority()).build(!b);return this};
B.host=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0===a)return this._parts.hostname?e.buildHost(this._parts):"";if("/"!==e.parseHost(a,this._parts))throw new TypeError('Hostname "'+a+'" contains characters other than [A-Z0-9.-]');this.build(!b);return this};B.authority=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0===a)return this._parts.hostname?e.buildAuthority(this._parts):"";if("/"!==e.parseAuthority(a,this._parts))throw new TypeError('Hostname "'+
a+'" contains characters other than [A-Z0-9.-]');this.build(!b);return this};B.userinfo=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0===a){var d=e.buildUserinfo(this._parts);return d?d.substring(0,d.length-1):d}"@"!==a[a.length-1]&&(a+="@");e.parseUserinfo(a,this._parts);this.build(!b);return this};B.resource=function(a,b){var d;if(void 0===a)return this.path()+this.search()+this.hash();d=e.parse(a);this._parts.path=d.path;this._parts.query=d.query;this._parts.fragment=d.fragment;
this.build(!b);return this};B.subdomain=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0===a){if(!this._parts.hostname||this.is("IP"))return"";var d=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,d)||""}d=this._parts.hostname.length-this.domain().length;d=this._parts.hostname.substring(0,d);d=RegExp("^"+g(d));a&&"."!==a.charAt(a.length-1)&&(a+=".");a&&e.ensureValidHostname(a);this._parts.hostname=this._parts.hostname.replace(d,a);this.build(!b);
return this};B.domain=function(a,b){if(this._parts.urn)return void 0===a?"":this;"boolean"===typeof a&&(b=a,a=void 0);if(void 0===a){if(!this._parts.hostname||this.is("IP"))return"";var d=this._parts.hostname.match(/\./g);if(d&&2>d.length)return this._parts.hostname;d=this._parts.hostname.length-this.tld(b).length-1;d=this._parts.hostname.lastIndexOf(".",d-1)+1;return this._parts.hostname.substring(d)||""}if(!a)throw new TypeError("cannot set domain empty");e.ensureValidHostname(a);!this._parts.hostname||
this.is("IP")?this._parts.hostname=a:(d=RegExp(g(this.domain())+"$"),this._parts.hostname=this._parts.hostname.replace(d,a));this.build(!b);return this};B.tld=function(b,d){if(this._parts.urn)return void 0===b?"":this;"boolean"===typeof b&&(d=b,b=void 0);if(void 0===b){if(!this._parts.hostname||this.is("IP"))return"";var e=this._parts.hostname.lastIndexOf("."),e=this._parts.hostname.substring(e+1);return!0!==d&&a&&a.list[e.toLowerCase()]?a.get(this._parts.hostname)||e:e}if(b)if(b.match(/[^a-zA-Z0-9-]/))if(a&&
a.is(b))e=RegExp(g(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(e,b);else throw new TypeError('TLD "'+b+'" contains characters other than [A-Z0-9]');else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");e=RegExp(g(this.tld())+"$");this._parts.hostname=this._parts.hostname.replace(e,b)}else throw new TypeError("cannot set TLD empty");this.build(!d);return this};B.directory=function(a,b){if(this._parts.urn)return void 0===a?
"":this;if(void 0===a||!0===a){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var d=this._parts.path.length-this.filename().length-1,d=this._parts.path.substring(0,d)||(this._parts.hostname?"/":"");return a?e.decodePath(d):d}d=this._parts.path.length-this.filename().length;d=this._parts.path.substring(0,d);d=RegExp("^"+g(d));this.is("relative")||(a||(a="/"),"/"!==a.charAt(0)&&(a="/"+a));a&&"/"!==a.charAt(a.length-1)&&(a+="/");a=e.recodePath(a);this._parts.path=
this._parts.path.replace(d,a);this.build(!b);return this};B.filename=function(a,b){if(this._parts.urn)return void 0===a?"":this;if("string"!==typeof a){if(!this._parts.path||"/"===this._parts.path)return"";var d=this._parts.path.lastIndexOf("/"),d=this._parts.path.substring(d+1);return a?e.decodePathSegment(d):d}d=!1;"/"===a.charAt(0)&&(a=a.substring(1));a.match(/\.?\//)&&(d=!0);var f=RegExp(g(this.filename())+"$");a=e.recodePath(a);this._parts.path=this._parts.path.replace(f,a);d?this.normalizePath(b):
this.build(!b);return this};B.suffix=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0===a||!0===a){if(!this._parts.path||"/"===this._parts.path)return"";var d=this.filename(),f=d.lastIndexOf(".");if(-1===f)return"";d=d.substring(f+1);d=/^[a-z0-9%]+$/i.test(d)?d:"";return a?e.decodePathSegment(d):d}"."===a.charAt(0)&&(a=a.substring(1));if(d=this.suffix())f=a?RegExp(g(d)+"$"):RegExp(g("."+d)+"$");else{if(!a)return this;this._parts.path+="."+e.recodePath(a)}f&&(a=e.recodePath(a),
this._parts.path=this._parts.path.replace(f,a));this.build(!b);return this};B.segment=function(a,b,d){var e=this._parts.urn?":":"/",f=this.path(),g="/"===f.substring(0,1),f=f.split(e);void 0!==a&&"number"!==typeof a&&(d=b,b=a,a=void 0);if(void 0!==a&&"number"!==typeof a)throw Error('Bad segment "'+a+'", must be 0-based integer');g&&f.shift();0>a&&(a=Math.max(f.length+a,0));if(void 0===b)return void 0===a?f:f[a];if(null===a||void 0===f[a])if(k(b)){f=[];a=0;for(var h=b.length;a<h;a++)if(b[a].length||
f.length&&f[f.length-1].length)f.length&&!f[f.length-1].length&&f.pop(),f.push(n(b[a]))}else{if(b||"string"===typeof b)b=n(b),""===f[f.length-1]?f[f.length-1]=b:f.push(b)}else b?f[a]=n(b):f.splice(a,1);g&&f.unshift("");return this.path(f.join(e),d)};B.segmentCoded=function(a,b,d){var f,g;"number"!==typeof a&&(d=b,b=a,a=void 0);if(void 0===b){a=this.segment(a,b,d);if(k(a))for(f=0,g=a.length;f<g;f++)a[f]=e.decode(a[f]);else a=void 0!==a?e.decode(a):void 0;return a}if(k(b))for(f=0,g=b.length;f<g;f++)b[f]=
e.encode(b[f]);else b="string"===typeof b||b instanceof String?e.encode(b):b;return this.segment(a,b,d)};var F=B.query;B.query=function(a,b){if(!0===a)return e.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"===typeof a){var d=e.parseQuery(this._parts.query,this._parts.escapeQuerySpace),f=a.call(this,d);this._parts.query=e.buildQuery(f||d,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);this.build(!b);return this}return void 0!==a&&"string"!==typeof a?(this._parts.query=
e.buildQuery(a,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!b),this):F.call(this,a,b)};B.setQuery=function(a,b,d){var f=e.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"===typeof a||a instanceof String)f[a]=void 0!==b?b:null;else if("object"===typeof a)for(var g in a)H.call(a,g)&&(f[g]=a[g]);else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");this._parts.query=e.buildQuery(f,this._parts.duplicateQueryParameters,
this._parts.escapeQuerySpace);"string"!==typeof a&&(d=b);this.build(!d);return this};B.addQuery=function(a,b,d){var f=e.parseQuery(this._parts.query,this._parts.escapeQuerySpace);e.addQuery(f,a,void 0===b?null:b);this._parts.query=e.buildQuery(f,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);"string"!==typeof a&&(d=b);this.build(!d);return this};B.removeQuery=function(a,b,d){var f=e.parseQuery(this._parts.query,this._parts.escapeQuerySpace);e.removeQuery(f,a,b);this._parts.query=
e.buildQuery(f,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);"string"!==typeof a&&(d=b);this.build(!d);return this};B.hasQuery=function(a,b,d){var f=e.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return e.hasQuery(f,a,b,d)};B.setSearch=B.setQuery;B.addSearch=B.addQuery;B.removeSearch=B.removeQuery;B.hasSearch=B.hasQuery;B.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()};
B.normalizeProtocol=function(a){"string"===typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!a));return this};B.normalizeHostname=function(a){this._parts.hostname&&(this.is("IDN")&&b?this._parts.hostname=b.toASCII(this._parts.hostname):this.is("IPv6")&&d&&(this._parts.hostname=d.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!a));return this};B.normalizePort=function(a){"string"===typeof this._parts.protocol&&
this._parts.port===e.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!a));return this};B.normalizePath=function(a){var b=this._parts.path;if(!b)return this;if(this._parts.urn)return this._parts.path=e.recodeUrnPath(this._parts.path),this.build(!a),this;if("/"===this._parts.path)return this;var b=e.recodePath(b),d,f="",g,h;"/"!==b.charAt(0)&&(d=!0,b="/"+b);if("/.."===b.slice(-3)||"/."===b.slice(-2))b+="/";b=b.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/");d&&(f=b.substring(1).match(/^(\.\.\/)+/)||
"")&&(f=f[0]);for(;;){g=b.search(/\/\.\.(\/|$)/);if(-1===g)break;else if(0===g){b=b.substring(3);continue}h=b.substring(0,g).lastIndexOf("/");-1===h&&(h=g);b=b.substring(0,h)+b.substring(g+3)}d&&this.is("relative")&&(b=f+b.substring(1));this._parts.path=b;this.build(!a);return this};B.normalizePathname=B.normalizePath;B.normalizeQuery=function(a){"string"===typeof this._parts.query&&(this._parts.query.length?this.query(e.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=
null,this.build(!a));return this};B.normalizeFragment=function(a){this._parts.fragment||(this._parts.fragment=null,this.build(!a));return this};B.normalizeSearch=B.normalizeQuery;B.normalizeHash=B.normalizeFragment;B.iso8859=function(){var a=e.encode,b=e.decode;e.encode=escape;e.decode=decodeURIComponent;try{this.normalize()}finally{e.encode=a,e.decode=b}return this};B.unicode=function(){var a=e.encode,b=e.decode;e.encode=s;e.decode=unescape;try{this.normalize()}finally{e.encode=a,e.decode=b}return this};
B.readable=function(){var a=this.clone();a.username("").password("").normalize();var d="";a._parts.protocol&&(d+=a._parts.protocol+"://");a._parts.hostname&&(a.is("punycode")&&b?(d+=b.toUnicode(a._parts.hostname),a._parts.port&&(d+=":"+a._parts.port)):d+=a.host());a._parts.hostname&&a._parts.path&&"/"!==a._parts.path.charAt(0)&&(d+="/");d+=a.path(!0);if(a._parts.query){for(var f="",g=0,h=a._parts.query.split("&"),k=h.length;g<k;g++){var l=(h[g]||"").split("="),f=f+("&"+e.decodeQuery(l[0],this._parts.escapeQuerySpace).replace(/&/g,
"%26"));void 0!==l[1]&&(f+="="+e.decodeQuery(l[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}d+="?"+f.substring(1)}return d+=e.decodeQuery(a.hash(),!0)};B.absoluteTo=function(a){var b=this.clone(),d=["protocol","username","password","hostname","port"],f,g;if(this._parts.urn)throw Error("URNs do not have any generally defined hierarchical components");a instanceof e||(a=new e(a));if(b._parts.protocol)return b;b._parts.protocol=a._parts.protocol;if(this._parts.hostname)return b;for(f=0;g=d[f];f++)b._parts[g]=
a._parts[g];b._parts.path?(".."===b._parts.path.substring(-2)&&(b._parts.path+="/"),"/"!==b.path().charAt(0)&&(d=(d=a.directory())?d:0===a.path().indexOf("/")?"/":"",b._parts.path=(d?d+"/":"")+b._parts.path,b.normalizePath())):(b._parts.path=a._parts.path,b._parts.query||(b._parts.query=a._parts.query));b.build();return b};B.relativeTo=function(a){var b=this.clone().normalize(),d,f,g;if(b._parts.urn)throw Error("URNs do not have any generally defined hierarchical components");a=(new e(a)).normalize();
d=b._parts;f=a._parts;g=b.path();a=a.path();if("/"!==g.charAt(0))throw Error("URI is already relative");if("/"!==a.charAt(0))throw Error("Cannot calculate a URI relative to another relative URI");d.protocol===f.protocol&&(d.protocol=null);if(d.username===f.username&&d.password===f.password&&null===d.protocol&&null===d.username&&null===d.password&&d.hostname===f.hostname&&d.port===f.port)d.hostname=null,d.port=null;else return b.build();if(g===a)return d.path="",b.build();g=e.commonPath(g,a);if(!g)return b.build();
f=f.path.substring(g.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");d.path=f+d.path.substring(g.length)||"./";return b.build()};B.equals=function(a){var b=this.clone();a=new e(a);var d={},f={},g={},h;b.normalize();a.normalize();if(b.toString()===a.toString())return!0;d=b.query();f=a.query();b.query("");a.query("");if(b.toString()!==a.toString()||d.length!==f.length)return!1;d=e.parseQuery(d,this._parts.escapeQuerySpace);f=e.parseQuery(f,this._parts.escapeQuerySpace);for(h in d)if(H.call(d,
h)){if(!k(d[h])){if(d[h]!==f[h])return!1}else if(!m(d[h],f[h]))return!1;g[h]=!0}for(h in f)if(H.call(f,h)&&!g[h])return!1;return!0};B.duplicateQueryParameters=function(a){this._parts.duplicateQueryParameters=!!a;return this};B.escapeQuerySpace=function(a){this._parts.escapeQuerySpace=!!a;return this};return e});var deps,util=util||{};util.getInternetExplorerVersion=function(){var b=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(b=parseFloat(RegExp.$1));return b};util.loadScripts=function(b,d,a){for(d=0;d<b.length;d++)document.write("<script src='"+a+b[d]+"'>\x3c/script>");document.write("<script>TGOS.APPID = 'BHvpiOJ5Wp41CsxemFMNWQ==';TGOS.APIKEY = 'mcXodoZFWJaUJRFS5H3gCec83a570/QupBX5ROqlSmu9vZW61YOYMe86Om9zQ2g2pVSGtjfLi5gex++mKHMFNK95UFUwZD3TtpSdH73WhL5KMv0WZVPMe5rB4KiLpaRrReusEFx+W10=';\x3c/script>")};
TGOS_LOADED=1;var DEBUG_MODE=!1;

TGOS.ThemeLayerID.DIPSLOPE_P="M01";TGOS.ThemeLayerID.LANDSLIDE_P="M02";TGOS.ThemeLayerID.FAULT="M03";TGOS.ThemeLayerID.HAZARD_LAND_P="M09";TGOS.ThemeLayerID.HAZARD_FLOOD_P="M10";TGOS.ThemeLayerID.SOIL_LIQUE="T05";TGOS.TGMapServiceId.DIPSLOPE_P="DIPSLOPE_P";TGOS.TGMapServiceId.LANDSLIDE_P="LANDSLIDE_P";TGOS.TGMapServiceId.FAULT="FAULT";TGOS.TGMapServiceId.HAZARD_LAND_P="HAZARD_LAND_P";TGOS.TGMapServiceId.HAZARD_FLOOD_P="HAZARD_FLOOD_P";TGOS.TGMapServiceId.SOIL_LIQUE="SOIL_LIQUE";
TGOS.TGMapId.DIPSLOPE_P="DIPSLOPE_P";TGOS.TGMapId.LANDSLIDE_P="LANDSLIDE_P";TGOS.TGMapId.FAULT="FAULT";TGOS.TGMapId.RAINFALLSTATION="RAINFALLSTATION";TGOS.TGMapId.SETTLEMENT="SETTLEMENT";TGOS.TGMapId.AGED="AGED";TGOS.TGMapId.DISABLED="DISABLED";TGOS.TGMapId.MONITOR_ROAD="MONITOR_ROAD";TGOS.TGMapId.MONITOR_BRIDGE="MONITOR_BRIDGE";TGOS.TGMapId.DEBRIS="DEBRIS";TGOS.TGMapId.DEBRISSTREAM="DEBRISSTREAM";TGOS.TGMapId.LANDSLIDE="LANDSLIDE";TGOS.TGMapId.DIPSLOPE="DIPSLOPE";TGOS.TGMapId.GAUGINGSTATION="GAUGINGSTATION";
TGOS.TGMapId["06HR150"]="06HR150";TGOS.TGMapId["06HR250"]="06HR250";TGOS.TGMapId["06HR350"]="06HR350";TGOS.TGMapId["12HR200"]="12HR200";TGOS.TGMapId["12HR300"]="12HR300";TGOS.TGMapId["12HR400"]="12HR400";TGOS.TGMapId["24HR200"]="24HR200";TGOS.TGMapId["24HR350"]="24HR350";TGOS.TGMapId["24HR500"]="24HR500";TGOS.TGMapId["24HR650"]="24HR650";
TGOS.MapIdInfo.DIPSLOPE_P={path:getWebProtocal()+getServicePath()+"DIPSLOPE_P/Agent.aspx",resource:"DIPSLOPE_P.cfg",layers:{DIPSLOPE_P:{name:"dbo.DIPSLOPE_P",oname:"dbo.DIPSLOPE_P_201304A",identify:{DATA_ID:"DATA_ID"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/12_DIPSLOPE_P.png",symbolName:"\u9806\u5411\u5761\u5206\u5e03\u5716"}]}}};
TGOS.MapIdInfo.LANDSLIDE_P={path:getWebProtocal()+getServicePath()+"LANDSLIDE_P/Agent.aspx",resource:"LANDSLIDE_P.cfg",layers:{LANDSLIDE_P:{name:"dbo.LANDSLIDE_P",oname:"dbo.LANDSLIDE_P_201304A",identify:{DATA_ID:"DATA_ID",SLIDE_KIND:"SLIDE_KIND"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/13_LANDSLIDE_P_A.png",symbolName:"\u5c71\u5d29\u2500\u843d\u77f3"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/13_LANDSLIDE_P_B.png",symbolName:"\u5c71\u5d29\u2500\u5ca9\u5c51\u5d29\u6ed1"},
{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/13_LANDSLIDE_P_C.png",symbolName:"\u5c71\u5d29\u2500\u5ca9\u9ad4\u6ed1\u52d5"}]}}};TGOS.MapIdInfo.FAULT={path:getWebProtocal()+getServicePath()+"FAULT/Agent.aspx",resource:"FAULT.cfg",layers:{FAULT:{name:"dbo.FAULT",oname:"dbo.FAULT_201304A",identify:{FAULT_NO_3:"FAULT_NO_3",FAULT_NAME:"FAULT_NAME",FAULT_TYPE:"FAULT_TYPE",PATTERNTYP:"PATTERNTYP"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/14_FAULT.png",symbolName:"\u6d3b\u52d5\u65b7\u5c64\u5716"}]}}};
TGOS.MapIdInfo.HAZARD_LAND_P={path:getWebProtocal()+getServicePath()+"HAZARD_LAND_P/Agent.aspx",resource:"HAZARD_LAND_P.cfg",layers:{RAINFALLSTATION:{name:"dbo.RAINFALLSTATION",oname:"dbo.RAINFALLSTATION_201208A",identify:{STNM:"STNM",CITYNAME:"CITYNAME",TOWNNAME:"TOWNNAME"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/19_HAZARD_LAND_P_1.png",symbolName:"\u96e8\u91cf\u7ad9"}]},SETTLEMENT:{name:"dbo.SETTLEMENT",oname:"dbo.SETTLEMENT_201208A",identify:{COUNTY:"COUNTY",TOWN:"TOWN",
VILLAGE:"VILLAGE",LOCATION:"LOCATION"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/19_HAZARD_LAND_P_2.png",symbolName:"\u805a\u843d"}]},AGED:{name:"dbo.AGED",oname:"dbo.AGED_201208A",identify:{NCDRID:"NCDRID",ID:"ID",COUNTY:"COUNTY",TOWN:"TOWN",NAME:"NAME",TYPE:"TYPE",ADDRESS:"ADDRESS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/19_HAZARD_LAND_P_3.png",symbolName:"\u793e\u798f\u6a5f\u69cb_\u8001\u4eba"}]},DISABLED:{name:"dbo.DISABLED",oname:"dbo.DISABLED_201208A",
identify:{NCDR:"NCDR",COUNTY:"COUNTY",NAME:"NAME",TOWN:"TOWN",ADDRESS:"ADDRESS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/19_HAZARD_LAND_P_4.png",symbolName:"\u793e\u798f\u6a5f\u69cb_\u8eab\u969c"}]},MONITOR_ROAD:{name:"dbo.MONITOR_ROAD",oname:"dbo.MONITOR_ROAD_201208A",identify:{ID:"ID",WORK:"WORK",MILEAGE:"MILEAGE",LOCATION:"LOCATION",RIVER:"RIVER"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/19_HAZARD_LAND_P_5.png",symbolName:"\u76e3\u63a7\u8def\u6bb5"}]},
MONITOR_BRIDGE:{name:"dbo.MONITOR_BRIDGE",oname:"dbo.MONITOR_BRIDGE_201208A",identify:{ID:"ID",WORK:"WORK",MILEAGE:"MILEAGE",LOCATION:"LOCATION",RIVER:"RIVER"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/19_HAZARD_LAND_P_6.png",symbolName:"\u76e3\u63a7\u6a4b\u6881"}]},DEBRIS:{name:"dbo.DEBRIS",oname:"dbo.DEBRIS_201208A",identify:{DEBRISNO:"DEBRISNO",COUNTRY:"COUNTRY",TOWN:"TOWN",VILLAGE:"VILLAGE"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/19_HAZARD_LAND_P_7.png",
symbolName:"\u571f\u77f3\u6d41\u5f71\u97ff\u7bc4\u570d"}]},DEBRISSTREAM:{name:"dbo.DEBRISSTREAM",oname:"dbo.DEBRISSTREAM_201208A",identify:{DEBRISNO:"DEBRISNO",COUNTY01:"COUNTY01",TOWN01:"TOWN01",VILL01:"VILL01",NAME:"NAME",MARK:"MARK",ROADNAME:"ROADNAME",DW_NUMBER:"DW_NUMBER",POTENTIAL:"POTENTIAL"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/19_HAZARD_LAND_P_8.png",symbolName:"\u571f\u77f3\u6d41\u6f5b\u52e2\u6eaa\u6d41"}]},LANDSLIDE:{name:"dbo.LANDSLIDE",oname:"dbo.LANDSLIDE_201208A",
identify:{DATA_ID:"DATA_ID",SLIDE_KIND:"SLIDE_KIND",YEAR:"YEAR",YEARBASIN:"YEARBASIN",BASIN:"BASIN"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/19_HAZARD_LAND_P_A.png",symbolName:"\u5c71\u5d29\u2500\u843d\u77f3"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/19_HAZARD_LAND_P_B.png",symbolName:"\u5c71\u5d29\u2500\u5ca9\u5c51\u5d29\u6ed1"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/19_HAZARD_LAND_P_C.png",symbolName:"\u5c71\u5d29\u2500\u5ca9\u9ad4\u6ed1\u52d5"}]},
DIPSLOPE:{name:"dbo.DIPSLOPE",oname:"dbo.DIPSLOPE_201208A",identify:{DATA_ID:"DATA_ID"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/19_HAZARD_LAND_P_9.png",symbolName:"\u9806\u5411\u5761"}]}}};
TGOS.MapIdInfo.HAZARD_FLOOD_P={resource:"HAZARD_FLOOD_P.cfg",layers:{RAINFALLSTATION:{name:"dbo.RAINFALLSTATION",oname:"dbo.RAINFALLSTATION_201208A",identify:{STNM:"STNM",CITYNAME:"CITYNAME",TOWNNAME:"TOWNNAME"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/20_HAZARD_FLOOD_P_1.png",symbolName:"\u96e8\u91cf\u7ad9"}]},GAUGINGSTATION:{name:"dbo.GAUGINGSTATION",oname:"dbo.GAUGINGSTATION_201208A",identify:{NAME_C:"NAME_C",CITYNAME:"CITYNAME",TOWNNAME:"TOWNNAME",LOCATION:"LOCATION",
BASIN_NAME:"BASIN_NAME",WARNINGL:"WARNINGL",WARNINGL_1:"WARNINGL_1",WARNINGL_2:"WARNINGL_2"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/20_HAZARD_FLOOD_P_2.png",symbolName:"\u6c34\u4f4d\u7ad9"}]},AGED:{name:"dbo.AGED",oname:"dbo.AGED_201208A",identify:{NCDRID:"NCDRID",ID:"ID",COUNTY:"COUNTY",TOWN:"TOWN",NAME:"NAME",TYPE:"TYPE",ADDRESS:"ADDRESS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/20_HAZARD_FLOOD_P_3.png",symbolName:"\u793e\u798f\u6a5f\u69cb_\u8001\u4eba"}]},
DISABLED:{name:"dbo.DISABLED",oname:"dbo.DISABLED_201208A",identify:{NCDR:"NCDR",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/20_HAZARD_FLOOD_P_4.png",symbolName:"\u793e\u798f\u6a5f\u69cb_\u8eab\u969c"}]},MONITOR_ROAD:{name:"dbo.MONITOR_ROAD",oname:"dbo.MONITOR_ROAD_201208A",identify:{ID:"ID",WORK:"WORK",MILEAGE:"MILEAGE",LOCATION:"LOCATION",RIVER:"RIVER"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/20_HAZARD_FLOOD_P_5.png",
symbolName:"\u76e3\u63a7\u8def\u6bb5"}]},MONITOR_BRIDGE:{name:"dbo.MONITOR_BRIDGE",oname:"dbo.MONITOR_BRIDGE_201208A",identify:{ID:"ID",WORK:"WORK",MILEAGE:"MILEAGE",LOCATION:"LOCATION",RIVER:"RIVER"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/20_HAZARD_FLOOD_P_6.png",symbolName:"\u76e3\u63a7\u6a4b\u6881"}]},"06HR150":{name:"dbo.06HR150_NCDR",oname:"dbo.06HR150_NCDR",identify:{COUNTY:"COUNTY",CLASS:"CLASS",NOTE:"NOTE"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",
symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf150mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf150mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf150mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"06\u5c0f\u6642\u964d\u96e8\u91cf150mm\u25002~3\u516c\u5c3a"},
{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf150mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"06HR250":{name:"dbo.06HR250_NCDR",oname:"dbo.06HR250_NCDR",identify:{COUNTY:"COUNTY",CLASS:"CLASS",NOTE:"NOTE"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf250mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",
symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf250mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf250mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"06\u5c0f\u6642\u964d\u96e8\u91cf250mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf250mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},
"06HR350":{name:"dbo.06HR350_NCDR",oname:"dbo.06HR350_NCDR",identify:{COUNTY:"COUNTY",CLASS:"CLASS",NOTE:"NOTE"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",
symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"06\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf350mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"12HR200":{name:"dbo.12HR200_NCDR",oname:"dbo.12HR200_NCDR",identify:{COUNTY:"COUNTY",CLASS:"CLASS",NOTE:"NOTE"},
legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+
"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"12\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf200mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"12HR300":{name:"dbo.12HR300_NCDR",oname:"dbo.12HR300_NCDR",identify:{COUNTY:"COUNTY",CLASS:"CLASS",NOTE:"NOTE"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf300mm\u25000.3~0.5\u516c\u5c3a"},
{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf300mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf300mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"12\u5c0f\u6642\u964d\u96e8\u91cf300mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",
symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf300mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"12HR400":{name:"dbo.12HR400_NCDR",oname:"dbo.12HR400_NCDR",identify:{COUNTY:"COUNTY",CLASS:"CLASS",NOTE:"NOTE"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf400mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf400mm\u25000.5~1\u516c\u5c3a"},
{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf400mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"12\u5c0f\u6642\u964d\u96e8\u91cf400mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf400mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"24HR200":{name:"dbo.24HR200_NCDR",
oname:"dbo.24HR200_NCDR",identify:{COUNTY:"COUNTY",CLASS:"CLASS",NOTE:"NOTE"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25001~2\u516c\u5c3a"},
{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"24\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf200mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"24HR350":{name:"dbo.24HR350_NCDR",oname:"dbo.24HR350_NCDR",identify:{COUNTY:"COUNTY",CLASS:"CLASS",NOTE:"NOTE"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",
symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"24\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25002~3\u516c\u5c3a"},
{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf350mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"24HR500":{name:"dbo.24HR500_NCDR",oname:"dbo.24HR500_NCDR",identify:{COUNTY:"COUNTY",CLASS:"CLASS",NOTE:"NOTE"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf500mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",
symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf500mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf500mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"24\u5c0f\u6642\u964d\u96e8\u91cf500mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf500mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},
"24HR650":{name:"dbo.24HR650_NCDR",oname:"dbo.24HR650_NCDR",identify:{COUNTY:"COUNTY",CLASS:"CLASS",NOTE:"NOTE"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf650mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf650mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",
symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf650mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"24\u5c0f\u6642\u964d\u96e8\u91cf650mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf650mm\u2500\u5927\u65bc3\u516c\u5c3a"}]}}};

TGOS.ThemeLayerID.HMS="M20";TGOS.ThemeTileID.CITYZONING="T02";TGOS.ThemeTileID.RURALZONING="T03";TGOS.ThemeTileID.TOPO1000="T01";TGOS.TGMapServiceId.CITYZONING="CITYZONING";TGOS.TGMapServiceId.RURALZONING="RURALZONING";TGOS.TGMapServiceId.TOPO1000="TOPO1000";TGOS.TGMapServiceId.TOPO1000_119="TOPO1000_119";TGOS.TGMapServiceId.HMS="HMS";TGOS.TGMapId.HMS="HMS";
TGOS.MapIdInfo.TOPO1000={tileoverlay:{path:getWebProtocal()+getAPIPath()+"TGOS_WMTS/TWD97/SimpleWMTS_TOPO10003826.aspx",layer:"Map",matrixSet:"TGOS97_TOPO1000.cfg"},resource:"CITYZONING.cfg",layers:{CITYZONING:{name:"dbo.CITYZONING",oname:"dbo.CITYZONING_201304A",identify:{Name:"Name",Classification:"Classification",County:"County"}}}};
TGOS.MapIdInfo.TOPO1000_119={tileoverlay:{path:getWebProtocal()+getAPIPath()+"TGOS_WMTS/TWD97/SimpleWMTS_TOPO10003826.aspx",layer:"Map",matrixSet:"TGOS97_TOPO1000_119.cfg"},resource:"CITYZONING.cfg",layers:{CITYZONING:{name:"dbo.CITYZONING",oname:"dbo.CITYZONING_201304A",identify:{Name:"Name",Classification:"Classification",County:"County"}}}};
TGOS.MapIdInfo.CITYZONING={tileoverlay:{path:getWebProtocal()+getAPIPath()+"TGOS_WMTS/TWD97/SimpleWMTS_CITYZONING3826.aspx",layer:"Map",matrixSet:"TGOS97_CITYZONING.cfg"},resource:"CITYZONING.cfg",layers:{CITYZONING:{name:"dbo.CITYZONING",oname:"dbo.CITYZONING_201304A",identify:{Name:"Name",Classification:"Classification",County:"County"}}}};
TGOS.MapIdInfo.RURALZONING={resource:"RURALZONING.cfg",tileoverlay:{path:getWebProtocal()+getAPIPath()+"/TGOS_WMTS/TWD97/SimpleWMTS_RURALZONING3826.aspx",layer:"Map",matrixSet:"TGOS97_RURALZONING.cfg"},layers:{RURAL:{name:"dbo.RURAL",oname:"dbo.RURAL_201304A",identify:{Code_Cou:"Code_Cou",Classification:"Classification"}},PARK:{name:"dbo.PARK",oname:"dbo.PARK_201304A",identify:{Name:"Name",Classification:"Classification"}}}};
TGOS.MapIdInfo.HMS={resource:"HMS.cfg",layers:{HMS:{name:"dbo.HMS",oname:"dbo.HMS_201205A",identify:{TYPE:"TYPE",NAME:"NAME",ADDRESS:"ADDRESS",MANAGER:"MANAGER",CONTACT:"CONTACT"},buffer:{TYPE:"TYPE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",MANAGER:"MANAGER",CONTACT:"CONTACT"},query:{TYPE:"TYPE",NAME:"NAME",COUNTY:"COUNTY",TOWN:"TOWN",ADDRESS:"ADDRESS",MANAGER:"MANAGER",CONTACT:"CONTACT"}}}};

TGOS.TGMapTypeId.MOTCMAP="MOTCMAP";TGOS.TGMapTypeIdCode.MOTCMAP="B03";TGOS.TGMapTypeId_zh_TW.MOTCMAP="\u8def\u7db2\u6578\u503c\u5716";TGOS.MapTypeDocumentName.MOTCMAP=getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_MOTCMAP3826.aspx";TGOS.MapTypeDocumentNameGoogle.MOTCMAP=getWebProtocal()+getAPIPath()+"Agent/Google/Agent_MOTCMAP3857.aspx";TGOS.MapTypeIndexViewId_zh_TW.MOTCMAP="\u8def\u7db2\u6578\u503c\u5716\u7d22\u5f15";TGOS.MapTypeIndexViewDocumentName.MOTCMAP=getWebProtocal()+getAPIPath()+"Agent/TWD97/Agent_MOTCMAP3826_IV.aspx";
TGOS.MapTypeIndexViewDocumentNameGoogle.MOTCMAP=getWebProtocal()+getAPIPath()+"Agent/Google/Agent_MOTCMAP3857_IV.aspx";TGOS.MapTypeBackgroundColor.MOTCMAP="#a5bfdd";TGOS.MapTypeMaxZoomLevel.EPSG3825.MOTCMAP=12;TGOS.MapTypeMaxZoomLevel.EPSG3826.MOTCMAP=12;TGOS.MapTypeMaxZoomLevel.EPSG3857.MOTCMAP=18;TGOS.ThemeLayerID.FLOOD_P="M07";TGOS.TGMapServiceId.FLOOD_P="FLOOD_P";TGOS.TGMapId["06HR150"]="06HR150";TGOS.TGMapId["06HR250"]="06HR250";TGOS.TGMapId["06HR350"]="06HR350";TGOS.TGMapId["12HR200"]="12HR200";
TGOS.TGMapId["12HR300"]="12HR300";TGOS.TGMapId["12HR400"]="12HR400";TGOS.TGMapId["24HR200"]="24HR200";TGOS.TGMapId["24HR350"]="24HR350";TGOS.TGMapId["24HR500"]="24HR500";TGOS.TGMapId["24HR650"]="24HR650";
TGOS.MapIdInfo.FLOOD_P={resource:"FLOOD_P.cfg",layers:{"06HR150":{name:"dbo.06HR150",oname:"dbo.06HR150",identify:{COUNTY:"COUNTY",WDEPTH:"NOTE",CLASS:"CLASS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf150mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf150mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+
getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf150mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"06\u5c0f\u6642\u964d\u96e8\u91cf150mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf150mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"06HR250":{name:"dbo.06HR250",oname:"dbo.06HR250",identify:{COUNTY:"COUNTY",
WDEPTH:"NOTE",CLASS:"CLASS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf250mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf250mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf250mm\u25001~2\u516c\u5c3a"},
{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"06\u5c0f\u6642\u964d\u96e8\u91cf250mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf250mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"06HR350":{name:"dbo.06HR350",oname:"dbo.06HR350",identify:{COUNTY:"COUNTY",WDEPTH:"NOTE",CLASS:"CLASS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",
symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"06\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25002~3\u516c\u5c3a"},
{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"06\u5c0f\u6642\u964d\u96e8\u91cf350mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"12HR200":{name:"dbo.12HR200",oname:"dbo.12HR200",identify:{COUNTY:"COUNTY",WDEPTH:"NOTE",CLASS:"CLASS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",
symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"12\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf200mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},
"12HR300":{name:"dbo.12HR300",oname:"dbo.12HR300",identify:{COUNTY:"COUNTY",WDEPTH:"NOTE",CLASS:"CLASS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf300mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf300mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",
symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf300mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"12\u5c0f\u6642\u964d\u96e8\u91cf300mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf300mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"12HR400":{name:"dbo.12HR400",oname:"dbo.12HR400",identify:{COUNTY:"COUNTY",WDEPTH:"NOTE",CLASS:"CLASS"},legends:[{iconUrl:getWebProtocal()+
getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf400mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf400mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf400mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",
symbolname:"12\u5c0f\u6642\u964d\u96e8\u91cf400mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"12\u5c0f\u6642\u964d\u96e8\u91cf400mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"24HR200":{name:"dbo.24HR200",oname:"dbo.24HR200",identify:{COUNTY:"COUNTY",WDEPTH:"NOTE",CLASS:"CLASS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25000.3~0.5\u516c\u5c3a"},
{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"24\u5c0f\u6642\u964d\u96e8\u91cf200mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",
symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf200mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"24HR350":{name:"dbo.24HR350",oname:"dbo.24HR350",identify:{COUNTY:"COUNTY",WDEPTH:"NOTE",CLASS:"CLASS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25000.5~1\u516c\u5c3a"},
{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"24\u5c0f\u6642\u964d\u96e8\u91cf350mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf350mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"24HR500":{name:"dbo.24HR500",
oname:"dbo.24HR500",identify:{COUNTY:"COUNTY",WDEPTH:"NOTE",CLASS:"CLASS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf500mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf500mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf500mm\u25001~2\u516c\u5c3a"},
{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"24\u5c0f\u6642\u964d\u96e8\u91cf500mm\u25002~3\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf500mm\u2500\u5927\u65bc3\u516c\u5c3a"}]},"24HR650":{name:"dbo.24HR650",oname:"dbo.24HR650",identify:{COUNTY:"COUNTY",WDEPTH:"NOTE",CLASS:"CLASS"},legends:[{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_1.png",
symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf650mm\u25000.3~0.5\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_2.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf650mm\u25000.5~1\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_3.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf650mm\u25001~2\u516c\u5c3a"},{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_4.png",symbolname:"24\u5c0f\u6642\u964d\u96e8\u91cf650mm\u25002~3\u516c\u5c3a"},
{iconUrl:getWebProtocal()+getAPIPath()+"TGOS_API/ThemeLegend/17_FLOOD_P1_5.png",symbolName:"24\u5c0f\u6642\u964d\u96e8\u91cf650mm\u2500\u5927\u65bc3\u516c\u5c3a"}]}}};
